"commit id","commit date","commit message"
"4dafbcd924b8c9a21461341e85eda4acf6b25e14","2010-03-07 23:07:32+00:00","And this is 1.2.0svn now

svn-id: r48178
"
"f7b1faedc251348692942b7cffbabea6959b7827","2010-03-08 00:33:36+00:00","Switch to the other DOSBox OPL emulator as suggested by the DOSBox developers.

svn-id: r48179
"
"f67f7d36f1f3bba5b571aef261e3be61dbd1fab9","2010-03-08 00:34:01+00:00","Cleanup.

svn-id: r48180
"
"e941780d39c6f12f7bb2622d39b46b8c3350aded","2010-03-08 00:34:29+00:00","Use memset instead of a custom loop for zeroing the sample buffer.

svn-id: r48181
"
"b8901a47419b0e8c98820fb8cad54d4e7dabc5b9","2010-03-08 00:34:53+00:00","Add a slight comment when the DBOPL sources where synched with DOSBox.

svn-id: r48182
"
"50116130efedc66ec8261df6080fb7ca6fe079f7","2010-03-08 00:54:05+00:00","Show an error message in case multiple OPL outputs are created instead of using an assert.

The new DBOPL emulator we are using should support multiple instances though. We *might*
consider allowing as many instances as the user wants. Of course since the original
games only had one OPL chip available, that should not be required. Also just in case
we might allow real hardware as playback device that would be out of the question again
too.

svn-id: r48183
"
"f24cc1c8be08448c8412afef29be3ffa4ff09dd5","2010-03-08 10:27:42+00:00","Tweak makeVOCDiskStream

* now takes a SeekableReadStream *pointer* like (almost) all other
audiostream factories
* fix potential memory leak in it
* rename takeOwnershipOfStream to disposeAfterUse for consistency

svn-id: r48184
"
"9fb27a26f86dcf888cb26cc1b4622c5a10de3fb5","2010-03-08 10:28:14+00:00","Remove unnecessary #includes

svn-id: r48185
"
"28c6c600d45b4ce16f13d08cfc7c9fbcc8461a63","2010-03-08 10:29:00+00:00","Move some aspect ratio related stuff to graphics/scaler/aspect.h

svn-id: r48186
"
"d239d5c2f82c1e2dea09ed27475ec136a7ea3b5f","2010-03-08 10:29:35+00:00","SCALERS: Change 'bitformat' template params to 'colormasks';
get rid of some #defines

svn-id: r48187
"
"78b6bed8db4052d97d37fa4ca0bac1bab7b669c3","2010-03-08 10:29:52+00:00","Code formatting

svn-id: r48188
"
"a558e60fec492d837f05a5b0e3a62b40b48e7964","2010-03-08 10:30:23+00:00","SCALERS: Get rid of MAKE_WRAPPER; make RGBtoYUV internal

svn-id: r48189
"
"deec3408a1b6e40144fc3b6cf75fa701d7e7f774","2010-03-08 10:30:39+00:00","Move some var declarations into '#ifdef USE_NASM'

svn-id: r48190
"
"0fc137cdf2f04d676b196efb6bc0599efd53e84f","2010-03-08 10:31:09+00:00","Rename PocketPCPortrait scaler to DownscaleHorizByThreeQuarters,
and move it to graphics/scaler.

svn-id: r48191
"
"2cdf8996f3394e3bde74eba404bdde121b41abe7","2010-03-08 10:31:42+00:00","Rename PocketPCLandscapeAspect to Normal1xAspect and move it to
graphics/scaler/aspect.cpp

svn-id: r48192
"
"569273040e42245a92d68fa98d79c7e57edb1c34","2010-03-08 10:32:05+00:00","Remove redundant code

svn-id: r48193
"
"706769a3dc616a7ab133bca84dae6bebfc182b7b","2010-03-08 10:32:28+00:00","Rewrite Normal1xAspect (untested, may be broken)

svn-id: r48194
"
"e90f074177e83630efdafe16fe59d4d1e42ab05a","2010-03-08 10:32:45+00:00","Add new aspect ratio scaler variant, based on the Normal2xAspect ARM code

svn-id: r48195
"
"807f0223d724d46b5320585b11d1597a30daa0e9","2010-03-08 19:07:31+00:00","Fix compilation.

svn-id: r48196
"
"56bd4a6e18b8bf6a3a91ee07fc881493e7819816","2010-03-08 19:16:50+00:00","Use a template for hq2x and hq3x instead of using #include and defines.

svn-id: r48197
"
"c554c8541e6b30fc4cf9bf858184cac8a5c8df1b","2010-03-08 20:11:44+00:00","WINCE: Rewrote SmartphoneLandscape scaler C version to match what the ARM assembler version does (untested)

svn-id: r48198
"
"5e8743d0d61ddd22f1475bf6448747c1959e6340","2010-03-08 20:12:17+00:00","SCI: Made some stuff static

svn-id: r48199
"
"688288ec7dd558170bbcf7298dde501faafe0a47","2010-03-08 21:33:23+00:00","Re-enable the arm asm costume drawer

svn-id: r48201
"
"38bf3d0d3c468cf5a51bf5d5e7393ffcad68eea1","2010-03-08 21:54:07+00:00","SCI: Make EngineState parameter to INV_SEL explicit

svn-id: r48202
"
"3366a19c37516389f312c43ae23636896ccdc5bf","2010-03-08 21:54:32+00:00","Fix bug #2872076 (MIXER: Division by 0 in rate conversion if w/o soundcd)

svn-id: r48203
"
"9bf5bbf9bf17b80eba2aa83447f0e6c019e36074","2010-03-08 22:14:57+00:00","Move gBitFormat definition so it works in both sizes of an ifdef.

svn-id: r48205
"
"575ddc434c1c846780fd78b8bdf3e9dcf3a35970","2010-03-08 22:25:38+00:00","Add missing include that caused build failures with Normal1xAspect and
Normal2xAspect being undefined.

svn-id: r48206
"
"bc2b90f43bb558bd5e0fcdc470499e4fc65ebcbb","2010-03-08 23:36:59+00:00","Workaround for bug #1878514: COMI: Glitch when turning pages in recipe book

svn-id: r48207
"
"6dacac2187e999f06a7bae04dda609669c8c3440","2010-03-08 23:56:59+00:00","Conistenlty use USE_NASM instead of using HAVE_NASM in config.mk (this matches all the external library use too).

svn-id: r48208
"
"b84beeb602bcc0849209f4c19dc4a672724231fe","2010-03-09 00:43:31+00:00","Add missing MKDIR command. This was upsetting the WinCE build.

I can't see how this should upset any other build, and every other rule
seems to have this (or a variant of this) anyway, so...

svn-id: r48209
"
"3eab993d03b9d27524d9b227c15276d7997f7419","2010-03-09 00:45:24+00:00","Only use CXX_UPDATE_DEP_FLAG for .S file rule, in case it is defined. (Thus matching the .cpp etc. file rules).

svn-id: r48210
"
"99e032e9545c6639f9d41a90d4e836fa570cc27b","2010-03-09 01:20:23+00:00","Fix missing definition of gBitFormat.

svn-id: r48213
"
"d9c4ee9376bde0a744ceae9fe6536664ffa08ac3","2010-03-09 05:03:38+00:00","Initialise 'releaseAdd' to avoid a Valgrind warning in Write20() when the
emulator is initialised.

svn-id: r48214
"
"da81c58af12467d3138caf8ee1664d7bbf290d60","2010-03-09 23:35:30+00:00","DRASCULA: Some cleanup; turn some global C++ objects into members of DrasculaEngine

svn-id: r48215
"
"c6f752ce30c6b13cc46990e507c2db443558c35a","2010-03-09 23:35:56+00:00","DRASCULA: Simplified some code, cleanup

svn-id: r48216
"
"fc50408ce38d562d73fea2182659a4800852dcb5","2010-03-09 23:36:18+00:00","DRASCULA: Simplify playFLI and its subroutines

svn-id: r48217
"
"65585f643375e71d21d1c33e7c2f9a118897837d","2010-03-10 06:39:23+00:00","Silenced some harmless cppcheck warnings about unreachable code after a return.
In this case, it was always a break after a return in a switch case. There are
similar cases which cppcheck didn't detect, and a couple of cases where we have
a break after a continue in a switch case (where the continue refers to an
outer loop), but I didn't touch those. Not yet, at least.

svn-id: r48218
"
"ae3cf39763aef27f73bdf97b591896cac9f26ffc","2010-03-10 10:57:03+00:00","Patch #2967256: Bashisms in configure break build on Solaris

svn-id: r48219
"
"77592b5690d227c48520427a3c0600a58471685c","2010-03-10 11:26:27+00:00","Fix warning

svn-id: r48222
"
"ca6469840801235f5bb901828cd89f8a549f343f","2010-03-10 11:43:48+00:00","Split up the SceneResources class into a generic common set, with specific versions each for M4 and Mads, and merged the MadsSceneInfo data into it

svn-id: r48223
"
"91e7d2746883b622648d6542d34345e1a18fb943","2010-03-10 17:05:25+00:00","Fix bug #2963556: SAGA: Memory leaks

svn-id: r48224
"
"80fae481b0d97b8de64803275067fa08dbe1c720","2010-03-10 20:33:38+00:00","Fix a valgrind warning.

It is *not* a good idea to pass a reference to a list entry to List::remove.
Since List::remove will remove *all* occurances of that list entry, it will
also invaldiate the reference, resulting in invalid memory reads after the
entry has been removed from the list, when List::remove will continue to
search the rest of the list for more occurances of the same entry.

svn-id: r48225
"
"8d1431a5ab0efe7c4f84f7c0fcdff10f8fe39ad1","2010-03-10 20:56:54+00:00","AGOS: cleanup

svn-id: r48227
"
"5af51ba9a1f60f740401fdb513d1a961c590e527","2010-03-10 20:58:09+00:00","N64: code formatting

svn-id: r48228
"
"c97ee14a65afc0b8a11ef5c10105e966f67a5934","2010-03-10 21:01:44+00:00","Remove last traces of OSystem::getOutputSampleRate()

svn-id: r48229
"
"43abd0e0192d290d3cf256bbc7cf16869031b98b","2010-03-10 21:03:50+00:00","cleanup

svn-id: r48230
"
"05b8c5b9c52f787caa865be99868c547cc714fa2","2010-03-10 21:05:48+00:00","Replace mutex_up/mutex_down methods by Common::StackLock

svn-id: r48231
"
"802ed6eb40f085d5752f96ec2bac69903ca4302a","2010-03-10 21:44:58+00:00","Fix bug #2963556: SAGA: Memory leaks #2
isomap-malloc to Common::Array conversation

svn-id: r48232
"
"31f980ffde0edd77594b7eece673dd5f0ec35962","2010-03-11 06:14:52+00:00","Adding support for the very primitive and simply early IMD format used in Fascination

svn-id: r48233
"
"c8d5f21010808f572016fbc13da424e67978f933","2010-03-11 06:15:23+00:00","Adding support for the early Fascination IMD format

svn-id: r48234
"
"8191092c18ef68cb4f085d26fdf615a61eb05ef0","2010-03-11 06:15:51+00:00","Loading the intro videos tira.imd and tirb.imd as early PreIMD

svn-id: r48235
"
"5886a0cc7715c874919a7056dfb6b65d3be19dce","2010-03-11 19:47:59+00:00","Removing a debug warning() and adding some comments

svn-id: r48236
"
"9b837d66d4647a7642a761cefe5798d30a21504a","2010-03-11 23:39:51+00:00","Replace Audio::MixerImpl::setOutputRate with a new 'sampleRate' param to the MixerImpl constructor

svn-id: r48238
"
"77fc15ce825963dc736aabdfd11628cdb26fd300","2010-03-11 23:40:19+00:00","MIXER: Change MixerImpl::playInputStream to error out when mixer is not ready

My previous commit which tried to support this does not work correctly when
using QueuingAudioStream; it then just leads to nasty crashes. Hence I am
removing this again for now, until I get around to implement one of the
better alternatives.

svn-id: r48239
"
"6e78fdc161501ed6d2be0e4004915b3660623647","2010-03-11 23:40:40+00:00","cleanup

svn-id: r48240
"
"4fc8ebab017a18b83ca82e930f02ceeac6313de7","2010-03-11 23:41:28+00:00","GUI: Remove GuiObject::getMillis()

svn-id: r48241
"
"8f560e5aaf779b754a32d35840930d4c3f736c13","2010-03-12 00:37:25+00:00","Fix typos

svn-id: r48242
"
"d3c29a62ae185bc8e16e0f227899b374bbe5784b","2010-03-12 00:46:54+00:00","GP2X: Try to fix compile error

svn-id: r48243
"
"314a119b9d506ac866bfeae7145c84bb253f3a65","2010-03-12 10:31:58+00:00","GP2x: Oops, forgot to checkin this file

svn-id: r48244
"
"bee3321ec44cbadf669987d81477b9a4313e1981","2010-03-12 13:10:37+00:00","This hopefully fixes building on win64.

svn-id: r48245
"
"79662919c6358954a020b7d4ed52b6ecf93327f1","2010-03-12 22:34:54+00:00","Fix bug #2969282: DW2: Weird 'PC SPEAKER-like' sound distortion.

svn-id: r48246
"
"75a3f4a3ecde4837976481fd1b7ea56bef0d0e25","2010-03-12 23:02:24+00:00","Fix from LordHoto for bug #2859401: GUI: GMM crashes when running in 320x200 and 320x240

svn-id: r48248
"
"124d1cacac9cece44d806513475f5b7de5d773d1","2010-03-13 18:19:43+00:00","rename samygo to cl

svn-id: r48250
"
"958fa8d5cbe1ccffdaf6812f39238fccb67307a4","2010-03-13 19:30:12+00:00","cleanup samsungtv sdl-config

svn-id: r48251
"
"40562798d6670775768224f77514ed000ff78c38","2010-03-13 21:55:49+00:00","Fix our DECLARE_SINGLETON macro to conform to the C++ specs.

We need to use a namespace Common { } there to make strict C++ compilers
like clang++ and comeau happy. I also added a slight comment about why
that is needed to the macro definition and a note that you need to use
it from the global namespace.

svn-id: r48254
"
"f4bf67cd217bec611cfa39b4d3c557a2413c2f15","2010-03-14 03:40:16+00:00","Increased the default Discworld 2 double-click time from 0.33 seconds to 0.55 seconds (from 6 to 10 frames)

svn-id: r48255
"
"77c821249e706875c45689ea8361773955cbd532","2010-03-14 05:39:47+00:00","Further work on separating M4 specific scene code into the m4_scene.cpp file

svn-id: r48256
"
"404088f58b0630ee357a03123e917c30d7674ee2","2010-03-14 05:47:33+00:00","Further separation of MADS and M4 scene logic

svn-id: r48257
"
"92aafad6c9f289a14e81cae228db4bfe5d68e49e","2010-03-14 09:24:59+00:00","add meta file for samsung tv 2008

svn-id: r48258
"
"77c033aca7c24b9d9d0a8900401b56452c069d87","2010-03-14 09:28:35+00:00","fixed terminate line

svn-id: r48260
"
"a9b7722df35f94d79363886534f393929e305e80","2010-03-15 17:44:59+00:00","The frame coordinate cropping for IMDs is wrong, and should be unnecessary anyway, since Imd::renderFrame() should already check for overblitting. This fixes bug #2969904 ('GOB3: Graphical Glitch in finished cutscene')

svn-id: r48262
"
"a1f1cdf820f5eefac4fbcba8a596646fc05b954e","2010-03-15 22:24:11+00:00","Changing Imd::renderFrame() and Vmd::renderFrame() to properly clip the drawing area to prevent overdrawing without producing garbage output

svn-id: r48264
"
"730405f975e05659b5f37ffd5bd8761eb20c7af4","2010-03-16 08:26:08+00:00","Further code implemented for the current action display

svn-id: r48266
"
"2035cdbba88d295af1b2e56c335e78db892f49e0","2010-03-16 08:38:06+00:00","Add patch #2970899 - MM V0: flipped limbs drawing fix.

svn-id: r48267
"
"a7e6397fa417cf64fa6f99a919ea0fbad5de616e","2010-03-16 08:43:46+00:00","Add patch #2971126 - MM V0: Ed(na) walk fix.

svn-id: r48268
"
"b968a69468f2806f46457af01d8f764957fdd8a4","2010-03-16 08:59:48+00:00","Add patch #2970176 - V0: MM Verb + Anim Fix.

svn-id: r48269
"
"2624b72513e25f2b55015614b5a2e9971fb9c28e","2010-03-16 14:13:52+00:00","SCI: fix assert in sound code when fadeout is done (lsl1 bug #2970301)

svn-id: r48271
"
"1242a4eb8c4f8c1cd5d3715bf2ecbc63c72f46db","2010-03-16 14:34:25+00:00","Some style fixes.

svn-id: r48272
"
"072e3806f1ec1668cac662e4dac81f4d8493cb0d","2010-03-16 19:59:12+00:00","Add detection for Adiboo 2.14. Specify the exact version of a Adi 4.0

svn-id: r48273
"
"80a81111938088f6730a5abfd03e6004f0c807bf","2010-03-17 20:29:26+00:00","Use resSize instead of computing its value again.

svn-id: r48274
"
"a17bbf3c2e8b9f9983adf2fd84fa8c7525f78cbb","2010-03-18 15:04:15+00:00","GUI: Make GuiObject::_name const, init all members in constructor

svn-id: r48275
"
"4e99cfc549d404c8c7b9b3e3478e12975039980d","2010-03-18 15:04:38+00:00","Switch from Common::tag2string(foo).c_str() to tag2str(foo)

svn-id: r48276
"
"0e0e11e6417fc431329386a5bb17cea3f84d1c5a","2010-03-18 15:04:57+00:00","Fix warnings

svn-id: r48277
"
"ef93d6921ee4dfed349093bd7378d99107d9e211","2010-03-18 15:05:14+00:00","Make keymapper compilable again

svn-id: r48278
"
"d78dba3bcae77e85107836cfeecaa958b7ebe4d4","2010-03-18 15:07:11+00:00","COMMON: Move Common::RandomSource to common/random.*

svn-id: r48279
"
"3e63df54152c278ea28b430875c82b00d2109967","2010-03-18 15:07:30+00:00","COMMON: Move port specific '#define fputs' from util.cpp to textconsole.cpp

svn-id: r48280
"
"30c84d2cff41924e6229d0cacd3d36ce1c2bf6ac","2010-03-18 15:07:48+00:00","COMMON: Move tag2str from util.h to str.h

svn-id: r48281
"
"c934642bdb7e6747a20054d7cc7b079e69bc22c2","2010-03-18 15:09:24+00:00","COMMON: Move typedef StringList from str.h to new header str-array.h

This removes the dependency on array.h from str.h.
Also, begun migration from the confusing type name 'StringList' to
the more appropriate StringArray.

svn-id: r48282
"
"8db54382bb1b5e2c3b8d262cff54b3edf62fd841","2010-03-18 15:09:48+00:00","ENGINES: Move SaveStateDescriptor etc. to engine/savestate.*

svn-id: r48283
"
"4e7dddadbc8a5bfa689adb4f2a58d9f490aca6c7","2010-03-18 15:10:07+00:00","SCUMM: Add WORKAROUND comment

svn-id: r48284
"
"75de0ebccbc2680758e1ae83b913eb481f90aeda","2010-03-18 15:39:56+00:00","TINSEL: Change SaveSceneSsData from char* to SAVED_DATA*

svn-id: r48285
"
"81a698d0a0a52115088825523950047d135b0ca0","2010-03-18 15:44:59+00:00","Convert some occurences of StringList to StringArray;
try to fix compile error in GP2x code

svn-id: r48286
"
"cac0ac66e22d18a57958ef342e6b115e35197e90","2010-03-18 15:54:40+00:00","COMMON: Get rid of Common::StringList

svn-id: r48287
"
"156a106ebcfaadbe8d2ff28cc05894ae79bc4204","2010-03-18 16:53:20+00:00","Trying to fix compilation (porters should review these changes, seems I uncovered some lurking old breakage)

svn-id: r48289
"
"ad8584d25c26f9feac82031fb9db050a140c5869","2010-03-18 20:19:58+00:00","One more try to make DC & PSP compile again

svn-id: r48290
"
"3f2057226f438244b8b7b84bcb5fc41040bd9339","2010-03-18 21:45:27+00:00","Commit salty-horse's patch for VectorRendererSpec.cpp, which fixes the use of invalid C++.

svn-id: r48291
"
"77411ff0f9356036bb45720ff98df951492600d1","2010-03-18 22:35:58+00:00","added abstract Pack class, moved code into FilePack and MemoryPack

svn-id: r48292
"
"062ac9f6f22ca141e078a5f34bddbf86da7e33ed","2010-03-18 22:37:07+00:00","do not seek for the empty assets

svn-id: r48293
"
"e245de962ac30fa1a6676a6fbf5e27f61c8c595c","2010-03-18 23:24:32+00:00","removed 'varia.res' from the resident pack files

svn-id: r48295
"
"412e63123e14e4bb838c9b1b8f7596ca53201f9f","2010-03-18 23:30:29+00:00","code convention fixes mentioned by Max Horn

svn-id: r48296
"
"b2b7a08cc2a502e0f6f9ec98afd85f30bdc529ab","2010-03-19 09:19:23+00:00","Beginnings of hooking up the new logic for current action display

svn-id: r48298
"
"b9d876e23a46c1619393438bc875e9e07a8dd82b","2010-03-19 11:55:18+00:00","PSP: removed unneeded overload of addCustomDirectories()

svn-id: r48299
"
"23547d60416719732fcc063e8fd9f1cd958453b8","2010-03-19 13:46:59+00:00","DC: Removing unneeded DCPluginProvider::addCustomDirectories

svn-id: r48301
"
"9015be816584165d428cdecaf434f30934b35f22","2010-03-19 13:55:25+00:00","Also remove Win32PluginProvider::addCustomDirectories, as it obviously isn't being used

svn-id: r48304
"
"a0f90fd603bfa474ed8082ca18b272ad1b490578","2010-03-20 12:13:37+00:00","Add common/util.h include to common/algorithm.h for SWAP.

This should fix the compilation with clang++, see bug report
#2971226 'COMMON: Compile error - SWAP undeclared in algorithm.h'.

svn-id: r48307
"
"a5c66b64f53332bc5245f167efb37392d392a3ee","2010-03-20 12:18:13+00:00","do not read last dummy entry in pack

svn-id: r48308
"
"8f30fa1a6cad5c03ff8fc6476357994592ec8d25","2010-03-20 12:18:56+00:00","marked all methods with virtual

svn-id: r48309
"
"38b2b3c04fcba9b767ea0121a558abcb7314675f","2010-03-20 12:56:56+00:00","Move StringTokenizer to its own files (tokenizer.h/tokenizer.cpp).

svn-id: r48310
"
"794fcf01709e3b97a0e4771cb998a9dc4d61d5a5","2010-03-20 12:57:12+00:00","Sort object files.

svn-id: r48311
"
"5c1a63026ef9000e08d6b8e05912cb15b5cd0b31","2010-03-20 13:00:23+00:00","Remove unused stdarg.h include.

svn-id: r48312
"
"e1177833790f0dc01cdcb392f729c7fd7e8d0395","2010-03-20 13:18:47+00:00","Some style fixes.

svn-id: r48313
"
"23f63e7531120ec67324e8cfcb6581cb4e2a3f3e","2010-03-20 13:52:08+00:00","added TransientFilePack

svn-id: r48314
"
"76c9e2a4f29f8c0f9e956d86fb747f9a5898e7ee","2010-03-20 13:54:05+00:00","added close()

svn-id: r48315
"
"34811eb8dd689eaf402ac2e3e7df37c8ba8ce94e","2010-03-20 13:55:07+00:00","removed 'subtitle' option, added missing finalize

svn-id: r48316
"
"4145c2ea887ca95e611cc1399ec26a896a5f8baa","2010-03-20 13:55:33+00:00","use TransientFilePack on psp

svn-id: r48317
"
"e037ea19acfa510ade04730ac6e2fae0585b61cd","2010-03-20 14:24:19+00:00","fixed compilation error

svn-id: r48318
"
"f122762309b84aaebb9b5f20559d1fe8e34e8577","2010-03-20 14:53:46+00:00","fixed file leak, cleanups

svn-id: r48319
"
"4da76a96d8419e01f919d9fc56f1e0c7852ee8fb","2010-03-20 15:00:42+00:00","restored subtitle feature

svn-id: r48320
"
"73d5251738459abb10b99fdf7b1fa18ec2ccd20a","2010-03-20 15:24:16+00:00","fixed stream leaks

svn-id: r48321
"
"6fb96d7e908a524c5f1abf3d3ad1f1e2c4033872","2010-03-20 15:52:31+00:00","DS: Changing version number on title screen

svn-id: r48322
"
"a61e36dcd2be51b3e1221d30b0dd29b95b8bdeed","2010-03-20 16:08:28+00:00","documented pack classes, restored old substream creation for FilePack

svn-id: r48324
"
"9c2289b7a3d79e283d5e710d996557796f45511a","2010-03-20 16:23:15+00:00","flush inventory items on savegame load, fixing invalid item tiles after multiple loads.

svn-id: r48325
"
"9d4cb7c23c91d3db4cb00752b1b0887d7fb97a09","2010-03-20 16:45:11+00:00","Add missing tokenizer.h include.

svn-id: r48326
"
"b5d3d0ebcff5a369e4bea4ccdd73877e674ce3f3","2010-03-20 16:52:51+00:00","fixed another stream leak

svn-id: r48327
"
"7666cac789506b367c504da41ce105e5e351c3dd","2010-03-20 17:06:18+00:00","removed auto_ptr semantics in a favor of boost's scoped_ptr

svn-id: r48329
"
"1bcf90c2e31ea85dc8df6660223f3a0b16d3dbbc","2010-03-20 18:02:43+00:00","fixed endianess issue

svn-id: r48331
"
"88656ae7c624c897daa20100d009d91fef083f6b","2010-03-20 18:15:32+00:00","cleaned up inventory activation, enter toggles the inventory.

svn-id: r48332
"
"3c884abfa6d6f2fe1f99f275d526952783c3962b","2010-03-20 19:48:21+00:00","textual cleanups

svn-id: r48333
"
"abdfbafa45bb65f7ce315a04411d1a8ffb9e5d50","2010-03-20 20:01:44+00:00","added ScopedPtr template

svn-id: r48334
"
"6e628f59dcbbcdfbccfee569c20450dbb1b48523","2010-03-20 20:03:58+00:00","removed local scopedptr

svn-id: r48335
"
"2a2cfe7ab04331633e7f0ba5b417038524016965","2010-03-20 20:16:16+00:00","Style fixes / cleanup.

svn-id: r48336
"
"a8d2c0de100ed132e0376c9a337a45d1bc7a0c69","2010-03-20 20:25:12+00:00","- Renamed SharedPtr<T>::Pointer to SharedPtr<T>::PointerType
- Introduced ReferenceType to SharedPtr and ScopedPtr

svn-id: r48337
"
"01f56108363514812860abe2620e677a1f30b7ec","2010-03-20 20:25:37+00:00","Fix out of bounds access.

svn-id: r48338
"
"22dd1a616f4c763936e9227fbc96a2414c5acb7c","2010-03-20 20:37:36+00:00","ported all code to ScopedPtr

svn-id: r48340
"
"933299f6b9360299e5799d835d1cff7acfe93cf6","2010-03-20 22:03:28+00:00","fixed inventory object overflow

svn-id: r48341
"
"109dbcbca6731b0e07163da69bb73ce58702d614","2010-03-20 23:04:18+00:00","reverted inventory objects patch, added mark's animation z-order patch.

svn-id: r48342
"
"6e9b43009c92ba4c9df52f93375b56cb7bec3150","2010-03-20 23:40:13+00:00","documented psp hack

svn-id: r48343
"
"ee2215eaeec86cfe55c28ddc438d8f1d55a1add0","2010-03-21 07:13:13+00:00","reverted the z-order patch.

svn-id: r48348
"
"76ef5d4aea87d07ccf1fd4fbba33af2aae9c42e8","2010-03-21 07:38:09+00:00","-added overlay rendering flag
-fixed music played too late on some scenes

svn-id: r48349
"
"338532ec3c1eff284f5b8876b1058531b2af46c5","2010-03-21 07:49:53+00:00","preload inventory graphics on load

svn-id: r48350
"
"487eebf9cf3b210322d8982c07fc65538a45bd23","2010-03-21 10:34:10+00:00","Autodetect long V numbers and shorten them.

svn-id: r48351
"
"e6619b579299ecefcf9cf6daf0e272cb86136aa4","2010-03-21 10:35:15+00:00","Ack, typo!

svn-id: r48352
"
"05922881cb2e7f8b0766587b20ed496bd83653bc","2010-03-21 10:51:11+00:00","Added framework for displaying game dialogs

svn-id: r48353
"
"68f5f0893074853a56797d2d36a937f198a4e22d","2010-03-21 10:53:13+00:00","Revert of accidental commit to engines.mk

svn-id: r48354
"
"a725b490e8a190e276fc689d4a147b7c49e98d7c","2010-03-21 12:36:57+00:00","Fix shadow member of this warnings of gcc.

svn-id: r48355
"
"86653687d7369a46ac25ef4a3cd513b401807c67","2010-03-22 15:54:56+00:00","Fix for bug #2969211 'NIPPON: Crash in Intro'.

It is not a good idea to supply an SubLoopingAudioStream with the start
and end time to be exactly the same time. Clarify that in the
SubLoopingAudioStream documentation, add an assert in the
SubLoopingAudioStream constructor for that case and also prevent
make8SVXStream from doing so.

svn-id: r48356
"
"dd7891cdadc5c2e4f9d1c10d229c4c0d7235f8b1","2010-03-22 20:26:57+00:00","Add simple testcase for ScopedPtr and SharedPtr

The new test verifies that a given object is indeed deleted after
the smart pointer leaves scope.

svn-id: r48358
"
"92c896d88317b64a2cc99fc3617f3405481e90a2","2010-03-22 20:28:08+00:00","Patch #2973290: Semicolon cleanup

svn-id: r48359
"
"b104534d0d6342bf75d5eff8bd85847fc7e7f18f","2010-03-22 23:03:09+00:00","Patch #2973283: SCUMM: Unneeded pointer dereference

svn-id: r48360
"
"6545e728b6b76e41d711858b209accfe9cc1f6da","2010-03-22 23:04:55+00:00","Patch #2938173: LinuxMoto update 23012010

svn-id: r48362
"
"9f53578fd2dcdd72c3bea2a4a7d92f342ae6a40f","2010-03-23 00:42:42+00:00","Fix compiler warning.

svn-id: r48365
"
"9571c817c7b7f30ed33ff5d4a07d80b8cea4f8c1","2010-03-23 08:33:51+00:00","do not close inventory if mouse moves up. better mouseless experience.

svn-id: r48367
"
"b46a2b4e100e3018d604da240cecf936c629e8a0","2010-03-23 12:02:23+00:00","Added further code for the game dialog framework

svn-id: r48368
"
"164dfdd0ab48bd44610ee31a7d9dbc3069ed8575","2010-03-23 20:58:40+00:00","do not skip warp+walk events

svn-id: r48371
"
"5d62e682cc20cc21315d6d7497da002b4022c805","2010-03-23 22:54:32+00:00","Cine: Fix regression in executePlayerInput (Caused slowness when clicking when moving).

The regression was caused by r47505.

svn-id: r48373
"
"e0f92f61eb3fdf40f32f130a8e17fe91d56c6e88","2010-03-24 11:46:09+00:00","Bugfixes for correctly getting string lengths and cropping drawn text

svn-id: r48376
"
"d34fd9cdd667dea9ce11bf4aa9028b3e91caf19a","2010-03-24 11:47:08+00:00","Bugfix for getting correct quote information

svn-id: r48377
"
"cf5cd833fde2765668aea3b8f234388da3f9f94d","2010-03-24 11:49:26+00:00","Moved new MadsView related code into Mads_Views, where it's more appropriate. Added extra logic necessary for displaying text in the game dialogs

svn-id: r48378
"
"d377ef562653e435c02aa9a439deb39ecbacf3aa","2010-03-24 16:40:35+00:00","update samsungtv toolchain prefix

svn-id: r48380
"
"55fb1225c865998451707a1a48250d7641ce5ae2","2010-03-24 17:46:35+00:00","Stop the music before starting the next one, after discussing it with joostp.
This should fix bug #2961891 ('FOTAQ: Floda Alarm Tone Won't Stop'). It's
probably too late to get this into the branch - at least before the release -
since it's not a particularly serious bug.

svn-id: r48381
"
"6e26a20b1cc3d2de18de90361bc7dbb049ed743a","2010-03-24 19:34:08+00:00","fixed big fan room

svn-id: r48382
"
"e9d80d104d75e8651a2334471df65efacdc92855","2010-03-24 19:34:58+00:00","validate path before examining object

svn-id: r48383
"
"f3ed66045ff11f3a1dfd74ed91e324279886358e","2010-03-24 19:48:32+00:00","fixed warning

svn-id: r48384
"
"837b7d096e257d3f4b7539f801614f7159c4525a","2010-03-24 19:50:47+00:00","Maemo icons

svn-id: r48385
"
"03ba4a33185198c08dc84c3888170797b1e7c7ce","2010-03-24 19:56:16+00:00","added desktop and service items for launching

svn-id: r48386
"
"620e8bb89f7b4ff855158f2592c836ee6ff831a5","2010-03-24 20:24:08+00:00","added shake screen effect

svn-id: r48390
"
"02ea77a2a80f912ca0931a88ffc3aec44e6a415f","2010-03-24 20:26:55+00:00","removed useless updateScreen

svn-id: r48391
"
"93084baf287d2d1d8b62ab9ee112882e5a320ce5","2010-03-24 20:45:37+00:00","implemented screen shaking as in the original engine with delays before moving video memory

svn-id: r48393
"
"51110f4be99ad6b4dedb27f8c8174b7e4a2c33c1","2010-03-24 21:25:18+00:00","not need this for samsungtv

svn-id: r48395
"
"5315993ffcee93693bb0fed2c27afe0399163557","2010-03-24 21:39:02+00:00","Remove pointer dereferencation in a place, where the result is not used at all.

svn-id: r48396
"
"86c779bed8eb6e023cc7c281016580474304dc8b","2010-03-24 21:39:26+00:00","Prevent inifinite loop caused by a check of an unsigned integer against >= 0.

svn-id: r48397
"
"ed6602502f0f9fc602276060b5dd6e65dcfd1fd0","2010-03-24 23:19:27+00:00","SAGA: Fix ScriptThread::operator=; some tweaking

svn-id: r48398
"
"1eda07f5242189e1d2be2869c118fce7833a7c4f","2010-03-24 23:19:42+00:00","configure: document --enable-release and --enable-profiling

svn-id: r48399
"
"ae8853d80bc9e4d6a7f952a76271ad06dd9a3970","2010-03-25 12:46:06+00:00","Added preliminary logic for showing loaded sprite frames

svn-id: r48401
"
"fcc7ab61ac3add71a127be0b503147fa8cc91d47","2010-03-25 12:54:55+00:00","Fix compilation by removing a public keyword outside a class scope and using '> >' instead of '>>' for template closing brackets.

Note that '>>' is always operator>> in the current C++ standard, thus
one has to use 'Common::Array<Common::SharedPtr<SpriteAsset> >' instead
of 'Common::Array<Common::SharedPtr<SpriteAsset>>' for example.

svn-id: r48402
"
"02b1e3278a659db490c88e44540ea72bab32799c","2010-03-26 09:35:48+00:00","Bugfix for logic used to calculate single RGB palette entries

svn-id: r48403
"
"5d85ad075981cbc3426c881542d6a4f4a89f22dd","2010-03-26 10:21:08+00:00","Further fixed the setEntry method to make it Endian safe

svn-id: r48404
"
"73787f05f009868ddf6c1f8e1a7d61b6a38c07d9","2010-03-26 20:45:32+00:00","Bugfixes to the graphics display of dialogs

svn-id: r48405
"
"8dfd670b22cf118aa3fd1fc6198ff539ac332a79","2010-03-26 22:16:45+00:00","Added explicit initialisation of NPC directions in the hotspot constructors

svn-id: r48406
"
"c73a50b4e31e5c5326bab3b3c6ca9f7a5354c2b0","2010-03-27 07:13:30+00:00","Changed the encoding of keycodes to only include the flags for Ctrl, Alt, and Shift

svn-id: r48408
"
"38f2c1b7a4eaa3dc136c6cd3c29d2b76f223d153","2010-03-27 07:14:52+00:00","Completed dialog item selection code

svn-id: r48409
"
"a2de7bb0ef8118c32e6e3ad1a945a8021544c519","2010-03-27 10:44:38+00:00","Added the game options dialog, along with several bugfixes to dialog display code

svn-id: r48410
"
"a3ab15e8cf13c1137a0baf7ec75320d21f22d6f1","2010-03-27 13:29:10+00:00","Use the enumerators instead of hardcoding the values of them.

svn-id: r48411
"
"b39222d6112f857b3d066da6e4f869c780c3e338","2010-03-27 22:00:16+00:00","Corrected deallocated of menu data reported by Valgrind

svn-id: r48412
"
"2872f197d81df8a804546207dc8388d7f4f87997","2010-03-29 18:47:40+00:00","Fixed bug 2969234 by tampering with the gameId. Probably not a nice solution, but hopefully ok for a while.

svn-id: r48415
"
"4bac9e1b752e92318ff1d5497ec1d7aa0f2786be","2010-03-29 20:31:23+00:00","COMMON: Cleanup ConfigManager code

* get rid of ConfigManager::_emptyString
* get rid of ConfigManager::Domain::get (use getVal instead)
* remove some dead code

svn-id: r48417
"
"db3f6be7774038d54f33d19acae96af283e6ced6","2010-03-29 21:01:19+00:00","Use ConfMan to query the gameid of the passed target instead of deducing from the target to the gameid. Along with it fix the removeSaveState implementation.

Note that this is untested! Someone with some parallaction game should test it
before it can be considered to backport it to branch-1-1-0.

svn-id: r48418
"
"3da0c234ea337d27b0907328828725ee87b1237e","2010-03-30 00:59:08+00:00","Patch from bug #2976619 (BUILD: Link error when building without engines)

Changes the order of the 'engines' module to be after 'backends'.

svn-id: r48420
"
"067fbe23f6e9b3dafb4b36ea2e9a80668c7c1d8c","2010-03-30 02:13:49+00:00","Fix for Lure memory error indicated by Valgrind on Restart/Restore Screen (Temptress over Castle).

This screen is displayed if you lose the fight with the Skorl in the Dragon Caves etc.

This fix should be reviewed and then backported to v1.1.0 branch.

svn-id: r48421
"
"1d2122d466801e36406aad80fe56f4349fa1ddaa","2010-03-30 05:53:36+00:00","Let Parallaction return game-specific gameids. This completes the fix for bug 2969234 after LordHoto's patch. Users might need to readd their games.

svn-id: r48422
"
"1fb60b4990b5b19e091c255f758288164b760272","2010-03-31 03:19:01+00:00","Basic correction for bug #2976774 'DRACI: Segfault Crash When Leaving Inventory'.

This patch corrects the valgrind fault, but may not be the ultimate fix.

This should be reviewed before backport to v1.1.0 branch.

svn-id: r48434
"
"34153fbfe2398bdf447b0457f3ba79c87db9c2b9","2010-03-31 22:24:24+00:00","Set 1.1.0 release date on trunk, too; also add entries for future 1.1.1 and 1.2.0 releases

svn-id: r48438
"
"3434aadcb97a30ab60ec3db7b8ef7d05c2f46369","2010-03-31 22:31:24+00:00","Change 'CVS' to 'SVN' in dist-module.sh

svn-id: r48441
"
"660950dadd3e6baacc0722fd17276b56651eaf65","2010-03-31 23:35:22+00:00","Tweak WinCE port readme file to correct version numbers.

svn-id: r48451
"
"77b25966a06fc690673ba76590faf5a75e19c452","2010-04-01 08:31:19+00:00","Add dists/redhat/scummvm-tools.spec.in, and add it to tools/update-version.pl

This is not quite perfect because in principle the ScummVM Tools version
might differ from the ScummVM version. But this way we are at least
reminded during a release that we may have to adjust this.

A potentially better approach would be to move scummvm-tools.spec to the tools
SVN module, and adding a similar update-version.pl script there.

svn-id: r48454
"
"09da7ca563eb2f8b66adb7f245e39d666df3ae46","2010-04-01 09:00:39+00:00","Updated readme with history of releases

svn-id: r48456
"
"aee05cd21d5da6de39f23e5250af00f05a94fb5d","2010-04-01 15:03:08+00:00","Remove extra semicolons

svn-id: r48457
"
"d38f71c1e45f4b45f2e11e02315957d40657f3f3","2010-04-01 16:11:29+00:00","Added an 'fxq' debugger command to print the FX queue. I guess it might help in
debugging the 'No free slot in FX queue!' bug I've heard of but never actually
seen. (See for instance bug #2976008, 'BS2: Game lockup in British Museum'.)

svn-id: r48458
"
"2d8b25f6569432f6c62d11763071cbde0db8c7aa","2010-04-01 22:01:40+00:00","Dragon History: fixing properly bug 2976774

The previous bugfix just hid the problem by removing an assert, but it might demonstrate
itself in another way later.  This is a proper bugfix.

svn-id: r48460
"
"33cc92d4149b646399e7079d70f8bd0405e4d215","2010-04-02 01:00:35+00:00","Fixed bug 2976767 on corrupted char glyphs.

After unfinished translation of the game, several inaccessible characters
have been left in the game files.  Since the font does not contain all 256
characters, trying to draw them brings them random jump.  I now properly
skip these characters.

svn-id: r48462
"
"a55cb7fa10548862b19d50fa4d4487336f0339c5","2010-04-02 12:51:42+00:00","Fix bug #2979193 - NIPPON: Crash at character introduction (regression). By restoring the kEngineBlockInput engine flag.

svn-id: r48464
"
"615378ca1135231a2e4bf48113b77430a49e4671","2010-04-02 13:12:23+00:00","Fix bug #2976353 - NIPPON: Sound looping fails (regression). By reverting 47469, since the IFF sound code is only used by the Parallaction game engine.

svn-id: r48467
"
"7e1f395e34ac83cad4df6268f2465adebe7b1abe","2010-04-02 13:49:59+00:00","Fix bug #2969232 - NIPPON: Kos sprite broken (Regression). The current disk archive requires a higher priority, compared to the default disk archives.

svn-id: r48469
"
"bc311445f815b9b9ede9a55e0c6d895d20ec72cc","2010-04-02 18:48:17+00:00","SCI: change actual setting of palette, fixes gk1 palette issue when talking to grace indirectly caused by r47955, seems to also fix jones palette issue, could cause regressions

svn-id: r48474
"
"4e9183cc1bc4f130222aa5cbb953970606a5536e","2010-04-02 18:51:20+00:00","SCI: removing unused variable from palette::set

svn-id: r48475
"
"fe51070977e01c0ab20807acf7a30388ee74ae6e","2010-04-02 22:14:18+00:00","Fix whitespace

svn-id: r48477
"
"0d83045b5fcc317cbed22b194ff9cb0a6eb6c61f","2010-04-03 00:44:38+00:00","Updated XCode project

svn-id: r48479
"
"397553cc569370db4da63a70f841671f7130655b","2010-04-03 04:48:20+00:00","Fix bug #2970141 - NIPPON: Crash at end of the game (regression). By reverting part of the changes to Parallaction_ns::cleanupGame() in revision 34939.

svn-id: r48480
"
"38e2506d4e4165f2f4954f8cc2da29ec552e93e2","2010-04-03 11:33:27+00:00","Updated README-WinCE.txt with release details.

svn-id: r48484
"
"1c7752d982cf0598b9ed5d8ff82771e2b8538264","2010-04-03 14:01:12+00:00","Fix bug #2976376 - NIPPON: Load from Launcher fails. By removing the kSupportsLoadingDuringStartup MetaEngineFeature flag (which was never supported).

svn-id: r48485
"
"45651803f1c6f20779afdfbc636e6e33099ac76c","2010-04-03 14:16:36+00:00","Disable the load from launcher button, in all games of Parallaction game engine.

svn-id: r48488
"
"df984a011e963617cb8189c737d4d8673d7bcdcb","2010-04-03 14:26:20+00:00","Fix bug #2959947 - HE: Broken saves show in launcher.

svn-id: r48489
"
"48dcdde45aa21614670c057a9ea31110f6bdb613","2010-04-03 15:16:32+00:00","Add teenagent.dat to .rpm

svn-id: r48493
"
"3b88a6ad5e3a7874b1d28a6c6d8c272c9faf5435","2010-04-03 15:16:52+00:00","Add .spec for new tools GUI.

Specifically:
include libmad,
package correct tools binaries,
use tools-1.1.0 instead of scummvm-tools-1.1.0 as directory.

svn-id: r48494
"
"5412dac46f06570c3d241ff63b3c94b8f277bea6","2010-04-03 15:56:40+00:00","Cleanup.

svn-id: r48495
"
"e4f588ae4cd666588a9055066304a67821daa005","2010-04-03 15:57:04+00:00","Do not use a template parameter for stereo setting for RawStream but instead pass the constructor a boolean, this should save some binary size.

svn-id: r48496
"
"753a73be293c4e1a768fe87545ea72606c93b32e","2010-04-04 09:36:10+00:00","Fix bug #2960022 - PUTTPUTT 1: No Load/Save possible.

svn-id: r48499
"
"703687a9e83ce04c71f1b02e6dc64ec22d79d70d","2010-04-04 11:53:19+00:00","Change path back from tools-VERSION to scummvm-tools-VERSION due to tools rerelease

svn-id: r48510
"
"6a840638ba57d61ec6652986e6182ef41e3fa2ca","2010-04-04 12:25:52+00:00","SCI: put an ending NUL in strncpy, fixes castle of brain scrolling problem - should be verified by the vm gurus (waltervn and lskovlun)

svn-id: r48511
"
"f792c100a31434d8b50c78698c03d5dc072c870a","2010-04-04 19:04:57+00:00","Add dists/redhat/scummvm-tools.spec to tools/update-version.pl

svn-id: r48516
"
"2e7b049e41eb02722d3daf518a8cfb83f95f8349","2010-04-04 20:47:03+00:00","SCI: check before writing 0 in SegManager::strncpy, fixes jones/cd crash

svn-id: r48519
"
"9c8813b6d4f1018d63b3b3aa208c2c3ccf87a2eb","2010-04-04 22:08:18+00:00","Commit of patch #2980597 'GSoC: GUI: Text input + Right Alt (bug #2978736)'.

svn-id: r48524
"
"6285ba4fdfd090378f3157743f164ac7d823a982","2010-04-04 23:04:33+00:00","Mention Nintendo 64 port in NEWS file

svn-id: r48526
"
"7555461ac39fb96bca690f6492cc3499674702c0","2010-04-05 01:49:00+00:00","Application of patch #2981748 - Make VGA detection entries take precedence over EGA for command line detection

svn-id: r48532
"
"29a8cb651a09e6d42e9bf123e3866d20373dc316","2010-04-05 06:07:14+00:00","Bugfix for correctly getting a follower to return to player when blocked from exiting a room 5 times

svn-id: r48533
"
"de3dd04005f802059833df1f5ac09da5c1f015c4","2010-04-05 07:22:34+00:00","Commit of the updated version of Fingolfin's patch for bug #2981788 'TINSEL: Build with -O2 broken'.

svn-id: r48534
"
"4aacbc5351bebbb4d9a2683fa2713e8270fc3cd1","2010-04-05 07:27:16+00:00","Corrected check to ensure return isn't issued if it's already in progress

svn-id: r48535
"
"e77985d1fd34673e2963134855260540b63c74fc","2010-04-05 09:08:48+00:00","Fix bug #2982014 'BASS: MT-32 warning on Intro skipping' by properly delaying the sysEx events.

svn-id: r48536
"
"75b041364b7d75ce9ace68b74721423220aef4aa","2010-04-05 10:38:43+00:00","Mark Chris Gray (former Win64 builder) retired and add myself to the Win64 builder section.

svn-id: r48540
"
"c5c40607194cb8ed598b371b62ca101c706d69b8","2010-04-05 12:41:08+00:00","Commit of patch #2980691 'GSoC: GUI: Caret blink shaves pixels [...] (bug #2951681)'.

svn-id: r48551
"
"96ccd4abccc66a3ef11b8e7b0d5ab9792285eb2a","2010-04-05 19:41:30+00:00","Add support for 32bpp DirectBitsRect in Myst ME PICT's. Fixes various cards, especially in the Myst observatory.

svn-id: r48558
"
"3a8366526b928992ed10bf4ae0d0d4ab8876bfe4","2010-04-06 09:25:44+00:00","Remove old & undocumented MSVC 6 workaround

svn-id: r48561
"
"7dafef752fea7d968bd4a4bc1292fcfa65341529","2010-04-06 09:26:04+00:00","SCUMM: Make HelpDialog & ConfigDialog internal

svn-id: r48562
"
"745edbadc7b3841556c2e8962725bfd3de8a4dd3","2010-04-06 09:26:20+00:00","Factor out save/load code from MainMenuDialog::handleCommand into new methods

svn-id: r48563
"
"894e2aefe6042cea38b93439812193f8ceb8356b","2010-04-06 09:26:43+00:00","GUI: Unify various definitions of kOKCmd and move it to namespace GUI

svn-id: r48564
"
"77c1e0dfe1185bd4f807436480a944ef7da2bbf2","2010-04-06 09:26:59+00:00","GUI: Remove 'typedef Common::String String' from (Global)OptionsDialog

svn-id: r48565
"
"7c510f2dfa1191ea76633e667ef302a6b6ed949b","2010-04-06 09:27:13+00:00","COMMON: Add Common::parseBool

svn-id: r48566
"
"56e81ac0da70b926ecd20c674145ec67c1332509","2010-04-06 09:27:27+00:00","Switch SaveStateDescriptor::getBool to use Common::parseBool

svn-id: r48567
"
"fd0e3de00b04c222679558cb9e6626a3f3820f5c","2010-04-06 09:27:40+00:00","Fix AdvancedMetaEngine::createInstance to use ConfMan.setBool

svn-id: r48568
"
"48a9e643388408ef71800969fa5103dc6abf9527","2010-04-06 15:40:13+00:00","Fix 'Transitions' typo

svn-id: r48570
"
"8e8b6cfa788c594ad8a841999afaeba779254b58","2010-04-06 16:33:15+00:00","More transistions->transitions fixes

svn-id: r48571
"
"3fe570cd70bda759dd9863c9da05289d0d072d98","2010-04-06 23:38:43+00:00","Cleanup the Myst resource caching code a bit and add support for caching Myst ME MJMP sound 'jumps'

svn-id: r48579
"
"9fbf1a113c98aec816edfb4609c07936e591467e","2010-04-07 06:46:50+00:00","Add detection for an English ADI2 environment disk (for Amiga)

svn-id: r48580
"
"b89b64f71a470c6e0ae4c5413ee6ba058dd2cfcf","2010-04-07 07:45:50+00:00","fixed crash during time challenges (rclick without object)

svn-id: r48581
"
"bfbbc0a07271609f03e10fc6ae4140e66628b41e","2010-04-08 22:04:17+00:00","Remove unused dereference

svn-id: r48586
"
"7d97ee48e6c903ba850e38fb3b76c14e75b23e85","2010-04-09 11:18:30+00:00","No Mandriva updates in ages -> mark Mandriva packager as retired

svn-id: r48592
"
"f2f0e1aa67dda73aeba9caa6dd62edbfbf992947","2010-04-09 12:23:43+00:00","Simplify GCC version tests, add support for the clang compiler

svn-id: r48594
"
"be31842b1c2e08106b3fc829b0c5304c7f7e96d7","2010-04-09 12:30:45+00:00","Future-proof gcc >= 4.3 test (Will break on version 5.0)

svn-id: r48595
"
"641f0616451f0a5835054306d1329713302f5d2e","2010-04-09 12:46:13+00:00","Fix configure script on cross-platform environments

svn-id: r48596
"
"3558ccccc4829bcb9c1222949d1dcfe10b06f3cc","2010-04-09 13:10:33+00:00","Have cc_check_define return 0 on success

svn-id: r48597
"
"003922f43deab6b9899cd796ef6004eaf45e77c6","2010-04-09 13:46:10+00:00","Remove unnecessary 'extern' keywords

svn-id: r48598
"
"92817e84ca5cc79ea15d652317d976d141935993","2010-04-09 14:12:20+00:00","Use head -1 instead of grep -m (non-POSIX flag)

svn-id: r48599
"
"a1fde3a03fdec6c0ceaf4fd664609c5b2f45c7a9","2010-04-09 14:13:37+00:00","Trying to fix cc_check_define breakage for cross platform builds which *require* a non-trivial LDFLAGS & CXXFLAGS; applying same fix to the memalign test code

svn-id: r48600
"
"f360dcac904dff82d70af7240299b7d1f1e09a5b","2010-04-09 14:23:30+00:00","Change cc_check to always pass LDFLAGS (it already always passed CXXFLAGS), and adapt calling code accordingly

svn-id: r48601
"
"0768eda96432186178f40f430fb1e102d9c4bd7a","2010-04-09 14:30:10+00:00","Change outdated configure status message

svn-id: r48602
"
"982cf400678384681a1c05e3745e25830ff13d9e","2010-04-09 15:47:49+00:00","Yet another attempt to fix cc_check_define: make it only link, but not compile, the test code

svn-id: r48603
"
"f4d7bdc9374ace439bff3d6b430e92c9cdd6cd44","2010-04-09 19:25:05+00:00","Add missing cases to switch statements, remove whitespace

svn-id: r48604
"
"fcee4f2ad753c06b4c58fc21c69b0d4e7f0c4967","2010-04-10 23:12:22+00:00","Part of patch #2982224: 'GSoC: Added unit test and unified error message display'

svn-id: r48613
"
"726500a2f3048b274364ba6f82203c0712bd8248","2010-04-10 23:13:18+00:00","Slightly tweak Common::StringTokenizer tests, cleanup

svn-id: r48614
"
"c66e47cad4bfc390dcc4c31f0b2c200b6a584814","2010-04-11 06:02:41+00:00","Fix bug 2983187 on continuing palette change

svn-id: r48615
"
"cf85c0b318bfa50fdb12deb03315053e2a4e5c35","2010-04-11 15:05:26+00:00","Fix bug #2985387 'KYRA1: Crash at the end of game'.

svn-id: r48617
"
"2e6b40798d3f945e1d1e36696c2af73506e8586b","2010-04-11 16:27:11+00:00","Change 'head -1' to (hopefully more portable) 'head -n1'

svn-id: r48619
"
"29172d48447d1418783333b93677f9151fc424c4","2010-04-11 17:26:32+00:00","Fix a memory leak in SCUMM which was caused by the SCUMM engine never removing its cursor from CursorMan.

The problem here was that SCUMM only uses CursorMan.replaceCursor. When no
cursor had been setup before it would cause the SCUMM cursor to be never
removed from CursorMan, since in this case replaceCursor just uses pushCursor.
To avoid this problem I am just pushing a dummy cursor (and palette, since
that is used in SCUMM HE games too) on engine setup and removing it on engine
destruction.

Actually every engine should setup their first cursor via CursorMan.pushCursor
and then on quit remove it again via CursorMan.popCursor. Using
CursorMan.replaceCursor is *no* good idea for the first cursor to setup, since
that might either replace an existing cursor, thus destroying the caller's
cursor, or pushing a new cursor on the stack, which might result in a leak.
This would also result in making a call to CursorMan.popCursor unsafe, since
that might also impact the caller's cursor setup again.

svn-id: r48620
"
"175a81ce98d618b07cacd2b1298365d3aaa7a3c4","2010-04-11 17:27:33+00:00","Fix KYRA's cursor handling by pushing a dummy cursor via CursorMan.pushCursor too. Also replace CursorMan.popAllCursors by CursorMan.popCursor to prevent the caller's cursor from being destroyed.

svn-id: r48621
"
"19e620ba60cf08b8d039dff3777061da1a0b21b8","2010-04-11 17:28:34+00:00","Enable the cursor palette in ScummEngine_v70he::setDefaultCursor just to avoid problems in case it was disabled earlier.

svn-id: r48622
"
"b928da4418d7acf05cc1b0889b0142fee177681e","2010-04-11 18:30:42+00:00","Setup and destroy a dummy cursor and palette in the Engine class.

The idea behind this is exactly the same as behind r48620,
but it affects all engines, thus engine authors can now use
CursorMan.replaceCursor without having to worry about possible
memory leaks or the like.

svn-id: r48626
"
"f2ff555996b2711685c86d5332e9899a2d2511b4","2010-04-11 19:04:02+00:00","Rest of patch #2982224: GSoC: Added unit test and unified error message display

svn-id: r48627
"
"3745c737887b9191a3785110a14cf4d3921b9a4b","2010-04-11 19:04:24+00:00","Explain the rational of the CursorMan.pushCursor calls directly
Instead of referring to the commit log of a prior ref.
Also rewrap some comments.

svn-id: r48628
"
"fd3970aa52a0c7f411afdddfebad208f783281c8","2010-04-11 21:30:57+00:00","Apply patch #2984508 - 'GSoC: SCUMM stopped audio from playing while saving'

This is a fix for bug #2090846 - 'SCUMM: saving a game will play music before
finishing'

svn-id: r48630
"
"18609a70b3b10c25efdd09b12af21aacc299baa1","2010-04-11 22:01:18+00:00","Add patch contributors to copyright file

svn-id: r48631
"
"9a2eac7eee8fbe6a903e842cb257d96bd57f8702","2010-04-12 06:49:05+00:00","PSP: refactoring/redesign of the backend

svn-id: r48632
"
"98d7ba281ca70af8d3a1ed1e84aa01dddbc5bccc","2010-04-12 07:20:54+00:00","Changed my credits to indicate more extensive contributions

svn-id: r48633
"
"87028c546fe5bdd8e5c08e47a551f15f9c257bb5","2010-04-12 07:28:54+00:00","PSP: Fix code formatting using astyle

svn-id: r48634
"
"eb433fcccd57060bb59e52879169e6114ad20461","2010-04-12 08:31:46+00:00","Added the beginnings of the main timer list

svn-id: r48635
"
"9191b9d5289b99b197fee8b9234080d03d2194c3","2010-04-12 08:54:32+00:00","Updated NEWS with PSP items including forgotten ones from 1.1.0

svn-id: r48636
"
"a1840bd5732473e3144857c74716ec2d6e4338c2","2010-04-12 09:14:17+00:00","AUDIO: Rename Mixer::playInputStream to playStream

svn-id: r48637
"
"fc40276ed7cfa0bce5394e0f2736513ae0b53cea","2010-04-12 09:14:37+00:00","formatting

svn-id: r48638
"
"f966f3184f5bc97c1e1ec85618c2f6fc581bba1c","2010-04-12 10:19:35+00:00","add const keyword to some methods

svn-id: r48639
"
"fe566293e71ecb481d67f3c748759986acd92f0f","2010-04-12 11:43:14+00:00","remove useless getObjectName() method

svn-id: r48640
"
"050aca584ba9b77c169b707db2e2a427e8c92637","2010-04-12 19:10:21+00:00","Fix use of 'friend' keyword in KYRA for strict C++ compilers.

Unlike g++, which does inherit friends (it seems), C++ does
specify that friend is not inherited. I.e. when B is a friend of
A and you have a class C subclassing B, C is not allowed to
access private memebers of A.

svn-id: r48641
"
"b5612d0cf6016dae72082c916859b041939cbd25","2010-04-12 19:40:54+00:00","Remove trailing whitespace from person names with no description

svn-id: r48642
"
"23ed4c2a76f924dd17a43edda5559ad8efa71488","2010-04-12 19:50:40+00:00","Revert 'Fix use of 'friend' keyword in KYRA for strict C++ compilers.'

Actually g++ is just fine in this case :-). The thing I missed here
was that I declared the 'offending' classes as friends in subclasses
of KyraEngine_v1, thus those friends were allowed to access the
protected elements of KyraEngine_v1 too.

svn-id: r48643
"
"3b252cb4c50494a60ddd3f40589336a757024f3e","2010-04-12 21:00:47+00:00","Remove duplicate entry for myself.

svn-id: r48644
"
"2fc9d6845b51dd589995891681ac01d241e9a2c9","2010-04-12 21:21:06+00:00","Apply patch #2982163 - CONFIG: Use HE keyword instead of HB for the Hebrew language

svn-id: r48645
"
"08077db0ea651f2a93daeb6e64ace41b70b2da61","2010-04-12 21:22:03+00:00","Update credits for myself to reflect that I am now part of the team.

svn-id: r48646
"
"024d44f3e3f6d0c1bb4cf801364ac32baaa510de","2010-04-12 21:30:47+00:00","Remove semicolon

svn-id: r48647
"
"e35133064b8f05c067b2a885e38a8e71d378ff1d","2010-04-12 23:23:23+00:00","Center labels in mass-add dialog

svn-id: r48648
"
"434b5369f64770a1875c449db9189f607e6a2c7d","2010-04-12 23:25:09+00:00","Remove trailing whitespace

svn-id: r48649
"
"843a547cf7d41307e88386d9ddeaa78543fd8e90","2010-04-12 23:30:52+00:00","Update default theme

svn-id: r48650
"
"97583b02cd3d19d3cc5547acd717ef10eca52576","2010-04-13 09:53:05+00:00","Patch #2985205: 'GSoC: Improve FSNode warning messages'

svn-id: r48651
"
"5a17a7be5f4cdd4bc0b805c1dc5c47e2190d5490","2010-04-13 09:54:21+00:00","Patch #2984292: 'AmigaOS4: Remove _SVN from unstable builds'

svn-id: r48652
"
"69b86db74cfcd1abee5e52ff71732153f39feed7","2010-04-13 10:08:17+00:00","Print message when creating new INI; don't rewrite it directly after reading.

Together with the r48651, this addresses bug #2983718:
'Incomprehensible message for missing scummvm.ini'

svn-id: r48653
"
"a71eb594677bf3631a6264e9b92bb1ac1ff4c8a6","2010-04-13 16:13:48+00:00","Whitespace fix.

svn-id: r48654
"
"cbee83a5363851d6ec35042417ffe653f329454c","2010-04-14 09:33:27+00:00","Added a default case for characters that don't have a message set, but try to display one

svn-id: r48656
"
"20392ebee8b5d5869e55199e3042d57d66f7ad9d","2010-04-15 16:40:37+00:00","SCI: split menu/item strings when displaying instead of when initializing - makes on-the-fly menu language changes possible (used by multilingual SCI01 games)

svn-id: r48659
"
"fcb8719e931b3031c33b7d4c8424a5b6f28f989e","2010-04-15 21:45:03+00:00","Replace ancient maemo patch with the one from 1.1.0 branch

svn-id: r48660
"
"f7ac94db122a49120257f5c49882a3e9451516d4","2010-04-16 10:00:49+00:00","Added code to de-activate town NPCs once the player makes it to the castle, since they're no longer needed

svn-id: r48661
"
"418bcdad7d8ca5d15a20e206e1c2c0195c9071a1","2010-04-16 10:59:23+00:00","Change configure entries for NDS and DC ports to use _port_mk

svn-id: r48664
"
"ae3962ce36cf558bf3fa5147fb4ec18f24686811","2010-04-16 11:00:13+00:00","Fix for bug #2987895: 'DW2: graphical errors in video on Windows'

svn-id: r48665
"
"1410f3c65a4cea2121b33f8eef94503ddbc5ae2b","2010-04-16 11:22:37+00:00","SCI: make scroll transitions work in upscaled hires mode

svn-id: r48667
"
"2cb0f7f155163b1ac414295d626fec757cc63e7c","2010-04-16 11:44:10+00:00","SCI: make pixelation transition work in upscaled hires mode

svn-id: r48668
"
"09a01c71ddd7843cd6ba5883aeb3be1863d24dff","2010-04-16 12:49:48+00:00","Trying to fix DC port compilation

svn-id: r48669
"
"dd6fbd887d86aa36bc1dbc13623f72b20ce9f840","2010-04-16 12:58:14+00:00","Added a sanity check for the current list node inside GfxAnimate::invoke(). This should fix the crash in LSL2 as described in patch #2987942, without adding additional lookups

svn-id: r48670
"
"050d034d796db3cb34d322804214e34547eb76e8","2010-04-16 12:58:42+00:00","Enable more ARM asm on arm-linux targets

svn-id: r48671
"
"85f0fceef3120831d4fad0cbac380b72f9b3312b","2010-04-16 13:03:26+00:00","Fix stupid mistake

svn-id: r48672
"
"01852cbf93de30fc8b61e8193379de1c2a5d689a","2010-04-16 13:27:30+00:00","SCI: dont switch to english on kanji text, also cut off text w/o spaces inside GetLongest() so that kanji raw chars will appear in windows

svn-id: r48673
"
"cd4812dfd9444a7c9df1955c940523186922de42","2010-04-16 18:23:50+00:00","SCI: support for kanji (sjis), minor centering issue left

svn-id: r48674
"
"17c0c846aaa5d2d1681566be0f7b5aa6ca57bbc6","2010-04-16 20:48:45+00:00","Remove type_4_byte='long' FIXMEs from configure

Since no porter complained about these during the last release,
this should be safe. In any case it would be trivial to put them
back, but that is only acceptable if an explanatory comment is
included.

svn-id: r48676
"
"b191acf7cc3822f325ea4fac6b8db7aa30342dcd","2010-04-16 20:49:16+00:00","DS: Merge changes from 1.1.0 branch into trunk

svn-id: r48677
"
"88f6a39312a27cfa70cfea283b63665894dc7579","2010-04-16 23:03:46+00:00","SCI: handle given coordinate to draw() inside SJIS font support as if the horizontal part would be the center of the character, fixes not perfectly centered japanese text. I assume that PC98 ROM also handled it that way. The actual cause for those 'bad' coordinates is GetLongest(), but that behaviour is definitely how sierra sci does it

svn-id: r48678
"
"20c461e541eba1e2db6ce18d859a79d4e1047602","2010-04-17 03:11:54+00:00","SCI: Remove subtitles in menu.

svn-id: r48683
"
"f8f50b52191f7cd15cce65eba56ab2a95238ae21","2010-04-17 13:31:04+00:00","SCI: changed coordinate adjustment for kanji chars to & 0xFFC

svn-id: r48684
"
"08ad84d5565131f5422a270046f6702243d55a50","2010-04-17 13:34:16+00:00","SCI: implement ability to handle multilingual menu separators (is actually 2 separators with a language separator inbetween)

svn-id: r48685
"
"2ac3e93dab227fb69e9fe1a8f9ec8c56c6520dd4","2010-04-17 13:42:19+00:00","SCI: move menu window inside the screen, if parts of it are outside (happens in multilingual sq3 and lsl3)

svn-id: r48686
"
"5c347aa70aab5377b4041b926568594d7485744d","2010-04-17 14:50:31+00:00","SCI: map keys from 8859-1 to dos codepage, makes special chars like umlauts work in multilingual games

svn-id: r48687
"
"09c0e553060fd3f5a84931a9ead0610026f9d3a4","2010-04-17 15:03:16+00:00","Fix for #2985480 - AMIGAOS4: Compiler errors on ./configure

svn-id: r48688
"
"da2027da361109b953c0105ab9700aad3bb5e60e","2010-04-17 15:16:40+00:00","SCI: change textedit control to cast to unsigned char to fix cursor position when multilingual chars are used. Also make getFontHeight() private inside GfxFontFromResource class, remove it in all the other classes

svn-id: r48689
"
"9bb92eba9e1b3298d77aecaf7919c57b18255790","2010-04-17 15:45:06+00:00","Fix for ARM Normal2xAspect scaler that was causing crashes when the screen
'shakes' (such as when the head/bomb goes of at the start of sam'n'max).
Was overwriting the end of the screen when asked to plot a non-multiple of
5 lines.

svn-id: r48690
"
"499e58caf02dafbb9c79dafdfd357c6ded31c7a8","2010-04-17 17:23:30+00:00","This should fix the scaler Valgrind warning reported in (but probably not the
cause of) bug #2976008 ('BS2: Game lockup in British Museum').

svn-id: r48692
"
"aaa6e7ee541fc8d149ffc536e9ff6a015b40d179","2010-04-17 20:43:09+00:00","SCI: key presses of extended chars (umlauts, etc.) will now get ignored in games that don't support them (which is all non-multilingual games)

svn-id: r48693
"
"bb26c040530f4ea212e17716702963a88165a3b0","2010-04-17 23:19:52+00:00","Fixing some warnings (with gcc 3.3.6)

svn-id: r48694
"
"b29b379894ac09f637218a6bb3f2ecea56a20379","2010-04-17 23:54:06+00:00","More const correctness fixes

svn-id: r48695
"
"6d8042490891f3864bf1a6492de77b572932a212","2010-04-17 23:57:50+00:00","Fix warnings when FLAC&MP3&VORBIS is disabled; also fixes leak in Tinsel

svn-id: r48696
"
"c0c351c76662998bdbb203758047d4b88da53b76","2010-04-18 00:56:04+00:00","SCI: Don't add subtitles for monolingual strings.

svn-id: r48697
"
"f68dfd61debb5197033bcee38057359db1848e17","2010-04-18 10:15:56+00:00","SCI: fix regression from r48685 - english got always used for menu entries

svn-id: r48698
"
"2590fd8c2a9dd7a28b863bd77412e9e7df9120dd","2010-04-18 12:09:22+00:00","SCI: sierra sci reacts on 0xD and 0xA to end a line. We only reacted on 0xA and ignored 0xD before (fixes subtitles in multilingual games, because the official subtitle separator is 0xD'----'0xD)

svn-id: r48699
"
"4b8d0f48dc14556c36bf1e8f8ef28fb7de0df62d","2010-04-18 19:40:20+00:00","Fixed XML syntax (& -> &amp;)

svn-id: r48702
"
"96b71b37456bc3aa21a2f98b35abde883e2e9527","2010-04-18 21:18:58+00:00","SCI: removing single byte chars from double byte check in sjis class (damn wikipedia with their similar colors hehe)

svn-id: r48706
"
"fa846bfebc4e79158b86739067cabc5d5de85b7d","2010-04-19 00:13:01+00:00","SCI: For Japanese system-font strings, convert half-width characters to
full-width characters.

svn-id: r48707
"
"210bc3a3cef2e84c0d7bde5afa40a779136cf5d7","2010-04-19 06:57:39+00:00","SCI: comment about platforms, where 8859-1 mapping is working

svn-id: r48708
"
"f1979f936fa30fba284a028a15518daf6c115c83","2010-04-19 09:40:20+00:00","Bugfix for correctly returning follower to player when they're blocked from acting

svn-id: r48709
"
"4bf7e9e6b0ce72a67b8c7d296ed714a6a195905b","2010-04-19 09:46:27+00:00","SCI: Fix yet another (new) const correctness violation.

I would suggest rewriting all of text16.cpp to use
byte* instead of char*, then all this casting around
(which introduces the const correctness violations)
would not be necessary in the first place.

svn-id: r48711
"
"ac2ffc65cbdedcfff6fd33f227dd6d27a4b60ce1","2010-04-19 09:52:11+00:00","Added note about Lure fixes

svn-id: r48712
"
"1e1e049e3266b3448c04b654fe0fb2b844ca6070","2010-04-19 11:59:46+00:00","SCI: added more comments for 0xD 0xA cases inside GetLongest()

svn-id: r48715
"
"71331c7f53d91b3e46b65b46aaa50d35f13176cc","2010-04-19 12:50:49+00:00","Fix regression introduced with r46130, which caused debugN strings to be post processed via debugOutputFormatter.

Formerly all debugN strings were not post processed via 'errorString' (or the
'debugOutputFormatter' as it is called nowadays). This revision did change
how debug strings are post processed and removed the special case for debugN
by accident.

svn-id: r48716
"
"b5851dab00986c7e441eecc06b3630a3e58e7d8d","2010-04-19 15:30:21+00:00","SCI: added even more comments about the 0xD 0xA inside GetLongest()

svn-id: r48718
"
"5e472b1ba22a26d6cc54b9b07f20ad45cd47a89e","2010-04-19 16:36:47+00:00","SCI: added upscaling for shape cursors in upscaled hires games (will make the cursor 'normal' sized in japanese sci01 games)

svn-id: r48720
"
"88af84514b96ac3cb77ae00b996414757bce5e18","2010-04-19 16:38:36+00:00","SCI: added comments about sierra not upscaling cursors for shape and view cursors

svn-id: r48721
"
"196f033e93450001ae30c9902c5bb35cec9de8d3","2010-04-19 16:38:41+00:00","Fix static initialization

svn-id: r48722
"
"4fd93aa27cb0b8762c0233ce7f2746d2bdaee569","2010-04-19 16:58:18+00:00","SCI: changed comment about 8859-1->cp850/437 conversion. ubuntu does work, i just used an outdated build by accident

svn-id: r48724
"
"75f7536ca18ce6e72e21f961d214b31f695378fd","2010-04-19 20:15:31+00:00","SCI: sierra switched hardcoded inside their pc98 interpreter to font 900, if sjis text got detected

svn-id: r48726
"
"eb05f83a08b4b0acc9dee662eca36540b25a369c","2010-04-19 20:25:20+00:00","Reinit the video mode when showing the console on an abnormal exit. This was not sccessful under some circumstances.

svn-id: r48727
"
"e6b835bce449ea6dba2a23feef6de627c318bdf3","2010-04-19 20:26:06+00:00","Fix lockScreen() for 16bit modes.

svn-id: r48728
"
"001bca2d6cf6c211f1d1640a74c9f19d1ef7cca5","2010-04-19 20:28:36+00:00","Remove use of global constructors in Mohawk.

svn-id: r48731
"
"64cba2878ac9c10f344af98a6683cc4bfd47b707","2010-04-19 20:37:20+00:00","Do not call OSystem::grabPalette() for 16bit modes, when the result is not used anyway for those modes.

svn-id: r48733
"
"589103f1b1a9fe3d76af48b9f5438c8ca163616e","2010-04-19 20:43:17+00:00","SCI: removed bad comment

svn-id: r48734
"
"498d1da18229b8de8faf2576e527a5ef82e7fdcf","2010-04-19 20:44:05+00:00","Cleanup.

svn-id: r48735
"
"d163686d2d411043b87df92d4d8151eab4747ed3","2010-04-19 20:44:25+00:00","Document that the current Hercules mode thumbnail scaler code is pretty much aimed for SCUMM games.

svn-id: r48736
"
"57781c0d8e41958f95a20d3d799378096c5aa0a2","2010-04-19 22:36:05+00:00","Mention Wii/Gamecube specific changes.

svn-id: r48738
"
"626784f28e8511af2ccb10376fc95d16c4593ce6","2010-04-19 23:01:26+00:00","Add note about fix for 1.1.1 to README-WinCE.txt

svn-id: r48739
"
"dead0db8d89cdfb256aeae831a637872aa481c26","2010-04-20 10:13:27+00:00","Corrected a debug statement that could use an object field after the object was destroyed

svn-id: r48741
"
"45833f7e9a497391e1720ba7e3ff10e4d21691d0","2010-04-20 11:13:09+00:00","SCI: sq4/japanese uses sjis 0x9781 for line breaks as well

svn-id: r48742
"
"e70a48441537dd628e94edd3d5468e387de9772f","2010-04-20 15:10:27+00:00","SCI: remove lone spaces at the end of right aligned menu items. fixes 'wrongly' aligned menu items in some games

svn-id: r48746
"
"ad24968f56a4dc0d36d6d21c096b1b302558f03d","2010-04-20 15:28:19+00:00","SCI: menu - handle right aligned '=' as actual text not as tag marker, also handle '=' as being a supported shortcut key

svn-id: r48747
"
"1e62e44fb6f5c5c1f764ec6535c3845eb7f2fc28","2010-04-20 16:46:26+00:00","SCI: the pc98 rom has to display kanji directly, because of the bad behaviour of GetLongest() we will actually put more chars in each line as actually fit. That way the scripts will only show most of the chars, but actually leave out some of the pixels of the far right characters. We now show kanji chars directly, sort of reproducing pc98 rom behaviour

svn-id: r48748
"
"dfc4f6ff08195625c1d664a25f47b6305819d87f","2010-04-20 16:58:52+00:00","Small tweak, works around a bug in the default OpenBSD gcc 3.3.5 compiler

svn-id: r48749
"
"d1bb33fbacadf3fa7c45b5dc645b33fbda4b9fbf","2010-04-20 18:24:14+00:00","Round up the game texture dimensions if the requested size is incompatible to the hardware.

svn-id: r48751
"
"6329d96cef9458afc27ea5285e404d21220d6594","2010-04-20 18:29:53+00:00","Fix the MT32 gfx output for 16bit compatiblity, cleanup, get rid of unnecessary buffers.

svn-id: r48753
"
"f3be0bc181facc6600b4ddc496dc6bdb23dc9891","2010-04-20 19:23:33+00:00","SCI: replaced values with constant

svn-id: r48754
"
"2242ee33ac8847d503ec52bada4503830f60708a","2010-04-20 19:37:58+00:00","SCI: get color white instead of hardcoded 255 inside openPort(), fixes not working inverting of button controls on qfg1ega character stats screen

svn-id: r48755
"
"74c0db4548afbc879bbe48bd0eee228917d8ff8a","2010-04-20 20:22:33+00:00","Use the faster memset() in Surface::fillRect() for 16bit modes when possible.

svn-id: r48756
"
"845d1869d8612ba408333bda01b7c687c64bf9b1","2010-04-20 21:16:58+00:00","abort() when calling setPalette() or grabPalette() in non CLUT8 modes.

svn-id: r48757
"
"0ef8fd7ddc49f5c90fd7506a2052308d8432cf7d","2010-04-20 21:18:37+00:00","Document setPalette() and grabPalette() changes, fix some incorrect 8bit statements.

svn-id: r48758
"
"2e89d9607d9190e58bbd7f1f1689a758899309f7","2010-04-21 05:30:38+00:00","Fixed GCC warning about 'hotspotId' shadowing a member of 'this'. Let's call
the variable 'charId' instead, like in the debug messages where it's used.

svn-id: r48759
"
"3edc151c5bde78eaa810a7ddc6092e9c920fb9c6","2010-04-21 10:42:01+00:00","Changed MadsView into a separate class, since it's functionality is needed by two different class hierarchies that can't share a common ancestor class

svn-id: r48763
"
"37b7be45194ba118f039a9268e42beed895ea9ba","2010-04-21 21:22:43+00:00","CINE: Change Doxygen commands to match our CFC

svn-id: r48764
"
"f103f01284b61b04aa8bc5978d5771d12e22f404","2010-04-21 21:23:08+00:00","TINSEL: Change cdGraphStream to a Common::File pointer,
to not rely on global constructors

svn-id: r48765
"
"5ab6a53f8739b40ec381241cadb82d6080dbc660","2010-04-21 21:23:35+00:00","Update credits: Fredrik retired

svn-id: r48766
"
"78efc863509ee46e6b9812d801fa49ac42430ef7","2010-04-22 09:46:30+00:00","Reformat NEWS items a bit, add full stops

svn-id: r48768
"
"6a368a2c01b2152078495042d2da28f9557cf554","2010-04-22 15:30:26+00:00","set cxx_verc_fail=no when MIPSpro 7.4.4 is detected + proper MIPSpro capitalization

svn-id: r48770
"
"e25651a4675e25c14521daa81ba4768642c88cce","2010-04-22 16:55:46+00:00","SCI: SCI1LATE+ checks for STYLE_USER, versions before check for STYLE_USER|STYLE_TRANSPARENT

svn-id: r48771
"
"4fbea9d02dc083b78ec95ec29ccd88c986d47e29","2010-04-22 17:41:04+00:00","SCI: make setOrigin() for ports behave like in sierra sci, fixes qfg1ega character screen issues ('moving' controls), fixes jones/vga 1 pixel-off windows

svn-id: r48772
"
"1243217547de55a9a83a2fadf88e73406b2769c6","2010-04-22 18:12:25+00:00","SCI: added additional comment for setOrigin() commit (from waltervn), after doing some test with sierra interpreter

svn-id: r48775
"
"328d571bba73525174531edcb2f68d28417e9aac","2010-04-23 10:28:30+00:00","Implemented extra timer methods and a DynamicHotspots class

svn-id: r48776
"
"35b21a94ff5155afa5f72fe7615143dff9a0bbb2","2010-04-23 13:51:59+00:00","SCI: pc98 sierra interpreter had special code, that circumvents having a japanese punctuation char as first char on new lines - we do so now as well

svn-id: r48777
"
"62833a3fd31f8411ef052c81057a7cf49e8beafc","2010-04-23 21:18:16+00:00","SCI: text16 ::Width() doesn't add ending spaces to the width anymore, sierra sci also doesn't do this - fixes windows being too large sometimes

svn-id: r48778
"
"b8a5507a17c456e9808a9b99a22c2dab7cd2c2a3","2010-04-23 21:57:29+00:00","SCI: fix for regression of r48778: do add spaces to width, if we are at ending of text - the whole change may be wrong altogether

svn-id: r48779
"
"666fefc79ddfbeb944b1c2e6fd7657528a78c12c","2010-04-24 11:59:19+00:00","SCI: first byte of resource patch must have 0x80 added to the resource type, otherwise sierra sci0+ interpreter won't accept the file, fixing this on debug export function

svn-id: r48780
"
"02b9b1019932796156c791f568d05a51b9c942c0","2010-04-24 12:49:22+00:00","SCI: change the way we handle breaking spaces based on how sierra sci does it, revert r48778/r48779

svn-id: r48781
"
"ca93a6ce9c51d4d994ce2657c57794bea1cb7223","2010-04-24 12:53:14+00:00","SCI: document skipping over breaking spaces done in r48781

svn-id: r48782
"
"b6c92b90b6bed242bbea8521615ca971c81171ca","2010-04-24 14:10:52+00:00","SCI: Fix regression in locals init for re-used segments

svn-id: r48783
"
"eb048f48b8680aa1407eb4f2ac272526d53152dc","2010-04-24 15:50:23+00:00","SCI: changing GetLongest() on kanji (again) hopefully it's now working as in sierra sci :P

svn-id: r48784
"
"61a57f53e530b89a458c979184c13c7ca398c9f9","2010-04-24 16:09:17+00:00","SCI: added special comments about r48784

svn-id: r48785
"
"0422560c5c1523f1854c44c42bf74a242e4df5f4","2010-04-24 20:08:03+00:00","SCI: beginUpdate()/endUpdate() of ports were introduced inside kAnimate() in SCI01 - fixes percentage bar not showing up in qfg1ega

svn-id: r48786
"
"cbd8faa82ed129615fcaffaa86ac2d862ffcae58","2010-04-24 20:41:26+00:00","SCI: r48786 port updates were actually introduced during SCI01, qfg2 and xmas90ega only. We enable port updates only for non-multilingual SCI01 games now - fixes percentage bar for qfg1 japanese as well

svn-id: r48787
"
"8f9dd90a871dee20ccb61efc2a5727f7a11b4a05","2010-04-24 20:49:19+00:00","SCI: add show_map command to debug help again (must have been lost some time due cleanup from old graphics code)

svn-id: r48788
"
"194bdd9b8375ae6612ef8ee2c733b6349c12d0fe","2010-04-24 21:45:17+00:00","SCI: reverting r48787 port updates were actually introduced (heard that before)  in SCI1. I used the outdated wiki before and that one lists qfg2 and xmas90ega being SCI01. They are actually SCI1

svn-id: r48789
"
"725fb248ea17245f71e1e8c81f82f29fc8f1bdbc","2010-04-24 22:02:31+00:00","SCI: Don't error() out when autodetection fails

svn-id: r48790
"
"aaaab9ec34bdb52d40b33295293fdbeab4568a93","2010-04-25 09:35:34+00:00","SCI: fix regression of r48659 - now calculating menu width and splitting text on kernelDrawMenuBar() as well - fixes menu not displaying all the time in hoyle 1&2

svn-id: r48791
"
"f036b6b9d2a753c42354b78eb71ebfbd3d58cbc9","2010-04-25 15:12:24+00:00","PSP:Implemented fingolfin's suggestion for cleaning up debugging code

svn-id: r48792
"
"731a9eda68e973693df3e4b290ca4cd2f8a74db8","2010-04-25 15:14:57+00:00","PSP: A couple of small fixes to the debugging support

svn-id: r48793
"
"482e89ea9f5f3b9ada2d1efa7feafdf22c7176dc","2010-04-25 15:20:52+00:00","SCI: reset cursor state when kDrawControl gets called on textedit controls, fixes cursor placement issues

svn-id: r48794
"
"c893ba1508ac849c34ca555496a3eb465192a362","2010-04-25 15:44:11+00:00","SCI: replaced value with constant when checking if controls are selected

svn-id: r48795
"
"14ac9b54a029fe4400ee5f6bd70e39e1ff459100","2010-04-25 16:43:16+00:00","SCI: we check for enough space, before adding pressed characters in textedit controls

svn-id: r48796
"
"cc4bd9bf1cf65663a63bb8ccad04e626bbc4b9cf","2010-04-25 16:47:14+00:00","SCI: changing setFont() call logic inside textedit controls to save 2 setFont() calls

svn-id: r48797
"
"3005fffe784e0359cc5a6b92a159136d6ccb0df6","2010-04-25 19:49:10+00:00","SCI: draw a black line between titlebar and actual window content for SCI0, also replaced hardcoded white value (255) with screen specific value

svn-id: r48798
"
"f334ecfa34cf6425a40453672c4a3267b0913f2b","2010-04-25 20:48:59+00:00","SCI: green buttons for sci0early implemented

svn-id: r48799
"
"8260919bad48eb35ed0634df0d21d5d63d5c09b6","2010-04-25 21:53:09+00:00","get rid of global Box objects and remove obsoleted PALMOS_ARM defines.

svn-id: r48800
"
"4decff1a9291e0733812bca290ed5ecab5792003","2010-04-25 21:53:27+00:00","fix missing sound effects during introduction with non French versions.

svn-id: r48801
"
"516fd1dc7642e49cc27f4b43676c4b3ad4d6b97a","2010-04-26 10:28:38+00:00","PSP: Cleanup trace.h a bit

svn-id: r48802
"
"20c0710db9a86badab09071bc2f7b3634836429d","2010-04-26 12:11:19+00:00","Modified configure to support PSP profiling

svn-id: r48803
"
"6ccdb3cba0d936645b74bcb0a332bc2188e23c27","2010-04-26 12:12:42+00:00","PSP: Added support for profiling using configure:

svn-id: r48804
"
"98ae0f82183ca3612f641d6203c42d8003bab36e","2010-04-26 14:11:30+00:00","SCI: also set signal selector when stopping sounds for SCI0 as well - fixes sq3 freeing 2 guys from andromeda endless loop

svn-id: r48805
"
"3f601f15bf59650cd31b2415c257c4871707ecde","2010-04-26 14:13:38+00:00","SCI: changing comment slightly about setting signal selector in stopSound for SCI0

svn-id: r48806
"
"78e85ce0539dbd2864cafb927fc7ab315b8a52d3","2010-04-26 15:30:32+00:00","SCI: fixing regression from r48771 - sierra used != before SCI1LATE and !(&) later - fixes broken windows in sq1

svn-id: r48807
"
"38ad443165f7a7fae8a894fe3bb978e4002c6bdc","2010-04-26 19:10:15+00:00","Mention that we switched to the 'fast' DOSBox OPL emulator for 1.2.0.

svn-id: r48809
"
"7c26675ec11018f4efa72607337dd6a9eae4dac1","2010-04-26 21:01:05+00:00","SCI: fix regression from r48720, upscaled games that use view cursors crashed

svn-id: r48810
"
"498d8000ca6869e6fae2678b4ff61f21c0cea1b8","2010-04-27 08:59:13+00:00","Fix bug 2969257 (labels) and hopefully plug all the leaks.

svn-id: r48811
"
"5a4df6fc95260ea9a045b4205d53d1b35acb53c2","2010-04-27 10:59:28+00:00","Minor bugfix for the shop-keeper sequence when you're viewing through the window - it was supposed to check whether Gwyn, rather than Goewin, is not in the room before sticking his fingers in his ears

svn-id: r48812
"
"eb4e7b4c77827c100c7ec271f150efbbfc9773cb","2010-04-27 11:00:43+00:00","Bugfix for making Goewin more smoothly follow player out of the caves

svn-id: r48813
"
"03b229dcbaa184341dffbf7ed3f6cf5921647055","2010-04-27 11:14:25+00:00","Added note about Lure fix

svn-id: r48815
"
"46c520f7972cac192b018896a039264a47984526","2010-04-27 11:23:27+00:00","Added further timer method implementation. Also renamed some of the classes to match those of the original engine, based on the contents of various in-game error messages

svn-id: r48816
"
"6f4063fd5f1c8d5ccf1ee44a8474a287d5ede723","2010-04-27 20:14:56+00:00","Fix warning

svn-id: r48817
"
"40525d1bb2cb47fa090ed2ff67c99c857654cce0","2010-04-27 20:18:10+00:00","Fix warning

svn-id: r48818
"
"8275b3e13b6eba5bd04bc6863c416555715fbea1","2010-04-27 20:47:06+00:00","Fix warning using GCC 4.5

svn-id: r48819
"
"445dccd59bc77e760e649bae982d78f0c3ca6b04","2010-04-27 21:39:43+00:00","cleanup

svn-id: r48820
"
"460d69e8855f849e2200c49b198936b1201e0c91","2010-04-27 21:40:52+00:00","COMMON: Move DebugChannel stuff into a new DebugMan singleton

svn-id: r48821
"
"2b6958995be123382e512f5c16ca6447b0f81933","2010-04-27 21:41:25+00:00","correct indention

svn-id: r48822
"
"5cb9f7ca2ef01ccf5290dc3aca4f2d13f40ff26a","2010-04-28 14:13:19+00:00","PSP: added profiling support to custom makefile for ease of use

svn-id: r48826
"
"9793430e58d0a29bbae3da24ab86a14d5504ef23","2010-04-28 18:50:22+00:00","Fix a destruction order issue and note two remaining issues from the label fixes (r48811)

svn-id: r48827
"
"89c0e30ddc3cd12d790da51c99a7d92d9e9739d0","2010-04-28 19:14:20+00:00","Only draw letters that actually fit on the surface. Should fix bug #2992268 (Reproducible crash creating Intuition formula)

svn-id: r48829
"
"cb17e00f0d1cb0638580c9f053c78bf2429ef154","2010-04-28 19:50:28+00:00","added cd-version detection and cdlogo.res support

svn-id: r48831
"
"1a1d99724a989ad81f341f5e7b62737de5f522a6","2010-04-28 20:18:56+00:00","Fix for bug #2824840: ZAK: Crash when using the yellow crystal (Amiga version)

The problem was a double free that could occur in two places.
Also added some missing whitespaces.

svn-id: r48832
"
"2b4093a41f0b9af397f1af43d618cee5307946a9","2010-04-28 20:47:49+00:00","Committed my proposed fix for bug #2970211 ('DRASCULA: missing german
translation'), after a brief discussion with Fingolfin to make sure I wasn't
doing something silly.

svn-id: r48833
"
"e432c6d21ada0a63d07df4b1d8b44ea293917ac3","2010-04-28 21:22:44+00:00","Add parallaction news

svn-id: r48836
"
"ee63bf51bd4c2e4a56fefff721e6298bd7f03378","2010-04-28 21:50:54+00:00","Fix Nippon Safes test result label memory leak

svn-id: r48837
"
"122fde0775c98b8e021b31ca21840848abd197ae","2010-04-28 22:13:02+00:00","Fixed leaks in parsing of examine and door zones.

svn-id: r48838
"
"a4dcfdd90742e1c5f6aa8e6dff0255ea6194e708","2010-04-28 22:13:11+00:00","Fix uninitialized variables

svn-id: r48839
"
"503ee780080beb986d101c155086ff12c2835cd4","2010-04-28 22:16:48+00:00","Initialize _requested*ScrollDir variables in constructor.

svn-id: r48840
"
"a5aedb73be3e6833506f2836d0c92ed2704fd1a5","2010-04-28 22:23:00+00:00","TINSEL: Avoid global constructor for clickPos

svn-id: r48841
"
"c75ff0515e144ab4c6a1c5d55d65508b32b3ef4d","2010-04-28 22:23:34+00:00","SAGA: Avoid global constructor for pieceOrigins array

svn-id: r48842
"
"76553e64182c3e508e112be7cce2e74a03f27512","2010-04-28 22:24:11+00:00","CINE: Get rid of some global constructor uses

svn-id: r48843
"
"9001a8fbc3429d4104f946322d306cbaef5f0965","2010-04-28 22:33:17+00:00","Fix uninitialized variable

svn-id: r48844
"
"4cb1fc9e795d555826e1bd5e06320c329d73f30c","2010-04-28 22:52:36+00:00","Make sure walk coordinate are valid before checking path buffer.

svn-id: r48846
"
"a0d55ca586cd232488ccb7193cdf8787a1b9ab8d","2010-04-28 23:11:34+00:00","Make sure dialogue manager is destroyed on quit.

svn-id: r48847
"
"763b1c7cb07da20f6d7d8a43e06b874a77914456","2010-04-29 03:54:20+00:00","Fixed a glitch when a one-word text (e.g. 'TOTENKOPF' in the first room, when
playing the German translation) doesn't fit on the screen at the desired
position.

svn-id: r48850
"
"59541d0742fd68b1fd0b07d86e40aaa8167eeec6","2010-04-29 06:22:50+00:00","replace bmp with png

svn-id: r48853
"
"aa6217223bca3940f1342d35628733c868400be1","2010-04-29 15:30:09+00:00","Final patch from #2891357 'create_msvc: Add support for MSVC10'.

svn-id: r48855
"
"13ee099090f45a1e9383d71d3481247f669d984c","2010-04-29 15:54:59+00:00","SCI: audio compression support

svn-id: r48856
"
"6e6b90f41c7abc07a356fe42f970ca6bb923fc9d","2010-04-29 19:01:06+00:00","SCI: remove unneeded #includes from resource.cpp

svn-id: r48857
"
"3b401eb53c8baddb0a907a44ccf343b32dad06bc","2010-04-29 19:06:49+00:00","Silence gcc warnings.

svn-id: r48858
"
"664fdfc9146dcf5d1505db29ef468868184e88a0","2010-04-29 21:35:11+00:00","remove unused files

svn-id: r48862
"
"b4f0d541608bd50e4226aa961d93ce956602d755","2010-04-29 21:42:14+00:00","Set 1.1.1 release in NEWS file

svn-id: r48867
"
"1c684af0676119dbe60f2bdb2def730293933080","2010-04-29 21:44:53+00:00","Maemo build instructions updated

svn-id: r48868
"
"df4400d223d397e0cfef7e6d1e721ec77556daf2","2010-04-29 21:54:39+00:00","Rename input -> stream

svn-id: r48869
"
"e11afdeab5534158c2005c23084fc278c30b0695","2010-04-30 11:27:42+00:00","Added proper names for some of the previous unknown timer fields, and bugfixes for the sequence list methods

svn-id: r48875
"
"beba3bf8a47a4c2480eb9d20ebc0c7dab5577348","2010-04-30 15:08:51+00:00","SCI: animate cleanup

svn-id: r48876
"
"eb429872d855c95d9979a76d43a2fc5d2abcfe9e","2010-04-30 16:49:57+00:00","Fixed warnings when building a GC binary.

svn-id: r48877
"
"45debce66eff7e57e71b83f8d1c4dd2066636355","2010-05-01 12:55:32+00:00","KYRA: fixed some cppcheck warnings

svn-id: r48879
"
"e3ac8713e3718bff97858d25b5a98048357867f1","2010-05-01 14:04:48+00:00","SCI: fix bugs in audio decompression (mp3, ogg, flac)

svn-id: r48880
"
"0cd0d8bafe300f3cf9c02fbea0a9d3287936c6f7","2010-05-01 14:51:57+00:00","SCI: fix sync resources not loading correctly when compressed (mp3/ogg/flac) audio resource file was used

svn-id: r48881
"
"561ad566169177227facc2b8e7a64959c3dca586","2010-05-02 10:21:02+00:00","SCI: make audio decompression (mp3/ogg/flac) work on BE devices

svn-id: r48889
"
"35f1a55b708e2315673e9510357c903574058727","2010-05-02 17:43:24+00:00","Allow the Orion Burger title screen to be shown again. At least, it doesn't
crash on my computer any more. (It doesn't do much interesting either.)

svn-id: r48892
"
"00ee958902fa044b88e30e9886d4fe197fc40a18","2010-05-02 21:31:30+00:00","Removing severaly outdated and obsolete dists/debian dir

svn-id: r48893
"
"3762b6f57851edd680c3bfaf2cd5046cc24890df","2010-05-02 23:58:59+00:00","Upgraded the iPhone target in the XCode project to support iPad as well

svn-id: r48895
"
"84cb07e98514bbe7ec8c3cc2c624fab92ccce2e4","2010-05-03 00:22:58+00:00","Removed an accidentally left in a CopyFiles reference for COMI in the xcode project

svn-id: r48896
"
"df679afe19901500a5e704d2b11df5a7b25c5436","2010-05-03 11:58:45+00:00","SCI: calculate sampleLen for compressed audio (mp3/ogg/flac) as well

svn-id: r48903
"
"f2ee496c0ead8812660385fe379bb005e0af0b3c","2010-05-03 13:03:44+00:00","Paranoia change: Prevent possible assertion caused by MP3Stream.

Currently we have an assert checking that the framerate of an
Audio::Timestamp is always > 0. Since MAD might return '0'
(and maybe even other illegal values) in case the MP3 stream is
invalid we need to check that before we setup the _length
Timestamp of MP3Stream.

svn-id: r48904
"
"990f633b00a36af1ba797336441191d97b12fd0f","2010-05-03 13:04:08+00:00","Fix g++ warning by commenting out an unused variable.

svn-id: r48905
"
"b4d35b327945830968b127aedaf34b6c3c976d4d","2010-05-03 13:30:09+00:00","SCI: calculate sampleLen for WAVEs as well

svn-id: r48906
"
"98aa8b195acb204587189c67f4e9eb306ee1ebc1","2010-05-03 13:55:49+00:00","SCI: fix possible heap error

svn-id: r48908
"
"1060b82f18ce3724c5215ded1a00de5d81d3451a","2010-05-03 15:10:25+00:00","SCI: copying over compressed audio (mp3/ogg/flac) buffers, because resourcemanager may free the memory at any time - fixes pseudo-random crashes - also added several assert()s after multiple malloc()s

svn-id: r48912
"
"c67344d380fd964334df6d00d9ddb99ab2394fbd","2010-05-03 16:47:09+00:00","SCI: reverting r48805 - caused regression in sq3new/kq1

svn-id: r48915
"
"b07a88548f47351fc2e89685312904e45e7664b4","2010-05-03 17:54:47+00:00","SCI: set signal in SCI0/SCI01 games, when samples have been played only. fixes sq3 guys from andromeda, but also doesn't screw up music in sq3new/kq1 - added comments about this issue

svn-id: r48918
"
"df318c0ec3627198941a0c2bf5c3704d44ba1530","2010-05-03 18:27:45+00:00","Fix for bug #2961787 'HE SAM1: Music in kitchen slightly off (regression)'.

Unlike in the branch-1-1-x I did not restore the old RawMemoryStream
code in the trunk. Instead I stripped out the pre-buffering of the
RawStream code. I still decided to add some in-place buffering
in RawStream::readBuffer to at least not rely on super-fast disk I/O.

This is currently an experimental change. There might be need to
reconsider the buffering (even though backends with slow disk I/O
should actually do buffering for file I/O on their own).

svn-id: r48919
"
"e7f29db4980ec3ad654a1b490ae040d09ad36ef1","2010-05-03 18:28:05+00:00","Check for read/seek errors of the underlying SeekableReadStream in RawStream.

svn-id: r48920
"
"c5436aebdd7234c6a89198b8766e47486b1cae7c","2010-05-03 18:32:26+00:00","Cleanup.

svn-id: r48921
"
"2e188d6bd32a806350b9ab27e4e705982dcd77e6","2010-05-03 19:18:55+00:00","Show the user a nice message, when the target passed to --list-saves does not allow listing of its save states.

This is a first step into implementing FR #2988017
'exit status with --list-saves always 0'.

svn-id: r48923
"
"6ac0d4dce55d11112b802179e1248a649afa0f1c","2010-05-03 19:20:19+00:00","Updated the iPhone Info.plist to allow full resolution on the iPad

svn-id: r48924
"
"3c0bd3dd270ea785c51c873b971820beda480933","2010-05-03 20:09:32+00:00","Tweak messages when listing save states.

Targets don't list savestates, plugins do; and since the user specified
a target, we should always list that first, and give the gameid only
as additional information.

svn-id: r48925
"
"c5f94872a7c4a1082f7c401c4e90f9bd3bf0290e","2010-05-04 08:54:07+00:00","SCI: kPortrait - correctly jump over offset table to land on raw lipsync data in portrait files

svn-id: r48928
"
"5568a8473b975dc2e7e0d1f1ae075ebd6d96f2f3","2010-05-04 11:56:52+00:00","Get rid of Engine::_gameDataDir.

This greatly reduces indirect dependencies on several header files
from common.

svn-id: r48933
"
"b3e404109c31160c978a17ebe497b9bdef9ff51a","2010-05-04 11:58:12+00:00","Move initGraphics and initCommonGFX from to new header.

These functions are only used internally be Engine subclasses, and
by moving them to a separate header we can reduce indirect header
dependencies.

svn-id: r48934
"
"970745e60c41286ff2dc1a448a5e6c39e4581671","2010-05-04 11:59:22+00:00","Move DebugChannel related code to new header

svn-id: r48935
"
"2149a2383d33ed83401a345219f0367694f9c367","2010-05-04 12:00:16+00:00","Reduce indirect header dependencies further

svn-id: r48936
"
"f7d2047d020c7a404a9af75223599456e8bbcdc9","2010-05-04 12:02:33+00:00","Fix non-Mac OS X builds

svn-id: r48938
"
"fc567b1b259a668e48a8d42e891b889c6c5068fb","2010-05-04 20:07:22+00:00","Fixed typo.

svn-id: r48944
"
"a753c9a411ba475398d8c9d875a61269e2864b77","2010-05-04 20:14:05+00:00","Switch from 'svn status' to 'svn info', which is way faster (especially over NFS).

svn-id: r48945
"
"27e1681fea7b251fc006673c020ae5af152e6aa8","2010-05-04 22:55:07+00:00","Respect the shell's and svn's exit code when checking for a checkout.

svn-id: r48948
"
"4b1cb26a394a924ced715f9128f2c63de5185efa","2010-05-04 23:12:16+00:00","Remove spurious quotes.

svn-id: r48949
"
"3b5bd3ada729c668b035ca0a418bf0f28d07d104","2010-05-05 12:16:51+00:00","Compress PNGs with advpng & optipng

svn-id: r48952
"
"388e4b65bf695bf3574a5311ea3806dc54ffe7a0","2010-05-05 17:52:59+00:00","Add a custom implementation of OpenBSD's strlcat and strlcpy.

This includes both an implementation and some basic unit tests for
the above mentioned functions.

svn-id: r48953
"
"7da8c8949b56835cf87f88ffd6cfb8204c711592","2010-05-05 17:53:30+00:00","Replace KYRA's strncpy and strncat usages by strlcpy/strlcat.

svn-id: r48954
"
"caf31ee5afb61a88342176473bf77ebddc098ca4","2010-05-05 17:54:12+00:00","Replace various strncpy usages by strlcpy.

svn-id: r48955
"
"d4e74e62a1bc51cc672e800050142008b5dac904","2010-05-05 17:54:34+00:00","Typo.

svn-id: r48956
"
"93375526c081f279578058fd4336c695898488c3","2010-05-05 20:43:22+00:00","SCUMM: Convert some code to use Common::String

svn-id: r48957
"
"e4a4df960afef56313b66a7e68c9342ec979d171","2010-05-06 19:00:39+00:00","Make sure that all the parameters to an mcode command are initialised. This
fixes one Valgrind warning mentioned in bug #2976008 ('BS2: Game lockup in
British Museum'), though I don't have high hopes that they are related.

svn-id: r48961
"
"2dd34a2123c053ec2c61c6885ca2f54a84fb15f3","2010-05-07 07:56:57+00:00","added voices pack/cd music support

svn-id: r48962
"
"3ebf0f5fce6ae554253d7ec86b6a7938e0a5a127","2010-05-07 11:18:18+00:00","Update scummvm.SlackBuild based on discussion with Robert Kelsen

svn-id: r48963
"
"49bd43ca33d59206eb2de9352f7f67d0eec6a9b7","2010-05-07 11:18:44+00:00","Fix Info.plist.in to match Info.plist

svn-id: r48964
"
"0ae4fcd055e1aca74ebc53d9b113ed0f2ee63b0f","2010-05-07 12:59:46+00:00","Fix comment to removed function

svn-id: r48965
"
"78a99ce6a698c855ace0d5d25ba630fdafa50048","2010-05-08 08:15:28+00:00","Remove the now broken 'deb' target.

svn-id: r48966
"
"ada03c57b349ab9d30f7ee1612ff52c77eda84cf","2010-05-08 18:30:00+00:00","Prevent editable widgets from adding various characters when F1-F12 is pressed by the user.

Formerly the code just casted the 'ascii' value of the key event to 'byte'
and thus truncating the character value. Now that would be fine, if we
would not allow values >= 256 in the ascii field, for example 322 for F8
which in turn resulted in a 'B' added to the editable field. I just added
a check for the values being in the byte range before doing the cast,
which fixes this.

svn-id: r48967
"
"bcbbe36976bb991efadeda925a5faec88e21c7a8","2010-05-08 20:22:50+00:00","Cleanup, remove tmp files to avoid /tmp file flood (like on buildbot).

svn-id: r48968
"
"67d9cc17b06edfd184454abe6c0e923dae673b80","2010-05-08 20:52:17+00:00","Lets not override the return value in cc_check()

svn-id: r48969
"
"9529dfa322409065bed36ba86dda260b70720187","2010-05-08 21:06:23+00:00","Cleanup.

svn-id: r48970
"
"fef4060a22627a8d53ed1df837bd4ea53574bf98","2010-05-08 21:25:18+00:00","Fix possible out of bounds access.

svn-id: r48972
"
"7bb2c9b5f4c3c91e33a4d6b40630a861cfcc247c","2010-05-08 21:34:10+00:00","Remove the disabled -Wuninitialized here, it's covered by --enable-release

svn-id: r48973
"
"b99508da842a6b9a7ab99d4d09e61feff0cfe617","2010-05-09 09:50:19+00:00","N64: Remove a potentially dangerous define in makefile

svn-id: r48975
"
"cff786341f22352066da235a288b876c3c2b1612","2010-05-09 10:31:32+00:00","Updated build files, version nr and added v5 compability flag

svn-id: r48976
"
"a3e428f6dbfd39c14495909b5e748d8581e3ad2b","2010-05-09 11:00:17+00:00","Rename DISABLE_*SCALERS to USE_*SCALERS, and move the mk/cpp defines to configure.

svn-id: r48977
"
"37e5691f1e375316ac85de54cc26f1675c9297d4","2010-05-09 12:14:16+00:00","Remove unsupported platforms for UIQ3

svn-id: r48978
"
"998531a0221646cb23bc053919e341b339522ca5","2010-05-09 12:30:20+00:00","Since configure allows HQ scalers without the normal onces, allow this combination.

svn-id: r48979
"
"09a54d765f96c1d6eed8fdbbc42aa3b47fa8f331","2010-05-09 13:31:34+00:00","Fallback to the nasm compatible yasm.

svn-id: r48980
"
"b0f17579c933a20c106c46f25e9f4a646d19e66d","2010-05-09 18:05:00+00:00","Patch #2968610: Zak C64 German: crash due to padding bytes

svn-id: r48981
"
"1823f6d94f89c77547eafd5384cd93ee4f6bb6e6","2010-05-09 18:12:22+00:00","Patch #2970203: Drascula: typo fixes in german text

svn-id: r48982
"
"99be18906835207af566264efac4b0242b2763d2","2010-05-09 18:15:28+00:00","New drascula.dat with updated German texts

svn-id: r48983
"
"57f2425b28575a06ae483b57afe316dd80c46323","2010-05-09 18:27:56+00:00","Patch #2901515: HE: Resource Forks on Mac OS X

svn-id: r48984
"
"0ace80fed4f2e6e3b03fce73fa14dc82ae3d4574","2010-05-09 20:17:30+00:00","Fix for bug #2995282 'FT: Cavefish Hideout Chase (Failure Cutscene) Crash'.

The bug itself is actually a regression from r43577, the merge
of the gsoc2009-16bit branch.

svn-id: r48987
"
"ea964491a0e8bb9ec5b45e806c7ac77a4a064103","2010-05-09 20:42:18+00:00","Revise how prefix, datadir etc. are handled.

With these changes, we are a bit closer to how autoconf works, the
de-facto standard for configure scripts. The changes make it easier
for packagers to modify where ScummVM install things (e.g. the
Maemo port might benefit from this). It is now also trivial to
override certain paths when invoking make, e.g. you can now do
make install prefix=/opt
and also datadir, mandir etc. will reflect the change.

svn-id: r48989
"
"e02168fb68192ccca58ca862a7be552c5a0e058e","2010-05-09 20:52:20+00:00","Fix bug in NES bundle reader which prevented reenterability

svn-id: r48990
"
"4eba9581b7809f0142dac65c4faca6f68adc3460","2010-05-09 20:58:41+00:00","Extended patch #2971742: SCUMM: autodetection for diskimage contents.
I added NES bundle handling to the patch.

svn-id: r48991
"
"00788185497e3b5a58da8cec5068585a0becd932","2010-05-09 21:15:58+00:00","Patch #2987340: GSoC: CINE: Hide cursor when viewing inventory

svn-id: r48994
"
"cdf30ecc5acf689a44156b7afdab7571d519d220","2010-05-10 00:50:37+00:00","Minor fix for using the MacResManager with a regular file; switch MacBinary's data fork to using a SeekableSubReadStream instead of a MemoryReadStream.

svn-id: r48995
"
"be0885e9d1edd6963a3060a41fa3b705c84c41f1","2010-05-10 17:25:12+00:00","Revert r48979. Instead, make the HQ scalers depend on the normal ones. Configure reflects that now.

svn-id: r48996
"
"b9813063ad3cfca5f7ff7a731eccca0bb32159e0","2010-05-10 18:23:54+00:00","Add support to the MacResManager and AdvancedDetector to take the md5 of a resource fork. This introduces a new flag, ADGF_MACRESFORK, which when set will take the md5 and size from the resource fork instead of the data fork.

svn-id: r48997
"
"7344ac20d7461245103279a8b48f853371018a79","2010-05-10 18:29:13+00:00","Add support for loading SCI games from Mac resource forks. The games themselves do not work yet as some (not all) of the data is in BE order instead of LE. They currently error out because it thinks the relocation block is outside of the script.

svn-id: r48998
"
"dce50f2e2d2e925b8f42e10f1d1aaca0b7a8c7c4","2010-05-10 19:44:19+00:00","Error.cpp needs to be included in the application mmp also for error translation.

svn-id: r48999
"
"a31de2adfa6818da700f82657dec6b79df9638c9","2010-05-10 20:32:55+00:00","SCI: set signal to SIGNAL_OFFSET, when a music slot is played that doesn't contain supported data - fixes lsl5 mud wrestling 'regression' in new music/sound code (worked before with old music/sound engine)

svn-id: r49000
"
"99ee5701f5e8ffaa145caa06360283d2be54efed","2010-05-10 20:55:24+00:00","Fix build with scalers for msvc.

svn-id: r49001
"
"829bded59f3015e88dfd2a12ccec2e57d382a579","2010-05-11 01:17:17+00:00","Added stripping and permissions of the iPhone executable in ports.mk

svn-id: r49002
"
"a9a56d50f0a534faac550e7a429848bcfda25ef3","2010-05-11 11:44:17+00:00","SCI: init _sysPaletteChanged

svn-id: r49003
"
"59476e44b9d72349fb094a665759729bef1c95b2","2010-05-11 15:38:21+00:00","Add support for getting a resource from the resource fork by name.

svn-id: r49004
"
"1c0ffdc42df5cbb81a15e403bfaea2c800dca89f","2010-05-11 15:41:31+00:00","Add support for loading T7G Mac resources using the MacResManager.

svn-id: r49005
"
"a5ed93034012eb17e3f756273a86c0c38b0ae200","2010-05-11 16:15:21+00:00","SCI: remove unneeded _mutex lock to fix deadlock issue

svn-id: r49006
"
"b05694b5299bd294f1f24577a2073d9ffeba924a","2010-05-11 16:16:49+00:00","SCI: fix crash/heap issue when saving games (change was actually made by waltervn)

svn-id: r49007
"
"8b1cb63de3ca51fea0ee5fba96b32b39b5ab4fe5","2010-05-11 19:13:24+00:00","Pass by reference instead of value to getResource(String)

svn-id: r49008
"
"47d6284c83352ad2429a2a535b53c02bb537867c","2010-05-12 01:22:37+00:00","ListIndexOf can have a null object reference, so adjust its signature. GK1 no longer crashes when right clicking in the inventory.

svn-id: r49009
"
"920e47cca0fadce21531e5a15bb76d4559067607","2010-05-12 05:01:58+00:00","Fix missing songs in the HE73 version of Putt-Putt Saves the Zoo.

svn-id: r49010
"
"dae53f7d747588a37b3aa2080373fdcfef52060c","2010-05-12 09:28:29+00:00","Changed the last global objects to class members.

svn-id: r49011
"
"9d3c8d49104aa2eba0865ef378c97955f262e907","2010-05-12 11:55:39+00:00","SCI: dont restore port settings for SCI0 games (fixes sq3 wrong font used when scanning for planets)

svn-id: r49012
"
"dd8aa85eb5f9fa5da23c8a9798d715c427d6a5bd","2010-05-12 14:11:28+00:00","PSP: fixed debug function. Compiler optimization was calling the destructor before the end of the function, causing incorrect stack output.

svn-id: r49013
"
"a9e5f65376f1814bdc71c00dd156c98e777de8d7","2010-05-12 16:36:08+00:00","SCI: added comments about r49012, change actually happened during sci0late

svn-id: r49014
"
"579a19fbc4866c426aacaed394b25d38a9cdffcb","2010-05-12 19:46:24+00:00","SCI: fix code that was commented out (wasn't meant to get commited that way) during cleanup r47745

svn-id: r49015
"
"b50af74703f26821062a79877067e3f28eadd2cb","2010-05-12 19:56:50+00:00","SCI: tracked down the kDisplay change, added comment about that

svn-id: r49016
"
"6f46d00a0adb248132d446741972fc4c9cf51bb8","2010-05-12 20:13:48+00:00","SCI: changed behaviour for kDisplay change (r49012) to use oldGfxFunctions (.502), which isn't 100% accurate (should be .566) but better than not restoring for whole SCI0LATE

svn-id: r49017
"
"fab2e2a8c49be5fcccaa2b0cae0779fec3c382b3","2010-05-12 20:22:10+00:00","Fix mismatched new[]/delete[]

svn-id: r49018
"
"7329e815afb67e35908ea8d5b559b9232fa630c1","2010-05-12 21:28:38+00:00","SCI: header size within sci1.1+ views doesn't include the actual header size word, adjust accordingly (should make mac view support possible now)

svn-id: r49019
"
"49d41d891b49e9b09cf62df46d0dfdddff93ec9c","2010-05-13 12:29:55+00:00","SCI: figured out weird special mac sci1.1 view decompression (currently commented out for clone2727)

svn-id: r49020
"
"f5f104f55053f42d630ec4d331c1ce55e3125389","2010-05-13 12:39:01+00:00","Fix bug #2880229: KQ4 AGI not recognized

svn-id: r49021
"
"983c41bea236f4d22277895ce29fb753407698a0","2010-05-13 13:32:12+00:00","Remove useless const on a value return type.

svn-id: r49022
"
"86cd5b71fc667cf7b85094500e1c6a8134d787d3","2010-05-13 15:39:20+00:00","SCI: adding some more assert()s in view data loading for clone :D

svn-id: r49023
"
"faffc57136b98e6a38c27317814f8f9627bbafec","2010-05-13 15:49:52+00:00","SCI: removing one assert() from view loading, cause view 260 in kq6 really contains a celCount == 0 o_O

svn-id: r49024
"
"070b2e14fe3fa1c89aba4e1e5410a52a5315fbfc","2010-05-13 20:19:54+00:00","SCI: don't adjust new windows to _wmgrPort for oldGfxFunctions() games (till kq4 .502), fixes all window positions for those especially sq3old speech bubble windows

svn-id: r49025
"
"a5f59ccdae6cd60b365229e7fd48c737dad6b4ba","2010-05-13 21:14:37+00:00","SCI: remove hack code for shadows and implement them properly (shadow is actually part of the window, not added onto the window) - fixes especially lsl5

svn-id: r49026
"
"38c661bfacf608840b2ad9170b50366e32bcf3d3","2010-05-13 21:29:32+00:00","SCI: fix regression of r49026 - line between titlebar and actual window was overdrawn

svn-id: r49027
"
"c083ce287900f90b0a90dc461add02891b2d0f48","2010-05-13 22:04:53+00:00","SCI: fix window, when its too large for screen (fixes sq3 crash at ending, actually caused by script bug)

svn-id: r49028
"
"94f1af2b4482c9447d05b95bdef058b5d085dc2a","2010-05-14 11:49:09+00:00","SCI: if no priority is set (=255) and a cel is embedded in picture vector data -> set priority to 0, fixes kq5/amiga - first scene not showing

svn-id: r49029
"
"25bac3bef494aede6167734b7837c9308c9d9445","2010-05-14 15:21:00+00:00","Silenced some MSVC warnings

svn-id: r49030
"
"6d38cf8b8f164b6d8e03715540b1d9bcfdad1ce7","2010-05-14 15:23:42+00:00","Made locateVarSelector() a method of the Object class

svn-id: r49031
"
"e91df69eb64d9e3ef7d02aa2423e3fbc96dc8aef","2010-05-15 00:28:44+00:00","Decoded further fields in the SequenceList class, and started implementation of kernel message display

svn-id: r49034
"
"86bfccb842cc17f3eb0845b238c92f778ccf890a","2010-05-15 00:42:56+00:00","Removed use of globally constructed menu item position lists

svn-id: r49035
"
"2da9fa5a6edd962acca228706a2f2d4465827015","2010-05-15 08:38:19+00:00","Rewrote playMovieSound() to keep it from hogging memory in the resource
manager. Perhaps this will finally fix the mysterious bug #2976008 ('BS2: Game
lockup in British Museum').

svn-id: r49036
"
"83a25d2e37ad1cc0870e195bc468a67dba4c353a","2010-05-15 08:54:58+00:00","Fixed a regression that caused some speech in cutscenes to not be played.

svn-id: r49037
"
"59a255226f95d395cb73119ae2e04a3494d404a5","2010-05-15 08:57:13+00:00","SCI: SCI_SCREEN_MASK_* now GFX_SCREEN_MASK_*, using enum - added new enum GFX_SCREEN_UPSCALED_*

svn-id: r49039
"
"eb2b3f352ed03dc7299ff6202e68a68116476aa9","2010-05-15 14:17:50+00:00","SCI: adding upscaled hires mode 640x480 for kq6 and gk1, fixing valgrind error in GfxPortrait class, not using priority anymore when drawing hires cels (shouldnt be needed for kq6)

svn-id: r49040
"
"f3b2627179852a869963c9120acf250de5a71b3c","2010-05-15 15:16:32+00:00","SCI: adding special 640x440 upscaling mode for kq6, finally hires portraits are drawn at the right position

svn-id: r49041
"
"19af89a902d3b4736d61fd701857f64d6694d8b9","2010-05-15 15:45:05+00:00","SCI: removed _mainPort (was unused, is unused)

svn-id: r49042
"
"ae4da9debe1d46815190470fde4ab2e0dddb0b6a","2010-05-15 15:59:46+00:00","SCI: setting port _menuPort, fixing crash on setFont()

svn-id: r49043
"
"5e4868fb008712d6504f0c1dab51b3566998b55f","2010-05-15 21:28:26+00:00","SCI: handle TAB like Ctrl-I on menu key checking, sci0 also did it that way - makes TAB work for inventory in iceman/qfg1ega

svn-id: r49044
"
"43e61ec60f804b2540d1188801ba44cf37727782","2010-05-16 01:32:46+00:00","Bugfixes for animation depth logic

svn-id: r49045
"
"b57bab8e3ba0909a253c439296f7f5e9c2bb2150","2010-05-16 10:23:44+00:00","Added automatic detection for the non-interactive ITE demos

svn-id: r49046
"
"80acb21a56f6e1a42de6d44de87d24891ded7e80","2010-05-16 10:36:21+00:00","Added automatic detection of the IHNM demo

svn-id: r49047
"
"c49930d523a7293cc81bf71eef7f28038ccf9098","2010-05-16 17:21:37+00:00","SCI: fixing possible typo for Shift-F1/F10 keys, fixing submarine controls in iceman

svn-id: r49048
"
"b4f810707d325b6f9e1cff37640f1bbb963d2da7","2010-05-16 17:59:18+00:00","Patch #2998635: 'IRIX packaging files + icons' + add scummvm.spec.in to update-version.pl

svn-id: r49050
"
"e46a01b8bb006d9ff5c593d638f8d6fda1565c63","2010-05-16 18:02:59+00:00","Correct IRIX spec filename

svn-id: r49051
"
"9891932d5660099c59dafe618935703f37a60d39","2010-05-16 18:05:47+00:00","Add back README.PSP

svn-id: r49052
"
"f4eacd6cc626f6879f4621e493fc28ca6799f168","2010-05-17 04:02:49+00:00","Synced NEWS with 1.1 branch.

svn-id: r49054
"
"8b59e45e6e8ffdd733abaa53d6ee4eea7ee6bc5d","2010-05-17 07:22:26+00:00","PSP: added option for render by callback and fixed up and cleaned up debug mechanism. This allows for about 4% speedup since we no longer need to wait for VSYNC in our main thread. I'll activate it as soon as I've tested it out properly.

svn-id: r49055
"
"4119fdb9a93207f9de5e925e1d095ca5dd6348b1","2010-05-17 09:32:16+00:00","SCI: adding speed throttler special case for iceman / submarine control room

svn-id: r49056
"
"68cae03b3c9fc35606ad899362a43e09b823f3e9","2010-05-17 10:30:17+00:00","Bugfixes for animation display, and better understanding of how animations cycle

svn-id: r49057
"
"946fe2905ec9fed65d504381e616eb9dfd91507a","2010-05-17 11:02:35+00:00","Change product id to just be 'ScummVM <version>'

svn-id: r49059
"
"dd0c1fd6f0b0cca6fba9c189b69debe28fe8a078","2010-05-17 16:50:10+00:00","Restrict MIPSpro workaround to non-gcc compilers -- fixes compilation with gcc on irix.

svn-id: r49060
"
"811fc0e7ec04950d0a4454d1780e49a4d87af9ae","2010-05-17 20:53:04+00:00","Add the Common::Rational class from patch #2963496 (VideoDecoder Rewrite)

svn-id: r49061
"
"ea84abf5880f0af2642dd3de08a6d9c6f7f88426","2010-05-17 20:57:36+00:00","Add tests for Common::Rational from patch #2963496 (VideoDecoder Rewrite), also courtesy of DrMcCoy who wrote the main Common::Rational class too

svn-id: r49062
"
"c7fa1074fbc55e9e519f9c7e08dea9603af22e61","2010-05-17 21:59:05+00:00","Change VideoDecoder::getCurFrame() to mean the last frame drawn instead of the next frame to draw. This is patch 1 from patch #2963496 (VideoDecoder Rewrite).

svn-id: r49063
"
"00cd966f3da11aea4cd1bc5a28808e006f7eff9d","2010-05-17 22:07:58+00:00","Some tweaks and fixes for Common::Rational

* Fix Common::gcd to work with negative input
* This fixes a bug in Common::Rational's multiplication code
* Add some more basic unit tests (including one which checks for
the now fixed multiplication bug)
* cleanup

svn-id: r49064
"
"c56a481f88c23ef394c723cd4ef4c7efec6a7aa9","2010-05-17 22:08:19+00:00","Use TS_ASSERT_EQUALS in test cases

svn-id: r49065
"
"22caf0e1cf95634cb5cabc4ea52fb3ccea15679d","2010-05-17 22:08:40+00:00","Get rid of Common::Rational::normalize and other redundant code

svn-id: r49066
"
"01070d72d39fba35ca8771055032c2b8a3f141f1","2010-05-17 22:17:42+00:00","Minor formatting.

svn-id: r49067
"
"cbbb78d9f29672e0f78724344040a692018fa3a5","2010-05-17 22:46:53+00:00","Enforce conversion formatting on pointer casts in the DEV code.

svn-id: r49068
"
"0fe2ba6a0dd1bc7a3edda7ed8deaeba10f39ab9b","2010-05-17 23:29:44+00:00","Some more enforcement of our formatting conventions in KYRA too.

svn-id: r49069
"
"3dda73d9a2b65da0dad2d184c52f5ebbee682b59","2010-05-18 04:17:58+00:00","Add initial support for KQ6 Mac. Wrapper functions for read/writing to pointers are now used (found in util.*) for code that has different endianness in SCI1.1+ Mac games. Add support for Mac 'snd ' and 'CURS' resources. QFG1 Mac is not yet playable due to script compression.

svn-id: r49070
"
"8b7c29a4adfb3c19583a38d85d8c248072fec40b","2010-05-18 09:18:27+00:00","Moved breakpointWasHit inside the DebugState struct, thus resolving a FIXME

svn-id: r49071
"
"16afdc372e156ac5ff85748c1a29bc833e201e75","2010-05-18 09:24:53+00:00","Fix missing dialogue index.

This is the BR case of the NS fix in r45053. Patch by fuzzie@fuzzie.org .

svn-id: r49072
"
"7ab8f6e25bb4904140116c4a484b5a23c44d6bf5","2010-05-18 10:01:31+00:00","Fix currentFrame semantics in Flic player

svn-id: r49073
"
"15986b81c2f30a52d2b7ebc90ce0eff9fe173443","2010-05-18 10:39:08+00:00","Added getBaseFileName() method and enhanced open() with trying macbinary format in plain files

svn-id: r49074
"
"75f4791a4a97889cd01663e9cc882682e58b6177","2010-05-18 11:23:13+00:00","- Moved determine_reg_type() and kernel_matches_signature() inside the Kernel class, where they belong
- Moved the kernel signature defines inside kernel.h
- Removed some unused references to EngineState

svn-id: r49075
"
"46af5a5162db4c2b5c238f02465ee226c04e834f","2010-05-18 12:16:48+00:00","- Moved kernel_lookup_text inside the Kernel class
- Added a pointer to the segment manager from within the Kernel class, thus simplifying the calls to it

svn-id: r49076
"
"e3297ef2cad4b0efc4b262d73b1be4630497dd4a","2010-05-18 12:34:14+00:00","SCI: fixing crash in pq2 - not sure about this, lskovlun should take a look at this

svn-id: r49077
"
"f3892a506b2f935bae0be6319394c503c786d368","2010-05-18 13:05:09+00:00","- Removed the wrapper kalloc, kmem and kfree functions. Now, the associated Segment manager functions allocateHunkEntry, getHunkPointer and freeHunkEntry are used directly (which are more descriptive, anyway)
- Replaced the GET_SEGMENT macro by a method of the segment manager
- Removed the unused reference to the created hunk in allocateHunkEntry(), only the reg_t reference to it is returned now

svn-id: r49078
"
"11cbdd03180a655b2b23ee4a13f1a00a1d782b3c","2010-05-18 14:17:24+00:00","Committing the rest of the VideoDecoder Rewrite from patch #2963496.

svn-id: r49079
"
"6499ddff8e2be705f3be53ab391178ec4c3764f2","2010-05-18 14:57:02+00:00","Added back video skipping in SAGA2 with the escape key or left mouse button

svn-id: r49080
"
"bddceced34f829b0640d1aecacac1e1079eb0839","2010-05-18 14:59:20+00:00","Have QTPlayer inherit from VideoDecoder. The video downscaling (QuickTime is insane) has also been moved to the QTPlayer class.

svn-id: r49081
"
"512435893b14e942f342e69a2b17c9a499ccf3a0","2010-05-18 15:16:53+00:00","Started simplifying and removing a lot of unused code from the SAGA Mac resource loader, to be ultimately replaced by the common Mac resource loader

svn-id: r49082
"
"83f31e4e44596c865132f9d92b54b166484ea89d","2010-05-18 15:52:45+00:00","Added the number of parameters passed in unknown kDoAudio subops

svn-id: r49083
"
"759e4923d07d2ac3eb23422aaa2a05671db4ce1c","2010-05-18 17:36:34+00:00","Add a new class 'RewindableVideoDecoder' that allows a video to be rewound and have QTPlayer inherit from that.

svn-id: r49084
"
"e4d1c8a1bdf8db48b7232837d14c489a5045b66b","2010-05-18 18:16:21+00:00","Replace one instance of strncpy with Common::strlcpy.

svn-id: r49085
"
"62717eafc4a0baf3e68f849d4a6c22578802e8a0","2010-05-18 18:16:47+00:00","Replace some strncpy usages with Common::strlcpy.

svn-id: r49086
"
"e41874c91d4e658289664e7ea5eddc2c89a03c34","2010-05-18 19:59:43+00:00","SCI: set signal on fadeOut and also set signal when fade is requested but sound is not playing (& show warning in that case) - fixes iceman hang after fireworks in room 14

svn-id: r49087
"
"9af44c9332bee7fb6057ea825be846a1d7c77038","2010-05-19 00:25:12+00:00","Added packing to the QT structures

svn-id: r49088
"
"61d7bfb730a7411bb4559e9d3a48d33a93014f78","2010-05-19 05:35:27+00:00","Patch from Littleboy to silence useless warning due to VideoDecoder changes

svn-id: r49089
"
"95b1c13eae52b99011f552579f547c3d5088c21a","2010-05-19 05:42:14+00:00","formatting

svn-id: r49090
"
"db3fc7a89e5a450e82f0b4a5a3b724ad251c8d54","2010-05-19 06:53:47+00:00","Added missing single quote

svn-id: r49091
"
"852cb16c49aaca1891d25e420ddf1459efa55ae8","2010-05-19 07:25:06+00:00","Moved the breakpoint information inside the DebugState struct

svn-id: r49092
"
"174a043aa7459478326a771581d39f3480ca82f6","2010-05-19 08:50:24+00:00","Removed the exportsAreWide variable from the segment manager and save games, and moved validateExportFunc() in the Script class, thus resolving a TODO

svn-id: r49093
"
"209798474bcca17347458b6116aa44af4d544c80","2010-05-19 09:39:11+00:00","Updated the save game format for the changes in #49093

svn-id: r49094
"
"2be9bb3d5fc90962cd672aaa99a3d1eea2898c82","2010-05-19 12:17:59+00:00","Implement FR #2841494: FW: Pause doesn't work

svn-id: r49095
"
"15c533d2c2b1464f2d55d3f6c48a9e21c85a2e7f","2010-05-19 12:34:10+00:00","Implement FR #2841445: FW: Restart doesn't work

svn-id: r49096
"
"bb10dabe904605505ab1dfb2cb46ed61e4d2d67e","2010-05-19 13:32:27+00:00","SCI: changing debugger commands to not require '?'-prefix for objects anymore. It's now also possible to use 0x prefix for hexadecimal values e.g. 'vo 0x13', 'vo 13h', 'vo theSound', 'vo 12f:34f' is now possible

svn-id: r49097
"
"9b4f35287027d6c9dafca8f6157fe60c620ee9c4","2010-05-19 14:19:16+00:00","SCI: cleanup soundcode - number renamed to resourceId, prio renamed to priority

svn-id: r49098
"
"d1f1c71f5007eb26b3945f1508f886d219491f42","2010-05-19 14:43:16+00:00","Cleaned up script_instantiate_sci0()

svn-id: r49099
"
"893af1600aa8f4619e6c56ca2a8f074e230c1084","2010-05-19 14:45:56+00:00","Fixed signed/unsigned warning, changed to CamelCase

svn-id: r49100
"
"3f10841ae8f167cd6bc08ef266d0161c2d608624","2010-05-19 14:54:39+00:00","SCI: removed cmdStopAllSounds(), can't be right - added FIXME - fixes iceman room 14 music stopping within 1-2 seconds

svn-id: r49101
"
"480e5c84888c40a54f173c90bc634fa579b83b79","2010-05-19 15:57:58+00:00","Added a new method to the resource manager, to help determine if we got a SCI1.1 Mac game. Started rewriting the fallback detector so that it doesn't rely on the segment manager to find the internal game ID

svn-id: r49102
"
"cbee7eebd4736a91400bc3df65d28215cb916aa9","2010-05-19 16:54:42+00:00","Do not try and run dialogues when there is no dialogue defined in a SPEAK zone. Patch 3003382 by fuzzie.

svn-id: r49103
"
"92c1f4625d7a8e7b119dc005539145f59ce6c49b","2010-05-19 17:11:15+00:00","Fixed silly typo in #49099. Iceman works again (thanks m_kiewitz)

svn-id: r49104
"
"f84b23244322f440e9503eb3519688a6a255be40","2010-05-19 17:16:15+00:00","Add a parser for HEAR zones in BRA, and handle the relative MUSIC command. Patch 3003382 by fuzzie, with enhancements.

svn-id: r49105
"
"9675bf2e7a3d987d636afaf639caa7a62858a447","2010-05-19 17:18:20+00:00","Reverted commit #49088, seems like to be a false positive from MSVC on the QTPlayer::*func pointer of the ParseTable struct (warning 4121, alignment of a member was sensitive to packing)

svn-id: r49106
"
"b0ac5ee897b9d3e59ae286856dfcbd1691af03ca","2010-05-19 17:19:51+00:00","Disabled probably false positive warning 4121 (alignment of a member was sensitive to packing) in mohawk

svn-id: r49107
"
"e243c87fc0d1ed282d391c5b78edeedf127f6432","2010-05-19 19:41:10+00:00","SCI: updated comment on kDoSound(12)

svn-id: r49108
"
"264fde962b564d6c37040c51724c70b3524a394c","2010-05-19 21:10:43+00:00","SCI: sound code now queues up music in sci0, wip-code: not reacting on priority yet - fixes iceman room 14

svn-id: r49109
"
"678411ae5e2dafd8878ddec119671611a4a39541","2010-05-19 23:29:27+00:00","Slight bugfix in the object iteration inside getSierraGameId()

svn-id: r49110
"
"75992f856cd4949973d7f9cc2847098887e333d7","2010-05-20 00:10:53+00:00","Groovie: Tweak a filename of the Mac version of T7G

svn-id: r49112
"
"a0db16294a6ce9bdc737e60586abcef7ec7a2dec","2010-05-20 05:48:37+00:00","SCI: adding workaround for some underwater rooms in iceman - removing visual&priority lines that appear because of non dither mode (would merge with dithered fill color combination normally)

svn-id: r49113
"
"5f8778395af3140f40f29415d320e7e1155f7ada","2010-05-20 06:11:46+00:00","SCI: fix regression of r49109 - only queue up midi sounds

svn-id: r49114
"
"23eae4e139507f31bc81f4896b71814f9db860de","2010-05-20 10:36:54+00:00","PSP: Had to switch to different way of using callbacks as last one wasn't working well. Seems to be working well this way, so I activated it. If need be, deactivate it by commenting out USE_DISPLAY_CALLBACK

svn-id: r49115
"
"474b804e33aec7d0aa9600fa6b210e50c0d13c85","2010-05-20 13:46:18+00:00","Make the MacResManager opening more robust to failed tries and plug its memory leaks

svn-id: r49116
"
"fd5000fb7907cc401197cb84d2ae39559e82c7ac","2010-05-20 15:16:09+00:00","Groovie: Add support for MT-32 custom instruments

svn-id: r49117
"
"f76f64774aa5c7d9669196c0258767d1e9f43cfb","2010-05-20 17:22:45+00:00","Add initial support for T7G Mac MIDIs. Compressed MIDI is not yet supported.

svn-id: r49119
"
"2e0fdda51ff9ff48bb8cbfcc770f9fd99cccd43e","2010-05-20 18:38:06+00:00","Add a pause level system to VideoDecoder (blatantly ripped off from Engine) and adapt Mohawk to it.

svn-id: r49120
"
"ad42fa0b2d613a879250cd601a4c0756bfe699cd","2010-05-20 18:45:12+00:00","The QuickTime getPalette() function should output in RGB format, not RGBA.

svn-id: r49121
"
"af44b2a420c12963400fa1c2d7ce19ced36dc533","2010-05-21 07:22:36+00:00","cleanup

svn-id: r49123
"
"20fcedc34a184ece45d4ff475f1d5f8881aa7c73","2010-05-21 07:30:37+00:00","Some further work on the fallback detector, reducing the reliance on the segment manager

svn-id: r49125
"
"e6ede6bba104d0d7c9fc9c8a114da8b7ba698fa5","2010-05-21 07:51:47+00:00","Removed the reliance on the segment manager from the fallback detector, for SCI0-SCI1 games (it still doesn't work with SCI1.1 and newer games, though)

svn-id: r49126
"
"8b20f16378c377fdcbf14a6b0293154396a6d7b5","2010-05-21 11:05:18+00:00","Added a new valid EOL character for scripts. Patch 3004990 by fuzzie.

svn-id: r49127
"
"1c579dc0ace2a1bc7750bdbf9d99d35b48afc168","2010-05-21 12:39:54+00:00","Fix loading of MSC files on big-endian systems. Patch 3004367 by fuzzie.

svn-id: r49128
"
"6408504c93b4cc5c2e9fe8053f726d7eb38685e1","2010-05-21 13:31:45+00:00","Slight cleanup

svn-id: r49129
"
"e7330aa0afec88c6d7327ac9fd1a49736daaad6f","2010-05-21 18:18:52+00:00","Fix spelling

svn-id: r49130
"
"01c55efc95b2510eca1842058ab878e1ebd5ed4e","2010-05-21 18:22:11+00:00","SDL: Split quit() method into deinit() so error codes could be returned.

svn-id: r49131
"
"1a938956ec00247794151bb2b72f088f68581857","2010-05-21 18:25:01+00:00","Implement FR #2988017: exit status with --list-saves always 0

svn-id: r49132
"
"e0099ef394e2363aa5ce4fd50c019a0154dafb18","2010-05-21 18:27:13+00:00","Implement FR #2858270: GUI: List scrollbar actions should focus on list

svn-id: r49133
"
"47d6e9eab7f657ac36b01c143a0bd5edba1d2361","2010-05-21 18:33:24+00:00","sync with parent sdl backend

svn-id: r49134
"
"bc479f8aef9b26d0690dfb8f311e41374d886d0c","2010-05-22 03:49:22+00:00","Make sure hitZone always gets absolute game coordinates. Based on the patch 3004658 by fuzzie.

svn-id: r49135
"
"5280cbbbcd4a43efd456d2949c4436ff054cbd5e","2010-05-22 12:36:36+00:00","Added descriptions for kFlagsSelfuse and kFlagsYourself. See patch 3003626.

svn-id: r49136
"
"a8ea833941208382e659914fb5bf99d5cb4f01a1","2010-05-22 12:36:52+00:00","Do not make the character walk towards the zone clicked upon by the user if it is marked for self-use. See patch 3003626.

svn-id: r49137
"
"d56352cbd515e35f5f85ee607d2f8148ae2e1e59","2010-05-22 12:37:07+00:00","Use the kZoneYourself flag to check zones for self-use in BRA. See patch 3003626.

svn-id: r49138
"
"1b6d9c86e2b62f4e1543417d43386fab12c7f4f0","2010-05-22 15:30:18+00:00","Make sure a dialogue is valid before entering dialogue mode.

svn-id: r49139
"
"866e15e8b2b11ae72f3fcb803b57dd770adc6b57","2010-05-22 15:56:09+00:00","Apply patch 3004991 by fuzzie: don't try and run dialogues for SPEAK zones without dialogue, but run the command list anyway.

svn-id: r49140
"
"45a5c29cdf01d7cade0dbfaf7ae2ee92bd75cc56","2010-05-22 15:56:27+00:00","Apply patch 3005433 by fuzzie: new 'toggleglobalflags' command for the debugger.

svn-id: r49141
"
"9b6a3712d6c237ac8453221b07a5a14ad0409e96","2010-05-22 16:50:15+00:00","Rewrote and simplified the game ID detector. It now properly works with SCI0-SCI2.1 games

svn-id: r49142
"
"80ffcc621dfea5bf00abbdd761dedcf83270021a","2010-05-22 16:54:13+00:00","Cleanup

svn-id: r49143
"
"b4813f9b182a5034a50412fe5212ba09f9323bfe","2010-05-22 17:59:16+00:00","Apply patch 3004687 by fuzzie: allow usage of merge zones.

svn-id: r49144
"
"2f5cb946bb6faa27efabd9a3914db805c4f3dbb6","2010-05-22 17:59:33+00:00","Finish implementation of hitZone and related functions as from the original code.

svn-id: r49145
"
"95f6a71f3699c91ec021e207d38c479dd7f28fa1","2010-05-22 17:59:49+00:00","Cleanup (removed many Parallaction::getGameType() calls).

svn-id: r49146
"
"5f2a88e5966e64e24f6630ca3d1e84077d76998b","2010-05-22 18:00:16+00:00","Cleanup (removed more Parallaction::getGameType() calls).

svn-id: r49147
"
"d04c7a58aa5d72f62f49c5c3246d5e5c0af8920a","2010-05-22 21:46:40+00:00","SCI: adding ability to specify hexadecimal number as index for debug command vmvars - also report error if invalid index is given to us

svn-id: r49148
"
"7a6a2a62eebfea5f09bf86fee3935e1ad031959d","2010-05-23 05:51:32+00:00","PSP: switched from SDL's audio to my own thread. Removed needless blocking while playing and made it generally more efficient. To deactivate, simply comment out USE_PSP_AUDIO

svn-id: r49149
"
"dd9bf70761f2de9771912984209422f1f63bd3e8","2010-05-23 07:20:40+00:00","Major work done on the animation and support classes to match the original

svn-id: r49150
"
"c874ff15a8e95acb85940ba5de0243b93077cc9d","2010-05-23 10:28:03+00:00","Cleaned up the game ID code:
- The game ID is now obtained from ScummVM ID directly, not by converting Sierra's internal ID
- Moved the code which reads the internal Sierra ID inside the resource manager
- Moved the code which converts the internal Sierra ID to ScummVM's IDs together with the rest of the detection code

svn-id: r49152
"
"8ed56e1834487f44c94c6b5c5a4353bb3a889696","2010-05-23 10:50:14+00:00","Keep the Broken Sword cutscene players from using up all available CPU.
Probably a regression from the recent video decoder rewrite, but I haven't
checked if it also present in other engines.

svn-id: r49153
"
"1b294306dd49fb8b97f0e74d94b6c4a89403191c","2010-05-23 11:16:10+00:00","Another video player regression: When the palette changes, look up the
lightest/darkest available colours to use as white/black for the subtitles. It
is possible that we could get away with fixed values for Broken Sword 2, since
it has always had subtitles. But for Broken Sword 1, subtitles is a ScummVM
addition, and we can't.

svn-id: r49154
"
"20c654f63b29a5eb120e5d7d72d06080995a463a","2010-05-23 11:48:21+00:00","PSP: replaced SDL's timer with much simpler and more efficient PspTimer class

svn-id: r49155
"
"aa4ae667a99219ef66bad260e29b468c7f6afa7e","2010-05-23 12:22:23+00:00","SCI: use priority when queuing up music in sound sci0 -> fixes lsl3 jingle issues

svn-id: r49156
"
"d27e32aa196afec2f2df20fea943a4b6978650b3","2010-05-23 13:22:58+00:00","SCI: fix regression of r49156 - if multiple songs are stored for resume-play, use the last one - fixes iceman wrong music played after going through door in room 14 - still not sure about this, added fixme

svn-id: r49157
"
"b069b9fe9691f1285446a89152cb9e295d15807c","2010-05-23 16:42:49+00:00","SCI: reenabling 'stopAllSounds' code disabled in r49101 - isn't called anymore since priority is honored so it may have been right after all

svn-id: r49158
"
"9be4f6250cc88a1638299b3661b9896f4ebf57ed","2010-05-23 16:44:36+00:00","Made shrink_execution_stack() a member of EngineState

svn-id: r49159
"
"db74441d558103c626d1ec078583b0266a190e5d","2010-05-23 16:59:09+00:00","SCI: fixing crash in _vocab_add_rule when running qfg2 demo

svn-id: r49160
"
"7cd9a23c0d11b451979aeea66a6bb325b2d31341","2010-05-23 17:03:16+00:00","Remove the unused SCI_GAME_WAS_RESTARTED_AT_LEAST_ONCE flag

svn-id: r49161
"
"e321e255147fc93a76518c92bcd521771f3ca651","2010-05-23 17:35:31+00:00","PSP: forgot to add a file

svn-id: r49162
"
"2ffbd661ac8c8eba7fcc20df33fc902687b5698e","2010-05-23 17:40:42+00:00","SCI: removed hack for iceman in kDoBresen - fixes all sorts of automatic walking issues (like rescueing ambassador) in iceman, dancing at the beginning also still works - thx to [md5]

svn-id: r49163
"
"e2a388e2f59f689cd89995013236e90a1b004264","2010-05-23 18:03:23+00:00","SCI: Enabled saving from the ScummVM menu again

svn-id: r49164
"
"2f31b05651baf87ea07bc00cced798955a5fa6be","2010-05-23 18:33:55+00:00","Move Mohawk's QuickTime code to graphics/ (and QDM2 to sound, disabled when Mohawk is not enabled) so SCI can use the code.

svn-id: r49165
"
"ed0e8182cee620e6abae2e9c1bc571b31833f474","2010-05-23 19:08:31+00:00","FFMpeg switched to Git, so update link to original smacker decoder.

svn-id: r49166
"
"088ad439669c3b535bb66e8773aaf706ba70e5fa","2010-05-23 19:24:19+00:00","add mips-sgi(-irix6.5) cross-compiling target

svn-id: r49167
"
"e5d239b779ba24e75f1f911b023c6c94b63ffefd","2010-05-23 19:31:38+00:00","PSP: changed thread stack sizes to prevent crashes in COMI

svn-id: r49168
"
"734042a32ce37822551094feac81887743998b6c","2010-05-23 19:32:56+00:00","PSP: commented out new PSP audio. Still has some clicking issues

svn-id: r49169
"
"5e90f66edc816931996a72b8fca8b01a96aff31a","2010-05-23 19:54:17+00:00","Hide the QDM2 implementation and only expose it via a factory method, hopefully fixing compilation on most systems at the same time.

svn-id: r49170
"
"b3bd797e019c20de1d4bfdac131e6e3e2c45860a","2010-05-23 21:41:13+00:00","Move the QDM2 code to the graphics module, removing the cyclic dependency.

svn-id: r49171
"
"8f14c15b1afc51a860d7fae28a59cbcd4d7d4d04","2010-05-23 23:26:28+00:00","Add support for loading the QuickTime 'moov' atom from the file's resource fork, needed for SCI Mac.

svn-id: r49172
"
"50847c02a6ca526a01f3eecae024e32973413a90","2010-05-24 03:05:17+00:00","PSP: moved timer thread to backends/timer/psp

svn-id: r49173
"
"54aabd425c9313a29acfa6ea29698f14f53e4453","2010-05-24 06:18:14+00:00","testing a sample commit to my branch

svn-id: r49174
"
"87eb782496c71fe10ac829769a8c9762f5372e6f","2010-05-24 06:57:58+00:00","PSP: switched to the way SDL does things in the audio thread to get rid of clicking. PSP's thread is still more efficient.

svn-id: r49175
"
"f9217ec031ff1740db0a7baca2fc486fe1d3d26f","2010-05-24 07:47:07+00:00","Added Russian airport and farm. Needs more work as crashes at attempt to opening some dictionary entries with Cyrillic characters

svn-id: r49176
"
"cfbf1a8a673295a621ee618be86bb7c42c531a8f","2010-05-24 09:19:40+00:00","PSP: turn off psp audio thread again. Must have tested it wrong.

svn-id: r49178
"
"55e29af78a52a13269d9905c6410e70f56b5920d","2010-05-24 11:41:45+00:00","PSP: switched to using slightly faster delay and getMillis

svn-id: r49179
"
"6bda3e15db6baaa3af3d479e86dad2dd4f95084f","2010-05-24 12:12:27+00:00","Implemented the bulk of the logic for displaying timed on-screen messages

svn-id: r49180
"
"35b3c3c083f0cea69de2a210379dc703ea8fca71","2010-05-24 13:18:00+00:00","Fix compilation under MinGW

svn-id: r49181
"
"c8584b7a82a3a97a6e5fb9cddde1b98ccd512292","2010-05-24 13:20:35+00:00","Fix warnings

svn-id: r49182
"
"19f369fe3bfcd1e2bed01f8d92898d06193050ee","2010-05-24 13:22:52+00:00","Added Russian Windows release of puttmoon

svn-id: r49183
"
"6e66fa3726a4616b093c2ffd7227d161ab4d70a7","2010-05-24 13:26:16+00:00","sync

svn-id: r49184
"
"350e3d7c053deb202ee8411f1ebda0a97a48e4e9","2010-05-24 13:50:19+00:00","SCI: remove isQueued status when sound gets stopped - fixes iceman resuming music when entering hotel complex (with bar) right at the start

svn-id: r49186
"
"b49efb67f6e6f9d8b8107ec0de82055588fe215f","2010-05-24 14:47:43+00:00","SCI: only remove isQueued status for sound sci0

svn-id: r49187
"
"babf7ef44c2407cd52000684e3fa08aa63c8b462","2010-05-24 14:54:50+00:00","added the testbed engine: basically renamed quux

svn-id: r49188
"
"e9db62b272409580e45e776d4dfcd358670d6ccd","2010-05-24 15:39:30+00:00","SCI: sort according to original order in kAnimate, when y and z are the same - fixes iceman half-open compartment in room 35

svn-id: r49189
"
"5ceb896b6b1d4a2d2ac83fdc5552013ab5abedc2","2010-05-24 16:51:33+00:00","Have the MacResManager ignore resources with length 0.

svn-id: r49190
"
"07ccf29ecf30b231191d6787564b675e7fb9c4a1","2010-05-24 16:56:56+00:00","Fix Russian versions of airport and farm as they use extended charset.

svn-id: r49191
"
"c96e234a0a48f91d52cda875485efeb644e4047f","2010-05-24 16:58:14+00:00","Fix warning

svn-id: r49192
"
"e39bf477173d6f0f75ddaf827338ebe0d4195525","2010-05-24 16:58:42+00:00","Fix crash when there is no drascula.dat file

svn-id: r49193
"
"afd909d69e461f42b454e8b6ff89cdca145890be","2010-05-24 16:59:06+00:00","Fix bug #2827172: DRASCULA: Cursor appears ontop of ending and credits

svn-id: r49194
"
"ad0eb0b06ef6c715280c21a1c036be5c56a3183a","2010-05-24 17:18:09+00:00","Move the PICT code to graphics/ with some updates; needed for SCI1.1 Mac.

svn-id: r49195
"
"d49fb8f42db7b9776f1dc426ebe2c6d806ad4720","2010-05-24 17:21:11+00:00","Add support for showing the icon bar in SCI1.1 Mac.

svn-id: r49196
"
"cbf491a7b847ba337c0e7d777d917b82b5a5e7b5","2010-05-24 17:43:55+00:00","adding (missed) testbed to engines/, reverting TODO

svn-id: r49197
"
"3fa50583a065dc6c6f9855bdb33918af9a540b43","2010-05-24 17:45:00+00:00","SCI: leave console open for pic_visualize/undither commands - also don't use SciGui class for undither anymore

svn-id: r49198
"
"f5ec3a3f741fbcfcd8e14661fff0558d45556224","2010-05-24 17:55:23+00:00","Oops, forgot to delete the icon bar.

svn-id: r49199
"
"1caf98700b7319719f6db062f7409ea9dc9caa57","2010-05-24 18:20:16+00:00","PSP: to fix the audio, I cleaned up the audio thread and changed the thread priorities.

svn-id: r49200
"
"d4ae096a633182c1a6a85061909c26a33a929460","2010-05-24 20:50:53+00:00","Surface is a struct, not a class

svn-id: r49201
"
"830d17ed318d62a01aa1ec24ec79a7439586eb5e","2010-05-24 21:47:06+00:00","SCI: renaming MacIconBar to GfxMacIconBar

svn-id: r49202
"
"58a7dbe7214c64ce77920e7e63dd9be445ebd805","2010-05-24 21:51:45+00:00","SCI: forgot one rename in r49202 - MSVC, why?

svn-id: r49203
"
"ab540af9f815183fb3bb087e0a7dcab9e62cd847","2010-05-25 02:35:50+00:00","Fix a regression with rewinding in QuickTime videos (looping works in Riven again) and some minor cleanup.

svn-id: r49206
"
"3c629571b2212c3efca52e3fa8d742e368ba9352","2010-05-25 03:35:08+00:00","removed .deps, modified properties, reverted TODO

svn-id: r49207
"
"4a8841202a25d48df190d9479bda98026f9c14d5","2010-05-25 03:46:28+00:00","Implement *scpbtn and *_domecheck. The domes can now be opened/closed (not using the sliders).

svn-id: r49208
"
"a83aafab545cbfdf47e5f724a856d1cbbb7914d0","2010-05-25 10:46:56+00:00","Changed the font system to allow for multiple fonts to be loaded simultaneously

svn-id: r49209
"
"7bbbaf7d8cc382dd3c6dfc6dcaacf9c902523525","2010-05-25 11:35:16+00:00","Patch #3006178: 'rjp1: calculate sample length correctly'

Fixes bug #3001110: 'FOTAQ Amiga: crashes reporting assertion failure'
Added a NEWS entry to the patch.

svn-id: r49210
"
"961a64a9f834a833e9ec7c060e8f81dddd91a3a3","2010-05-25 11:54:18+00:00","Bugfix to allow timed text to display in the correct colours

svn-id: r49211
"
"5317b8195d252942f084e3120809ab496411e963","2010-05-25 12:04:32+00:00","SCI: sci1.1 changed priority to 15, when adding to picture - fixes title in island of dr. brain intro

svn-id: r49212
"
"2502038e73e19dd5cf819834369fffa6e86caa7d","2010-05-25 12:53:35+00:00","SCI: sci1.1 uses hardcoded white for picture cel data instead of the value specified in header - fixes pixel glitches in island of dr. brain title, sq4 title and qfg3 room during intro

svn-id: r49213
"
"849cfe4f0e5793caf648cb8fb030698c88c622f5","2010-05-25 15:38:30+00:00","SCI: dont lock mutex in pauseAll(), isn't needed anyway - fixes deadlock in sq4

svn-id: r49214
"
"5f3952e5787079d8acd3476d3b7f0d67116b5d94","2010-05-25 18:11:14+00:00","Fix a Myst regression: not a good idea to use memset on a Common::String :)

svn-id: r49215
"
"aa8c6377a5cb8c51717f6bcf1ffc950c6c837021","2010-05-25 18:45:25+00:00","SCI: error out on pattern opcodes inside vector data when drawing pictures in sci1.1+, also adding workaround for garbage data inside picture 381 in sq4

svn-id: r49216
"
"71436c5a8643710a1dac3a489af03e5ca2729261","2010-05-25 18:48:50+00:00","SCI: adding comment about error() on pattern opcodes sci1.1+

svn-id: r49217
"
"b8df22646b6be2a3d0c10e1df2a6122f9a0d0e26","2010-05-25 20:47:48+00:00","Patch #2959341: Minor update to SCUMM debugger command 'passcode'

svn-id: r49221
"
"cd5e90f298098fa44299bcf054fffeada9da2996","2010-05-26 03:43:21+00:00","Implement QuickTime playback for SCI1.1 Mac. The 'Halfdome' and 'KQ6Movie' videos now play. However, they require multiple edit list support to look completely correct.

svn-id: r49224
"
"2c6ea824ec6fcccc1bef48fac479ce0d47569520","2010-05-26 06:44:07+00:00","Reverted commit #49107 - it is pointless to keep silencing this warning (which is, in fact, correct)

svn-id: r49225
"
"ad9772fac6dcd3d462053bb80ebe54a012990a24","2010-05-26 06:45:57+00:00","Properly fixed MSVC warning C4121 (alignment of a member was sensitive to packing)

svn-id: r49226
"
"60dd3106885b9784af15cb96122d28a5f0bf33f1","2010-05-26 06:53:08+00:00","Cleanup

svn-id: r49227
"
"1c0bbb10cbb20b8dd0bdc1cb748bb5ec9e538b42","2010-05-26 08:27:24+00:00","More work on controlling access to members of the Object class:
- Moved the code for initializing the object class, species and base object inside the Object class
- Made propertyOffsetToId() a method of the Object class
- Made relocateObject() a method of the Object class
- The Object getVariable() method now returns a reference to the requested variable

Only SegManager::reconstructScripts() is left needing direct access to the members of the Object class

svn-id: r49228
"
"eca8c35cfc6b183800abb1d34c06e787c1b18477","2010-05-26 08:32:32+00:00","Gave proper names to each flag in the message flag set

svn-id: r49229
"
"1818fa137f491ba8898d83afde86f2d98c857415","2010-05-26 09:33:33+00:00","Silence a warning inside send_selector(): argc > 0 means 'write selector'. Added code do make sure that argc is always either 0 or 1 when referencing variable selectors (this isn't strictly necessary, but better safe than sorry...). Some cleanup

svn-id: r49230
"
"9a66bfb575ff536d1a110a43c238b944fe2ea9c7","2010-05-26 09:59:40+00:00","After running some tests, it appears that modifying argc inside send_selector() was a bad idea. Reverting the relevant code, and putting the warning back, with some extra comments

svn-id: r49231
"
"1bee6daff006970b0f1e7186d43c05540a2bb316","2010-05-26 10:35:54+00:00","Added more info to the warning thrown when argc > 1 while modifying a variable selector in send_selector()

svn-id: r49232
"
"65fa2f5af836b10554485555959adebc15bde240","2010-05-26 10:37:54+00:00","Formatting

svn-id: r49233
"
"3187149cca9ab48a391e09c7af6430c2187cd4c6","2010-05-26 11:02:50+00:00","Avoid adding a null char in the sierraId Common::String

svn-id: r49234
"
"14fae8db03e5a314ec19277ef497fbaae03d6177","2010-05-26 11:56:58+00:00","Proper fix for the MSVC warning concerning packing: reordered the members of the ParseTable struct and removed the struct packing pragmas

svn-id: r49235
"
"f2dda51943c0a34315babb8241c1f12fe3f5d658","2010-05-26 12:15:14+00:00","Have makeADPCMStream use the entire stream if the size is 0 (as it says in the doxygen comment).

svn-id: r49236
"
"163847b24572ff5425f5ab4256ab1349c9840a74","2010-05-26 13:11:04+00:00","Fix the 'boiling water' videos in the boiler puzzle.

svn-id: r49237
"
"1a01caece762dd06886460830c4cdaf7de42c8d8","2010-05-26 13:24:32+00:00","SCI: adding another hack to sci32 picture drawing, fixes crash in sci32 games introduced by r49216

svn-id: r49238
"
"2f4f70f3b02f49dc65ec2ba74adf29fbbcbd7323","2010-05-26 13:26:52+00:00","Patch #2951677: Text boxes should init with the caret at the beginning

svn-id: r49239
"
"d502bdf982410dfc0e5731fa9a83f543f08bd744","2010-05-26 13:27:11+00:00","Add safeguards when no engines with engine-data are included. Inspired by patch #2986300

svn-id: r49240
"
"bfaba64c6a3aee6875bf135147c2f29a621c876b","2010-05-26 14:25:51+00:00","Made find_unique_script_block() a member of the Script class

svn-id: r49241
"
"af8a82aa13f2a316f6a9b4fd857230cbf87c6b1c","2010-05-26 14:31:51+00:00","Fixed compilation

svn-id: r49242
"
"8b54efd8a62a68a0544dfc5438c4efe42c0f79f1","2010-05-26 14:43:25+00:00","PSP: implemented basic file cache. Turns out the PSP reads 1 byte as fast as it reads 1 KB.

svn-id: r49243
"
"7b8837cda7b3c44d5e283ef8bb9ebe6e943ebb27","2010-05-26 15:41:50+00:00","SCI: Simplify appending string 'seeker' to sierraId

svn-id: r49244
"
"017507ffa6a774ea1df4d74b8431155540f76244","2010-05-26 15:42:26+00:00","Take any 'moov' resource from a resource fork, not just 0x80; minor cleanup.

svn-id: r49245
"
"0197e9f6a19738054a4b847e3217cd3794ef3ce3","2010-05-26 16:30:10+00:00","SCI: Making various object and script related things const

svn-id: r49246
"
"2fa8ac0575e45ddfee96e3cd1eba2f2d9c3d2db3","2010-05-26 17:15:49+00:00","SCI: adding another workaround for picture 376 in sq4/cd (same issue like originally found in r49216)

svn-id: r49247
"
"db475d1501452490ab4e95ecbd181380b0bec414","2010-05-26 18:11:17+00:00","SCI: More const related changes; remove unnecessary casts which hide const issues

svn-id: r49248
"
"947edd08c3b60ec873fcc6c922ef4ebb34ba2305","2010-05-26 19:54:50+00:00","Replace SCUMM F5 dialog by GMM & add help button to GMM

The new 'Help' button in the GMM is currently only used by SCUMM.
To use it, an engine currently needs to subclass MainMenuDialog.

svn-id: r49249
"
"d35121fc6144eb9fc9e06d60d5c8cf49f5c1b181","2010-05-26 20:48:08+00:00","SCI: fixing kReadNumber to behave like in sierra sci (non standard atoi implementation) - fixes big door not unlocking in sq4

svn-id: r49250
"
"2c2a1fa1ba9c4da4f955f341a8710b9cb40ede7e","2010-05-26 22:05:51+00:00","Made _k_new_node() a method of the segment manager, and fixed a bug with the rarely used SCI0 kernel function kSort in the process (_k_new_node was called with key, value instead of value, key inside kSort)

svn-id: r49251
"
"7f678907d7067d3747d69e4564f64e6c1d5adc24","2010-05-27 02:15:11+00:00","Add some null checking when pausing/resuming videos.

svn-id: r49254
"
"99fc5cbfca3403b07ab023c857b7b997cc9389b4","2010-05-27 03:15:24+00:00","Add the Mac sync resource type and allow for more than 9 Mac SCI1.1+ data files.

svn-id: r49255
"
"f7ba7b4684c86546151928cf5de669af04d237c1","2010-05-27 06:11:50+00:00","PSP: fixed issue with handling of EOS. Caused crashes.

svn-id: r49257
"
"5f53683cab48becc1d790132cc46ff29a1a3ae26","2010-05-27 06:21:37+00:00","PSP: fixed a screen shake bug

svn-id: r49258
"
"739f551852b428115f2cd2bca4f7a0a1054b79a8","2010-05-27 07:50:23+00:00","Slight formatting, and added a note that audio36 and sync36 resource patches were introduced in SCI2, and didn't exist in SCI0-SCI1.1

svn-id: r49259
"
"e5eaf3ee5578367cc74c3155a68a904e6ce77b9b","2010-05-27 08:09:32+00:00","Split all of the audio-related functions of the resource manager in a separate file

svn-id: r49260
"
"cfed70df07781327effb6c5eb3d87b29ef0f34da","2010-05-27 11:26:37+00:00","SCI: fixing resuming samples - fixes hang when ship is flying away happening when you entered menu during that sequence

svn-id: r49261
"
"5f5dcbad47c3f120541c59a141e84bb8aed5184d","2010-05-27 12:00:20+00:00","Added an explanation for audio36 and sync36 external patches

svn-id: r49262
"
"453d13dc2d2bec3a4d7cc4395bf98bd2103c5ff8","2010-05-27 17:41:20+00:00","SCI: fixing -propDict- selector on instances to contain -propDict- of the corresponding class - fixes sq4cd/room 381 talk-clicking on robot - thx to waltervn & wjp

svn-id: r49263
"
"845c34ee4561b54389437009e449a16b4fb872d4","2010-05-27 17:43:06+00:00","SCI: removing tab from vo output (debug console)

svn-id: r49264
"
"a32b7b38518dd662304a2645bfe4288b18522183","2010-05-27 17:47:32+00:00","Fix starting GK1.

svn-id: r49265
"
"a03b5a3434a274447deaa9963ca6df87ee213059","2010-05-27 19:34:12+00:00","GUI: Reduce code duplication in about dialog

svn-id: r49266
"
"b99d65e561d1940c5644b6c9d4e27af1c0a56923","2010-05-27 19:34:41+00:00","Fix for bug #3007656: 'GMM: Crash in 320x200'

svn-id: r49267
"
"4ba291d4b18271f6e313e3a207e668dc6599aab9","2010-05-27 20:29:39+00:00","GUI: Fix about dialog regression from my previous commit

svn-id: r49268
"
"d2513c9cc25c29a2e32882e0617dfc5d5854a6c2","2010-05-27 20:53:37+00:00","SCI: enabling fading again, issues in pharkas and gk1demo are actually 'normal' - maybe we should add some hack workaround, but the delay in ssci was just slow resource loading

svn-id: r49269
"
"bbaf98127d95f60740ab9db304be2b9854fda9ec","2010-05-27 20:59:15+00:00","correct typo

svn-id: r49270
"
"7029b059bfa4bcff3b4be07af407f5c2cadb410b","2010-05-27 21:20:07+00:00","SCI: disabling music fading again, but only for sci32 - drivers seem to have issues when fading in on gk1/sierra logo

svn-id: r49271
"
"b0366e65e593c2b4fa6b5999a5558508d80883f7","2010-05-27 23:57:44+00:00","Cleanup AVI a bit, add support for stereo audio

svn-id: r49279
"
"dad3ad86eac7954f0e5e1932b628c68d22e890a8","2010-05-28 09:29:05+00:00","SCI: read out vol selector on initSound/playSound for sci1early (soundversion) as well - fixes lsl1demo

svn-id: r49285
"
"145eacd491ce54c8c33d80dda2ec3ec3416a3f87","2010-05-28 10:17:16+00:00","Implemented needed methods for scrolling surfaces horizontally or vertically

svn-id: r49286
"
"bea6ef4beb9ff55a848a76c2b33e32a9b3d9cdd9","2010-05-28 10:20:02+00:00","Clarified variable usage for sequence list entry indexes

svn-id: r49287
"
"967d9ea308342cbfb3c99904b5d6f1a0a3cd7ba0","2010-05-28 10:45:20+00:00","Added a stub for kMergePoly, to avoid crashing in QFG1VGA after killing a monster

svn-id: r49288
"
"e694b66e4f8cb3bc60f8084c94aaccdc5405eab8","2010-05-28 10:52:22+00:00","Added comments to kMergePoly()

svn-id: r49289
"
"d9c0abe0b827a5c1fe15528ba3430fcbf2bdf71b","2010-05-28 10:53:03+00:00","Cleanup

svn-id: r49290
"
"b2e4e4b3409b1b8061890f921c80375096dc097e","2010-05-28 12:36:47+00:00","Cleaned up detectGfxFunctionsType() slightly, and made it work for Hoyle 1 and 2 properly.

svn-id: r49292
"
"5b12fda0596b8b05768cc073b681d61c1493cf8e","2010-05-28 12:37:54+00:00","Added some more info when severe script errors occur

svn-id: r49293
"
"5d21ff280a30347362701ee177ab54f85e18e712","2010-05-28 16:47:30+00:00","Silenced some superfluous warnings in KQ5CD

svn-id: r49294
"
"1c32db1e084698f6594a66e142c217e83cab60d9","2010-05-29 08:09:47+00:00","Removed some unused variables, found by cppcheck.

svn-id: r49306
"
"928eafcccf755859a86587e01b676d020baf4d85","2010-05-29 08:14:50+00:00","Fixed potential memory leak found by cppcheck. Though I'm guessing that if this
case happens, we may have bigger problems...

svn-id: r49307
"
"6f056c6c98e6c32c1e18a731ca6296b9ee4b130a","2010-05-29 14:03:08+00:00","Added a method to the resource manager, to limit the places where script exports are accessed, since for SCI11 and newer exports can be functions and objects (first step in removing scriptRelocateExportsSci11(), which is a gross hack and it fails in QFG1VGA)

svn-id: r49308
"
"708b37898c17ca520e8b3ae92a2e458665c7bd81","2010-05-29 15:01:33+00:00","Fixed regression in SCI2-SCI21 games from commit 49308

svn-id: r49309
"
"3d09af03773d353e73b61197befa63031e99d096","2010-05-29 15:27:27+00:00","Removed the hack inside findGameObject(), and replaced it with code from the segment manager, till we find out why the segment is sometimes off by 1 (note that findGameObject() works fine for finding the game ID itself)

svn-id: r49310
"
"a6156a680583bfd3876bcd1c6d5e550763d0a677","2010-05-29 15:29:27+00:00","Removed the scriptRelocateExportsSci11() hack. The open spell in QFG1VGA works now (thanks to waltervn for all his help on this)

svn-id: r49311
"
"d3bcb10861b7716ed59ecc53efcaabad1f14e246","2010-05-29 15:47:28+00:00","Cleanup

svn-id: r49312
"
"989c1fddddbe63075a9d4b9860476a080711164c","2010-05-29 20:30:54+00:00","DS: Various fixes to allow the DS port to compile on DevkitARM r30 and libnds 1.4.3.

svn-id: r49313
"
"5143e7fff42de358021c1a150d2bd7495374ba49","2010-05-29 20:32:25+00:00","Fix typo(?) which prevents streaming code from compiling.

svn-id: r49314
"
"42d6ed880b92e19c469c70da92397bd860abb483","2010-05-29 21:42:42+00:00","SCI: Make Script::_exportTable const (yay :-)

svn-id: r49315
"
"4ecacdad164d95154ac8a645058c2de0e2be73a9","2010-05-29 23:09:00+00:00","SCI: Merge Script::relocateBlock and Object::relocate

The shared code now resides in a new static function named
relocateBlock, which is invoked by the two methods.

svn-id: r49316
"
"67de5b1bd33d55a21bc2728cedfee25c321b4e36","2010-05-29 23:37:15+00:00","Mass renaming of selector-related functions, and removed some defines which were just cloaking functions with a different name
- GET_SEL32 -> readSelector
- GET_SEL32V -> readSelectorValue
- PUT_SEL32 -> writeSelector
- PUT_SEL32V -> writeSelectorValue
Also, changed some selector-related function names and variables to CamelCase

svn-id: r49317
"
"5f2ff0b1e7147a5638e66bbd1362196b5419c330","2010-05-29 23:56:37+00:00","Limit access to the _classTable array (now it's directly accessible only inside saveLoadWithSerializer()

svn-id: r49318
"
"6884ffc2918d192c9b091d4836f8c566ef3a7fcb","2010-05-30 09:47:00+00:00","PSP: added preliminary support for using ME hardware to play MP3 files. If the decoder fails to load, MAD is used instead. Disable with DISABLE_PSP_MP3.

svn-id: r49319
"
"dbe561c59b61f40459ed2b4602457308e0426269","2010-05-30 10:27:39+00:00","Clarify reasoning behind hack in Script::scriptRelocate()

svn-id: r49320
"
"d0c79d21e969b0881fb9dfc1d7b204fa74ff2721","2010-05-30 12:44:59+00:00","Fix file length of zip file members inside ZipArchive (thanks to fuzzie for reporting).

svn-id: r49321
"
"0e9156c7c4d481a0f43b232207dd6065779e9765","2010-05-30 13:10:23+00:00","Add a (currently) failing test for reference logic in Common::String. (Taken from an example by fuzzie)

svn-id: r49322
"
"f02e31f2fca7299695e006f0a0bffbebe115d8e9","2010-05-30 13:10:44+00:00","Fix non-const version of Common::String::begin.

Common::String::begin now assures the storage is a unique one, i.e. there are
no other Common::String objects pointing at it. This allows for safe use of
the writable iterators (and thus fixes the test case added with my last commit)

svn-id: r49323
"
"9521f8d0085f7159bf61770ef13e7f949c0a3fd0","2010-05-30 13:41:40+00:00","Typo fixes.

svn-id: r49324
"
"ff3f0f5d65ec72e7a8e189089e59e8b818beddb7","2010-05-30 13:42:04+00:00","Split test cases for internal and external storage.

svn-id: r49325
"
"0276ec835ef3c77a4dbf772ea54cc6d5292452f2","2010-05-30 15:17:29+00:00","Fixed findGameObject() for SCI11 games

svn-id: r49326
"
"c32e88fe0bb61e75ca983072ba28102d4efbf123","2010-05-30 16:14:31+00:00","Limit access to the _bufSize, _scriptSize and _heapSize members of the Script class

svn-id: r49327
"
"5cdb13b3e8a160e7eae14c03644ad3be5a38b415","2010-05-30 16:38:08+00:00","Made load_script() a member of the Script class

svn-id: r49328
"
"29c2f30558e9c40d5c1a76ab600611b21ee72851","2010-05-30 17:02:21+00:00","Unified the script loading code, and marked an issue with the SCI11 heap addresses

svn-id: r49329
"
"016862ac3a4928529d9eaedf6edf3e916c89155c","2010-05-30 18:45:07+00:00","Moved setScriptSize() inside Script::init(), and removed a FIXME - the SCI1.1 word-align is done inside Script::init()

svn-id: r49330
"
"9c2da78ba9a99145241025974c42219a673dd2a8","2010-05-30 20:01:25+00:00","kScriptID can be used to load scripts with no exports. Don't throw warnings in this case if no export is requested, as it's perfectly normal behavior

svn-id: r49331
"
"dc4d61f7181edf332d426bab9d16e0055e3d0f21","2010-05-30 20:06:50+00:00","- Merged the SCI0 scriptRelocate() and SCI11 heapRelocate() functions inside relocate(). scriptRelocate checked one more relocation entry, which seems wrong, so we're now checking for the correct number of relocations in all SCI versions
- Re-added the error when script + heap exceed 64KB (better than an assert) - this should theoretically never happen, and it never has for the games tested
- Removed the relocated sanity check - again, it shouldn't occur (else something else is wrong)

svn-id: r49332
"
"1fd3877ec7778535174cdfaef50810d619630fbb","2010-05-30 20:18:42+00:00","Cleanup

svn-id: r49333
"
"3b96e4833e0035ce5d54efbdd1badeaca858f5ae","2010-05-30 20:30:07+00:00","Cleanup

svn-id: r49334
"
"e13abd77e92a4c363731f4a6775aa26865bb4ad6","2010-05-30 21:44:26+00:00","Add md5's for Myst ME and Riven DVD French.

svn-id: r49335
"
"a0ee93ece52213cd989a50902281d917fe392ea4","2010-05-30 21:49:07+00:00","SCI: Script exports and synonyms are now initialized when a script is loaded. Removed a sanity check inside script_instantiate_sci0 for a bug which no longer exists

svn-id: r49336
"
"4e25867a671a8847b167decba1ed1e95cf699e66","2010-05-30 23:00:32+00:00","SCI: Merge setLockers(1) call into Script::init

svn-id: r49337
"
"50cd1d1da4a934cfcdcf7cb0b05bed6f7d9735c2","2010-05-30 23:31:33+00:00","Limited access to the script export table and synonyms block

svn-id: r49338
"
"693618d89a56ccc943f9f0608abf8737d5002d32","2010-05-31 00:04:38+00:00","Slight cleanup

svn-id: r49339
"
"2a0f91444f3d42068a7aa6e1b6a6ac57ce0a0574","2010-05-31 01:27:57+00:00","Ignore v2 compressed audio chunks instead of treating them as Huffman DPCM. Should fix playback of at least the video portion of those videos (found in later Broken Sword releases).

svn-id: r49340
"
"a8a8ea31df50d8c6078cb95a949e84a58314d5b9","2010-05-31 04:58:19+00:00","the basic testbed skeleton, removed any trace of quux

svn-id: r49341
"
"05357d0f2aa7695981f5df706787bcd741e32c93","2010-05-31 07:34:18+00:00","Cleanup

svn-id: r49342
"
"66d4bddb30498419cebf0478a83b77ca3abb8131","2010-05-31 08:11:49+00:00","Merged several script instantiation-related functions inside script_instantiate()

svn-id: r49343
"
"7001d3e6157dc9fe601a5f0e2195a367755a344b","2010-05-31 09:21:15+00:00","SCI: when getting invalid chars in kReadNumber don't error() out, but create a warning - we get invalid chars in the intro of lsl5, cause currently unknown

svn-id: r49344
"
"9d50dac101b0d545b23397eef83f34b75a382303","2010-05-31 09:31:05+00:00","SCI: skip spaces in kReadNumber - this happens in lsl3 intro

svn-id: r49345
"
"3f4302214c334a590b8428fe7ae32c76e64b6ed5","2010-05-31 11:25:59+00:00","The save/load object init code is now unified with the regular object init code

svn-id: r49346
"
"088e6456ea4d009b8ab0c91176c84dce34a8ea41","2010-05-31 12:10:30+00:00","In progress work implementing the animation player

svn-id: r49347
"
"a963917e89f0f4d404872473c99fd998938984b2","2010-05-31 12:11:42+00:00","SCI: added TODO at kReadNumber space code

svn-id: r49348
"
"cc025ace18b2bd47e81d4ec1ac46aa9abb566c16","2010-05-31 12:13:50+00:00","The code that loads saved game from the launcher
can now load SCI2 saved games. Added an explanation
why the injected call is necessary

svn-id: r49349
"
"ff40247376606412556e4cc39b4da3361842dd3c","2010-05-31 12:27:13+00:00","Hopefully fixed compilation

svn-id: r49350
"
"ba11596572c32c3282f03c643dc23f6050210a08","2010-05-31 12:36:42+00:00","SCI: Silenced warning when no audio decoder is compiled in

svn-id: r49351
"
"2bebba8c947ed6862a915d074804fc819ffd1472","2010-05-31 12:38:15+00:00","Fix warning, whitespace

svn-id: r49352
"
"b5a2e3c758361e19518f934f99a69056319f5de4","2010-05-31 12:43:28+00:00","Fixed operator precedence warning

svn-id: r49353
"
"753fdd6c123e3be04057ad4e4e35a95a3c39a2b7","2010-05-31 13:52:07+00:00","SCI: break on anything, warn on anything but spaces in kReadNumber

svn-id: r49355
"
"d1da820a75a3a8f921c0b7cd1ae26bf6f7cb6729","2010-05-31 15:16:46+00:00","Fix for DW2 engine abort with message 'Cannot find file hienergy.sc!'.

Bug introduced by r49086 change which could trim the last character of filenames.

svn-id: r49356
"
"5bb4fadc4c85e14b5881fb3849ea32233dba91ed","2010-05-31 18:05:39+00:00","Fix change in r49356, Common::strlcpy should only be used on zero terminated source strings.

The original code change with r49086 did only aimed at zero terminating
the szFilename string (as the comment suggests), so I now changed it
to use memcpy and a manual placement of the terminating zero.

svn-id: r49357
"
"6c44df455ecbdd1a5793cbf2c3670491cc18bbd8","2010-05-31 18:22:29+00:00","Add OS2 specific files to repository

svn-id: r49358
"
"443c0d4f935ce908caf79bdc94183ad5214dc7c1","2010-05-31 18:28:26+00:00","DS: Use gScummVMVersion in dsmain.cpp; merge 1.1.1 changes in readme_ds.txt

svn-id: r49359
"
"de2e935b2c6ca2091e37068772931da1ec51ceb3","2010-05-31 18:31:37+00:00","Wrote the initialization code for the exports and synonyms table to make more sense and fixed a bug with the initialization of the synonyms pointer, introduced with rev #49336

svn-id: r49360
"
"844ef9ba1a08de70058cfa8014f55a801b7c77aa","2010-05-31 18:35:13+00:00","Merged all the script relocation code inside script_instantiate(), and changed the warning when reading an invalid species into an error (as it's severe, and if it happens it means something is seriously wrong)

svn-id: r49361
"
"2138fe0d5afbcb8566c90e8338a5c2896282772f","2010-05-31 21:29:43+00:00","Fix our interpretation of the audio compression types to what FFmpeg currently does. Should fix bug #3009282.

svn-id: r49362
"
"c9a38abf605197c4641b74fcef06d44d8d87b2d7","2010-05-31 22:41:46+00:00","modifications to get the ps2 to use the ps2loader

svn-id: r49363
"
"25fb93465df5903bf4b03f47b10b69def667ef26","2010-05-31 22:57:05+00:00","Added a new console command, verify_scripts, used for sanity checking of SCI1.1-SCI2.1 game scripts

svn-id: r49364
"
"9d72dde5e7d3e92e7e870350c0b24bf556e425f6","2010-05-31 22:58:22+00:00","Fix trunk compilation (don't try to compile non-existing files)

svn-id: r49365
"
"400542a1fe688bb702a89333c833bc1d89dd1ed4","2010-05-31 23:04:30+00:00","Revert the rest of 49362, which wasn't meant for trunk

svn-id: r49366
"
"e083c20da1aab0090a5fc3ea624c9810c63dad52","2010-06-01 14:41:48+00:00","The system strings segment is a fixed segment of the segment manager, which doesn't change during the game, thus move all the system strings code and variables inside the segment manager

svn-id: r49372
"
"9c92bd1b810621bdaa779bd3354b10ad048c7924","2010-06-01 15:11:20+00:00","The parser vocabulary remains static throughout the game, thus it has been removed from the engine state

svn-id: r49373
"
"caf1a6bee4bb60014290a2208ec0daa0c68496cd","2010-06-01 15:38:09+00:00","Remove dead code from PS2 and GP2x backends

svn-id: r49374
"
"1f54cdf90d5d14c4acee4cd2a358585b43abb188","2010-06-01 15:38:34+00:00","SCI: Fix malloc<->new mismatch in SysStrings, try to increase readability

svn-id: r49375
"
"65f3cfcbd816fe05437298cd46621d9f058aaea3","2010-06-01 15:48:17+00:00","Stop reconstructing the engine state when restoring, but reset it instead

svn-id: r49376
"
"42b22d16f6f4f8defc3bc276343b3066c8603877","2010-06-01 17:01:22+00:00","Fix videos in Riven activated from a different card from which they are played; minor cleanup.

svn-id: r49377
"
"4cb3a2b41b5f92fda50f6db15e4e69be7dd0129a","2010-06-01 17:03:43+00:00","This hopefully fixes the compilation of the GP2x backend.

svn-id: r49378
"
"da1f5ee54c91cab0e8a7bf1523a7c8318ee63d1d","2010-06-01 18:06:31+00:00","created the basic testsuite class, will use it to create the GFX testsuite in graphics.h

svn-id: r49379
"
"95001e3676c98b5d13dee3340efcc20e6f4d9f77","2010-06-01 20:37:55+00:00","Add support for SCI2.1 resource patches to the fallback detector

svn-id: r49380
"
"a6efbf8880d56680e5503bcf1f68fdf2c9ef9156","2010-06-01 22:06:52+00:00","Fixed the detection of SCI2.1 games in the fallback detector

svn-id: r49382
"
"93867d567fd76f909bfbb64f8300d6841af584e2","2010-06-01 22:28:24+00:00","Inline palettes in SDL backend into class OSystem_SDL

svn-id: r49383
"
"9f14e43d16a45c37b041ed2e3041fd8e7690121d","2010-06-01 22:29:55+00:00","Fix bug #2999153: 'IPHONE: No grabPalette() implementation'

svn-id: r49384
"
"24673b9ee91f6d80ae1b32f239fbe25489c519a0","2010-06-02 00:20:52+00:00","Fix warning

svn-id: r49386
"
"c4c63223cc45ce192f8b03f27fff56fcdf56a502","2010-06-02 00:25:11+00:00","IPHONE: Disable RTTI and C++ exceptions

svn-id: r49387
"
"767edc91faebdc1a60e5c8b3764b169dc9807ea5","2010-06-02 00:52:57+00:00","OSYSTEM: Get rid of kFeatureAutoComputeDirtyRects

svn-id: r49388
"
"4493080220a98d596ee578bddc8a64c0d3955eac","2010-06-02 02:55:55+00:00","If we can't find the game object or game ID in fallback detection, break out instead of assuming the script is there. Fixes a segfault when detecting an LSCI game.

svn-id: r49389
"
"5df3809d371c1d37d03dfd51689a58420cc337a6","2010-06-02 04:45:44+00:00","enhanced the basic testsuite class

svn-id: r49390
"
"af3fec8c26d92005b507dca65d1d50f820feb0e7","2010-06-02 13:17:36+00:00","- Fixed findGameObject() to properly handle SCI0-SCI1 games where the first block of script 0 isn't the exports block
- Changed many places where Common::File is used directly to use Common::SeekableReadStream instead (in order to ultimately remove the SCI_detection hack in the fallback detector)

svn-id: r49391
"
"91a8d25cea4eb44e55ac5e966b21c89bd044bc49","2010-06-02 13:56:04+00:00","completed the basic testsuite class

svn-id: r49392
"
"a8deacfc7eaf6b845d93b7a3f7343b55ee7ec097","2010-06-02 15:26:35+00:00","In Riven, if we get a change card opcode on a mouse down event, ignore the next mouse up event so we don't misinterpret that as an event in the next card; minor cleanup.

svn-id: r49393
"
"c4bdca72d7fcd837e51a449ff68a1d93977a0d18","2010-06-02 15:31:20+00:00","Fixed regression from commit #49332 (merging of the SCI0 and SCI11 relocate functions, where the SCI0 equivalent had a +1 count): it seems that we should skip over zero exports, however the total number of valid exports remains the same. Fixes KQ5 and QFG2. This also fixes the relocation calculation of script 71 in SQ3, so remove the comment that the script has broken relocation entries

svn-id: r49394
"
"14a4d8f8b06abb095cf6c9db718b4e26c266e78b","2010-06-02 17:04:55+00:00","Fix a regression from r49377 - we should be checking against code in addition to index for duplicate MLST's.

svn-id: r49395
"
"0d0abbc91a5fb0559e891a6f1f528a8c0dfa0b2f","2010-06-03 03:11:19+00:00","Updated xcode project

svn-id: r49402
"
"90649938d2d70115967c45cdd1cbb8dab1635794","2010-06-03 03:22:10+00:00","We'll now default to non-touchpad mode on the iPad

svn-id: r49403
"
"fababbe205395b6b8c812b458df3af65e3f5e01c","2010-06-03 03:55:08+00:00","able to display rectangle on screen using grabPalette() and copyRectToScreen, will use it to test palettes and autocomputeDirtyRects features

svn-id: r49404
"
"86dcc28342021933f04ff3542932fc8823ff2360","2010-06-03 09:34:32+00:00","Moved the MADS interface view into mads_scene.cpp and did a major cleanup of scene loading code

svn-id: r49405
"
"86b452d36cb781c24e1b167dd6cef768b7c6286b","2010-06-03 10:16:21+00:00","Moved several object-related defines inside vm.h into segment.h, where the Object class resides. Also, removed several unused defines

svn-id: r49406
"
"f1af6bad6db5714a8a2f4664b080d5d45c0810d1","2010-06-03 10:26:51+00:00","Fixed compilation

svn-id: r49407
"
"2ae4c5796b44f6ab6ecf68425e096dde50cb9f95","2010-06-03 10:44:50+00:00","The setCursor selector is no longer used for the detection of the kSetCursor() kernel function semantics

svn-id: r49408
"
"26860b8e5170d9da92b5da82325c137fddfd8778","2010-06-03 10:46:55+00:00","Properly implemented the logic for loading the correct interface background as specified in a scene's resources

svn-id: r49409
"
"7f0b0a83edfee3b139dea783293282e05898f070","2010-06-03 20:42:06+00:00","Fixed crashing with wave file patches, a regression from commit #49391

svn-id: r49411
"
"038ac90482863d60567e64c11ed138d79000fe28","2010-06-03 21:13:08+00:00","Renamed some variables to silence GCC warnings.

svn-id: r49412
"
"576306c323d092b590e184ececb70745633aae4e","2010-06-03 21:52:21+00:00","Re-enabled the cursor position limiting code

svn-id: r49413
"
"1973bd5a71fc2847b123e0f1d769220210eceba4","2010-06-03 21:57:49+00:00","Added channel remapping to MidiParser_SCI (currently unused)

svn-id: r49414
"
"ddf7449b00d15c5419c667f9df553053e8dc0cec","2010-06-03 22:00:50+00:00","Added code to get which channels are used by a sound. Also, fixed a crash when using Sierra's GM patches, a regression from commit #49391.

svn-id: r49415
"
"8dd7537a55add13179520ec751641baac47373c7","2010-06-03 22:13:23+00:00","A first attempt at channel remapping (currently disabled)

svn-id: r49416
"
"02ed1a684ae54b1ae3124aa3064889164e33ed69","2010-06-03 23:07:53+00:00","- Made some methods const
- Prefer const_iterator over iterator in SciMusic::findUsedChannels

svn-id: r49417
"
"664c86f25d5476089194650fe3d6509c5c4d7c2f","2010-06-03 23:37:05+00:00","Replace two uses of ::qsort by Common::sort.

svn-id: r49418
"
"333989fc6d6a254f0383407de6d69be6c8ca994c","2010-06-04 03:54:17+00:00","some code on getting strings printed on the screen

svn-id: r49421
"
"f1a55a9c67886209e69900159c7917dfedc1d79f","2010-06-04 10:15:13+00:00","SCI: Cleanup

svn-id: r49423
"
"a8acf7468c8f795355bb85962052eb8c02e2a4de","2010-06-04 10:36:49+00:00","SCI: Add savegame version check in CheckSaveGame

svn-id: r49424
"
"997fdac4271aac6a345bbdd0782d55d48ed0b400","2010-06-04 10:51:27+00:00","SCI: Replace strncpy with Common::strlcpy

svn-id: r49425
"
"86462c66a04fd208716f072d4ba0028a04bf9ad8","2010-06-04 11:28:30+00:00","Added code and support routines for destroying animations correctly, which also necessitated changing the sprite list code

svn-id: r49426
"
"3d98f679e72b5dcf16d4c85a286bdaf5a35c95a6","2010-06-04 12:51:06+00:00","Bugfix for the loading of the animation frame list

svn-id: r49427
"
"9906030312842ae3f3537824c36697c2f5eb60bf","2010-06-04 13:48:09+00:00","Ensure that zones/animations always get the same index number.

When a zone/animation is skipped by the parser because already
loaded, the index is now increased. This does not affect NS, since
indexes are only used for scene sorting there, but is relevant for
BRA, where indexes need to be coherent across location changes.

Patch #3004008 by fuzzie.

svn-id: r49428
"
"fdc9bbcbf5cee1b5e0cca6838ff30b0133b882fa","2010-06-04 14:53:12+00:00","Simplified the channel monitoring code inside the SoundResource class

svn-id: r49429
"
"722c4f1b8dd9a25e94e48ea1368e786250de7a5c","2010-06-04 15:01:26+00:00","Some more work on channel remapping: Moved the remapping code to the music loading code (still disabled)

svn-id: r49430
"
"8b102ab7afae80d57bbbd03d2cd4a9bea09c9115","2010-06-04 20:06:59+00:00","SCI: Fix for Valgrind Warning in Palette.

svn-id: r49433
"
"3a5fe4ca002a85f7c4549c8d36203553553c53f9","2010-06-04 22:53:26+00:00","Bugfix for wrong parameter order in scene resources load method call. Also added fragment to destroy an active animation when it's finished animating

svn-id: r49434
"
"5686c251f09fa25432d5db8195ac1df2fcda88fb","2010-06-05 01:55:17+00:00","Added missing animation initialisation code

svn-id: r49436
"
"b9065aa2d23d87c5da887ebe1f685230a4693827","2010-06-05 04:18:23+00:00","Various bugfixes to the animation code - first Rex animation now plays, albeit in the wrong place

svn-id: r49437
"
"e9f35fbf4ce36b2a7cbdada429c5e7a2d49cbab8","2010-06-05 14:09:52+00:00","Rewrote the remaining parts of the ResourceManager class to work with file streams, thus removing the SCI_detection hack in the fallback detector

svn-id: r49438
"
"c00d645506d60aea320a72cea2c5b9cb5368891c","2010-06-05 18:15:41+00:00","Fixed the cursor limiting code in GK1

svn-id: r49440
"
"6a796c2bb0b2a6d46546a97c24320bdceae2c69d","2010-06-05 18:24:28+00:00","GP2X Wiz: Update handy shell scripts.

svn-id: r49441
"
"7b56f39985a62852478ccb8ad01a85e9f028097c","2010-06-05 18:26:53+00:00","GP2X Wiz: Add missing '#include 'graphics/scaler/aspect.h''.

svn-id: r49442
"
"abcd8e093a52745a5925993c74abfe901234df3a","2010-06-05 19:55:03+00:00","Replaced a leftover Common::File::exists() call in the fallback detector

svn-id: r49443
"
"193d7df5940ada9c2ec7e3a233c2b26aa3b25e84","2010-06-06 00:27:56+00:00","Correction for SCI valgrind uninit memory error in MIDI sound which occurs during LSL6 intro.

This may be 'hiding' a bug in the use of sound/midiparser.cpp in SCI i.e. incorrect use of parseNextEvent(), so this should be reviewed, but this patch initialises _next_event at object construction, which corrects this, should not break anything else and is good practice.

svn-id: r49445
"
"c253a57e471be34567c2a28f8ccb4f6e084d7e20","2010-06-06 01:12:41+00:00","Bugfix for #2974817 - Mad Drongo Animation Malfunction

svn-id: r49447
"
"3efec5720de2c46355c323763dee96b719ed5aa1","2010-06-06 06:46:29+00:00","Bugfixes for correct positioning of opening animation

svn-id: r49448
"
"46155b2c3678784f6333eed1d65a35eefdcb2001","2010-06-06 09:34:36+00:00","Add Android backend from patch #2603856

svn-id: r49449
"
"b90ca013a814fd1023254543217c554382a3bd67","2010-06-06 12:37:43+00:00","PSP: added news item about switch to media engine for MP3 playback

svn-id: r49450
"
"43c353d9308515e0ce4d73773e50810f9e89ae47","2010-06-06 13:04:24+00:00","Now opening all files via getVolumeFile()

svn-id: r49451
"
"8e6cc1201a43dbba52daa528c07622f02d121c3d","2010-06-06 13:31:19+00:00","use palette image during sequence 3 scrolling

svn-id: r49452
"
"4667907b5cf9da3336352053b16b84484adf0393","2010-06-06 13:35:08+00:00","whitespace corrections

svn-id: r49453
"
"48cfc944216c863ea59160a54739799af21d1768","2010-06-06 13:36:55+00:00","Add Gus to credits, update README & NEWS

svn-id: r49454
"
"536e6a9bc308153f36d3eaf509bc0e66bcefc5e7","2010-06-06 13:40:15+00:00","fix sequence frame numbering (decrement if getCurFrame now returns the last decoded frame number)

svn-id: r49455
"
"1819c8b23b0beac173ed61f777a3656879d020d1","2010-06-06 14:06:51+00:00","polished the interface to interact with testsuites, added code to report test results

svn-id: r49456
"
"857f3ab550e015f9560bafa6bf080619216140fa","2010-06-06 14:17:37+00:00","PSP: faster way of getting file size

svn-id: r49457
"
"548015ac10c89da839343b12274123898c113df1","2010-06-06 14:18:16+00:00","add missing decodeNextAnimationFrame in default case for sequence 9

svn-id: r49458
"
"e00e94ae18aeb1ed460476f822e20b5bdfe171a4","2010-06-06 16:55:29+00:00","some minor modifications in function args,use of inline specifier

svn-id: r49461
"
"51a897845532cc1fe587352726051e5f420d5d68","2010-06-06 22:44:14+00:00","Throw a warning in kString(At) if the index is out-of-bounds instead of having it assert out.

svn-id: r49464
"
"3c82b6578fa3bd4b3d91c1933dd390581dbe08d1","2010-06-06 23:00:33+00:00","Now that EngineState is not deleted when loading games, we can move some more state-related variables to it, and remove several FIXME's about non-const global variables. Also, the entries in the data stack are now deleted when loading (fixes a memory leak - thanks to digitall for this).

svn-id: r49465
"
"1e56ea9ac9ec21490d2ee626d4c49cdf6794e2b0","2010-06-07 01:43:35+00:00","Change some kString subops to use the raw string directly instead of through a Common::String. Fixes usage with strings from kGetSaveFiles().

svn-id: r49468
"
"b04535d487dd292b16768b036a0b24fc6965ed36","2010-06-07 02:11:01+00:00","SCI: Adjust kGetSaveFiles for SCI32.

svn-id: r49469
"
"d30d57b923ddad194071d3fc07d79385c1ce4a37","2010-06-07 02:11:19+00:00","SCI: Relax signature of kCreateTextBitmap.

svn-id: r49470
"
"1572524b645b9a40e097a99773cb40e7f954100c","2010-06-07 09:06:06+00:00","Moved destruction of globals and resource manager to common M4 engine base class - this fixes a bug where resources were still being tossed after the resource manager was destroyed

svn-id: r49476
"
"43ec405ffe08cef3168c9618be6169e6d81290f8","2010-06-07 09:10:22+00:00","Some initial code for audio36 and sync36 patch support

svn-id: r49477
"
"34f7c05e4dd0e7cd3f84576f57593d034f666d31","2010-06-07 09:19:42+00:00","Initial conversion of the AnimviewView class to use the expanded MadsAnimation class, rather than the older AAFile skeleton class

svn-id: r49478
"
"b2678ddf52117773bf08bed260a6512464e286aa","2010-06-07 09:35:59+00:00","Changed a create call to setSize to fix compiler error

svn-id: r49479
"
"62402e743ece682c19f986ab25c9941686262ef7","2010-06-07 10:17:44+00:00","Added extra positioning and dummy depths surface so that the introduction cutscene now starts up

svn-id: r49480
"
"d5b5a8dbaeac596d02ad6063a61f566c6c092de0","2010-06-07 11:44:52+00:00","Allow for the other audio36 patch naming schemes (Mac and some Torin ones).

svn-id: r49482
"
"8ef5d55edb5b463abca1adf0ed1f359ce94bd391","2010-06-07 13:47:14+00:00","Fix gcc warning about an comparison which is always false due to data type range.

svn-id: r49484
"
"356728dab7f2c4cedf73684d7fe3b968be7396fd","2010-06-07 13:47:27+00:00","PSP: found bug in fast getMillis() implementation. Fixed it by adding a fixed amount to the time counter.

svn-id: r49485
"
"2c950b321c3354144debd6a7f5e7d19cbc6c3a32","2010-06-07 15:14:58+00:00","Fixed regression from commit #49465 - there are in fact two restAdjust variables, the current and global one

svn-id: r49486
"
"0e95d8a5faee7f674665067505635a9d31cc174b","2010-06-07 17:14:42+00:00","Groovie:
- Rewritten T7G's font code to subclass Graphics::Font and make it cleaner.
- Use theme fonts for the Mac version of T7G (which used ugly system fonts
originally). With this the Mac version should be completable.
- Cleanup include interdependencies.

svn-id: r49487
"
"354499c7372956ff045c39c5b85456340e26526c","2010-06-07 17:17:41+00:00","Fix some typos in a comment

svn-id: r49488
"
"9255d7c3cb38093f060266d7cbd137792cea811e","2010-06-07 17:18:25+00:00","Remove some extra spaces

svn-id: r49489
"
"b0cb5e7b7e67ad3d87594041f6ea172c3650e888","2010-06-07 17:27:22+00:00","Document the Groovie engine news and reorder in order to match the previous releases.

svn-id: r49490
"
"419b4b7348038a64f9e9c405e69022035c4c832c","2010-06-07 17:44:17+00:00","Added support for SCI2+ base36 encoded patches (audio36 and sync36)

svn-id: r49491
"
"ae599e63c26b315215c47666094ed844e36cddb2","2010-06-07 21:33:55+00:00","SCI: fix regression from #49484, we were ignoring 65535 patches and this broke kq6 - the check was previously for -1 and this case wasn't able to happen at all, maybe it was left-over code from freesci somehow

svn-id: r49494
"
"ea2e2053f25c216342c74bb7a74dabc682766720","2010-06-07 21:55:57+00:00","SCI: slight cleanup on processPatch, etc.

svn-id: r49495
"
"f743468ec7174088dffde0fd1a61d3afcf78280b","2010-06-08 09:36:27+00:00","SCI: if song isn't playing, set signal and don't set fadeout/fadein variables - fixes lsl3 music lost after entering/exiting tv room (bug #3007406)

svn-id: r49500
"
"707ccdbac78510a5861d9460d1503e25f6634947","2010-06-08 13:15:05+00:00","Add a version check for base36 encoded patches - they were introduced in SCI2

svn-id: r49501
"
"fb73cef4d9d481f616576a2779b53ea6c8c48b18","2010-06-08 13:15:15+00:00","Add a few files mistakenly left out of initial Android patch :(

svn-id: r49502
"
"5ba761a687d9b908f09b218cc22aec548d98c3f6","2010-06-08 13:16:30+00:00","Made reconstruct_stack() a member of SegManager

svn-id: r49503
"
"33c2e03ccc30fb5c7464319081bf5599858f6fd1","2010-06-08 13:18:25+00:00","Remove unnecessary explicit _endian=little for Android

svn-id: r49504
"
"ec524e3705970a725c9dd1008fff97ccd7f1d250","2010-06-08 13:23:08+00:00","Remove obsolete ANDROID_VERSION_GE macro

svn-id: r49505
"
"d72ae64e3447ca01e308e61c320692463596fb0b","2010-06-08 13:25:00+00:00","Provide a replacement for bionic's __assert().
The usual Android version doesn't actually print the assert message
before aborting.

svn-id: r49506
"
"f6b02e9986ae8965034ffd1d2e0b895e7f115deb","2010-06-08 13:27:46+00:00","Whitespace fixup in last submit.  I'll get the hang of this eventually :/

svn-id: r49507
"
"8a3837ff3ab1b5b64efe196c9cc3e75434ec1e8a","2010-06-08 13:38:47+00:00","Add png icon files that were too binary to be part of original Android patch.

svn-id: r49508
"
"12ca735cebcad417e995566e446142ffd41e6323","2010-06-08 15:08:45+00:00","SCI: use base36 sync/audio patches for sci1.1 as well and also check if patch filenames make sense, otherwise skip them - also remove hack for excluding bootdisk.* and aud*.drv

svn-id: r49509
"
"207a5e0779de9f0002b0b1984bde90ce6597e1f2","2010-06-08 17:24:29+00:00","updated my outdate copy of trunk, added couple of more tests in gfxtests

svn-id: r49510
"
"3d0ac2a676bd726a1f390b83812f8f5ac7a52d4a","2010-06-08 18:23:38+00:00","Merged sync_SegManagerPtr() inside EngineState::saveLoadWithSerializer()

svn-id: r49512
"
"67690e89a37a27ff34ab515c934edbce887fa897","2010-06-08 18:44:27+00:00","Merged _game_run() inside game_run(). Some cleanup

svn-id: r49513
"
"73010518b22c8c24cf09b07bbd6c17655aa1d331","2010-06-08 19:36:33+00:00","Fixed compilation when the SCI32 code is disabled

svn-id: r49514
"
"52cf6e4caa04f996bc7f4f78a464564db39de480","2010-06-08 20:24:54+00:00","added working test for palettized cursors, tests mouse events as well

svn-id: r49516
"
"641ffa5ee3b8036c1a03fc557d0f9705c824eb3e","2010-06-08 20:29:33+00:00","Modification to remove false positive 'Possible divide by zero' warnings given by cppcheck-1.43.

These are incorrect as '/' operator has precedence over >>, but this does improve readability anyway.

This bug in cppcheck has already been corrected: http://sourceforge.net/apps/trac/cppcheck/ticket/1714

svn-id: r49517
"
"9304b5fbeb4cb3d181d96be6da34073fc5851939","2010-06-08 21:05:46+00:00","Merged the restarting_flags, script_abort_flag, and restoring members of the EngineState class into one variable, abortScriptProcessing. The flag kept to signify a game restart has been placed in a boolean, gameWasRestarted

svn-id: r49518
"
"6474eaa1b293b24db51d2a14ef345c7c853a26e1","2010-06-08 21:15:53+00:00","SCI: check for SOL header in audio36 patches

svn-id: r49520
"
"eafc63e57266d690b177bf34fa593e37d8cf320f","2010-06-08 21:21:19+00:00","Cleanup

svn-id: r49521
"
"dc8b826f5ea77a0173c5ad64d6508f9ec7ed798a","2010-06-08 22:00:59+00:00","SCI: set default palette after initializing music driver, fixes palette getting messed up when using mt32 emulation

svn-id: r49523
"
"81907a8e6fdefbb173d596763e5ba9d9eacd4363","2010-06-08 23:29:35+00:00","Don't shrink the stack after reconstructing it, when loading a saved game. Fixes game restoring in some games (e.g. LSL3), a regression from commit #49376

svn-id: r49525
"
"b494d46fdde717bf877c1422026038c3c9fed5f4","2010-06-08 23:29:48+00:00","chmod +x mkmanifest.pl

svn-id: r49526
"
"10aeb33a4253b5df05f19a9bfabc3cc374db096c","2010-06-09 07:32:17+00:00","Merged restAdjust and restAdjustCur, as we don't save the restAdjust modifier inside saved games (rightfully so). Also, the segment manager is now reset inside the main loop, when the game is restarted, not in game_exit()

svn-id: r49533
"
"5cb311ee2c352372e8eb494933e2bc36ffd5c4f5","2010-06-09 07:59:42+00:00","Renamed the SciEvent class to EventManager, to separate it from the sciEvent structure, and removed it from the engine state

svn-id: r49534
"
"95b080f60b74fe9b83d71abc9a80038f025845c6","2010-06-09 08:49:37+00:00","Fix compile errors

svn-id: r49535
"
"536b2614e8bd7c3c6e47e686a90596460c5448d1","2010-06-09 09:17:48+00:00","Globals from script 0 are now initialized in script_init_engine(), and are accessed from the relevant variables pointer. Removed direct reference to script 0 from the engine state

svn-id: r49536
"
"2c629a04dd502ff130127072e69724b2eec29c68","2010-06-09 10:45:54+00:00","Merged script_init_engine() and game_init() and cleaned up SciEngine::run() a bit

svn-id: r49537
"
"0f2e6b0f856afdfb540b681a194d001d051029f5","2010-06-09 13:27:59+00:00","SCI: fix multiple playing of the same sound in a row (without using looping) - thx to LordHoto for helping me finding this one out - fixes pharkas right at the start (hammering only played once)

svn-id: r49538
"
"5b2a60d0495c76c32e358e8a2dff6c82f7ddd710","2010-06-09 13:34:15+00:00","Rewind the underlying audio stream on LoopingAudioStream creation.

Also mention in the documentation that both LoopingAudioStream and
SubLoopingAudioStream do rewind the underlying in their constructor.

svn-id: r49539
"
"015262a0ee77abcbd49d9ab40909daa77d303a81","2010-06-09 14:06:16+00:00","Fixed compilation when the old sound code is used

svn-id: r49540
"
"f770156dccff6ed5f1211cbe7676652897582ee9","2010-06-09 14:15:51+00:00","PSP: fixed missing frame issue with kyrandia and possibly other games by calling updateScreen() from pollEvent() once in a while

svn-id: r49541
"
"32d7f7ddb09c908104dc83217aa08f6083189d17","2010-06-09 14:16:00+00:00","Disabled the mouse warping code, as it can be annoying in windowed mode

svn-id: r49542
"
"3c9ab81a0764298baf1b604914a7c2e3f33f6b1a","2010-06-09 15:21:10+00:00","Fixed regression from commit #49537

svn-id: r49543
"
"a542ce174b68e32a9266c8efaea7be877b74fccc","2010-06-09 15:28:14+00:00","Proper fix for kernel name loading (regression from commit #49537)

svn-id: r49544
"
"d191c9d0f935d280d7c1a7e71e3e13bbb76ee893","2010-06-09 17:04:03+00:00","Limit kPortrait to be used in the Windows version of KQ6 only

svn-id: r49545
"
"c486b77bb7d96908d7df1e00b6a61b92fbd176ee","2010-06-09 18:42:21+00:00","Fixed crash in SCI2.1 games

svn-id: r49546
"
"5d71ae952f47084da758cb5d2df0e53a6c663111","2010-06-09 20:12:25+00:00","The EngineState is no longer recreated when a game is restored, thus we don't need to refresh pointers to it

svn-id: r49549
"
"e533289e07f9bbbc195d91619582df6eca39ec2a","2010-06-09 20:32:55+00:00","SCI: document raw lipsync data skipping in readAudioMapSCI11()

svn-id: r49550
"
"d8050029f9940ec7abe0a3868f17e55319bad9c3","2010-06-09 21:30:06+00:00","Improve build instructions to include themeengine patch and
scummmodern.zip compression.

svn-id: r49551
"
"d44efa817fd997f336ac83f0490212fb21e9bf02","2010-06-09 21:31:48+00:00","Fix dirty tracking in paletted textures.

svn-id: r49552
"
"14437e6394172dcabd0f5255b724c38f5b862332","2010-06-09 21:41:20+00:00","The segment manager is now initialized before the graphics subsystem. Fixes the detection of the fastCast object on startup, and hence fixes LSL1VGA

svn-id: r49553
"
"ede57eb61b541c9487d2068f01fb28be2e984f5f","2010-06-10 04:29:34+00:00","Removed some unnecessary whitespace. (Or should I have saved that for the
rapidly approaching, much coveted r50000? :-)

svn-id: r49558
"
"9b8e4e8359083ba322c19701579762104b7a6826","2010-06-10 07:32:05+00:00","Moved all of the game init/run/exit logic inside the SciEngine class

svn-id: r49559
"
"abc5f97608952d4d1f43c736ecd31f23d0aecb8c","2010-06-10 07:41:48+00:00","Fixed compilation with the old music code

svn-id: r49560
"
"50c1f4e545dde784341eebf6eb8cd6d3ce0751b7","2010-06-10 07:48:32+00:00","Moved the MoveCountType enum above the GameFeatures class, as it's the only class using it

svn-id: r49561
"
"0ab7c908bb3971a74bb1c8848d6f59f161464ad1","2010-06-10 08:11:38+00:00","Removed the pointer to the game object from the EngineState class

svn-id: r49562
"
"eb4ec596cdb8e541d5221263b3db185bd01b206f","2010-06-10 09:18:57+00:00","Use the SELECTOR() macro for readability

svn-id: r49563
"
"cc6f5eb3e42bb4f7af47a70802a236fdbffc7b74","2010-06-10 09:22:30+00:00","Unified invokeSelector() and invokeSelectorArgv(), and removed the INV_SEL kludge. Also, removed the selectorInvocation parameter - if invokeSelector() fails, the error is in most cases unrecoverable, and the error description thrown covers all cases where kContinueOnInvalidSelector was used. This uncovered a bug too: in some places, non reg_t parameters were parsed

svn-id: r49564
"
"8a5762c52db029386135ed7dd83f69fe5d34509c","2010-06-10 10:15:32+00:00","SCI: set picport when loading saved games

svn-id: r49565
"
"4d8734284701153f10e9a2691d9b3cf5fd51e069","2010-06-10 10:20:25+00:00","Added extra code and support methods for properly clearing up backgrounds and used sprites when an animation sequence ends

svn-id: r49566
"
"a635b948239fbbd1ce302fb9d5eac943e90ca7ee","2010-06-10 10:27:13+00:00","Pic port saving/loading is only used in SCI0-SCI11

svn-id: r49567
"
"93f33c7dab009e8ff82fac195e7b6d02e66ab755","2010-06-10 11:18:10+00:00","Resolved a FIXME with getSciLanguage(), by creating a separate setter. Also, some camelCase changes

svn-id: r49568
"
"944b511633e793f149e787b3f9cd1502b14d9993","2010-06-10 11:35:15+00:00","Fixed regression from commit #49564

svn-id: r49569
"
"711f679b7ffa9b51c2d6a07dab0a1dd7799f155d","2010-06-10 11:43:20+00:00","camelCase changes

svn-id: r49570
"
"1032b69f51444fb48e9ba9313180e009513fa33e","2010-06-10 12:40:58+00:00","some minor changes in the testsuite structure, reduced no. of files per testsuite, fixed some formatting

svn-id: r49571
"
"c8ee854600710f36f09d8375fbe51e1924d97320","2010-06-10 13:41:29+00:00","PSP: switched to psp semaphores rather than SDL's. Removal of SDL is almost complete.

svn-id: r49572
"
"afa2af5dfb0214c4aeeb2f21ef43dca5e3886181","2010-06-10 13:43:38+00:00","SCI: cleanup

svn-id: r49573
"
"d89da56f471735b50a5eafbf9ee9eeb0c190f4eb","2010-06-10 14:01:30+00:00","PSP: swapped order of checks in renderAll. It's a little cheaper this way.

svn-id: r49574
"
"5330e632de917d603a6d246d53f4ed4e5bdf51ec","2010-06-10 14:02:20+00:00","Don't attempt to modify the printLang selector if it doesn't exist

svn-id: r49575
"
"6ad04a4a96b0290125e33535f84a98e4d79dff2c","2010-06-10 15:06:25+00:00","Add support for AIFF sound in SCI32 Mac games and add support for AIFF/WAVE audio36 patches; minor cleanup.

svn-id: r49576
"
"8295eb09cd7f0a62359631ab4b1975b2b6364bf3","2010-06-10 15:25:18+00:00","SCI: Fix Console::cmdValueType to handle all possible reg types

svn-id: r49577
"
"874151f5d12d86557dbea3bde180dbba0dfd4a2c","2010-06-10 15:25:36+00:00","SCI: Cleanup kernel signature code a bit.

* Moved KSIG_SPEC_* from kernel.h to kernel.cpp
* Clarified the comment on KSIG_SPEC_* a bit
* Changed the other KSIG_ #defines into an enum
* Removed KSIG_TERMINATOR and KSIG_SPEC_ARITMETIC (sic)

svn-id: r49578
"
"5424d8aecb0d2c078aa8e18e94a2ac104d4bf039","2010-06-10 15:25:54+00:00","SCI: Get rid of DEFUN, cleanup

svn-id: r49579
"
"4b0f0894c4fbd864c7d75dd04134f4b59af448a6","2010-06-10 15:26:10+00:00","SCI: Switch Console::cmdSelector to use Kernel::getSelectorName

svn-id: r49580
"
"85b0ec3408ca46251835f9e3db8f2e96cafe60ac","2010-06-10 15:26:26+00:00","SCI: Fix some doxygen comments

svn-id: r49581
"
"8f55c4ddb4ceb64e6121ee9fe08b07c2905d4748","2010-06-10 18:16:05+00:00","Allow for digits in stage directions in SCI32 games: GK1 floppy uses them.

svn-id: r49582
"
"9f907aac095123ac016a23a559f54ada35af6772","2010-06-10 20:26:59+00:00","kSciAudioWPlay should not actually play the song, but 'pre-load' it. We fake the pre-loading with a flag that will return 0 if the song has been called with kSciAudioWPlay. Fixes the dream sequence sound in MUMG.

svn-id: r49583
"
"f470e1d96ed152751dc57418b7659559bc43217b","2010-06-10 20:52:04+00:00","SCI: adding current delta to tick position when getting the setsignalloop command - fixes sq3 music slight delay before actual looping

svn-id: r49585
"
"5baa47a9cbd42b2b40b599928ea6bf41f47fdc18","2010-06-10 23:16:32+00:00","In SCI1.1, kSetSynonyms is a dummy (empty) function

svn-id: r49586
"
"377cfe6fefe6a817a6ce778e7721dc3818780c01","2010-06-11 07:47:57+00:00","Added a new kernel function, kEmpty, for really empty (not dummy, i.e. unimplemented) functions

svn-id: r49591
"
"3269e5cc4ca2ea04f862767595720ad2044cfd09","2010-06-11 09:17:11+00:00","SCI: adjust priority bottom, if its 200 to avoid possible out of bounds (sierra actually does the same)

svn-id: r49592
"
"b9ea841b8afd346c8737a14816db2144d68457f1","2010-06-11 10:44:32+00:00","added code for ellipse drawing (Aspect ratio correction), fixed some more formatting

svn-id: r49593
"
"580c9032f02123ba1f46a49c098dbf34f0b2f3c1","2010-06-11 10:54:49+00:00","Add support for setFocusRectangle - enabled on 'small' Android screens.

svn-id: r49594
"
"ef34896dce9188591e8ddd6e8eed543febd70b87","2010-06-11 11:03:51+00:00","Clarified various incorrectly named parameters, and fixed code for loading the correct art file backgrounds when running animation sequences

svn-id: r49595
"
"e572267a05674b4b462602781be58f813c84479d","2010-06-11 11:08:37+00:00","Bugfixes to correctly scroll the background during animations

svn-id: r49596
"
"a08d06ad353996ee9bf495a84988f3a91cacf51a","2010-06-11 14:47:13+00:00","- Added a new debug command, verify_midi, which can be used to check all the songs of a game for unmapped instruments (still WIP and disabled)
- Fixed a bug in the verify_scripts command (it was loading the script resource twice)

svn-id: r49597
"
"a8af267651c054bb45a0b5da77ea71b7100474ad","2010-06-11 19:49:41+00:00","Renamed verify_midi to show_instruments (and fixed a bug with it at the same time). This command scans all songs, or a specific song of a game and displays the instruments used

svn-id: r49599
"
"b97d7adc3b43c648e56738fc6e43736a74248961","2010-06-12 09:29:28+00:00","Extended show_instruments to show the songs where each instrument is used in

svn-id: r49603
"
"277a700e6743b481eba8efb86fe37c339d880279","2010-06-12 11:32:28+00:00","Reimplemented the scaled sprite drawing logic. The first introduction sequence scene now displays correctly

svn-id: r49604
"
"f4739f9f68026d5e3ea3304777260cef3101a031","2010-06-12 11:41:22+00:00","Added debug output to kDoAudio and some music commands. Also added a warning when an audio stream can't be created. Finally, the debug level of the MIDI parser debug output has been raised to 4, as it's too verbose

svn-id: r49605
"
"6fa4d1ba805237cd44f6c64cf1088988c5d652f8","2010-06-12 11:43:30+00:00","Initialize compression-related variables when loading external patch files. Fixes Cassima's speech in the intro of KQ6 (the engine thought that the external patch files of her speech were compressed)

svn-id: r49606
"
"0492bd6aa65fa931bb84bb994f9e9e9757acc90a","2010-06-12 18:20:22+00:00","SAGA: Music code cleanup. The music driver is now placed inside the MusicPlayer class, instead of the SagaEngine class. Split the functionality that the music parser should handle from the functionality that the music driver should handle. Also, fixed a bug in MusicDriver::send() (the notes off signal was sent to unallocated channels, not allocated ones)

svn-id: r49607
"
"2625c9b20be6ed4bef0fd8da600729a7316d7ac4","2010-06-12 23:53:26+00:00","Applied fix for checking unallocated channels for All Notes Off MIDI command

svn-id: r49613
"
"0659d5f2448cbea343d294146ba20f656f759f42","2010-06-13 06:55:24+00:00","Improved debug output of BRA walk code.

svn-id: r49618
"
"3cacd7bc4372dbaae5c454236b4413ab87955347","2010-06-13 06:55:40+00:00","Keep the balloon from getting stuck in an infinite loop when floating near the borders of the screen.
See the detailed explanation in walk.cpp.

svn-id: r49619
"
"d16eb491b17e662705e80d14c1f2ebe5f4e38cef","2010-06-13 06:55:58+00:00","Support for vertical scrolling. Patch 3005933 by fuzzie.

svn-id: r49620
"
"94cdfefe1c9c32b3497d8d1564d4e5e0940dc403","2010-06-13 06:56:13+00:00","Fixed clipping when drawing sprites at small scale factors (this fixes the balloon scene).

svn-id: r49621
"
"eff1d4bb1c2e1a33946c7333c3d28f38dfdcb5e8","2010-06-13 07:17:44+00:00","Added a default constructor for the ResourceSource struct

svn-id: r49622
"
"d1993773880143d234f3355dd5a03f778e35b78c","2010-06-13 07:35:48+00:00","When closing inventory, do not force input back to game-mode if commands need otherwise.

svn-id: r49623
"
"12b591ed4619330adc430f61193cc1caaca702bd","2010-06-13 07:49:36+00:00","improved aspect ratio correction and cursor tests, added test for iconifying and testing mouse movements

svn-id: r49624
"
"0bd7bf32cac760c59e2a7a140b8ee46a795465ce","2010-06-13 07:55:50+00:00","removed obsolete comments

svn-id: r49625
"
"02ed880180a83a46ec72f69879df565f42c840db","2010-06-13 08:53:06+00:00","Added logic for handling the rate of animation background scrolling, and miscellaneous extra fields

svn-id: r49627
"
"466479eb77dfd04c7116f97f93e2f8013442307b","2010-06-13 09:07:15+00:00","Added a parser for kZoneNone zones/animations in BRA.

The only thing it does is parsing a possible command list, which is enough to support the script bug in 'scende2'. See ticket #3005384.

svn-id: r49628
"
"4c6d276ce914cafc170732fb7203145c8a763b37","2010-06-13 10:50:54+00:00","Bugfixes for correct moving of the screen viewport within an animation

svn-id: r49629
"
"3c511eab1a3c9e3be7125a6159265e0f5e25beed","2010-06-13 19:19:06+00:00","added code for testing shake, focus, overlay, scaling, need to fix more some of these although

svn-id: r49634
"
"a4ac9347d4bbac0ee8bef8786c9e23831ad60636","2010-06-13 21:43:13+00:00","Fixed regression from commit #49251, and added an explanation. Calls to kNewNode with 1 parameter are handled properly again. Fixes the demo of Phantasmagoria 1. Thanks to lskovlun and waltervn for spotting this

svn-id: r49638
"
"01d53a62165d229b88db11647ffe40ff2502d7b4","2010-06-13 22:01:10+00:00","Disabled two cases of findObjectByName() in SCI0 early games

svn-id: r49639
"
"b5ebd40d614ab7b1c2f1408750c09f528b7ae2de","2010-06-13 22:15:30+00:00","The offset of script local variables is now calculated when the script is loaded, thus we no longer need to save it. Merged scriptInitialiseLocals() with scriptInitialiseLocalsZero()

svn-id: r49640
"
"d36f6638c0fd6e5aeaf8d8ac8665d5d2d8a2575f","2010-06-13 22:48:49+00:00","Fixed compilation with the old music code

svn-id: r49641
"
"ae0a7a667504b3356f2355aadfa6add722749ca6","2010-06-14 03:15:58+00:00","Added logic for animation sequences specifying a starting animation frame number

svn-id: r49642
"
"466a151744618f89d6a0b53d23189af048d88831","2010-06-14 04:20:57+00:00","Fixes for memory leaks reported by Valgrind

svn-id: r49643
"
"6fb462e6b05c5ead3fefe97e18d31f4835d5e321","2010-06-14 05:27:54+00:00","Further memory leak fixes reported by Valgrind

svn-id: r49644
"
"889013b54623930f49e834010fd394e774dd9dd7","2010-06-14 05:39:10+00:00","some minor change as per CFC

svn-id: r49645
"
"58487da20bf0115cfdefc2769c831c64b22d524c","2010-06-14 06:33:24+00:00","Moved the actionNouns array from the scene to the globals object, since the scene will no longer be active during animation sequences

svn-id: r49646
"
"cfdbfaa28eb29cb17185d3d3d1ddde8c89a369c1","2010-06-14 08:36:52+00:00","SCI: Limit the screen refresh rate to 60fps

svn-id: r49647
"
"b921cebce882de6d32ed3fd62de16ee215daa467","2010-06-14 09:33:36+00:00","GP2XWiz: Add shellscripts to support building a non-stripped bundle for use with GDB.

* This should help Tony (GSoC) get debug builds going.

svn-id: r49648
"
"cd77cb96fc85ba2f681337630c4374ce0565927f","2010-06-14 12:44:57+00:00","Some cleanup of the script locals code

svn-id: r49649
"
"2a78b8279930212337c446948cc9a2943d685c94","2010-06-14 13:13:02+00:00","Fixed a bug with commit #49640

svn-id: r49650
"
"5230930d9577726d6f64fa8ffa73690314fd0a56","2010-06-14 13:41:06+00:00","Silenced warning

svn-id: r49651
"
"4f3bb60cd59f7b24a4c1d29de7ba790d262b16ee","2010-06-14 13:53:15+00:00","Really silence the warning with _bufSize

svn-id: r49652
"
"4d517ed0e9870ef75b7b0c3eeda9659563d3ace9","2010-06-14 14:50:23+00:00","Extended advancedDetector with depth parameter.

Now AD can search nested directories. By default it is turned off,
but there is new parameter to ADParameters struct. Usually value
of 2 is good enough for all purposes.

svn-id: r49653
"
"d59c312b0890d4ad9b97c4cc0280e00fac69d725","2010-06-14 14:50:53+00:00","Mohawk: Added support for running Riven off DVD layout.

Uses new directory depth feature of AdvancedDetector.
Set directory depth to 2 and added Assets1/ directory.
As a result, DVD layout which does not have any game data
file in top level directory gets detected and runs well.

svn-id: r49654
"
"e281f2599a8ad608b61be3a7129f951223cad9f6","2010-06-14 14:51:18+00:00","Implement safeguard for negative depth values in AdvancedDetector.

svn-id: r49655
"
"ca161920a4dcf26a6d8773dec5d95141b0383df2","2010-06-14 14:51:46+00:00","SCUMM: Fix bug #1438631.

Bug #1438631: 'SCUMM: Detecting mac version of indy3/loom broken'
fixed by implementing recursive directory lookup similar to what
was done for AdvancedDetector, since SCUMM engine does not use it.

svn-id: r49656
"
"6916e547a3cd3330bfc5da7df3fe2c74e64eae76","2010-06-14 14:52:13+00:00","AGOS: Fix bug #1777795.

Bug #1777795: 'SIMON1: Acorn CD MD5s' fixed by specifying directory
depth for AdvancedDetector to 2.

svn-id: r49657
"
"1c3e96ac122dd82b4dbd253c169f50013429e157","2010-06-14 14:52:49+00:00","Split out Mohawk detection tables into separate file.

svn-id: r49658
"
"95f55f3b05f2bb3074afba81ee1e1b2c02735203","2010-06-14 15:49:11+00:00","Hopefully fixed kOnMe (SCI2) and implemented kIsOnMe (SCI2.1). GK1 and the demo of Phantasmagoria 1 should now be responding to mouse clicks and movement correctly

svn-id: r49659
"
"b04269e7e4ebaf36e654f0604602dd64dee48211","2010-06-14 16:04:28+00:00","Fixed GK1 again, including the inventory screen

svn-id: r49660
"
"60eced7a81c37d3db7c5fffee2d34463f8313e9d","2010-06-14 16:57:43+00:00","Cleanup

svn-id: r49662
"
"303c7b0a8dd0fb120f1fa1ec0abb03b27912e8a5","2010-06-14 16:58:15+00:00","Ignore and remove invalid plane and item objects in kFrameout. Fixes loading in-game in GK1.

svn-id: r49663
"
"86878450ee26cbf2b4f79e5e54787fe5cce2a10e","2010-06-14 19:37:19+00:00","Cleanup of the SCI0 object initialization code

svn-id: r49666
"
"af60633d6873f4071fcae95c6b5681c9b27ee6a4","2010-06-14 20:15:15+00:00","added some features suggested by jordi, needs more work although

svn-id: r49668
"
"1fde7f1abceb5f7c52982e9b2bf18188037b63d5","2010-06-14 20:45:00+00:00","Removed the code used for tracking script code block relocations in SCI0-SCI1 games, as we don't actually relocate these blocks, and it was used solely for verification of the exports table. The issue that this warning was created for should no longer occur

svn-id: r49669
"
"22e9fe8291b2f7f2111823614de4976f058ef524","2010-06-14 22:31:38+00:00","Since allNotesOff() is virtual and can be overriden, make its associated variables protected instead of private

svn-id: r49672
"
"a6a482b83cb8f924f920ac16c8a48a321e89ecc9","2010-06-14 22:35:49+00:00","SCI: Added a version of allNotesOff() which sends messages only to the channels used by the associated song instead of all channels

svn-id: r49673
"
"25c7dc08b1ca6816ef3b99bb13819469bd45c710","2010-06-15 05:34:37+00:00","PSP: fixed bug in hardware MP3 that caused crash in broken sword. The sample rate must be returned from our member variable, not from the header value which disappears.

svn-id: r49680
"
"ff66c67439ec501da5335e78e77b58943cea0972","2010-06-15 06:30:49+00:00","PSP: fixed SCI freeze issue by using recursive mutexes

svn-id: r49682
"
"e93f8902a89cb969fd344e49e7086213c8609dbf","2010-06-15 07:20:53+00:00","Cleanup of the savegame code:
- Added a saveLoadWithSerializer() method to the reg_t class
- Moved SegManager::reconstructClones() inside savegame.cpp
- Moved SoundCommandParser::syncPlayList() and SoundCommandParser::reconstructPlayList() inside savegame.cpp

svn-id: r49683
"
"60d8cc5180c4033978e1bb38e6cc26dab8a126b2","2010-06-15 07:21:52+00:00","Removed the now unused EngineState parameter of script_adjust_opcode_formats(), as well as an obsolete TODO

svn-id: r49684
"
"0dab9e0e1f39b856a0b996dfa2c3103fe0dbfe2f","2010-06-15 07:25:09+00:00","Reorganized functions a bit

svn-id: r49685
"
"9a1db3f77092f13829604701b419ffc38577388b","2010-06-15 08:21:39+00:00","Add support for SCI32 segment types to seg_table and vr debug commands

svn-id: r49686
"
"0ad3bedf9880b51e40459df4e33547bf234eeb4f","2010-06-15 08:25:51+00:00","Added a signature of the game itself inside saved games (the size of script 0, as well as the offset of the game object, which are unique for each game), to prevent users from loading saved games across different versions of the same game. In the cases where we can't load a saved game, throw a nice GUI dialog instead of a console warning

svn-id: r49687
"
"ba3c43498b12b4c5855030bea7ab9e613c55d4ac","2010-06-15 08:39:03+00:00","- Swapped the return value of gamestate_save (false = failed, true = succeeded)
- Removed some duplicate code inside Console::cmdSaveGame()

svn-id: r49688
"
"e64eb71ce86663c479bbbb94072fee94a015eecb","2010-06-15 09:11:26+00:00","Properly reconstruct the running stack when restoring (a regression from commits #49376 and #49525), some formatting

svn-id: r49689
"
"13aba8747a8293388640211233375cc4e7ecaf95","2010-06-15 10:09:42+00:00","Throttle screen updates to 60fps in some screen transition effects as well

svn-id: r49690
"
"28f6f7a3f0225406162b3dbf009ace4500f6e87c","2010-06-15 10:14:04+00:00","Split out detection tables for Cine engine

svn-id: r49691
"
"977b1561d4a13b980ab293316133c9e029b348b8","2010-06-15 10:14:38+00:00","Split out detection tables for Gob engine

svn-id: r49692
"
"560809e42c16425a80d2bddeeb8a13b49ad4f498","2010-06-15 10:15:08+00:00","Split out detection tables for AGI engine

svn-id: r49693
"
"d5c3cda8c5cc06a75b27d7fd7f735fb27e5877e3","2010-06-15 10:15:29+00:00","Moved tinsel detection tables to separate file.

svn-id: r49694
"
"d137b4610ab6c2d1577d6656bf8c193d2e4cf8a3","2010-06-15 10:15:51+00:00","Split out detection code in Kyra engine.

svn-id: r49695
"
"723cb6c0f0a638cc9d4f07c0fccf7bdf0197a6ac","2010-06-15 10:16:13+00:00","SAGA: Moved more code under ENABLE_IHNM

svn-id: r49696
"
"5d72a614ec75b875e950ecd62222bac3008945bc","2010-06-15 10:16:32+00:00","SAGA: Add more thread-related output.

svn-id: r49697
"
"7746321ed62d80c918a3687b595405e07e80e2aa","2010-06-15 10:16:53+00:00","SAGA: Fix bug #1970191.

Bug #1970191: 'IHNM: Psychic Profile problem'. Still there is a
slight artefact. When the profile has 2 pages and is skipped,
there are two fade-ins in a row. It could be checked by analysing
event queue.

svn-id: r49698
"
"d577d863ce4cee58b973e3a1cb461ad339e91c61","2010-06-15 10:17:18+00:00","CINE: Fix bug #2812694.

Bug #2812694: 'CINE: Operation Stealth german crash'. Our code
assumed that there exists only 256-color version which is not
the case for German version. Added code to store background
format. Old savegames are broken and could not be fixed.

Bumped savefile version.

svn-id: r49699
"
"c933bec975e7d8e176884312a257472a6358fea1","2010-06-15 10:17:34+00:00","Drascula: Optimized blitting code.

svn-id: r49700
"
"b78663f6fb45728fd90da0c91f5432e1389e421e","2010-06-15 10:17:51+00:00","Drascula: Added animation-related debug output.

svn-id: r49701
"
"f992721361d182223f1f551fe8bbfd030a27bd1f","2010-06-15 10:18:08+00:00","Drascula: hid room updater-related debug output to deeper level

svn-id: r49702
"
"2ccb5bb0251d801ef8b2fc15accbf7d421990afa","2010-06-15 10:18:34+00:00","Drascula: Added debug console. Implemented a (buggy) room comand.

svn-id: r49703
"
"6d4ad23b55c328fd1674b07330f85b14bfc20482","2010-06-15 10:18:51+00:00","Drascula: Fix bug #2854303.

Bug #2854303: 'DRASCULA: Glitch when using cross on vampire guard'.
Apparently during refactoring of animation-related code duplication
the conversion was incorrect. Rewrote relevant function.

svn-id: r49704
"
"9224a0bd6e560dbd6dbf3a07f136ba412e1bd316","2010-06-15 10:19:06+00:00","Hid hashed fileopening to debuglevel 8.

svn-id: r49705
"
"eac1fdc7caf115f2deacecd8438cb650b403e6c2","2010-06-15 10:19:25+00:00","Drascula: added more debug output

svn-id: r49706
"
"b743cc316e3a0af47880f98f01f1437dc5b8124d","2010-06-15 10:19:48+00:00","Drascula: Fix bug #2929931.

Bug #2929931: 'DRASCULA: Graphic Glitches'. Cursor graphics was
not loaded at needed time.

svn-id: r49707
"
"27c27c82b1f29030af468142a452dc33e87e56f4","2010-06-15 10:20:10+00:00","Drascula: add more pic-related debug output.

svn-id: r49708
"
"e8b72467e1472c42bb99c5eba84f2e9e059c1a3b","2010-06-15 10:20:26+00:00","Drascula: ease load on backend.

svn-id: r49709
"
"a9b9da5d7263c0c0cb9c1cc76a4351440d4d3a97","2010-06-15 10:20:44+00:00","Drascula: Fix bug #2826610.

Bug #2826610: 'DRASCULA: Graveyard GFX error'. Actually it was fixed
by previous commit. Added more responsiveness for this animation.

svn-id: r49710
"
"07cc483e139ac9449b2c41240aa43dbb18bab823","2010-06-15 10:21:01+00:00","Drascula: Restore cursors before automated converse responses

svn-id: r49711
"
"0796580c3e10c99af209b26537823ca4a69acd76","2010-06-15 10:21:18+00:00","Drascula: Made actors animation more smooth.

svn-id: r49712
"
"671ed4873f163bc64f59af6317791db4bbaa2824","2010-06-15 10:21:42+00:00","Drascula: Fixed bug #2826608.

Bug #2826608: 'DRASCULA: Cursor GFX error' fixed by introducing
separate buffer for cursors. This also fixes the root cause of
the problem.

svn-id: r49713
"
"1850d53793388f81b3c058ba02c314994a6e6ec9","2010-06-15 10:21:59+00:00","Drascula: Plug memory leak

svn-id: r49714
"
"f53211fbadb6c88161f8830baee476a91a0cc547","2010-06-15 10:22:19+00:00","Drascula: Move more cursor-related blits to cursorSurface.

svn-id: r49715
"
"e4d77cf098e9e9bdefce9ab13e7808ca89226c74","2010-06-15 10:22:39+00:00","Drascula: Add responsiveness while talking.

svn-id: r49716
"
"ba25faaf421bbe28403ede0fcf15015b7eb4729e","2010-06-15 10:22:56+00:00","Drascula: more responsiveness.

svn-id: r49717
"
"02a76b2e91a0993d551ad799ebe2f98ed0f9e98b","2010-06-15 10:23:17+00:00","Drascula: add even more responsiveness

svn-id: r49718
"
"e71caf8600bfdfeccd1cf817401daf457ce17a94","2010-06-15 10:23:36+00:00","Drascula: Fix bug #2827169.

Bug #2827169: 'DRASCULA: gfx glitch in pendulum room' fixed by
rearranging draw sequence.

svn-id: r49719
"
"08c5d37da495538e5a4b634ec5a705ec305a97bc","2010-06-15 10:23:58+00:00","Drascula: Fix bug #2827166.

Bug #2827166: 'DRASCULA: Repeating conversations'. It looked like
bug in original engine.

svn-id: r49720
"
"508256a71e3a194043f1c5e65699613ba2b441db","2010-06-15 10:24:19+00:00","Drascula: Fix bug #2011470.

Bug #2011470: 'DRASCULA: slowdown when you hold mouse buttons' fixed
by changing right mouse semantic. Now the items menu showed on
button up instead mouse down like earlier.

svn-id: r49721
"
"2e20a48f907c61352a1ae69573830dd346a1bc61","2010-06-15 10:24:38+00:00","Drascula: improve responsivity during pauses and palette updates.

svn-id: r49722
"
"6d2c916c34d875d540f2a06b112b2e2fba5f2473","2010-06-15 10:24:55+00:00","SAGA: Add debug output for sfLockUser()

svn-id: r49723
"
"0b8f8d7a249b5077e8866bc2f5d959d4a118d5b1","2010-06-15 10:25:13+00:00","SAGA: Fix bug #2886151.

Bug #2886151: 'ITE: Mouse stops responding at Boar Castle' fixed
by implementing a workaround. It is a script bug in original.

svn-id: r49724
"
"d1c34efad91e4b42dd88e0e45452f26d117d3c04","2010-06-15 10:25:34+00:00","SAGA: Fix bug #2886141.

Bug #2886141: 'ITE: Cumulative Snoring sounds in Prince's Bedroom'.
Implemented safeguard against running same looped sound more
than once.

svn-id: r49725
"
"fead2bb719c0a86b5aab8a3ea62d3c4d0eb5cd92","2010-06-15 10:25:50+00:00","SAGA: Fix bug #2886130.

Bug #2886130: 'ITE: Graphic Glitches during Cat Tribe Celebration'.
We redraw statusbar for this scene. Bug in original.

svn-id: r49726
"
"51c22b39c86426b7f303d4d4f4d797e19bd63dbf","2010-06-15 10:26:10+00:00","SAGA: Fix bug #2928923.

Bug #2928923: 'ITE: Graphic Glitches during racoon death 'Cut Scene''.
Disable actor drawing for these scenes. A long standing bug in
original.

svn-id: r49727
"
"fa2b0a0dd20afa55d133ba3aece36148d98cd15c","2010-06-15 10:26:29+00:00","SAGA: Fix bug #2827504.

Bug #2827504: 'ITE: Music restarts on every background change in
credits'. We errorneously were stopping music on each scene,
though it appeared only with Adlib music.

svn-id: r49728
"
"4046cd84571694c66f19b9fe0215a284a7d14357","2010-06-15 10:26:46+00:00","AGI: debugger. Improved usage output, added safeguards to runopcode command

svn-id: r49729
"
"1c1fb7c9acb77d552e51d7f41d91fadb35c63ee1","2010-06-15 10:27:04+00:00","AGI: add optional parameter to 'room' debug console command.

svn-id: r49730
"
"14205bdbc0aaeea34824c8f2dc43ec273955c7fd","2010-06-15 10:27:23+00:00","AGI: add more status-related debug output.

svn-id: r49731
"
"316e171e67ddf01f9ae36b06c075b7d2ea46ad3c","2010-06-15 10:27:42+00:00","AGI: Fix bug #2959630.

Bug #2959630: 'LSL1: Security in blackjack' fixed by partially
reverting r41241. Do not clear prompt without on disabling input.

svn-id: r49732
"
"4c617e8282dedf2f3c5d8c344851310665cc0be5","2010-06-15 10:28:01+00:00","AGI: Fixed named fanmade games detection.

svn-id: r49733
"
"968f959158ced8c1820b847e4c2b3a85d82d6e61","2010-06-15 10:28:21+00:00","AGI: Fix bug #2960567.

Bug #2960567: 'AGI: Ego partly erased in Load/Save thumbnails'.
Force screen redraw after confirmation window is closed.

svn-id: r49734
"
"4dddfd44ceb8de712e51e83738f897ea9f9d3444","2010-06-15 10:28:40+00:00","AGI: Fix bug #2960584.

Bug #2960584: 'AGI: (Fan) SQ0: Music lost on saving (and loading)'.
Actually music did not loop at all. Our looping code was broken.

svn-id: r49735
"
"a993e2fb45dd836efad3bc225f7186a4f48384fe","2010-06-15 10:28:58+00:00","AGI: Fix bug #2960563.

Bug #2960563: 'AGI: (Fan) SQ0: Text input field overdraws Text window'.
Now our text wrapping code matches original.

svn-id: r49736
"
"25948606c46fdb841b961439023bb64ca542e461","2010-06-15 10:29:20+00:00","AGI: Fix bug #2960557.

Bug #2960557: 'AGI: (Fan) SQ0 - Sprite (Ego) not erased'.
Added a workaround. Actually root cause is not yet clear.

svn-id: r49737
"
"341fba383e8493e214c9e74c67cf3de0467c3e6a","2010-06-15 10:29:43+00:00","AGI: Fix bug #2862508.

Bug #2862508: 'AGI: Black cauldron save through GMM'. BC does not
have input line, and that was used for determining that user
can save. Added special case for BC, so it is always allowed to
save. In fact, original does not allow saving in some rare
occasions, but that will require analysing of variables, which
is a gross hack.

svn-id: r49738
"
"409fe0bd561e75b7312e4143b5e9c3803322430e","2010-06-15 10:30:01+00:00","AGI: made sprite-related debug output more informative

svn-id: r49739
"
"295edafdc4b266a7283ba494e685dfb22f132c6a","2010-06-15 10:30:26+00:00","AGI: improve script-related debug output.

svn-id: r49740
"
"7034d071b6f44fb77f3379535f146a095357c5be","2010-06-15 10:30:54+00:00","AGI: proper fix for sprite leftover-related bugs. Removed workarounds.

svn-id: r49741
"
"ffc390e64c1adc8bd863ecd0bfe72ff7ecba6832","2010-06-15 10:31:18+00:00","AGI: Fix bug #1945716.

Bug #1945716: 'AGI: Fan(Kings Quest 2 1/4) - Sprite not erased'.
Added a workaround, since it is design flaw of our rendering
system.

svn-id: r49742
"
"83053ecc27905bc60cdeea2cbfc9f9550764579b","2010-06-15 10:31:39+00:00","AGI: Fix bug #2825278.

Bug #2825278: 'AGI: KQ4: Swimming on land'. Our drawing code was
not picture perfect, and thus priority screen was trashed by one
of Fills, i.e. the color leaked and took whole screen.

svn-id: r49743
"
"462d1afed8ffbc9a018d07d0c0b280af448e7b52","2010-06-15 10:32:01+00:00","AGI: Fix bug #1875842.

Bug #1875842: 'AGI: Character loses final walking position'.
Do not reset ADJ_EGO_XY if non-directional keys were pressed.

svn-id: r49744
"
"88421532aa2fc34fda1a940a4ba994f96e324574","2010-06-15 10:32:25+00:00","AGI: Implemented immediate update for most of gfx to match original.

This fixes many subtle effects as in many cases there were no
special pausing and engine relied only on the slowliness of the
machine.

svn-id: r49745
"
"81870dba5804b776044f89112976d0110b5c0695","2010-06-15 10:32:44+00:00","AGI: Fix bug #2825273.

Bug #2825273: 'AGI: KQ4: Dwarf sequence'. Always allow ESC to work
in KQ4.

svn-id: r49746
"
"f7c830af26b8a7cac4b8a6864e161f614e0e9e06","2010-06-15 10:33:07+00:00","AGI: Fix walking for some versions of KQ4.

svn-id: r49747
"
"71917dc52daf2f2cbc2931f59c893c6c933fa2aa","2010-06-15 10:33:26+00:00","AGI: Implement FR #1881179.

FR #1881179: 'AGI detecting agi mouse'. Always run ScummVM in
AGIMOUSE compatibility mode, thus no detection for it is
needed.

svn-id: r49748
"
"38ef876d5beabb3f5e5d35690b5b14d6643e6aa3","2010-06-15 10:33:57+00:00","AGI: Split out IIgs sound emulator into separate files.

svn-id: r49749
"
"024f49213781a34c9d18a9580589e088062cec33","2010-06-15 10:34:14+00:00","Added seek() method to MemoryWriteStreamDynamic.

If it deserves a separate class, shout.

svn-id: r49750
"
"0a1a9194064a96673b45d856f06dbb689838d746","2010-06-15 10:34:45+00:00","AGI: Implement FR #1913900.

FR #1913900: 'AGI: MIDI support'.
Currently it gets selected when Adlib is chosen. Finding a better
way to do it is a todo.

Also default instrument mapping is plain.

Based on original code by Jens. Christian Restemeier.

svn-id: r49751
"
"c7e9b620eef9973beee5f2055fb37308682d86ff","2010-06-15 10:35:10+00:00","AGI: properly setup Sound var.

svn-id: r49752
"
"9358b54332411498e1dec39ceb90b60748d7c921","2010-06-15 10:35:23+00:00","Mention in NEWS most significant items which have been done so far.

svn-id: r49753
"
"85d8b4f5d848c0e1ec6c7b4ef3e6bdd839b05197","2010-06-15 10:35:42+00:00","AGI: Make sure that sound variable is reset once music is stopped.

svn-id: r49754
"
"6903fc7a070e33809ba277256b23fa1963e65db7","2010-06-15 10:36:10+00:00","AGI: Implement FR #2813133.

FR #2813133: 'AGI: Proper Tandy 3-Voice/IBM PCjr Sound Support'.
Add proper Tandy music. Heavily based on NAGI source, thus attached
its X11 license.

To run it now use -e pcjr. Old one is still default for adlib but
most likely will be changed in the future.

Also lied ground for further separation of different sound generators.

svn-id: r49755
"
"0fe65d3e5fcabaac354ffb67cb1970e3e0f5f270","2010-06-15 10:36:53+00:00","PSP: fixed invisible bug in power callback

svn-id: r49756
"
"ceb2909e0ad0ee4db8846bc2e6e9009364e24731","2010-06-15 10:36:54+00:00","AGI: Split all sound generators into separate modules.

Now the sound subsystem of the engine finally is possible to grasp.
Also now it is obvious why CoCo3 sounds are not functioning.

svn-id: r49757
"
"db6673c408865b201808e01ab5db796f2e794058","2010-06-15 10:38:39+00:00","AGI: rearranged class methods a bit and cleanup.

svn-id: r49758
"
"859212df2523e8b15076d968018dbf98618fd60f","2010-06-15 10:44:51+00:00","Implement translation support for ScummVM GUI.

Based on patch #2903830: 'Updated Translation Prototype' by alexbevi
which in turn is based on patch #1739965 by jvprat.

Currently it builds all translations right into ScummVM. Once the
feature will be accepted more widely, i.e. more translations will
pop up, it will be trivial to move translation strings to external
file.

Finished translation: Russian
Unfinished translation: Hungarian

Things which are nice to do:
- Language code -> language mapping for more user friendness
- Specifying fonts to be used with language
- Updating of interface language without restart. It will require
moving of much code to reflowLayout() methods for each dialog

The .po files must be in single byte encodings. I.e. no support
for Unicode.

svn-id: r49759
"
"09b776ad1f421ac947826771b06c02975b2dcbb9","2010-06-15 10:45:14+00:00","AGI: Made proper Tandy emulator default for PC games.

svn-id: r49760
"
"c066372b9bb560ed12537280771a5bfef17ff9e0","2010-06-15 10:45:29+00:00","Mentioned support for GUI translation in NEWS.

svn-id: r49761
"
"9867d4ba875a9de5eaad245f395d7c2d22940258","2010-06-15 10:45:43+00:00","Mention AGI sound improvements in NEWS file.

svn-id: r49762
"
"48d0d3008b3e886f06f63a9a67733cb3de8fcb0a","2010-06-15 10:46:04+00:00","SCUMM: Fix bug #1879604.

Bug 1879604: 'MANIACNES: Music not played when loading game'.
Actually previous attempt to fix this bug was not successful
since first entry of script 5 does not have needed functionality.
Now we resume music manually.

svn-id: r49763
"
"ba72975d3f5e88691506c670158ccda2e542013b","2010-06-15 10:46:23+00:00","SCUMM: Fix bug #1328120:

Bug #1328120: 'MANIACNES: Screen width incorrect, camera halts sometimes'.
Fixed by workaround and was tested with intro and on the kitchen,
where now it is possible to see Edna without her noticing you
first.

svn-id: r49764
"
"9ebed7b3d9c1f3f93d44d5e94cdf8669f3f441b6","2010-06-15 10:46:37+00:00","Mention MM NES improvements in NEWS file.

svn-id: r49765
"
"3fafa07ab0aeb65fedad159fb0cf345cc8f5f278","2010-06-15 10:47:31+00:00","GUI: Added in-place hotkeys for widgets.

Now it is possible to specify hotkeys in place for ButtonWidget
and CheckboxWidget (the only widgets with hotkeys now).

Use de-facto standard with putting hotkey between tildes (~).
Like '~O~pen'. The tildes gets stripped before after hotkey
is extracted.

This is done for giving translators possibility to specify
their own hotkeys.

Old hotkeys defined at widget instance creation are left for
leaving possibility to specify non-printable hotkeys such as
Common::ASCII_ESCAPE.

Translation files were updated respectively.

svn-id: r49766
"
"dc040aa8671797853b0b1f9add3320c6e1f22c33","2010-06-15 10:48:39+00:00","GUI: Implement radiobuttons.

Implement radiobuttons in GUI. Also closes FR #2821529:
'GUI: volume and subtitles speed sliders'.

Subtitle toggle button is replaced by three radiobuttons grouped
by a single group.

Updated translations and themes.

svn-id: r49767
"
"24abc6fb39ebf79e06fb39888bba6ae7e87f771a","2010-06-15 10:49:16+00:00","GUI: Improved look of GMM options menu.

svn-id: r49768
"
"a295f13152cc5c3d87d0ec88c14e5ab8740070ec","2010-06-15 10:49:46+00:00","GUI: Tidied up lowres themes.

svn-id: r49769
"
"ef36b80dfa120edb4648b3f1f7409fc858ba4712","2010-06-15 10:50:28+00:00","GUI: Implement FR #2821514.

FR #2821514: 'GUI: OK and Cancel buttons in option tabs'.
Now tabs are visually separated from the buttons.

svn-id: r49770
"
"9d4d191baa0eafcdd470f33bd589e204bd8e5863","2010-06-15 10:50:49+00:00","SAGA: fix timers.

Second parameter to intallTimerCallback is in _micro_seconds.
Correct calls which assumed  milliseconds.

svn-id: r49771
"
"a8a44a07d15aa3012ca27b38db3c702c3a40b0a3","2010-06-15 10:51:10+00:00","SCI: Fix timer.

installTimerProc requires interval specified in milliseconds,
not microseconds. Correct palVary method accordingly.

svn-id: r49772
"
"ea7405d7ef177a547d840424497d2f7ffd72626b","2010-06-15 10:51:26+00:00","GUI: Added default names for builtin fonts.

svn-id: r49773
"
"01f9006ee7e8d0fd153f42fb00afbc25c4804d2b","2010-06-15 10:52:35+00:00","GUI: Implement tooltips. FR #2821513.

FR #2821513: 'GUI: add tooltips'.
Added tooltips for Add Game button, clear field buttons and couple
other.

Current problem: Only first call correctly restores text. I could
not find where restore information gets lost.

svn-id: r49774
"
"d19807e983d001c3bd910275a274eda4ec0ed26d","2010-06-15 10:52:52+00:00","GUI: Add auto-repeater to scrollbar arrows.

svn-id: r49775
"
"b13636d6240d3926c7c79e8b69737e497e7824ab","2010-06-15 10:53:13+00:00","i18n: update Russian translation with tooltips.

svn-id: r49776
"
"96b3aa65046a371700228e4bfcecda2f8f84fa56","2010-06-15 10:53:30+00:00","GUI: Added tons of tooltips.

svn-id: r49777
"
"5370fc2312b1f01f81c5ad4ce2ef0a2c879f9c71","2010-06-15 10:53:55+00:00","GUI: Widened max tooltip width for bigger screen resolutions

svn-id: r49778
"
"2b67bcc8e499581c33f9a4d914df056e9c2c0bf2","2010-06-15 10:54:22+00:00","GUI: Added tooltips to more widgets.

svn-id: r49779
"
"7be2812757f066c8b73deda0406e79cd31d2f601","2010-06-15 10:54:48+00:00","i18n: Update Russian translation with new tooltips

svn-id: r49780
"
"eef983c2c6eec26c29d032818a838c563e0a0b98","2010-06-15 10:55:07+00:00","AGI: enable MIDI in options since now there are ways to play it.

svn-id: r49781
"
"2bcafcb02dd406a36fd0a11c6b0df742840a9a7e","2010-06-15 10:55:31+00:00","Sound: add PCJR as a pseudodriver.

Since AGI distinguishes between PCSPK and PCJR/Tandy, make it as a
pseudodriver.

svn-id: r49782
"
"67bc7115804b6f256f776fc761f7fffffa901c31","2010-06-15 10:56:12+00:00","GUI: Implement MIDI drivers as GUI options.

Proper version of patch #2988641: 'GSoC: Select drivers in GUI
based on output types'. So far only SCUMM engine supports this
feature.

svn-id: r49783
"
"dc57c684547bab8368d05a3822d1848d62211dd0","2010-06-15 10:56:30+00:00","GUI: Fix crash.

svn-id: r49784
"
"8dcc49251f08492968ddfcbb825bfe0a17d0747b","2010-06-15 10:56:46+00:00","GUI: Disable AdLib controls if game does not support it.

svn-id: r49785
"
"01bc5dda944f121187a4499f03d3a3814741f093","2010-06-15 10:57:28+00:00","GUI: Implemented Languages as GUI options.

SCUMM and AdvancedDetector support this feature.

svn-id: r49786
"
"0b83afce03572eb513dd2802a8ad4c0377600f84","2010-06-15 10:57:47+00:00","MOHAWK: Sync with latest GUI changes.

svn-id: r49787
"
"44a39ffbc66dbc9f019f041a47aaf9ba5a24d19f","2010-06-15 10:59:23+00:00","AdvancedDetector: Add new parameter directoryGlobs.

Without this parameter mass detection gave tons of false alarms.
Use globbing for narrowing down the depth search.

svn-id: r49788
"
"f2a62bb1f5bdc422eda47b5d673614e02d796035","2010-06-15 10:59:43+00:00","MOHAWK: Properly add detection for Riven DVD.

svn-id: r49789
"
"03ed49169c22cf169369ccec005e6e6e6cb129dd","2010-06-15 11:00:07+00:00","AGOS: Readd Simon1 Acorn CD detection.

svn-id: r49790
"
"c6d9812270a7ae2fcf68a054a6730c6cfcbfed29","2010-06-15 11:00:35+00:00","DS: sync with recent GUI changes. NOT TESTED.

svn-id: r49791
"
"d6d7cf3edfa0b69f3ad67c032ca4ec15229126bd","2010-06-15 11:00:57+00:00","IPhone: sync with recent GUI changes. NOT TESTED.

svn-id: r49792
"
"91078cc1bba6e768881ec099424b58cf822ef1b6","2010-06-15 11:01:17+00:00","WII: sync with recent GUI changes. NOT TESTED.

svn-id: r49793
"
"9aa8a9d51903cf68b594a9403fe22fe92af7d036","2010-06-15 11:01:41+00:00","Symbian: sync with recent GUI changes. NOT TESTED.

svn-id: r49794
"
"9793c96f1b0afd9e6898d73012be2492e4d53be8","2010-06-15 11:02:23+00:00","WINCE: sync with recent GUI changes. NOT TESTED.

svn-id: r49795
"
"9e006b74d342c5b020f36b5b75285e71d74f7d20","2010-06-15 11:02:42+00:00","Keymapper: sync with recent GUI changes.

svn-id: r49796
"
"94c9f9cdd11c64810aa0333d503403e54413fc09","2010-06-15 11:03:11+00:00","I18n: Add backend files to POTFILES. Update .pot.

Translations were not updated.

svn-id: r49797
"
"b6940caaaa59a534774425104f48733f8277d82b","2010-06-15 11:04:35+00:00","SCUMM: Added directory globs for in-depth search.

The code was compied from AdvancedDetector. Currently it is
set up to detect Mac indy3/loom which contains it data in
Rooms 1, Roooms 2 and Rooms 3 directories.

svn-id: r49798
"
"2399f998a393b8c4cff6410da4bead1374674b08","2010-06-15 11:05:52+00:00","i18n: Update Russian translation.

svn-id: r49799
"
"ab901bccd06ea88fdd7c16f77e8f7e437092e9eb","2010-06-15 11:06:14+00:00","Mention GUI improvements in NEWS.

svn-id: r49800
"
"deb907de637b963af91aa530251fad5ad6b45025","2010-06-15 11:19:32+00:00","Bugfixes to depth processing that was causing the 'Microprose Design Group' message not to appear in the first intro scene

svn-id: r49801
"
"079713c717cb06b93fbf7d8c510bec3151ab4b9b","2010-06-15 11:32:08+00:00","GUI: Fix crash

svn-id: r49803
"
"103cb1b3baffbb1a480e5e1dccd6f98aaa97f591","2010-06-15 11:38:53+00:00","GUI: Fixed warnings

svn-id: r49804
"
"5b484b5be7a9b9abbaf6b686e59b2ee9f88acb2d","2010-06-15 11:44:55+00:00","Fixed compilation when SCI32 code is not enabled

svn-id: r49805
"
"59d0035b033ac4791bfa91245418852a66e4e63a","2010-06-15 12:01:49+00:00","SCI: move portrait methods to gfxPaint16

svn-id: r49806
"
"69bfbdfa0406cd12c2275d481e296cf4f1e3faad","2010-06-15 12:08:40+00:00","SCI: Move ResourceSource to new header resource_intern.h

svn-id: r49807
"
"e32f3d5a4344953d9fdec6b9bd1627a4eb8de156","2010-06-15 12:09:03+00:00","SCI: cleanup

svn-id: r49808
"
"98e1f1a193a27cad12a888c8375c523420b25cbe","2010-06-15 12:09:30+00:00","SCI: Only use MacResManager if needed; start to OOPify ResourceSource

svn-id: r49809
"
"dea38106f84873a62c4a342c564dbfe9f38ff480","2010-06-15 12:09:51+00:00","SCI: Change ResourceSource to a class, further OOPify it.

In particular, renamed location_name to _name and made it const and
protected. Thus it cannot be changed after creation, and only read
access is now possible, via a getter method.

svn-id: r49810
"
"793c04f43b3d75b4b6d1ff2a2a93f2a496c0065f","2010-06-15 12:10:18+00:00","SCI: Changed some 'const char *' to Common::String

svn-id: r49811
"
"24a295f4a31799acefc4ace5eac3eaded36d3e42","2010-06-15 12:10:41+00:00","SCI: Add ResourceSource subclasses, one for each type

svn-id: r49812
"
"17a51121623a971b249cd33a8b581fe44b3e5616","2010-06-15 12:11:04+00:00","SCI: Convert code to use ResourceSource subclasses

svn-id: r49813
"
"8c06425ee3cac66469c817ab96cd0ab3688cdae6","2010-06-15 12:11:30+00:00","SCI: Remove 'map' param from addSource, and let AudioVolumeResourceSource subclass VolumeResourceSource

svn-id: r49814
"
"89cf6f7cb1b8336931b46e714b403f9bfe9af128","2010-06-15 12:11:56+00:00","SCI: Change ResourceManager::getVolume() to use new classes

* Add new ResourceSource::findVolume() virtual method
* Rename ResourceManager::getVolume() to findVolume(),
and change it to use the new ResourceSource method
* Add some TODO comments pointing to further OOPification
possibilities

svn-id: r49815
"
"055ee6ab5b51c0e0fbaa8e6e9e66850ac48504aa","2010-06-15 12:12:21+00:00","SCI: Add virtual method ResourceSource::scanSource

svn-id: r49816
"
"d15e09fdc27a2a65857ab0d7fa42c923470021ae","2010-06-15 12:12:44+00:00","SCI: Merge MacResourceForkResourceSource::scanSource and ResourceManager::readMacResourceFork

svn-id: r49817
"
"d0f59edd96025cce257e6d39cbc60fed25809279","2010-06-15 12:13:07+00:00","SCI: Rename ResourceSource::resourceFile to _resourceFile

svn-id: r49818
"
"d4f16962d03f7b1e88ea76560801f2f77a20ebd1","2010-06-15 12:13:29+00:00","SCI: Move code from ResourceManager::loadResource to ResourceSource::loadResource

svn-id: r49819
"
"d032e6481beee01a22302edac5193bc9ebdb8ea9","2010-06-15 12:13:52+00:00","SCI: Add loadResource impls to MacResourceForkResourceSource and PatchResourceSource; move _macResMan to MacResourceForkResourceSource

svn-id: r49820
"
"bb1336ca415311ed28195b2b7ac574e2244c2cc5","2010-06-15 12:14:15+00:00","SCI: Add loadResource impls for WaveResourceSource and AudioVolumeResourceSource

svn-id: r49821
"
"07b896802b3d56748c0e33877a325978db0513ff","2010-06-15 12:14:39+00:00","SCI: Pass volume number to ResourceSource subclass constructors; make ResourceSource::volume_number const

svn-id: r49822
"
"4020500640481e0a8089fd82ad94d2c286f0e024","2010-06-15 12:15:05+00:00","SCI: Rename ResourceSource members to follow _camelCase convention

svn-id: r49823
"
"713e61acba05c49ec4bc896fa2e873c3265000a7","2010-06-15 12:15:27+00:00","SCI: Doxygen fixes

svn-id: r49824
"
"824dd44ddfc7ca70aafcb4182b3afc58fa480528","2010-06-15 12:15:52+00:00","SCI: Revise how ResourceManager is instantiated.

This should allow for better error handling. Also, it
means that g_sci->getResMan() returns a valid value much sooner,
allowing me to simplify some code.

Also added a note about potentially replacing Common::FSList usage
by Common::Archive (and FSNode by Archive/ArchiveMember ?). This
might be a way to unify the addAppropriateSources variants again.

svn-id: r49825
"
"348953c067bc9e70702b64f130cbbe4cbc742223","2010-06-15 12:16:17+00:00","SCI: Make ResourceSource::_resourceFile const

svn-id: r49826
"
"88663c9186e5a4282f5553ad401b340db51164c2","2010-06-15 12:16:42+00:00","SCI: Merge ResourceManager::checkIfAudioVolumeIsCompressed into AudioVolumeResourceSource constructor

svn-id: r49827
"
"6248daccfc636533ad294df7739b00c0f011f2e3","2010-06-15 12:17:05+00:00","SCI: Get rid of ugly resMan params to ResourceSource methods

We might want to add a ResourceSource::_resMan member, but for
now I am not adding one on purpose; many more things might still
move between ResourceSource and ResourceManager, so we should
wait till the refactoring is complete.

svn-id: r49828
"
"1a0201f7e978df307e496a43691b81950eba66b1","2010-06-15 12:17:25+00:00","SCI: cleanup

svn-id: r49829
"
"6667a7102738cda6e36e928bb7a9b4ca8f128e78","2010-06-15 12:17:47+00:00","SCI: Move _audioCompression(Type|OffsetMapping) to AudioVolumeResourceSource

svn-id: r49830
"
"b9a3a9c12d04ab0886cedc2dec81689d5458d4ca","2010-06-15 12:18:07+00:00","SCI: Move _associatedMap to VolumeResourceSource and make it const

svn-id: r49831
"
"63d9cfb3bf0eb252838ad30946fa8cf51921124b","2010-06-15 12:18:31+00:00","SCI: Add ResourceManager::updateResource(); change some code to use addResource()

svn-id: r49832
"
"335e17af012590a68ae16ed60eff6fda221a1dce","2010-06-15 12:18:57+00:00","SCI: Move several methods from ResourceManager to Resource

svn-id: r49833
"
"4392cdaee19b626058144b0fc309c1a6ea09cd79","2010-06-15 12:19:14+00:00","SCI: cleanup

svn-id: r49834
"
"583a966d8c91250284ebe3fd84fce4e0ed12ae13","2010-06-15 12:19:39+00:00","SCI: Move decompress & readResourceInfo to Resource; more cleanup

svn-id: r49835
"
"79c9be5d96ca58a20afa61b4b26e28839dfb925e","2010-06-15 12:20:03+00:00","Reduce header dependencies

svn-id: r49836
"
"96f1e293009a7fe1291ed0f7c1255f9010b75098","2010-06-15 12:20:24+00:00","cleanup

svn-id: r49837
"
"703f0ca29c8f1915b5fae13decb6ccde110adada","2010-06-15 12:21:08+00:00","SYSTEM: Unify OSystem::getSupportedFormats() signature

svn-id: r49838
"
"db4533533a4e6676a834a5c036a088cdcb04de5f","2010-06-15 12:21:26+00:00","SCI: fix changes from r49806

svn-id: r49839
"
"68eeef8f1aa560954297291887f26bad6591aa15","2010-06-15 12:21:29+00:00","SCI: Add ResourceManager::getVolVersion()

svn-id: r49840
"
"2b24a1a2adcd112a6f3d878c9172ec570a6077d9","2010-06-15 12:31:16+00:00","SCI: OOpify class ResourceId

svn-id: r49841
"
"7a5ce0eddd01d29d14543679aef8892e08829a63","2010-06-15 12:31:37+00:00","SCI: Make Resource::_id protected

svn-id: r49842
"
"651e2760a3b2de0c542ccbbf1bf3caa319cc0349","2010-06-15 12:33:20+00:00","Fix spelling, cleanup

svn-id: r49843
"
"d570e10b77887fa163f17de512b14fc824f45f33","2010-06-15 12:33:54+00:00","Modify makeAIFFStream to match the other sound decoder factories

svn-id: r49844
"
"e62169c383c987949a5e7aad971691c030eb8a97","2010-06-15 12:34:12+00:00","AGI: Specify bug reference for workaround

svn-id: r49845
"
"f93644325244cc111634e2e8e4f97adb5a3fbe15","2010-06-15 12:34:33+00:00","SCI: Saner and simpler conversion from msecs to ticks

svn-id: r49846
"
"82b66ffdf8439eff0043256bff9daf4f0c3d84ed","2010-06-15 12:34:55+00:00","Fix some warnings about 'format not a string literal'.

svn-id: r49847
"
"e4153ffa381542ee14ad268475f679917d177254","2010-06-15 12:35:17+00:00","SCI: Add Resource::getNumber method

svn-id: r49848
"
"f387025e9b6a38b9023ffb2a766c168120472202","2010-06-15 12:35:39+00:00","SCI: Add FIXME regarding audio specific code in Resource(Source)

svn-id: r49849
"
"604f85588965498f7852b579e19a9f6e99d32590","2010-06-15 12:36:04+00:00","SCUMM: Fix composeFileHashMap

svn-id: r49850
"
"891b568fde51c7f1732c86fd34cc40efcd4314ce","2010-06-15 13:01:07+00:00","SCI: move textSize and textFonts and textColors inside gfxText16

svn-id: r49851
"
"a21b9c7b96a29d3be9285b4217e91f835fed31ec","2010-06-15 13:10:00+00:00","PSP: fixed up PowerManager and removed dependency on SDL

svn-id: r49852
"
"af5346e7ab97190f45be17192deef9a764cd128d","2010-06-15 13:14:23+00:00","SCI: calling wait() directly and removing it from SciGui

svn-id: r49853
"
"ba2de6dfa4f160d04474b76d8d5f7a24634196e1","2010-06-15 13:34:40+00:00","SCI: putting SciGui::init into SciEngine, removing it from SciGui(32)

svn-id: r49854
"
"45fe9a469e0f0281926920614e1ffec88932d7e8","2010-06-15 13:45:12+00:00","Fix wave patches.

svn-id: r49855
"
"ddb5a769a2e4f74c1da945914a67e169bc94bafb","2010-06-15 13:52:06+00:00","SCI: reset _gfxText16 for sci32, fixes gk1

svn-id: r49856
"
"ab558b45d252743797bca27d2240bf0e2057863f","2010-06-15 14:55:52+00:00","Fixed detective Mosely's hotspot in GK1 (day 1)

svn-id: r49857
"
"e94e91222c70537740ce9610cd8eecfa15f93cb0","2010-06-15 15:02:52+00:00","Fixed comments

svn-id: r49858
"
"44ce741f9c3fd1651c62ffee91467437f24e5d3c","2010-06-15 15:39:59+00:00","Code formatting

svn-id: r49859
"
"b25aba1d1ed9c867bbb4ff1b6b7ef9ea075b3cd1","2010-06-15 15:44:24+00:00","SCI: SciGui/SciGui32 gone for good...

svn-id: r49860
"
"365973542c1b5abbf0d9320d85115f0ff24c3bbf","2010-06-15 15:50:37+00:00","Add TranslationManager::getTranslation variant taking/returning a Common::String (should fix WinCE build)

svn-id: r49861
"
"90408a59cca70c9890f7b32bc0788f8c0418bad7","2010-06-15 16:36:09+00:00","Don't adjust the object's coordinates if the object does not belong to a plane in kIsOnMe(). It's now possible to start the interactive part of the Phantasmagoria 1 demo

svn-id: r49862
"
"b8d9cf27737f13937b5950b72d7911cf5281e7c5","2010-06-15 16:50:10+00:00","SCI: Pass resman to scanSource() methods

svn-id: r49863
"
"953b1324a3dd7c4eca5446fa4ab128960178173c","2010-06-15 16:50:28+00:00","Another attempt to fix WinCE compilation

svn-id: r49864
"
"cf38303497e00744fbd7c95bbd711d25cac1c6c4","2010-06-15 16:56:23+00:00","Don't disable kPalVary for SCI32, the semantics have remained the same.

svn-id: r49865
"
"831e626ccd488df9e8c3d534bf129c48e66f18e0","2010-06-15 16:58:03+00:00","SDL: only change mouse cursor, when mouse is currently within our window, also enable mouse position changing again for SCI

svn-id: r49866
"
"cf6a29e8623be7ae9575ee34fa42e1c2c2d29a3b","2010-06-15 17:13:18+00:00","Some documentation cleanup to ease readability.

svn-id: r49867
"
"0d7c8071cc8baed030d5f25203982e0613440412","2010-06-15 17:13:42+00:00","Fix iconv signature on BSD systems. (Based on what we do in tools/)

svn-id: r49868
"
"c09af1dcae051220f896002ca10877dc8eac76dd","2010-06-15 17:14:02+00:00","Some style fixes.

svn-id: r49869
"
"7c7054dbd1697b95634979f05d4a7b153bb17082","2010-06-15 17:14:38+00:00","Remove unnecessary svn:executable properties

svn-id: r49870
"
"0bff5c29fe8d7d0c4edaabee576289ea3cb21d4c","2010-06-15 17:33:45+00:00","Use a Common::String instead of a fixed size array for _syslang in TranslationManager.

svn-id: r49871
"
"f607fc59dbdeecedb3151a7532be7e170812cb38","2010-06-15 17:34:07+00:00","Extend (and along with it add) some doxygen comments.

svn-id: r49872
"
"34d8196334c628ebf240c7e3fc86615bc371bdc0","2010-06-15 17:34:26+00:00","Output some warning in case an invalid ID was passed to TranslationManager::getLangById.

svn-id: r49873
"
"c9ba23f2b461c40c1b985faa4091c9363d20163c","2010-06-15 17:41:33+00:00","SCI: only set mouse position, when cursor is visible (fixes non-stop, but escapeable mouse position setting to 0, 0 in eco quest 1 floppy during intro)

svn-id: r49874
"
"f3288b0f267672a6f9b0039cf9aeff514d2e42f8","2010-06-15 17:47:04+00:00","Fix a typo.

svn-id: r49875
"
"d8bc79814532818615a571e327e9f4d201e93057","2010-06-15 17:47:23+00:00","Strip out charset information from the system locale again (like it was done before r49871).

Unlike with the old code, we know allow for locales
with a different size than 5 though.

svn-id: r49876
"
"ee419aad9cb16e36248158a434831163a93731db","2010-06-15 17:49:40+00:00","GP2XWiz: Add port distribution rules into a makefile so they can be used with buildbot.

This removes them from the old scripts in /backends/platform/gp2xwiz/build/ and puts them in the right place as make targets.

svn-id: r49877
"
"212d0ac28c3b10c57ffefb16af998f58fa5e294c","2010-06-15 17:50:14+00:00","Fix compilation when using ICONV_USES_CONST.

svn-id: r49878
"
"a42ea73a768f52105ef3ac36041db0c5c14ec113","2010-06-15 17:56:05+00:00","Simplify code for the 'ICONV_USES_CONST' case even more. (i.e. remove the 'msg' variable there).

svn-id: r49880
"
"93df097f39dda7b1b0d68a94d0f06b01b9b834b4","2010-06-15 18:17:51+00:00","Added the same quit/restart test to print() as we have in so many other places.
This makes it easier to quit the game during the text box in the King's Quest 3
into, and probably other places as well.

svn-id: r49881
"
"6210b44eba8ec045a06a1ef272b9b1465652889f","2010-06-15 18:30:30+00:00","Fix linking of the cc_tests

svn-id: r49882
"
"9938661ffaa5923069fe5ee9e8f2ecb96a961ff5","2010-06-15 18:36:05+00:00","Surface is a struct, not a class

svn-id: r49883
"
"7360bea1ee55443c14639c13bc0b548bb941a705","2010-06-15 18:42:08+00:00","Fix linking of the cc_tests (gamecube too)

svn-id: r49884
"
"49463c2bf95f8293746f2b6cb9420f313c6babf3","2010-06-15 19:20:58+00:00","Use USE_TRANSLATION, USE_DETECTLANG and USE_TERMCONV instead of (ENABLE_)TRANSLATION, DETECTLANG and TERMCONV.

svn-id: r49885
"
"a6fc45b29b07c6b619b4889893846e6dec151b34","2010-06-15 19:21:20+00:00","Add translation feature support in create_msvc.

svn-id: r49886
"
"a8598767c627d8be616f31855b1ff5d6e0f752f9","2010-06-15 19:25:45+00:00","Fix some warnings inside convbdf.c

svn-id: r49887
"
"3f9bb1e9b08511f89bd53ff3e456ef4335a2ba71","2010-06-15 19:26:14+00:00","Fix some warnings inside make-scumm-fontdata.c

svn-id: r49888
"
"38fc910353009fe14124e1041d34d0df654d3f88","2010-06-15 20:01:31+00:00","Yet another WinCE fix

svn-id: r49889
"
"fea248ae2f0c2659d84bd8ec400530a6c5e5bc22","2010-06-15 20:23:25+00:00","SCI: make umlauts work in kFrameout for sci32

svn-id: r49890
"
"5534caa65d8acbad5325245e222d81d44a2bc51a","2010-06-15 20:32:46+00:00","added/fixed some features in palettized cursors/aspect ratio correction etc.

svn-id: r49891
"
"2e9a7155e6ba4398a1594df4c21de97f29a99193","2010-06-15 20:45:13+00:00","GP2X: Move port distribution rules into a makefile for use with buildbot.

This removes them from the old scripts in /backends/platform/gp2x/build/ and puts them in the right place.

svn-id: r49892
"
"46a555d6384f3e43c569d1f5b90b6848a661cff0","2010-06-15 20:57:20+00:00","some changes in the display texts

svn-id: r49893
"
"3f4ec4a8a4bd70bb340a5ba358e8aa4b622ee844","2010-06-15 21:31:46+00:00","Fix link of scummvm-static (for MacOS X bundle) when translation is enabled.

svn-id: r49894
"
"444a6b5976f1f5b41db1db94ae16a8987fff134c","2010-06-15 23:12:34+00:00","Workaround bug #3003643 (MI1EGA German: Credit text incorrect)

svn-id: r49895
"
"81926f106abce4d73a899962a7a1f3fd0307ff40","2010-06-15 23:45:13+00:00","Fix g++ warning 'format not a string literal and no format arguments'.

svn-id: r49896
"
"e7275161f431d0025a7e2bb47bc2d442670fd155","2010-06-16 00:24:16+00:00","SCI: Avoid using g_sci in resman (as it might not yet be inited)

svn-id: r49897
"
"408bfa20981bfef70b904cdc396c175c9612b7c7","2010-06-16 04:47:18+00:00","Fixed QDM2 to working state.

Major issue was that the input frames are reused 16 times to produce output frames.
Thanks to clone2727 for helping with this.

svn-id: r49900
"
"8f962a8fc319f757ea281848a78bb6c5d5365203","2010-06-16 06:24:21+00:00","Fix for Tooltip calls causing valgrind errors.

svn-id: r49901
"
"4ac81f3d18c6d31d1e6291e53d128db9f7199f57","2010-06-16 07:22:54+00:00","Fix for Valgrind Uninitialised Error from SDL_Event in sdl backend and derived backends.

svn-id: r49902
"
"e7e8808affc1a256b228da859e44ec3071c3a5a4","2010-06-16 09:04:27+00:00","PSP: got rid of SDL

svn-id: r49903
"
"569caaf14e90ec66a04f22a9c361dc2e81be84cc","2010-06-16 13:10:59+00:00","some changes in scaling and overlay

svn-id: r49904
"
"af65de6e1aaa197e17f10cd976ea2f5d15f0d7c8","2010-06-16 21:02:58+00:00","SCI: implement channel remapping for SCI1

svn-id: r49905
"
"02c3397ddf12e636da0b851f6350b45af1859dcd","2010-06-16 21:07:26+00:00","SCI: fix debug command 'show_instruments', got broken by r49905 on purpose

svn-id: r49906
"
"289b668099071c4609a6081cca97c626d61e93eb","2010-06-16 21:23:47+00:00","SCI: dont seek during init of music but on play, fixes assert when restoring saves caused by r49905 - because channel remapping isn't done at that point

svn-id: r49907
"
"9b6f71d7cf76e529ed8010224442ceef18183fcb","2010-06-16 21:44:33+00:00","Added handling for the SCI2.1 kPalette(1) call. The graphics in Torin's Passage are shown with the correct colors now

svn-id: r49908
"
"20d8de27bad1e9e8cd218c258ec863f89219b49c","2010-06-16 21:56:39+00:00","Implemented the SCI2.1 kMulDiv kernel function. Walking in Torin's Passage is done correctly now, without leaving trails

svn-id: r49909
"
"fa0011f51216d926d0922fba7bfb1ed65958dff2","2010-06-16 21:59:21+00:00","Added a sanity check inside kMulDiv

svn-id: r49910
"
"93890a49c1f62791f39e4ee07c2366c8fdb8fb37","2010-06-16 23:28:20+00:00","Added back the functionality to skip videos

svn-id: r49911
"
"18dc295a339cb7cc618ba565f68d05c6eada9782","2010-06-16 23:30:22+00:00","Hooked the VMD player in kPlayVMD. The VMD videos in the demo of Phantasmagoria 1 are shown now (e.g. the intro and the chapter beginning)

svn-id: r49912
"
"a7b76c04d9df2c30d541554b9f907f6bcedd307a","2010-06-17 00:07:03+00:00","Added handling of VMD video files in kResCheck, fixes video playing in GK2

svn-id: r49913
"
"2cba994bb4179cbed1c54921ff825bc4f7735efb","2010-06-17 00:20:40+00:00","Only hide/show cursor when playing a VMD if it was visible in the first place.

svn-id: r49914
"
"e5f609a40ab68cad298b75a3d69a7d61e7b79e70","2010-06-17 03:22:52+00:00","Correction for Invalid reads in Translation iconv calls reported by Valgrind.

The string terminators were omitted from the iconv call and not restored.

svn-id: r49916
"
"6ee4bf06ade5fdc6158d55b10cd73b1bf9377941","2010-06-17 03:53:13+00:00","Fix a valgrind warning in GfxCursor. Thanks to digitall for finding it.

svn-id: r49917
"
"39276e82dbebf55e68ecc298cbeef01133fb0bf8","2010-06-17 03:57:38+00:00","Fix another valgrind warning, thanks to digitall for spotting.

svn-id: r49918
"
"f10b1a23f807d7889a2776ce80ea8b7a77160eb5","2010-06-17 05:40:48+00:00","Fixed a few cppcheck errors.

svn-id: r49919
"
"894ba682cdfb60a268dd4f4cb09d74d5cbb590b0","2010-06-17 07:26:06+00:00","Moved kMulDiv together with the rest of the math functions, and kPlayVMD together with the rest of the video playing functions

svn-id: r49920
"
"25496abe1b494e125cc8dd7892e9c95e3da61042","2010-06-17 07:53:57+00:00","Added 2x scaling for VMD videos, for bugtesting (temporarily in SCI itself). It's currently not optimized much, but since the VMD decoder code will be revamped, we don't really care about performance at this point

svn-id: r49921
"
"705d3c2d85b30368a7b138328cdd99040fe0bf28","2010-06-17 08:41:04+00:00","SCI: fixes regressions of r49905 (thx to digitall) - first we now find out what channels are used in sci0 as well, we are doing straight mapping for sci0 though - this fixes music in sci0 games, also fixing crash in sq1vga because of using null pMidiParser

svn-id: r49922
"
"81fe1aa19ee4a9e8ffb7a77fbef8dc40fddbc750","2010-06-17 08:55:08+00:00","Added some more information on some of the calls of kPlayVMD

svn-id: r49923
"
"3a8e11767d07e836bc001e931c480a3cd63dcd67","2010-06-17 11:05:39+00:00","SCI: decreasing channel given to us on cmdSendMidi by one, so mute command now matches the right channel. sierra sci also decreased by one (their channel is 1-based)

svn-id: r49924
"
"f3dcd38c74c835b0046a849cefa7dafcf1844ccd","2010-06-17 11:23:51+00:00","few fixes in GFX tests, added template for FS tests

svn-id: r49925
"
"423029c027c2013c4d23062b2ce81a807d6c74ec","2010-06-17 11:54:54+00:00","SCI: implemented channel muting for sci1, finally fixes lsl5 paino scene with patti

svn-id: r49926
"
"cf86b447939a3baea5aa3bd53450f8f56f436740","2010-06-17 12:13:27+00:00","M4/MADS: Some slight tweaks to the animation message chunks

svn-id: r49927
"
"0e365131ac58b7504e9e16b08a8b3125b6b37027","2010-06-17 12:29:58+00:00","Fixed wPlayAudio, and added some documentation on the 3 new kDoAudio subops. Digital sounds in Pharkas work again

svn-id: r49928
"
"45b23601e77d816415cccd7cd73f487d3a0f485b","2010-06-17 13:42:02+00:00","Add detection of original directory structure for Touche.

svn-id: r49929
"
"36d92b4566ba15d381f56870ccf9898ca0383138","2010-06-17 14:05:05+00:00","Fixed kLoad and kUnload (the resource type was incorrect)

svn-id: r49931
"
"4e7b98db0cd978af5913ca3604fc72f4d4f7d7d9","2010-06-17 14:06:12+00:00","Removed a now obsolete FIXME (spotted by Fingolfin)

svn-id: r49932
"
"f403d0f806d56dbe2017374792e0697e6d46bc1f","2010-06-17 15:02:18+00:00","Don't translate both x and y of the rect in kOnMe if only one of the variables is negative. Fixes the GKEgo hotspot outside of the Madame Cazanoux's house.

svn-id: r49933
"
"1bbb9d7bd29020566c36d7812c6de236a25c025e","2010-06-17 15:46:01+00:00","Fixed cppcheck warning.

svn-id: r49935
"
"00ac852dc861877857bbb4065a6cd1f78f04b023","2010-06-17 16:06:01+00:00","SCI: implement workaround for laura bow 2 demo, because that interpreter uses the old real palette merging from sci1 - some views contain a palette that has all colors marked as being used, which would overwrite sysPalette with blacks

svn-id: r49936
"
"7bb48adda7e9e04fb1b8a6ccce38b29a143ba835","2010-06-17 16:09:06+00:00","SCI: slightly change comment from r49936

svn-id: r49937
"
"5daa17473ba3b21683f111989eaa1156f72171cd","2010-06-17 16:36:01+00:00","SCI: applying forceRealMerge change to pq1 and qfg3 demo as well (see r49936) for now

svn-id: r49938
"
"1cb4f703f116d5d69e72f9ae45fa863fb062ab9f","2010-06-17 18:30:11+00:00","Fix the QFG4 Demo: kStrSplit has been replaced with kRemapColors.

svn-id: r49939
"
"b56b3b9eadd82685da6f8973bc8775176e67f1ff","2010-06-17 18:47:25+00:00","Fix common/messages.cpp rule for out of source directory builds. (Maybe this fixed bug #3017628 'AMIGAOS4: messages.cpp errors')

svn-id: r49940
"
"690203de7486b577dc8b34d1a2fa8b97b686d2f9","2010-06-17 18:54:37+00:00","Fix possible link error for scummvm-static (for MacOS X bundle) when USE_TRANSLATION is set but USE_TERMCONV is not.

svn-id: r49941
"
"e7305339abe68d32506afd3667ba006ca780a21a","2010-06-17 19:07:45+00:00","Fix out of updatepot and update-translations for source builds.

svn-id: r49942
"
"10b95b93eacdd89095a4642dd1058516f90e1d41","2010-06-17 19:08:05+00:00","Update scummvm.pot.

svn-id: r49943
"
"1028e8e0c8a9ebef7f99d0ee512ff8e60fe563fe","2010-06-17 19:14:40+00:00","Yet another fix for 'update-translations' in out of soucre directory builds. (Whoops...)

svn-id: r49944
"
"4dbee278f1c768c2840d9eb3b46877c5d7dc2520","2010-06-17 19:15:03+00:00","Update our two current translations too.

svn-id: r49945
"
"cb92890d7bc99ddad504c43bd12423caa4a8fcda","2010-06-17 19:15:23+00:00","Commit updated common/messages.cpp too.

svn-id: r49946
"
"27741ee9707b97bcfa09d4bb4f274e4788a46449","2010-06-17 19:42:34+00:00","SCI: dont subtract offTop on wmgrPort when using old gfx functions - fixes about window in pq2

svn-id: r49947
"
"fb210bd45fc5f02038f3c5602d9ba602fd60b1a0","2010-06-17 20:24:01+00:00","added a FS test to open and read a file from the game-data dir

svn-id: r49948
"
"c8dfa255a3c812dbd4a852c839407a31c0122a70","2010-06-17 20:49:33+00:00","Fixed the selector console command (don't change the selector name to lowercase...)

svn-id: r49949
"
"701d69d6e2c1cd6007107720e41c2de2670951a1","2010-06-17 20:52:53+00:00","Don't show warnings for a known script bug in SQ4CD with the Sq4GlobalNarrator object

svn-id: r49950
"
"82c36b6b262bd435fc358917494eed34a25eac5c","2010-06-17 21:00:45+00:00","Only do video scaling when required (hopefully fixes SQ6). Adapt the scaling code to normal SCI videos as well.

svn-id: r49951
"
"d1964ec18b81b157617ac7fb914400ec98cf8255","2010-06-17 22:05:28+00:00","Add additional documentation and code to PlayVMD(1) describing the
myriad parameters settable here, and dump actual parameters passed

svn-id: r49952
"
"37434d86ae8f4e7ca3e7f0258c78ad9441f99e31","2010-06-17 22:08:07+00:00","SCI: PlayVMD(1): Hmmm. Don't print gammaBoost etc if they aren't used

svn-id: r49953
"
"8e07a1e16768548112a290d04348e26173e8afa0","2010-06-17 23:10:37+00:00","SCI: Moved the event code a little bit around.

* Move sleep() from EventManager to SciEngine
* Rename EventManager methods: get -> getSciEvent, and
getFromScummVM -> getScummVMEvent
* Make scancode_rows static const
* Turn altify & numlockify from EventManager methods into static
functions (and comment out the currently unused numlockify)

svn-id: r49959
"
"a2bcf9ac31d025d09fabcd2d636eeb34d3c75df0","2010-06-17 23:11:12+00:00","SCI: Rename sciEvent to SciEvent

svn-id: r49960
"
"fabba55e6df2a3ae1b1bba5f3e145cae5bba0dc4","2010-06-17 23:11:34+00:00","SCI: cleanup

svn-id: r49961
"
"06997c0da6f45a760b8bf4dcf3d604bc1a977bad","2010-06-17 23:11:56+00:00","SCI: Update FIXME in SegmentManager

* Turn one FIXME into a simple comment
* Rewrap comment to 80 columns
* Turn several warnings into errors

svn-id: r49962
"
"2556ea192cac369f86d1b237335ae7c0aa0b13e2","2010-06-17 23:12:17+00:00","SCI: Turn _modifierStates into member of class EventManager

svn-id: r49963
"
"69fb7032460e7874d12d8f07bcc436eb0bbab18d","2010-06-17 23:12:38+00:00","SCI: cleanup scancode rows code

svn-id: r49964
"
"337711d3215bf199260746920c46f7db85a2f70c","2010-06-17 23:12:59+00:00","SCI: Get rid of duplicate _system member in SciEngine

svn-id: r49965
"
"cfcbdf86569dac5856d364316caa5b0a57713fd7","2010-06-17 23:13:30+00:00","SCI: Remove selector_name function, some cleanup

svn-id: r49966
"
"78cd1aa145fb454de67444ef58bed6381ce2396c","2010-06-17 23:13:54+00:00","SCI: Remove hack related to compiled kernel signatures.

Also change some things to comply to our code formatting conventions.

svn-id: r49967
"
"359be0c0665d9fed898ad1c511614a76ee92e331","2010-06-17 23:14:34+00:00","SCI: Change SciEngine's 'char *getGameID()' to 'Common::String getGameId()'

svn-id: r49968
"
"b474a72d1823d721f6f50de07bdebfdab3951632","2010-06-17 23:14:57+00:00","SCI: Remove incorrect gameid check

svn-id: r49969
"
"50c3a087e3fb75ac06ea6186909b49885de6226d","2010-06-17 23:20:39+00:00","Reduced header dependency

svn-id: r49970
"
"f977faaf9f9d2289adfbc2ccf9338cb24266dce5","2010-06-17 23:44:01+00:00","SCI: Fix a few errors in PlayVMD comment.

svn-id: r49971
"
"9c1ec81d76def56d55df701df9d158532da1bf0f","2010-06-17 23:45:38+00:00","Strict mode: Turned several severe errors (almost all detection related) into errors, instead of warnings

svn-id: r49972
"
"db70d66e4ae872ebdeb2a88ef0870708a30c7667","2010-06-17 23:50:28+00:00","Strict mode: Changed several warnings due to logic bugs into errors. If an error pops up from these ones, please add the game where it occurred and the steps to reproduce the error before turning it into a warning

svn-id: r49973
"
"c9c9a21a0836edfc824e821702e886a656167692","2010-06-17 23:52:17+00:00","Renamed error -> errorNum to avoid name clashes with error()

svn-id: r49974
"
"6946167f34518d16036e37ce19683be1592a9424","2010-06-17 23:53:30+00:00","Strict mode: error out on unhandled subops, to note if they actually exist and where they're used

svn-id: r49975
"
"39e77edbb71f04dc1436db152849aec1cd09e873","2010-06-18 00:05:41+00:00","Process kAddAfter with 4 parameters (Torin's Passage)

svn-id: r49976
"
"660ae052c88fc2e209dde87595799bff8b2bd09b","2010-06-18 00:36:20+00:00","Fixed a bug in detectHires(), so that it actually works

svn-id: r49978
"
"880e07250ea86416c29fde16341429f347dc4d8a","2010-06-18 00:37:56+00:00","Added warning about unhandled kGraph subop 1 (GK1CD)

svn-id: r49979
"
"949493d14160530a37c02f2440f41e5dac49e725","2010-06-18 00:49:55+00:00","Fixed invalid memory read in GK1CD

svn-id: r49980
"
"d2a9fdae260b74b23be7b2f14f5723914ab5a559","2010-06-18 00:59:10+00:00","Added stubs for kPalVary, subops 2 and 5 (XMAS '92, QFG4 demo)

svn-id: r49981
"
"b453d139d49bb17fef58a329d1fba55b3fa8fbba","2010-06-18 01:09:40+00:00","SCI: (Temporary?) workaround for firmware bug in common USB-MIDI cables.

svn-id: r49982
"
"ac4659b92acd42690dae6b09a1a72bb0d30c1764","2010-06-18 01:11:00+00:00","Added several unimplemented kDisplay subops, as well as a new sound command, found in the demo of Longbow

svn-id: r49983
"
"30ea5f3ad2c45702f15e0941829fe002a4d22711","2010-06-18 01:27:25+00:00","Added a workaround for the KQ1 demo (looks like a script bug)

svn-id: r49984
"
"7a22e491e39a5e15cf17168c2fde1368eea2d96b","2010-06-18 01:29:07+00:00","Marked the KQ1 demo workaround as a workaround

svn-id: r49985
"
"2d61dd8608aafe0e524cec3e496f6d33f55cd922","2010-06-18 01:38:08+00:00","Fixed invalid memory access in SQ6

svn-id: r49986
"
"8f761de15ffb4475bf529248b0bf7b635db53400","2010-06-18 01:48:56+00:00","Added a new subop of kPalVary (PQ4)

svn-id: r49987
"
"01cb1cf01164987770ac76b897f2dc7eb7cb300d","2010-06-18 02:03:28+00:00","Turned more warnings into errors, some cleanup

svn-id: r49990
"
"e347a6856ef3d4796a794cc51e7d078ec3c2a26f","2010-06-18 02:08:00+00:00","Do not rebuild common/messages.cpp automatically when a translation changes, but require the user to do 'make update-translations'.

This should be helpful for building on a system without perl.

svn-id: r49991
"
"e3c8624510fb0d7b28e95dd79d99c39b643d42e1","2010-06-18 02:08:21+00:00","Explcitily use 'perl' from the PATH, this fixes translation updating on systems, where perl is not installed in /usr/bin/perl.

svn-id: r49992
"
"31930b6d09a711a1c1ed708d2f23a6fc05ba2d63","2010-06-18 02:09:12+00:00","Error out on unimplemented kDeviceInfo() calls

svn-id: r49993
"
"0eee4e79bf320a2b068a1460613e879751853b17","2010-06-18 02:16:00+00:00","Changed an assert into a warning with a FIXME (happens in SQ1)

svn-id: r49994
"
"773f3bf1453b7e4cc55753e8ca882f5346ef5f83","2010-06-18 02:23:30+00:00","Changed another warning into an error. Cleanup

svn-id: r49995
"
"a451ffe2687dc894d8026de14b4235b4e9b2953d","2010-06-18 02:25:11+00:00","Make MidiParser::sendToDriver protected.

The client code should never try to pass commands to
the output via the MidiParser API.

SCI currently does that though...
Actually that shows that either our MidiParser API becomes
more and more an MidiPlayer than just a parser or that the
SCI design has its flaws here.

svn-id: r49996
"
"d869d1370e01839bb6213c61e82bf2aca793b4d2","2010-06-18 02:25:33+00:00","Properly provide stub implementations for all TranslationManager methods when USE_TRANSLATIONS is not defined.

svn-id: r49997
"
"492f748a4baaf72a5ca41a4b487966b3110ea580","2010-06-18 02:28:58+00:00","Add a comment on the unknown switch command argument.

svn-id: r49999
"
"8bd71a6ab2ba9dcce676ee7935540ca651c0f5e6","2010-06-18 02:29:04+00:00","Cleanup; add a TODO.

svn-id: r50000
"
"98944b81719ba0c173e8c603a22e229994318447","2010-06-18 02:29:20+00:00","Added information regarding a FIXME

svn-id: r50002
"
"4d3d63223b2f3297ab1c977dc3bbf198c08ecbec","2010-06-18 02:29:21+00:00","Cleanup.

svn-id: r50003
"
"cccfed3ba352edc81ccc06f51bbd2f8f18b892ea","2010-06-18 02:30:19+00:00","Cleanup

svn-id: r50004
"
"8f655615d774d7172e606ad2b99e02afe3ad5010","2010-06-18 05:40:12+00:00","SCI: reverting #49978, it worked correctly. the new values contain the full height/width of the picture (may be much larger cause of scrollable areas) and we actually don't want that. the values before and now contain the height/width of the on-screen picture size - although this may contain 0, 0 for low-res games, but that's fine then

svn-id: r50006
"
"08ff57cc9705bcbce30439a489988bcc059ce22b","2010-06-18 05:55:27+00:00","SCI: partially revert r49983 - all of those are not implemented in sierra sci or not even pseudo-valid in there. all of those seem to be script bugs

svn-id: r50007
"
"8493edf0827f8c931b68ce35fe71718e3a3c176a","2010-06-18 06:47:16+00:00","SCI: changing error to warning inside detectHires() for gk1 to work again...

svn-id: r50008
"
"7b8693757c6c7631ca4f54d10761517c2bcb1792","2010-06-18 08:45:57+00:00","added testcase for writing files in the filesystem

svn-id: r50009
"
"bb528d894cff2a6e249d6b7fe469fc86f048a894","2010-06-18 09:37:06+00:00","SCI: Rewrap some overlong comments

svn-id: r50012
"
"5a95c2a652e5043673dff16383f3114247059d46","2010-06-18 09:37:25+00:00","SCI: Doxygenify some comments

svn-id: r50013
"
"8ade66ba132a9ca929838722aa67857666871c6f","2010-06-18 10:49:26+00:00","SCI: Unbreak diskdump console command, maybe others

svn-id: r50014
"
"543610d4d4a7458ac99e0126e03e96ab581adf68","2010-06-18 12:15:33+00:00","Don't throw a warning when we can't find hires content

svn-id: r50015
"
"919c348c5a739ed4cd85f7c38cb7cf10f86f3737","2010-06-18 13:02:48+00:00","SCI: pseudo-implemented 0x72 and 0x73 for kDisplay used by longbow-demo, although sierra sci doesn't support them at all

svn-id: r50016
"
"661a170c86ee1fc7db05e16b19455bddeb6f66e8","2010-06-18 13:05:08+00:00","SCI: change error() inside adlib driver ::setPatch() to warning() again, fixing pq2

svn-id: r50017
"
"562f8a9463a23e7dfac01d81b6e11c13b4c66600","2010-06-18 13:36:29+00:00","SCI: implementing fading for sci1 only for used channels of the object, fixes lsl1 music issues when going right at the start

svn-id: r50018
"
"b152f6d68ff00290b475df35df180e95f84af6d3","2010-06-18 14:36:22+00:00","Added an explanation about the invalid instruments used when using the Adlib driver in PQ2

svn-id: r50019
"
"874eeb2370164d0a7f8cd588f817beb64d98575d","2010-06-18 14:48:39+00:00","Added hints inside validate_arithmetic(), together with some code useful for debugging. Some cleanup

svn-id: r50020
"
"5d378574a438f7b7f60fd01b88dd58e05c0bcd9b","2010-06-18 15:18:14+00:00","Fixed show_instruments to ignore instruments in Sierra's special MIDI channel 15, and updated the comment regarding PQ2 accordingly (it only has 2 incorrect instruments)

svn-id: r50021
"
"680f7c897af5dac091e1abc47f0500cccbd07a51","2010-06-18 15:40:18+00:00","Fixed a problem in kAnimate which occurred when a list was modified by a call (e.g. in KQ1 demo, PQ2)

svn-id: r50022
"
"8a8480c0caa2848522cf18ec870343677c6af44f","2010-06-18 17:20:09+00:00","SCI: fix typo when setting EGA palette

svn-id: r50023
"
"6f7f6572c4ded607d5f479c699d035cb2c8ebabb","2010-06-18 17:34:34+00:00","Fixed invalid memory read in LSL6 hires - kRobot(1) returns an integer

svn-id: r50024
"
"636ef64c688d1a059bc3dedb2afc35c3acb2e713","2010-06-18 17:40:13+00:00","SCI: making vga views work in ega games :P

svn-id: r50025
"
"3197dfc033adba2ced19dcaf3762a5b2c0ad2452","2010-06-18 17:53:35+00:00","SCI: added more description about changes in r50025

svn-id: r50026
"
"8c8ce14164c21210e05115ab6a8f4f3f8a1d0e20","2010-06-18 18:49:06+00:00","SCI: not using views coming from patch files anymore for detecting view type

svn-id: r50027
"
"602b32175a75cac3ddf6d8ff531202fe197c91c4","2010-06-18 18:55:17+00:00","SCI: fixing detection of vga sci11 views for ega games (original change in r50025)

svn-id: r50028
"
"75b7b54fe119bffa74cbba9b5c663b45769f3e10","2010-06-18 22:06:13+00:00","SCI: Add mac SQ1 & SQ3

svn-id: r50030
"
"e5fcbc0c3a9b926cca5ba61d9c89038b260fbfa1","2010-06-18 22:06:31+00:00","AGI: Fix serguei1/serguei2/sqx detection

svn-id: r50031
"
"7a8b8c88ae52cb4a6a40ec233e43d006ce645c8d","2010-06-18 22:06:56+00:00","AGI: cleanup

svn-id: r50032
"
"da28fde4c61d8f050be8b2eb90b7b634869e3f22","2010-06-18 22:07:32+00:00","AGI: Change some #defines to enums

svn-id: r50033
"
"25c86e8b03574163d7c6df6e54d00cbffc66b4ef","2010-06-18 22:16:05+00:00","SCI: set resulting type to keyboard+joystick for sci1middle+ in kMapKeyToDir - fixes keyboard controlling of mouse in all sorts of games - although this is not 100% done, the change actually happened inbetween sci1early, added fixme

svn-id: r50034
"
"f4b700c4c45e601a5d1571f980ec7e5636e0f166","2010-06-19 01:16:25+00:00","SCI: AdLib: add dummy instruments when there are only 48 in the patch

svn-id: r50035
"
"61c40e2bd4cf5f23314d819e70d7eb0a966993cf","2010-06-19 02:50:46+00:00","Save the context of a suspended list before resuming the execution, so that it can safely be suspended again. Patch 3004652 by fuzzie.

svn-id: r50037
"
"5b3075bd653f888d814abd32b878870c2388668c","2010-06-19 02:51:03+00:00","Guarded the command execution suspension for NS demo (this was due in r38662 - see bug #2619824).

svn-id: r50038
"
"d7a165b9f256244ed5b4e7f48cea82a540cf1698","2010-06-19 04:50:44+00:00","Implemented PART command for BRA, largely based on patch #3005434 by fuzzie.

svn-id: r50039
"
"de7de460e8c985764d9e5719789da0aa8df914e9","2010-06-19 04:51:00+00:00","Use the new _nextPart member switching part from the menu in BRA.

svn-id: r50040
"
"96d4ae0fcccbe6438c5829a4a679d94180407159","2010-06-19 04:51:14+00:00","Cleanup some more state when switching part in BRA.

svn-id: r50041
"
"5328abe2f0b1afa33c360b098865de491410b677","2010-06-19 04:51:31+00:00","Cleanup.

Got rid of the legacy 'location.part' string handling in BRA.

svn-id: r50042
"
"73e612a801dc26afe518ef7033efea5602988057","2010-06-19 04:57:54+00:00","Mention that part 1 of BRA is completable.

svn-id: r50043
"
"4fb3059edcfdcfc6ab64cd0c4437e1cbb289d00e","2010-06-19 08:43:50+00:00","Fix some typos (thanks to fuzzie).

svn-id: r50044
"
"a7fa0649dfc71c79f496a86986413f35c8d36966","2010-06-19 09:46:04+00:00","SCI: implemented checking of keyboard driver in case of SCI1EGA/EARLY, also renamed SCI_EVENT_JOYSTICK to SCI_EVENT_DIRECTION

svn-id: r50045
"
"101218c1b6843692d82e992372e5ac8af81393d5","2010-06-19 10:28:41+00:00","SCI: added TODO for keyboard driver size check, maybe this whole stuff isn't needed at all

svn-id: r50046
"
"710f0257eb1cd1fda1f5ac340375b13ee6efabe9","2010-06-19 10:57:01+00:00","SCI: replacing the keyboard size check for direction type detection with checking for script 933 (pseudoMouse) instead - this is better because its working multiplatform

svn-id: r50047
"
"0c93154eb90b58cf5618b45e5e63a91694196d93","2010-06-19 11:08:16+00:00","AGI: Fix detection of AGI Tetris and Caitlyn's Destiny

svn-id: r50048
"
"32668b553fe69fc8cea5afc60d5f82abdc9a4fb8","2010-06-19 11:08:41+00:00","AGI: Get rid of GID_SQ0

svn-id: r50049
"
"721db3eccb82e27d1169a46b282975534ce106fe","2010-06-19 15:35:21+00:00","Fix an issue in String::ensureCapacity() when the string is shared. It could allocate two much memory as it was at least doubling the current capacity even when this one was sufficient.
It fixes a crash in GUI::Widget::cleanupHotkey() as the capacity of the string was doubled at each iteration once it was too long for the internal storage (only to add one character to the string). This ended up in a bad_alloc exception after a few iterations.

svn-id: r50050
"
"3b6fac3703a76192022bfbf8bc513f424ee1872c","2010-06-19 17:06:37+00:00","Comment out rule for common/messages.cpp for now and make update-translations update common/messages.cpp directly.

svn-id: r50051
"
"78068df9084867faef35a1ada3abe3c4bb764a13","2010-06-19 17:08:17+00:00","Whoops copy&paste mistake...

svn-id: r50052
"
"26e4e0e345bbfb5b84a53a023b9b78207f859cc7","2010-06-19 17:12:17+00:00","SCI: cleanup view decompression code

svn-id: r50053
"
"ab4e02422cda7ba436c667bf4a3758a4588f170a","2010-06-19 17:43:13+00:00","SCI: free channels for channel remapping on stop and pause, instead of dispose - fixes qfg3 demo going out of channels

svn-id: r50054
"
"996bd693e0ad45d5d5d599b6d5e320c1f52afe8a","2010-06-19 19:04:35+00:00","SCI: resume when unable to locate base objects - fixes loading some saved games

svn-id: r50055
"
"ed50ecd62d21e728480710e64aea79c5d132ac77","2010-06-19 19:06:58+00:00","SCI: make channel remapping stop using channel 0 for mt32 - fixes playback accordingly (like lsl1 at the start)

svn-id: r50056
"
"447f1270139890877ecdc32c06138f88525e1458","2010-06-19 19:16:42+00:00","SCI: fixing uninitialized usage in MidiParser_SCI

svn-id: r50057
"
"a845e8b859e215a24e68bfbc5990153faf733548","2010-06-19 19:39:36+00:00","SCI: move setVolume down inside loadMusic so that it actually affects the used channels

svn-id: r50058
"
"24459b5842e6cf8ef906e81c9b43c36c657f1119","2010-06-19 19:47:22+00:00","SCI: reverting r50058 - we can't actually send to the channels at that time, because we do not own the channels at that point

svn-id: r50059
"
"089f5bba1491be81cebc495a7e5245fe045da323","2010-06-19 20:00:32+00:00","SCI: stopping scripts from sending to unused channels manually (fixes sq1vga)

svn-id: r50060
"
"f3b8a5927d16da3a35a55069a9fe9d9e6500a2f8","2010-06-19 20:23:55+00:00","SCI: fixing another uninitialized variable usage issue - also limiting reset velocity to used channels only, same is true for setting voice count

svn-id: r50062
"
"ef67a37b5498fd256533369f2c8e531887d2b6f6","2010-06-19 20:37:53+00:00","SCI: fixing last uninitialized variable issue in MidiParser_SCI (hopefully)

svn-id: r50063
"
"492f743d47ea47ee9e28368fce1b5505399c011e","2010-06-19 20:50:10+00:00","some more changes with GFX and FS tests

svn-id: r50064
"
"b0a36849daaf02ba01e2a0603569b20a608250e0","2010-06-19 21:15:58+00:00","SCI: locking _mutex inside SciMusic::sendMidiCommand(MusicEntry *pSnd, uint32 cmd)

svn-id: r50065
"
"87132bd411c760812ef2b5b65c11115d689de52b","2010-06-19 22:14:15+00:00","SCI: changing error to warning in ResMan::detectViewType()

svn-id: r50067
"
"f2983093e83425d7a5b14cbb43b1ba2d995e29f4","2010-06-19 22:56:58+00:00","Add nearly complete french translation. I tried to make it work also in 320x200 but french can be quite verbose, so in a few places it does not fit. Also I could not check any of the device specific strings (e.g. from WinCE, Wii or other backends) and a few are missing.

svn-id: r50068
"
"d6cd656f15aed3ac3b8428442f9397944e6b2c85","2010-06-20 05:25:34+00:00","Added support for the alternate encoding for depth surfaces

svn-id: r50069
"
"fcdb7807a456f5a6cb94932977a1b0e4f0e11089","2010-06-20 07:04:58+00:00","Implemented explicit transparency index support - the previous hardcoded index of 0 wasn't correct, since some sprites need that index

svn-id: r50070
"
"110e03c87b65330ef1ac105ddfca55bb1ac1d4ac","2010-06-20 07:06:22+00:00","Removed unused variables

svn-id: r50071
"
"41990883bf003ff075821bc484b605b1ba87c8ad","2010-06-20 09:51:11+00:00","Don't go into 'menu input mode' unless the game currently allows the menus to
be displayed. I hope this is the correct fix to keep Police Quest 1 from
hanging if you press Escape while reading the newspaper in the briefing room.

svn-id: r50072
"
"81f64c9e3e8cacf106c36eff2f443f29ed1f50c3","2010-06-20 10:25:46+00:00","SCI: storing all manual midi commands now and actually sending them to driver during onTimer() - fixes mt32 emulation crashing during lsl5 piano scene

svn-id: r50073
"
"36ca2ce421d1dfbf6517d6ea008bbd97b9f6ccb8","2010-06-20 12:21:57+00:00","SCI: some cleanup for kPalVary

svn-id: r50074
"
"daf1429ca22e887d49e761304e60b47f46e97bbf","2010-06-20 12:38:08+00:00","SCI: implementing reading of parameters for kPalVary(init) for argc 4 and argc 5

svn-id: r50075
"
"871c9bdddeaee6756f5c8d943c2ff8ed337abd4d","2010-06-20 13:15:45+00:00","SCI: removing unneeded parameters inside SciPalette, cleanup of SciPalette

svn-id: r50076
"
"30f6e7824bad89293db3a43b6d67657862a03c51","2010-06-20 13:25:08+00:00","SCI: update sys palette timestamp only on kDrawPic in SCI1.1, fixes intro of island of dr. brain

svn-id: r50077
"
"d2a3f59bfb5d27c5524a4bd59a789378f7bd09e6","2010-06-20 13:30:40+00:00","SCI: update timestamp like before for inbetween SCI1.1 games

svn-id: r50078
"
"15ae4d8f595346dffde8be6b186fc696f28c8900","2010-06-20 13:38:24+00:00","SCI: fix r50078, we need to update timestamp for inbetween SCI1.1 games, but not on kPortrait palette changes

svn-id: r50079
"
"f58c69e65d8dfa7ca924885d86043b84b18a522b","2010-06-20 14:46:00+00:00","Commit slightly modified version of patch #3018727: fix subtitle options (thanks fuzzie).

svn-id: r50080
"
"7ce739f51b1556e211bffc3f82617013afe23cb8","2010-06-20 15:01:31+00:00","SCI: kPalVary - cleanup and some more code

svn-id: r50081
"
"b016c16300577ae29d5a78e5be532cef3d4e21ce","2010-06-20 16:31:24+00:00","SCI: some kPalVary support - intro of island dr. brain works fine now

svn-id: r50082
"
"8fcb14d235cc4dbfc25eb503d197ff5c2f268179","2010-06-20 16:36:34+00:00","SCI: adding kPalVary update call to kFrameout - it's getting morning now in gabriel knight 1

svn-id: r50083
"
"e8262d989e31742f554d37c962254c6ac37a1a7f","2010-06-20 16:48:52+00:00","SCI: adding code for kPalVary ticks == 0 case, fixes pharkas

svn-id: r50084
"
"7ecff0a300e2e8a809818472160121743971e17a","2010-06-20 17:08:39+00:00","SCI: implementing kPalVary(2)

svn-id: r50085
"
"bb1358ae3b224d8cdb1a870778e75334a691cf13","2010-06-20 17:14:58+00:00","SCI: adding info about kPalVary(8) being SCI32 exclusive

svn-id: r50086
"
"ff785325ad3527394cec06fbd9dc331854e97f30","2010-06-20 17:17:46+00:00","Sort planes in kFrameOut by priority and keep plane/item priority separate as they represent two different things. Fixes various SCI32 graphical glitches. Most (all?) remaining glitches are because we don't yet handle kSignalFixedPriority.

svn-id: r50087
"
"2cce1d08fc39e649538061ab4bf2c71a88a631a6","2010-06-20 17:20:22+00:00","added data-directory for testbed

svn-id: r50088
"
"3c6639eb86e8328af84c190878b09c331fe4c1ac","2010-06-20 18:20:05+00:00","SCI: implemented kPalVary(reverse) for pharkas, although there is a bug somewhere, not working 100%

svn-id: r50089
"
"05e2bbcc333afd73a5671980a90f70e0e0fb9506","2010-06-20 18:22:49+00:00","SCI: dont display string set by kSetQuitStr

svn-id: r50090
"
"d37a25cfee6832e7b92abaa693531e496b83a3c2","2010-06-20 19:18:33+00:00","SCI: cleanup of SciPalette

svn-id: r50091
"
"a22e294ca674a2e879b31eff877fc30d256965d7","2010-06-20 19:39:08+00:00","SCI: displaying debug warning again for kPalVary(init)

svn-id: r50092
"
"3a9217dd5a2b1f9376f65111f8b975c07d50a9ad","2010-06-20 20:05:00+00:00","SCI: disable palvary when reverse is fully done - fixes palette getting stuck in pharkas (the broken palette in there is actually not caused by palvary, it was just overwritten before by view palette updates and those dont occur when palvary is active)

svn-id: r50093
"
"66b9eaac34d3eefc12cf6dcbacf2eb8192e0de81","2010-06-20 20:09:07+00:00","SCI: adding timestamp update for frameout, fixes gk1 windows main menu

svn-id: r50094
"
"d79428e816af4a73a21d6c350c5a266af01a08de","2010-06-20 20:36:14+00:00","GUI: Tweak low-res Launcher layout (1-2 more games visible in game list, less space wasted between buttons)

svn-id: r50098
"
"4a83b2c5f6a0b43c25d8870168baca9a76eee103","2010-06-20 20:52:31+00:00","SCI: properly implement kPalVary functionality within kDrawPic and transitions, so pharkas finally works w/o palette corruption

svn-id: r50099
"
"6f195ae5a4c862fede87126e2587b0fdc2952827","2010-06-20 21:12:15+00:00","SCI: implemented kPalVary(changeTicks)

svn-id: r50100
"
"7694993bef7a1c60e7e6413b09d54d2808bb699b","2010-06-20 21:14:46+00:00","SCI: fixed typo

svn-id: r50101
"
"72534afea9696316c61c2b647f87638a34c2f57e","2010-06-20 22:30:20+00:00","Ignore the broken 65535x.map file in the QFG4 demo, mistakenly picked up when checking for patches. Audio now works there.

svn-id: r50102
"
"473ae1c11efd6833fd0a9172b9fc54ee6ef66211","2010-06-20 23:41:54+00:00","Cleaner fix for the QFG4 demo audio map problem.

svn-id: r50104
"
"cbd36ff78dbb5571adb9095605b03a2d93c3a38b","2010-06-21 07:37:00+00:00","added a zip file and a script to create desired directory structure

svn-id: r50106
"
"98196b8af672ecbf42738487e659fe905163819a","2010-06-21 10:14:04+00:00","SCI: GfxPalette::kernelSetIntensity() now also triggers throttler - somewhat 'fixes' lb2cd when selecting play game

svn-id: r50108
"
"8fce6600904e2094de6488e01540fca1433b1530","2010-06-21 10:40:48+00:00","SCI: also set throttle trigger on kPalette(animate)

svn-id: r50109
"
"cfcf53bec0f566d8fc20c5ba75ccdc00ba62ee86","2010-06-21 10:51:14+00:00","SCI: fix regression of r50073, allNotesOff() now directly sends to driver again. If we send to queue, queue will never actually get processed and even if it was, the channels wouldnt be mapped anymore anyway

svn-id: r50110
"
"3c857be0c5cf397d364f9a6e23a095cfef0cda04","2010-06-21 11:51:19+00:00","PSP: switched loader to use PSP's debug mechanism

svn-id: r50111
"
"57b8e2caaabebde88eb46d0d85d3c09414cdc778","2010-06-21 13:23:13+00:00","PSP: removed default 'using ME' message

svn-id: r50112
"
"b5a25a6e1988c11929fe68cc9e5786bf738b21ce","2010-06-21 13:58:51+00:00","PSP: errors from both ScummVM and the PSP port now print to file by default. This should make debugging easier, especially for users.

svn-id: r50113
"
"faef4ab349df5cd206fe2e5dfc666f76be3b60ec","2010-06-21 14:44:18+00:00","Check against the signature of Groovie v2 cursors with MKID_BE, makes it easier to see what it's doing.

svn-id: r50114
"
"4a4fcb19dd85cd8f3ffc63ef44f033d21b50744e","2010-06-21 15:05:48+00:00","SCI: added fixme about r50110/r50073

svn-id: r50115
"
"65fe8d817c627fe56929533a4a0fb4d2c5cb76c2","2010-06-21 15:13:36+00:00","PSP: moved RTC to singleton to allow usage by classes other than Osystem

svn-id: r50116
"
"9ecbffe11aee736c0a3783358fb2640b0d6f5237","2010-06-21 15:51:04+00:00","Add a workaround for a MUMG script bug, MUMG now works again.

svn-id: r50117
"
"0ab7a16e452f5244d37dc0426f62b5b05d12f032","2010-06-21 19:07:41+00:00","Fix the Hoyle 4 (Hoyle Classic) demo's top offset. It currently errors out later from lacking a selector (static selector problem).

svn-id: r50118
"
"6110f16b295e90e50042c7142a26115ef5b3a291","2010-06-21 19:09:19+00:00","fixed couple of leaks in testbed/fs.cpp, removed some unecesarry code from graphics.cpp/graphics.h

svn-id: r50119
"
"38b172e8e5339c867fe66c69d9ef70d26c20ebf3","2010-06-21 19:32:25+00:00","Fixed some Cppcheck warnings. (There are plenty left, if anyone's wondering.)

svn-id: r50120
"
"97dd94019cc668342ea52603891d706f3fbab5e3","2010-06-21 20:17:59+00:00","When loading or restarting, stop script processing if the game is being loaded or is restarting and the stack position has changed (it's always changed when loading) - fixes the case where the VM is trying to parse an invalid script

svn-id: r50121
"
"9d5d9e13aea2e5c34ec237e735152427dd40b65c","2010-06-21 21:25:13+00:00","Fixed the demo of Hoyle 4 by adding two selectors it needs 'syncTime' and 'syncCue'. Usually, games that need them are CD talkie versions which have a selector vocabulary, but Hoyle 4 is an exception

svn-id: r50122
"
"e86f732a7b67b6df6d78000d0f34ca8013b93b46","2010-06-21 21:26:07+00:00","crash with 3x sacling with cursors of odd dimmensions

svn-id: r50123
"
"df569a6c822f3893c9daeee649fde7a974ee1cd2","2010-06-21 21:32:56+00:00","AGI: Change AGI commands/opcodes to member methods

svn-id: r50124
"
"e7da62763ecb26a35b2a4624226a8ee2bf79a853","2010-06-21 21:33:22+00:00","AGI: Turn timerHack and curLogic into AgiEngine members; get rid of some #defines

svn-id: r50125
"
"c7a9865a73eae69e73fb8a67bffbbe2286074a8c","2010-06-21 21:33:45+00:00","AGI: Change a static var to member var AgiEngine::_lastTickTimer

svn-id: r50126
"
"49448af6cb2613460fe37caf79bdb1ed4c206715","2010-06-21 21:34:06+00:00","AGI: Turn some more AGI static functions into AgiEngine methods

svn-id: r50127
"
"bbad3f333a9227ccb1de633a0fe92d9e01ad7bb3","2010-06-21 21:36:36+00:00","Patch #1956501: 'GUI/LAUNCHER: Midi device selection'

svn-id: r50128
"
"6c854f30da2579c8e7059948c700fd0bcc72366d","2010-06-21 21:37:00+00:00","PSP: Whitespace fix (and rewrap overlong line for readability)

svn-id: r50129
"
"1041067a0c1ca2ac528338d99eaa1df677538265","2010-06-21 22:07:03+00:00","SCI: instead of queueing inside midiparser, we are queueing now globally in SciMusic, also some little cleanup

svn-id: r50130
"
"b5dffc5aa33466bdaf5bd06c4a24d7b1b4194ff3","2010-06-21 22:15:33+00:00","SCI: fades already send out commands directly

svn-id: r50131
"
"727841ef913bbf61d035847b705ba47e488c57aa","2010-06-21 22:58:33+00:00","In SCI32, kDoAudio subop 10 is no longer CD audio. Just stub it off for now.

svn-id: r50134
"
"e3b3641db22ba38177a66d2ff73f342075f0687b","2010-06-22 05:10:43+00:00","Finish implementation of the jspit elevator logic.

svn-id: r50136
"
"53b82298e8236938d8724f904d2baba1f67b9eb1","2010-06-22 08:57:25+00:00","Stop saving the buffer, script and heap sizes of each script in saved games

svn-id: r50137
"
"019657fcd6278906a4c96425c438cc98808fd172","2010-06-22 14:03:55+00:00","Fully implement xvga1300_carriage, the gallow's carriage is now fully usable.

svn-id: r50139
"
"0012b23e8471135c7c5dcff5311db60c0164a881","2010-06-22 14:39:51+00:00","modified the filesystem test, added a script to directly create the game-data-directory, no zip file required

svn-id: r50140
"
"5855cd7127c9c7b40a67dd9d8aecbd065fc231b9","2010-06-22 15:01:45+00:00","The volume subop of kDoAudio returns the previous volume in SCI2.1, but not in earlier versions

svn-id: r50141
"
"c28fa2cf196eec983ad2b33b4f5ca9e607a9652d","2010-06-22 15:03:19+00:00","Reverted the code which handles objects without a base object when loading, for now. This possibly indicates an issue related to the garbage collector

svn-id: r50142
"
"a82ca9de5cd207e9c00b41277e8a3e1e3869e254","2010-06-22 15:05:09+00:00","SCI: change midi queue to Common::Array and make it resize itself if needed instead of error()

svn-id: r50143
"
"bb9f556c363718959a43c7a65cec1944b626d358","2010-06-22 15:18:55+00:00","Add support for the QFG3 demo audio map and audio resources. Based on a patch by Walter.

svn-id: r50144
"
"46ec88f74d9b7596cee2e6a167b1ccf361771601","2010-06-22 15:30:41+00:00","GUI/LAUNCHER: This should fix the regression concerning pc speaker / pcjr support caused by patch #1956501

svn-id: r50145
"
"66c286d096503bf54cce16a1920fa96b9a46228e","2010-06-22 15:33:46+00:00","SCI: kPalVary(setTarget) now triggers an error

svn-id: r50146
"
"3c4bfa6caccb8beeb5c603865879da7f6b31c556","2010-06-22 15:45:59+00:00","SCI: removing unneeded capacity uint from r50143

svn-id: r50147
"
"3a2cd87c454924c45edf671bc3b118a9599bee8c","2010-06-22 16:08:57+00:00","Add '2gs' to tools/md5table.c (this is used in tools/scumm-md5.txt, but was not added to the tool)

svn-id: r50148
"
"90a1d7c609760830fb9c94c574c2f7c6aa694321","2010-06-22 16:09:27+00:00","SCUMM: Add Japanese FOA CD version from tracker #3017219

svn-id: r50149
"
"33347e12bd94552a0c100351747b6c693d144f68","2010-06-22 16:09:50+00:00","SCUMM: Add a debug message to detectGames() to help find filesizes of detection files

svn-id: r50150
"
"5b24d39cdd94889e223d41acfea395414b608040","2010-06-22 16:10:16+00:00","SCUMM: Specify various file sizes of detection files

svn-id: r50151
"
"0a757c185fc513a5f846545ab3055ec4fcfe4b78","2010-06-22 16:42:49+00:00","Remove some trailing tabs.

svn-id: r50152
"
"9ca43423b478561d17716ae2537f6b232f625c74","2010-06-22 17:05:00+00:00","SCI: kPalVary(SetTarget) implemented

svn-id: r50153
"
"079e5c3135aea031a23401c39110cc883c421112","2010-06-22 17:13:44+00:00","SCI: fixed typo

svn-id: r50154
"
"3a394793b6ef84d3bf200c7aac276ac39f8dc36f","2010-06-22 18:25:15+00:00","Fixed 2 crashes in QFG1VGA, when dying:
- Ignoring a non-game breaking script bug (modifying the 'longSong' object with argc = 2)
- Don't pop the callk stack frame if the stack is empty - fixes a crash when restoring from the death screen

svn-id: r50157
"
"78fb62bcdf8c54a4c6024aa160641f6a196ebcf4","2010-06-22 18:27:00+00:00","LAUNCHER: hopefully fixed music driver selection via command line

svn-id: r50158
"
"56bf0c0e635383929704ba12df3808f39aeb697e","2010-06-22 18:33:19+00:00","Fixed kMergePoly after discussing with waltervn so that it correctly returns a pointer to an empty (for now) polygon array. This means that you can walk over enemy bodies after killing them in QFG1VGA, but at least it fixes the crashes after killing monsters

svn-id: r50160
"
"38cf6aa3e4c0415f507f5ec514834440bfbf90ca","2010-06-22 19:01:43+00:00","SCI: implemented kAssertPalette and a palvary fix for ::set, fixes erana's place in qfg1vga nighttime

svn-id: r50162
"
"33b991ee9d987acf013606341a60c8e3ff95ca77","2010-06-22 19:21:05+00:00","Groovie: Add support for the compressed MIDI files of T7G Mac.

svn-id: r50163
"
"99807b88945082ac029710c4ab9be5322c04e0ea","2010-06-22 19:39:30+00:00","Fix uncompressed MIDI in T7G Mac.

svn-id: r50165
"
"a836f965f8c313fad8d3f36b94ccec4bf5c0c00b","2010-06-22 20:40:41+00:00","SCI: set offTop to 26 for mixed up fairy tales to fix all sorts of non-fully-removed windows

svn-id: r50166
"
"f444d451169cdcf7e3dd2deef146e5a26e73bd49","2010-06-22 20:49:38+00:00","some more filesystem related tweaks

svn-id: r50167
"
"93b2336aa2ed65bcc1cca1db878dc0d07dc0fc2f","2010-06-22 21:01:34+00:00","SCI: demo of fairy tales uses regular offTop

svn-id: r50168
"
"d8968ee5b95d62fd357dfec163436f7f164e5244","2010-06-22 21:05:34+00:00","SCI: reversing r50168, demo is using the same offTop as well (demo.bat)

svn-id: r50169
"
"04c04ff01ee4e6288d8600661c67aebee8b959b3","2010-06-22 21:24:52+00:00","SCI: eco quest 1 demo also uses inbetween sci1.1 interpreter, fixing graphics

svn-id: r50170
"
"b68180efe525c37f48a81ce7946d9e6f2045cf07","2010-06-22 21:58:55+00:00","SCI: added nicks picks sq to the sci1.1 interpreter games, the other ones may also use the same interpreter, but we currently can not verify

svn-id: r50172
"
"717005bf25b6e74f22418324845f363eb4a1068d","2010-06-23 10:11:01+00:00","Rewrote the MADS animation frame decoder to better guard against invalid data causing memory overruns

svn-id: r50174
"
"3569b496622a61eb7d82c3033b188c4cd0426ae6","2010-06-23 11:22:44+00:00","Changed some asserts to warnings

svn-id: r50175
"
"fedc06060594c4f9fbd1db4511c513eb3926d135","2010-06-23 11:28:53+00:00","Corrected newly added palette conversion warning

svn-id: r50176
"
"3cdd841192d840be6094aefa3b89eee582375946","2010-06-23 11:32:36+00:00","Made a warning more verbose

svn-id: r50177
"
"f0145e6dcd3f96225be7fc6c5b8aebce9ee545d8","2010-06-23 11:47:14+00:00","SCI: implementing boundary checking for GfxPalette::createFromData(), sq5 has a broken picture 0 resource, which would result in either crash or at least bad read from memory depending on whats read there

svn-id: r50178
"
"3bc011357bba0104de2e7f910cde6a7d62d7581f","2010-06-23 12:58:14+00:00","SCI: some initial work on global scaling

svn-id: r50179
"
"eeba2812c1a950380ea3ea8766704ced11afaffd","2010-06-23 13:42:09+00:00","SCI: adding some more global scaling code, adding vanishingY and vanishingX as selectors

svn-id: r50180
"
"c1d3fd670c34b751c5e7a4236c14cb72ca973548","2010-06-23 14:06:31+00:00","SCI: global scaling implemented (hopefully, i'm not sure if it works 100% :P) thx to waltervn for telling me the vocab 994 stuff used for disassembly

svn-id: r50181
"
"db6c7a3deee4f9e312c8dcead3e7e32baddf4166","2010-06-23 15:08:23+00:00","Removed a hack with SCI1.1 static selectors, and set them properly. This fixes scaling in the demo of QFG3

svn-id: r50182
"
"0a102981f004733c9e7956ae58b4d0050db38e2b","2010-06-23 15:23:37+00:00","Moved the SelectorCache struct inside selector.h, where it belongs, and fixed some header dependencies in the process

svn-id: r50183
"
"496905dcc3f0871ef763de133010dc3b996de21d","2010-06-23 16:49:03+00:00","SCI: dont write palette in reorderView() if there is no palette :P

svn-id: r50184
"
"e39f2ae1c19ecc1bf42a20ab1eb430e09e46ef52","2010-06-23 16:53:56+00:00","SCI: adding cnick-longbow to inbetween sci1.1 in GfxPalette

svn-id: r50185
"
"e7634ee147323f1c698cc87671d5f49d40a16526","2010-06-23 16:58:42+00:00","SCI: it seems that all cnick games are using the inbetween interpreter

svn-id: r50186
"
"72ee20bc4d2aa4326530d1f91f2c5e5b3f6fa5db","2010-06-23 17:05:54+00:00","SCI: cnick-laurabow & cnick-kq are called with -Nw 0 0...

svn-id: r50187
"
"6d1f2d1d26ed1faad4c55aa8b4e71a290f0137fa","2010-06-23 17:30:18+00:00","Fixed memory fragmentation warnings in Crazy Nick's games

svn-id: r50188
"
"51ba34df0e7fce4f9760de9c2b3c0da77d605e06","2010-06-23 20:13:33+00:00","SCI: we extended the showBits() rect all the way depending on where the object moved, fixed - fixes kq6cd flickering coin and pq1 flickering locker issue

svn-id: r50190
"
"3838197ac14be050f1b2db5e1f26d82052dbd331","2010-06-24 01:29:46+00:00","Silence gcc warnings.

svn-id: r50197
"
"7c9cbf75c0ed6e66b5c7875f5e7657313b943a5c","2010-06-24 05:31:07+00:00","Implement the rest of xvalvecontrol for the boiler puzzle in Riven, initialize a variable for the boiler platform switch.

svn-id: r50200
"
"f65c4f988639b1ba5e6b2a95174aef3ec7fd8941","2010-06-24 07:32:34+00:00","Changed an error in LocalVariables::dereference() back to a warning, as it occurs in 2 places during the intro of LB2 (called from kMemory(peek))

svn-id: r50202
"
"bbb29e2650bf9b51818e710fb177b6b19894c1fe","2010-06-24 07:54:02+00:00","Fixed script 140 in the Island of Dr. Brain by adding a workaround for it inside op_link

svn-id: r50203
"
"70e9df9566007a495f5b77fa6ee4c6d31efdbe15","2010-06-24 08:15:31+00:00","Corrected incorrect variable name change

svn-id: r50204
"
"cd8bec1ae28c89f89fa8e4707a81b2947bd9ebc5","2010-06-24 08:16:40+00:00","Corrected rendering of sprites into a scene background

svn-id: r50205
"
"aa0c86e7557fbe68d33dec52139015562004742f","2010-06-24 08:17:46+00:00","Bugfix for correctly decoding 2-bit encoded depth surfaces

svn-id: r50206
"
"0fb54293181d76d5b84cb7da5ff54c883630bf86","2010-06-24 09:52:08+00:00","Initialize the stack with 'S' or 's' characters, like SSCI does (ultimately, we should not change the stack again like we do in op_link - this is what Sierra is doing). Some cleanup

svn-id: r50207
"
"afffcec96ec03a0e39d692080849e2e36722637a","2010-06-24 11:29:26+00:00","Turned two hacks inside validate_property() into errors till we find out where and why they occur (they shouldn't occur).
Also turned an error inside send_selector() when argc > 1 into a warning - these are usually script bugs and aren't fatal

svn-id: r50208
"
"9a3ef9b8e17151993c9b1a6f79fd97ec058a4cc9","2010-06-24 11:50:25+00:00","Initialize properly paramCount in gob1. This fixes several valgrind errors, and the unknown opcodes are now skipped as expected. (related to bug #3018918, only partially solved)

svn-id: r50209
"
"0722d96a3e249a7efe853d77b1432100912499d1","2010-06-24 11:52:08+00:00","SCI: fix kTextSize to not crash when destination has an invalid rect in it

svn-id: r50210
"
"f93ca1e4242da27079e6ce4cd4d4e8d569984ec4","2010-06-24 11:54:33+00:00","SCI: implement detection for uninitialized temp variable reads and implement direct fixes for them, i couldnt figure out a valid replacement for island, pharkas and laurabow2 work that way. this should also get changed to a replacement table

svn-id: r50211
"
"e5f22da0510065f1d38cfe745c49873f07de6904","2010-06-24 12:25:47+00:00","SCI: added objectname and method name printed out when uninitialized temps are read

svn-id: r50212
"
"898c9165d9a7f110b674a8bee82d30090a6010bc","2010-06-24 12:32:41+00:00","SCI: added currently known object/methodnames in comments for uninitialized reads

svn-id: r50213
"
"e45ffc68a32a13e81e7d12d3f43750f91e71cf91","2010-06-24 13:17:45+00:00","SCI: created a workaround table for uninitialized reads, removing old commented out workarounds for pharkas and laura bow 2

svn-id: r50214
"
"3fcb833148528e7f1e8b5e54668cb9bd99c17afb","2010-06-24 13:20:21+00:00","SCI: fixed workaround table from r50214 to have a valid terminator, also added another fix for pharkas

svn-id: r50215
"
"a268d3462b361588f60fba81e37d9bf5f048ccbc","2010-06-24 13:30:20+00:00","SCI: change fix for island to make it work

svn-id: r50216
"
"4b2661c06a77d36fe6e22fc9d55ab6a93b946675","2010-06-24 13:38:24+00:00","SCI: removing warning for known uninitialized reads

svn-id: r50217
"
"59c908e97d8c2c71e4823cb04059f7bc56e3c414","2010-06-24 13:44:27+00:00","Changed a warning which seems like regular SCI behavior into a debugC

svn-id: r50218
"
"6a811a8ae69332bb181a65777f08a39d6f420abc","2010-06-24 13:45:31+00:00","Added more information concerning the Dr. Brain uninitialized read

svn-id: r50219
"
"b243a93932ae6111d676799ce891ae63a97b0c94","2010-06-24 15:27:28+00:00","added palette rotation test

svn-id: r50220
"
"00e88f15e3772eca43c7a8034bc4a31806eeb1dc","2010-06-24 17:02:55+00:00","SCI: arg5 is map for graph(updateBox), added comment

svn-id: r50221
"
"b8e2e8e5ddf21a9b27bbc74e6658b637b092de9f","2010-06-24 17:10:26+00:00","SCI: added uninitialized read for room 720 in lsl1

svn-id: r50222
"
"7edbcc26f75e9953d3ed8225e351d398cf9099fc","2010-06-24 17:48:15+00:00","Cleanup uninitialized read workaround(s).

svn-id: r50225
"
"346c3a3230cf19a3fe9b0306634864f8dfa60faa","2010-06-24 18:17:36+00:00","SCI: added uninitialized workaround for sq4cd

svn-id: r50226
"
"42ca630f46f0991f58592c7b2195ff41bdd73b04","2010-06-24 18:48:50+00:00","Fixed the LSL3 binoculars scene again, by fixing the invalid varselector reference

svn-id: r50227
"
"381a862d61aa06c02f90071eeefffb28db3fcb4e","2010-06-24 20:01:31+00:00","SCI: partly reverting r50208, iceman has script code (fred::canBeHere) that asks for property 380. sierra also returned a zero when going out of bounds (see gregs engine object.cpp, ::getPropertyN - fixes iceman, lsl3 and probably more

svn-id: r50229
"
"b0fde0a1f6009432e1e5af8771176eea327af887","2010-06-24 20:03:32+00:00","SCI: removing debug warning to show processes opcodes, accidentaly commited

svn-id: r50230
"
"e8d31ccc078b4144ae073881b79517bae2b0cb07","2010-06-24 20:10:51+00:00","SCI: fixing the tortoisegit commit disaster :P

svn-id: r50231
"
"893429d092cd10a490d14beff74217a6080d1f5a","2010-06-24 20:40:57+00:00","SCI: correctly put NUL inside SegManager::strncpy() even when using n = 0xFFFFFFFFU

svn-id: r50232
"
"35b5da7e0fbc2ee3b3b81c2a0371ac57a00dc856","2010-06-24 20:52:35+00:00","SCI: reverting r50232, didnt make sense. thx @ wjp for noticing

svn-id: r50233
"
"a03afd18985ffef220ffbdce3ea4c66c035609da","2010-06-24 21:09:38+00:00","SCI: Make kStrAt clear segment when writing characters

This is necessary since the uninitialized value detection from r50211,
and is analogous to seg_manager.cpp's setChar.
(Triggered in LSL3 age verification.)

svn-id: r50234
"
"06a65d5c331bd009827f9fa711f7cdf5cc7905eb","2010-06-24 21:32:29+00:00","SCI: better initialize temp variables with FFFF:0 instead. foreign lsl3 uses kFileIO(readraw) and then kReadNumber directly. In that case we would produce many warnings because no terminating 0 is found

svn-id: r50235
"
"f014c9ed7ef5a193ce17ba870698a389a65a985a","2010-06-24 21:42:08+00:00","SCI: ignore segment 0xFFFF in segmanager getchar, when offset > 1 - so we dont write a warning, if the scripts use some uninitialized temp variable as terminator

svn-id: r50236
"
"aa3bfe5489f45f922574265d21a9aa8059e5b208","2010-06-24 21:46:57+00:00","SCI: doing the exact opposite of r50236 code-wise now, as it was meant to be

svn-id: r50237
"
"c96991d991ed46fe7d79bde67d21808cf03969d1","2010-06-24 21:59:03+00:00","Added some consts to the output of tools/po2c.

svn-id: r50238
"
"63cab52b854bedb33d5b2ef478c7f2568440a589","2010-06-24 21:59:27+00:00","Adapt po2c's output to better mach our code formatting conventions.

Along with it I added a suffix '-scummvm' to the version variable,
since we also feature some custom extensions like the charset
specification.

svn-id: r50239
"
"a5fb4fec2e71f252d5f7aa2b8d09165ce46fa3fa","2010-06-24 21:59:50+00:00","Some more cleanup of po2c's output.

svn-id: r50240
"
"968e10795ffdf2e17a7ca678ca5e303b0d265795","2010-06-24 22:00:20+00:00","Do not include any headers from common/messages.cpp, since that file might be included into an namespace.

svn-id: r50241
"
"17a96b3bd2f0c24fdf581aac8cffabb575fd8c82","2010-06-24 22:00:45+00:00","Yet another slight variable renaming to match our conventions.

svn-id: r50242
"
"e7f3ddf2dbb379ee41d82347f928d5f8d6f0e60d","2010-06-24 22:32:52+00:00","Cleaning the header of the french translation file.

svn-id: r50245
"
"d783ca972abee9702e6abf31f13188fc59d7d32d","2010-06-24 22:33:49+00:00","Disable addition of 'SCUMMVM_SVN_REVISION' to the version string, in case --enable-release was specified on configure run.

svn-id: r50246
"
"04ae0bcf585a397719f6b9e66e38f5efc17c2b0e","2010-06-24 22:36:21+00:00","Add German translation from patch tracker (patch #3020282).

svn-id: r50247
"
"ff47de5cd1a3323466973a2fbff1815ec687754f","2010-06-24 22:37:30+00:00","Add credits for the translations.

svn-id: r50248
"
"ff33acb132c3d7f15060e528c7ac4bf34321807e","2010-06-24 22:55:24+00:00","Fix build with --enable-release.

svn-id: r50249
"
"1e29dc3641919ecca4589ba40df7789e6758c037","2010-06-24 22:55:44+00:00","Fixed use of uninitialized variable.

svn-id: r50250
"
"dfd8ecc55c143963612467e599f57b96cfc5b62f","2010-06-24 22:56:32+00:00","Gives proper credits for the Hungarian translation. Also remembered to update the website credits this time (it was also missing the Android credits by the way).

svn-id: r50251
"
"1e224366867490c9f0a02e3864b02f095be197e7","2010-06-25 03:48:28+00:00","added code to test 16+ bit pixel formats

svn-id: r50257
"
"550209d1e6468a575fa980144389eda64eddb730","2010-06-25 09:57:37+00:00","Removed the game ID check for embedded priority in icon controls, and replaced it with a check for priority existence

svn-id: r50260
"
"c6b0a5e8962297cfd808c708ff3e1022a875fd18","2010-06-25 10:04:31+00:00","SCI: detect, if SCI1.1 game is merging or copying palette instead of using gameIds. Also prints method used, when using debug command 'version'

svn-id: r50261
"
"279da6ac48c1d68d724cbb46e560a7439be8a4d8","2010-06-25 12:15:36+00:00","Added workarounds for two issues which appear when throwing the water at Orat in SQ1, room 28

svn-id: r50262
"
"494a7fa8abc41915b70f37047149e23fa1980e25","2010-06-25 12:43:43+00:00","Extended validate_read_var to check for parameters too, and fixed the uninitialized variable in SQ1 there

svn-id: r50263
"
"bc3a7ba915221b130bfb6390c1dedf86dac81c95","2010-06-25 14:49:11+00:00","improved the pixel and other gfx tests

svn-id: r50264
"
"df37aff35756e03e02b47ce3483b06679a662ce6","2010-06-25 14:50:10+00:00","Added the SCI2.1 kText kernel function (subop 0, kTextSize for now)

svn-id: r50265
"
"2b43c3a668485a0a382d7c627b2fb281865e0cd4","2010-06-25 14:50:27+00:00","SCI: changes to the op GT workaround

svn-id: r50266
"
"159958fbe233c1b58b4df4cd3fcacffd9d40f7c2","2010-06-25 15:06:00+00:00","Some more info on kText(), removed dead code

svn-id: r50267
"
"e55686590e2ca6a6e7eeca7a73def9dd3a0722c9","2010-06-25 15:28:24+00:00","Removed the checking of parameters again (it's wrong, as it happens after, instead of before) and restored the workaround for SQ1 in op_add again

svn-id: r50268
"
"8ff6a709fbe72bbd2d1ac53623558a2ed0e6c2a6","2010-06-25 16:04:37+00:00","SCI: when writing to a temp, check for segment 0xFFFF and remove it. This fixes a false-positive uninitialized read error in room 44 sq1

svn-id: r50269
"
"7d4d58bab41249e9a29c42c0f2715ff5e1c1d6cc","2010-06-25 16:08:34+00:00","SCUMM: Set some more detection file sizes

svn-id: r50270
"
"1e9977a725ca24a2d31cac56b0587bae09ab5b3a","2010-06-25 16:11:00+00:00","SCI: Restrict some 'error' exceptions to the places they occur; cleanup

svn-id: r50271
"
"23d384e6b88f4023b9150401a70a4efdf9bae018","2010-06-25 16:12:38+00:00","SCI: Remove SciEngine::getFlags()

svn-id: r50272
"
"6ee82a20276d213a06d43ff731d197f5a92a09d7","2010-06-25 16:16:29+00:00","SCI: Introduce SciGameId enum

svn-id: r50273
"
"b188fc14a2591e480c0fb4a16558ef0a2aacd3a3","2010-06-25 16:43:09+00:00","SCI: only send new volume to currently mapped channels, fixes assert in sq1 because setVolume is called on an object that's currently not playing. added fixme

svn-id: r50274
"
"ab19e874147da865aab63ee89c50ef21bb687613","2010-06-25 16:54:03+00:00","Removed all of the non-validating code - there's no real point in removing script validations

svn-id: r50275
"
"b6d1b3bc0b2c4e3edbc49a73cb629313eb84c889","2010-06-25 17:13:47+00:00","Do not allow the VM to run on non-existent scripts (which shouldn't be happening anymore)

svn-id: r50276
"
"aedc77f0bddcfcd11e465ee29c5fc66973ef9f9b","2010-06-25 17:25:00+00:00","When loading a game, stop all running VMs recursively, and also stop kAnimate's current recursion. This fixes the invalid execution stack frame in SQ1, when loading from the death screen after dying from the acid drops in Kerona. This should also fix the invalid hunk pointers, thus the warning about invalid hunk pointers has been turned into an error, as it shouldn't occur anymore

svn-id: r50277
"
"69694f361977d8ae1908957e5fb9d4ad242bbf98","2010-06-25 17:59:48+00:00","SCI: changing workaround results for opcodes from signal_reg to make_reg(0, 1)

svn-id: r50278
"
"784f52a677aed3877b47371f6bbcb3e3ffa97393","2010-06-25 17:59:49+00:00","Removed the getHunkPointer error - it's valid SCI behavior (e.g. when loading/quitting sometimes, since hunks are not saved). We check for valid hunk pointers anyway, so there's no reason for the warning/error

svn-id: r50279
"
"be8a59666894364c04b127b7b97bfd6efdd08b35","2010-06-25 18:20:31+00:00","Add support for the third inventory case in Riven: you have the two journals but not the trap book (happens at the end of the game).

svn-id: r50280
"
"3962f8ba59925ea3ffa5e27e738c2edc9434b74c","2010-06-25 18:47:52+00:00","AUDIO: some fixes in the audio device code (no sound option, new GUIO flags)

svn-id: r50281
"
"e34d7342f54ff5d23273eeec15fe5d4934492749","2010-06-25 18:57:50+00:00","KYRA: implement new gui option flags

svn-id: r50282
"
"6561b93f1e15e4b78bbf62044ea145e866978eeb","2010-06-25 19:06:10+00:00","KYRA: fixed typo

svn-id: r50283
"
"4785e1fd3ffe2dbe862e9aafcf18eb2a10602bc4","2010-06-25 19:09:19+00:00","Renamed some variables

svn-id: r50284
"
"784c655e82f2e1f80bda0a40005ed91754dff844","2010-06-25 19:30:01+00:00","Formatting fixes.

svn-id: r50285
"
"6e27ad3b2bdafce93a5743bdacb932b711bd7ef2","2010-06-25 20:26:54+00:00","some more refinements to FS and GFX tests

svn-id: r50286
"
"683d54a74660745d6bd408788170b19adb08581e","2010-06-25 20:46:08+00:00","SCI: adding workaround for uninitialized read in sq1

svn-id: r50287
"
"c35e3505319977e56d1c413b39133dfedf6c1105","2010-06-25 20:51:57+00:00","AUDIO: get rid of MDT_PREFER_MIDI since it should be sufficient to either select MDT_PREFER_MT32 or MDT_PREFER_GM

svn-id: r50288
"
"e1a333570eb127fd9d16c1272cc9772d6f6b9559","2010-06-25 20:58:52+00:00","SCI: set MDT_PREFER_GM instead od MDT_PREFER_MT32

svn-id: r50289
"
"82bfb7b7bfce5fed14b8d0d1463a01f8cc8156fd","2010-06-25 21:03:53+00:00","added savegame tests

svn-id: r50290
"
"b96c0a1f0797812e45d1ee135d291556f9c60866","2010-06-25 21:04:22+00:00","SCI: fix typo

svn-id: r50291
"
"fc4fa25ec4272f6117ca32e3c3998b15de30eca3","2010-06-25 22:34:53+00:00","SCI: adding capability for detecting export-calls into valgrind-sci, adding workaround for export 1 of script 703 in sq1 (gets called from various objects)

svn-id: r50292
"
"56c6907477095d404523303330d4ceff9889a3be","2010-06-25 22:37:19+00:00","AUDIO: fix comments

svn-id: r50293
"
"56d9acad90588453837710775ab8fbb7649884a5","2010-06-25 22:48:55+00:00","SCI: implementing workaround for issue in room 58 sq1 (operation lt, doing comparsion against pointer)

svn-id: r50294
"
"e328bd8f7f95ae18be4ec6796baf14c1c8b17728","2010-06-25 23:43:07+00:00","Added support for Fab compressed sprite sets

svn-id: r50295
"
"5ba7be88b8641e8cc8b4760b44d87ddc7b1ed0f7","2010-06-26 00:28:29+00:00","Fix formatting again.

svn-id: r50296
"
"ab261facee90ede5dd7dd5bf38262745eef3e946","2010-06-26 00:36:43+00:00","Added extra validation for sprite decoding

svn-id: r50297
"
"70e4a8605b85abf3edb83afe2df0ca8992e79f20","2010-06-26 00:37:44+00:00","Minor bugfix for correctly positioning where background sprites are drawn

svn-id: r50298
"
"258494f03694362e2d0e63b6803dcb7eaabfaa21","2010-06-26 08:29:55+00:00","SCI: adding capability to resolve local calls as well for valgrind-sci, adding another workaround for a script bug in sq1 (this time export 1 gets called locally)

svn-id: r50308
"
"cf3a37585cfd333a10acfd5d2eae853c6c47ed6d","2010-06-26 09:34:14+00:00","SCI: making hack inside kAbs hoyle1 specific, added fixme

svn-id: r50309
"
"16f854ba644aff930236d4f3ed5c8e6be35a970b","2010-06-26 10:47:38+00:00","SCI: dont call midiparser->stop() if paused sound gets stopped

svn-id: r50310
"
"906b3221f58d71c0c73a9c60f9fd3feb7fcafaab","2010-06-26 10:51:38+00:00","SCI: removing fixme (issue got already solved)

svn-id: r50311
"
"d7fe98825154ede7beb0987ee3177ed46f1a3fa4","2010-06-26 11:14:38+00:00","Bugfix to dirty area handling to prevent creation of invalid rects

svn-id: r50312
"
"18d9f917a0be68327ed3b06da588a5804f42e54f","2010-06-26 11:16:25+00:00","SCI: set _driver to 0 in MidiParser_SCI destructor to stop the MidiParser destructor call allNotesOff() which would affect all channels all the time - fixes sq1 ship flying away sound getting stopped when ladder falls down

svn-id: r50313
"
"8eb206b6b97d172617902f92ea241af89dd22b5f","2010-06-26 11:31:04+00:00","Bugfix to correctly handle transparency when rendering scaled sprites

svn-id: r50314
"
"be75870100e7e411b35f70cd96a851d7e50c20da","2010-06-26 11:43:14+00:00","SCI: fixing deadlock possiblity on samples (sq3 deadlocked on door opening/where am i on me)

svn-id: r50315
"
"e4153044d42ec976699389956441020cc52d9005","2010-06-26 11:48:42+00:00","SCI: reverting r50315 - had the deadlock just again...

svn-id: r50316
"
"cb5d9f6af5f2c44907215490dff0ace4b2b134c6","2010-06-26 12:04:15+00:00","SCI: added workaround for island of dr. brain elements puzzle

svn-id: r50317
"
"a4f139c4d23845b622a2df427a375ca2953bbf66","2010-06-26 12:20:40+00:00","SCI: adding more comment for export workaround (sq1)

svn-id: r50318
"
"ba36675351e40b801458cf5563abf5d419922e15","2010-06-26 12:30:57+00:00","completed the savefile tests

svn-id: r50319
"
"3cc204f461bc08c16b6c8a0920c432355b4a4d74","2010-06-26 13:07:13+00:00","the ScummVM header included to all source files

svn-id: r50320
"
"783b71d58562c5a9a8eac23690e658931b086f1a","2010-06-26 13:28:22+00:00","Load the correct speech file pack for the intro of Rex Nebular

svn-id: r50321
"
"e537ce48bbbdbb0e322370c984e5f906052db003","2010-06-26 14:29:50+00:00","split testsuite.h into testsuite.cpp

svn-id: r50322
"
"21831b61832060855017d5b30dc277eaa333aef8","2010-06-26 15:25:47+00:00","GUI: If no language is explicitly selected and autodetection is available, select '<default>' (which is already in use) instead of English.

svn-id: r50323
"
"063cef0c284cda74f6ad366182818ac4d3dfca83","2010-06-26 15:48:03+00:00","GUI: Add and improve some messages to translate

svn-id: r50324
"
"691323f16e9661b50e0178046bd3b423bb79dc22","2010-06-26 15:55:40+00:00","Fix format string warning

svn-id: r50325
"
"0eb128ee471159cab8e8e4658bcbe98fa0a6b3ad","2010-06-26 15:55:53+00:00","Add missing include for translations

svn-id: r50326
"
"4102b4a682967d4753cf13e72b30842452988246","2010-06-26 15:59:06+00:00","GUI: Add the catalan translation

svn-id: r50327
"
"8008e09ea39e650e533fe49928ba7d75d16dafab","2010-06-26 16:02:40+00:00","GUI: Update translations after the last message changes

svn-id: r50328
"
"79b5e7d77e26da5b27a2dd6d8527ca47fd873b09","2010-06-26 16:21:28+00:00","SCI: fixing stupid torturegit conflict merge

svn-id: r50329
"
"41aca44b037c129d837021eb0d0e91990e41856a","2010-06-26 16:27:01+00:00","SCI: another commit for adding a workaround for islang room 300 again (although i already commited it already, stupid torturegit)

svn-id: r50330
"
"61295bcc4ef0426e772211fc0a5212796acab83f","2010-06-26 16:54:09+00:00","SCI: pseudo-adding workaround for kq5 room 25 witch forest

svn-id: r50332
"
"554640ee8a41fdfd29bbb4a710b7eae4255a2d8e","2010-06-26 17:21:50+00:00","Fix saving while viewing the inventory in Riven and cleanup the save/load code.

svn-id: r50333
"
"9a0e2e9c461547b1a2d8bf32a3e7ba52853358f5","2010-06-26 17:37:28+00:00","SCI: add another unint temp workaround for kq5 - when playing harp for the harpies

svn-id: r50334
"
"58fcda82f33e3ba8f813eeac412612ae09a34c9f","2010-06-26 18:07:41+00:00","Remove support for translation of console messages.

In recent discussions on -devel it turned out, that this
feature is rather superfluous and instead we should rather
implement a proper error reporting in our GUI.

I also removed the dependency on iconv along with this.

svn-id: r50335
"
"c2cb3bb79917c8a2993a3895deadae590107a1ec","2010-06-26 18:27:18+00:00","Add the page turning sound for the Riven journals and stub off the swipe transition used when turning pages.

svn-id: r50336
"
"2b9f4e5068081b3b172ac859648555f1f9bdecdb","2010-06-26 18:44:32+00:00","Gehn's cage should be closed initially, so initialize ocage to 1.

svn-id: r50337
"
"e5e90eb8a8078d108d9985e6303b3975f1b6da55","2010-06-26 19:09:45+00:00","Add a debug console command to Riven for displaying combinations to puzzles.

svn-id: r50338
"
"710fc6c71e21bb0b3b9f7f89cdaf9445450df2e2","2010-06-26 19:55:49+00:00","SCI: do boundary checking when loading sci1 sounds and mixing them together. The final end credits song (resource 699) in kq5 has some channels with invalid offsets, crashing ScummVM before

svn-id: r50339
"
"caded4f892905eb8821ba9431ec2119aab6facd9","2010-06-26 20:28:42+00:00","Improve readability

svn-id: r50340
"
"1ca0cdc8b105d4b6f033e1c0b8b0cdee996903fd","2010-06-26 20:47:28+00:00","SCI: fix warning

svn-id: r50341
"
"cea663adb6279b8693ae9cec5224dac131121b8f","2010-06-26 21:28:50+00:00","renamed the guards in header files

svn-id: r50344
"
"af755b0b3d732a0976b4c008b849ca907421d6eb","2010-06-26 21:36:25+00:00","Further improve readability

svn-id: r50345
"
"09b4f7cbed4f258a00822f2b135df475f6e1b398","2010-06-26 21:55:52+00:00","Define WIN32_LEAN_AND_MEAN before including windows.h.

This will cause our code to include less functionality, but might on the other hand fasten up the compilation.

svn-id: r50346
"
"25cb3092f4f2ee84fa26e0f31f81bccb861efe39","2010-06-26 21:57:13+00:00","SCI: added comment to vm-workaround table

svn-id: r50347
"
"578cdb2aeb0beff80eb57b4d9fcc504a69593d42","2010-06-26 22:32:51+00:00","Implement support for auto detection of the users preferred locale on Windows.

Note that this might break support for Windows versions older than Win2k,
at least according to the MSVC docs GetLocaleInfo is only supported by Win2k+.

I added a comment about that though.

svn-id: r50348
"
"14fdd11c04c587f5fe2abe446c49d178957f53db","2010-06-26 22:44:43+00:00","Fix compilation with our default build system when USE_DETECTLANG is specified.

svn-id: r50349
"
"ce111a39df155f379ec829f66a39498bee303720","2010-06-26 22:45:53+00:00","Add flag to set USE_DETECTLANG in create_msvc.

svn-id: r50350
"
"e2026f4a26c648482b1823938c2d4a496ed56375","2010-06-26 22:48:47+00:00","Zero out the memory pointer of a hunk when freeing it

svn-id: r50351
"
"b2f2c48c7e31d322399997f30d4e32369806f60e","2010-06-26 22:50:39+00:00","Added a workaround for broken script 377 in Castle of Dr. Brain, room 320. It constantly tries to free the saved area rectangle (underbits) underneath the popup window

svn-id: r50352
"
"b7ab6ca3f16b4371b1a99caf041d0998e1c10fa3","2010-06-26 22:51:13+00:00","Use 'C' on Win32 as syslang in case the locale could not be determined.

svn-id: r50353
"
"4ec0827551a9448a2020ae9112b5b000ffd0d009","2010-06-26 23:01:12+00:00","Add some explanation why we can not just use setlocale on Win32.

svn-id: r50354
"
"3dcebcb1bcf69bafc61ca4466b01237000533656","2010-06-26 23:01:22+00:00","Shuffled some functions around. Also, the filename in kResCheck can never be bigger than 9 characters, when dealing with VMD videos

svn-id: r50355
"
"3cf0114164aa07cdd2ae557ea49cf59a31ea5f67","2010-06-26 23:13:05+00:00","Moved script_instantiate_sci0() inside the segment manager, and renamed it to scriptInitialiseObjectsSci0()

svn-id: r50357
"
"7a14846bdd99dc81a70baa43836282af47205e16","2010-06-26 23:48:27+00:00","Removed the misleading getHeap() function (only valid for SCI0-SCI1), plus removed some unused defines

svn-id: r50358
"
"daab502028761f8da7a4f75a7bbd265f8127892d","2010-06-27 00:08:00+00:00","Cleanup

svn-id: r50359
"
"b161310193713f262dec017e11997ef77eac20c6","2010-06-27 01:06:51+00:00","Script workaround fix for bug #2917661 - Crash when interacting with D'Blah

svn-id: r50360
"
"ae332b620e13d554563a3a6f9b435ebde6761f7a","2010-06-27 04:19:55+00:00","Run possible cut-scenes before each location change.

This is the behavior of the original player.  It is not necessary to click on
the hero.

svn-id: r50361
"
"6a6091f6d7547d750985f6ee757d5b7c9c2d78b3","2010-06-27 04:58:48+00:00","Prevent execution of the STOP script command when its Zone does not exist. Patch #3021744 by fuzzie with some comments.

svn-id: r50363
"
"c922af06c2d209de13349d9938388242238fc744","2010-06-27 05:17:40+00:00","Centralised the update logic for the various system lists into the MadsView class

svn-id: r50365
"
"965cdb6fbf1d7db6ca839a9cb75be1821975d8b7","2010-06-27 05:18:21+00:00","Several bugfixes to the loading, display, and digital sound playing of messages during cutscenes

svn-id: r50366
"
"be399485cde37b84fa660b6f83c4adf29f6312c7","2010-06-27 05:30:18+00:00","Add Nintendo Wii (PAL) versions of Freddi Fish: Kelp Seed Mystery.

svn-id: r50367
"
"9a8683ac656e37a62ecf483f635424cc559d397a","2010-06-27 05:58:11+00:00","Added accidentally deleted line

svn-id: r50369
"
"c7682f5117c5286247fbaf50497c4b35e5f6817f","2010-06-27 06:35:32+00:00","Added proper conversion of message RGB colour values

svn-id: r50371
"
"b6b4247335c5cc0f82cdaf590b2bd93e22eb62af","2010-06-27 11:16:49+00:00","Workaround that corrects some bad frame data in the Russian version that was causing the several game crashes

svn-id: r50372
"
"0b6bd84aba372076c450dfefa89752a3c7778bae","2010-06-27 11:19:23+00:00","SCI: adding uninit workaround for lsl6 (Narrator::startText)

svn-id: r50373
"
"32ee0338f8309bddfe61cc23db934bfb4447cdc2","2010-06-27 11:51:44+00:00","SCI: better solution for the lsl6 uninit issue, we now go through all the parents till we find a working workaround - we can use Narrator::startText that way inside the workaround table

svn-id: r50374
"
"25ca058fa841f29b0e2999f446b9d6f8198d78e5","2010-06-27 13:06:22+00:00","Add support for Chinese The DIG.

svn-id: r50375
"
"6864d09d68b8e31f94ac802dd791a188523322d9","2010-06-27 13:15:01+00:00","SCI: Fix for large views in GK2. At least it does not segfault now.

svn-id: r50376
"
"d5bff2f5d40a756c48b29a3984e80231f312f41f","2010-06-27 13:25:06+00:00","GUI: Copy over fonts from the vendor branch, so they will lay next to the GUI.

It will be used for future support of locale-dependent fonts.

svn-id: r50377
"
"01bfcf98cc2bb5e135549b3e0cbdc4f3fe57e5ee","2010-06-27 15:50:51+00:00","SCI: debug command vmvars - adding acc support

svn-id: r50378
"
"d7f212647a115b011db7c37f5bcdd6a5eae62235","2010-06-27 16:02:03+00:00","Turned the error when failing to locate an invalid object back to a warning (KQ5 French has an invalid object in script 202)

svn-id: r50379
"
"a2cdc475300c7f8e56cd26146f513715ecfa05e0","2010-06-27 16:09:17+00:00","SCI: now showing kernel call name when argument signature check fails

svn-id: r50380
"
"006197e5bdb7962e3529557f37f269ef6c3bdef0","2010-06-27 16:53:08+00:00","Update the french translation.

svn-id: r50381
"
"72f65f8204d599c1a29a63377accd8d538ef1e88","2010-06-27 16:58:06+00:00","GUI: fix music device popup (thanks to clone2727 for reporting)

svn-id: r50382
"
"5997307081db72c002a9a131d0eefc1a190e1ced","2010-06-27 17:06:26+00:00","Fixed GCC warnings. (Same warning twice, actually.)

svn-id: r50383
"
"7e05376ebe3f82420e26941b4b74883c95060d00","2010-06-27 17:37:35+00:00","GUI: and another fix for the music device popup

svn-id: r50384
"
"777794d11d8d26e0c2cc87d7e039548a723ef474","2010-06-27 17:58:26+00:00","SCI: filter out set signal commands from midi streams, if they happen at ticker 0. fixes castle daventry getting removed immediately in kq5 french/mac

svn-id: r50385
"
"945297a599c8e3274d5f4faf64379049e60520b0","2010-06-27 18:19:37+00:00","Add italian translation from the patch tracker (#3022046) and update credits.

svn-id: r50386
"
"303dc063883dab2dfe30b44d9fad9fe8e3948ec5","2010-06-27 18:41:07+00:00","SCI: fixing regression from one of the merges

svn-id: r50387
"
"4653153910ee2186e914f5f4717e212053adef54","2010-06-27 19:58:32+00:00","SCI: added new command 'p' / 'stepover' to execute one command, but skip send/calls processing. single-step is now 'trace' (alias 's' and 't'), stepping till ret is 'step_ret' (alias 'pret'), removed unused kDebugSeek

svn-id: r50388
"
"7644631daf8758e50e113f908f9db3b7d7c68a90","2010-06-27 20:02:58+00:00","SCI: removing debug command 'set_acc', use 'vmvars a' instead

svn-id: r50389
"
"aa9b9dd08fb8a56685d30995661773cdc87eb546","2010-06-27 20:09:51+00:00","SCI: Separated the code for initializing script classes from the code for initializing script objects

svn-id: r50390
"
"1537d6129964732b03aae5186e9bc3e01c164817","2010-06-27 20:11:15+00:00","SCI: added alias for bplist ('bl') and bpdel ('bc'), added capability of deleting all breakpoints by using 'bc *'

svn-id: r50391
"
"e6a9a9da823b6c8fef25f2949d21525d8a229b9c","2010-06-27 20:22:09+00:00","Silenced a false positive in MSVC about a potentially uninitialized variable

svn-id: r50392
"
"f5bc8be952edb58c61459efc526229438bb87c69","2010-06-27 20:36:39+00:00","i18n: Update Russian translation

svn-id: r50393
"
"7078655de0511522dd6baaa7c91977376638f3c5","2010-06-27 20:38:05+00:00","i18n: Sync all translation with sources

svn-id: r50394
"
"0436f2823d7c83fa76d68fba3c18a7fcc4a29173","2010-06-27 20:38:41+00:00","SCI: added additional output to vmvars command

svn-id: r50395
"
"bb992b0b93f3ee9dfad6524fd0721a350f12085a","2010-06-27 20:38:43+00:00","SCI: Moved all the script-related code inside script.cpp/.h, and all script opcode-related code inside vm.cpp/.h

svn-id: r50396
"
"5f9cc9e8f8272fd2e07c9b6cce8bcc541772d17f","2010-06-27 20:43:32+00:00","SCI: adding alias for vmvars ('vv') and vmvarlist ('vl')

svn-id: r50397
"
"2843feeb9a4d031eaacc896da0045877fd048004","2010-06-27 21:00:34+00:00","SCI: Made the code for initializing script classes, objects and locals part of the Script class

svn-id: r50398
"
"819dc92802d330a27066b755854cba7169b8dfad","2010-06-27 21:04:47+00:00","Escape a '?' character to prevent '??)' to be interpreted as trigraph and thus becoming ']'.

svn-id: r50399
"
"cf3d5c27742bf1591ea91b05eb18e600c6ce332c","2010-06-27 21:09:57+00:00","added files for misc tests, implemented the datetime test

svn-id: r50400
"
"456265f8fac8c5020e30fa99e0be1c1ff1a02aa8","2010-06-27 21:12:38+00:00","SCI: resetting curPos as well when mixing sound resources

svn-id: r50401
"
"4a60ff409050e8f3da6065f2a44d78d31c4f34b9","2010-06-27 21:18:19+00:00","Made the script initialization/uninitialization methods part of the segment manager

svn-id: r50402
"
"1faebccce25ac422f65ab9616b9a7ecb647894a8","2010-06-27 21:29:35+00:00","Cleanup, remove unused/obsolete code

svn-id: r50403
"
"8db94ef9913713185dafebfd040b6f08611f903d","2010-06-27 21:38:45+00:00","Cleanup

svn-id: r50404
"
"a887d4898db9c954f29972e8bfb5155659069e4b","2010-06-27 21:41:30+00:00","SCI: tell midiparser that he lost ownership of channels in case we take them away

svn-id: r50405
"
"048ceb73d36e4729cb9c8dde292043c32a554234","2010-06-27 23:20:08+00:00","SCI: Removed the hack for loading games from the launcher from run_vm(). This is now done on startup. This should fix loading from the launcher for LSL6

svn-id: r50406
"
"c7554c267e6eaf8457611c44476143a54bbb66c0","2010-06-28 04:04:16+00:00","Implement shortcuts for switching items in the inventory

slash: switch between the last held item and normal mouse
comma, period: replace the currently held item with the previous/next item in the inventory

Also, commented a bit better what happens when ESCAPE is present with respect to map
programs and cut-scenes.

svn-id: r50407
"
"d4a0c8a1ad162aaa8d7f207161cbe61abc458d4c","2010-06-28 04:16:00+00:00","bugfix for the item fast-switching commit

svn-id: r50408
"
"76b8c33aaf964dab911b00e616e7800110dd780c","2010-06-28 04:59:13+00:00","Fade palette in/out when entering/leaving a location

svn-id: r50409
"
"31af2bfe32429563563d5beaa320a23fc035ad71","2010-06-28 07:42:16+00:00","SCI: show arguments on selector invoke breakpoint even when VM_DEBUG_SEND is not used, but in a compressed fashion

svn-id: r50410
"
"698f10611ccf82b0941b04f7d2bcebfe0c971b84","2010-06-28 08:16:20+00:00","SCI: fix regression of r50405 - sq1vga right at the beginning - scripts are pausing sound and then sending manually commands afterwards

svn-id: r50411
"
"52ddc711d0bcea3f447c46d25f8c5c959c5ad558","2010-06-28 08:18:55+00:00","SCI: separated the graphics initialization code a bit
- Moved all of the graphics initialization code on startup inside initGraphics()
- Moved all of the screen initialization (resolution, upscaled graphics etc) code inside GfxScreen()

svn-id: r50412
"
"253036ec4d76492dde59d52264ade1c5730a9643","2010-06-28 08:25:45+00:00","SCI: regression from implementing channel remapping and r50405 - center pitch wheels and hold pedal on init instead of unloadMusic(), fixes lsl5 piano scene

svn-id: r50413
"
"e4cb2703ca654ca11bd067f4c2eef2f4631a507f","2010-06-28 09:22:57+00:00","SCI: implementing real setVolume() support, fixing some fading in sci1 games (like pq3 intro)

svn-id: r50414
"
"92cc16e6a5f3b096868a8fa45b923de38d678e5d","2010-06-28 10:00:12+00:00","SCI: reordering and cleanup, removing debug code from sci0 mix-code

svn-id: r50415
"
"10a9dfc0d7a521d7f9815fd21edc5e7b82d8344c","2010-06-28 10:15:13+00:00","SCI: added uninit workaround for lsl3 - when accessing set volume menu the first time sound got muted before (because a uninitialized temp was used to do it, would have been 's' in sierra sci)

svn-id: r50416
"
"caa4479bdf593241e3a93525387f98ba4fd969bf","2010-06-28 10:36:10+00:00","SCI: changed the way setVolume works for sci0 back to the way it was from r50414, because adlib driver doesn't support channel volume changes for sci0 games, fixes fading in those games

svn-id: r50417
"
"22a8b2236ee57884929b71eb8cbf1adb5a071b37","2010-06-28 10:48:09+00:00","SCI: set volume all the time, fixes volume being 0 after fading in sci0

svn-id: r50418
"
"4016bdfd271be8f20d6da5bbfad982d2fb7fa24d","2010-06-28 11:19:27+00:00","SCI: cleanup

svn-id: r50419
"
"db2d41a4332c6c2a468f4460a23189a750fb8616","2010-06-28 11:19:45+00:00","SCI: Make src param of GfxScreen::scale2x const

svn-id: r50420
"
"9f48a37671737229e76cd38cf766d855fd2e7318","2010-06-28 11:20:14+00:00","SCI: Add const qualifiers to many GfxView methods and their return values.

This helps to ensure proper data encapsulation.
Also reformatted some overlong comments to 80 chars per line, and
fixed some other code formatting issues.

svn-id: r50421
"
"2c01d10a36f50da6c8bdcfe70558f7d9a2e56324","2010-06-28 11:20:33+00:00","SCI: Remove GfxView::getLoopInfo; add assert to GfxView::getCelInfo

The return value of GfxView::getCelInfo was used virtually everywhere
without a check for it being non-NULL. Hence instead of returning
NULL when the loop count is zero, it makes more sense to assert out
(instead of a segfault, or worse, random data being used).

svn-id: r50422
"
"7e0240ab14d29401877ff0c4d827be859e13ea58","2010-06-28 11:20:51+00:00","SCI: Comment cleanup

svn-id: r50423
"
"793d482f4fccd8999d71c9a0dbed518216cbb6ac","2010-06-28 11:21:07+00:00","SCI: Optimized GfxScreen::scale2x a bit

svn-id: r50424
"
"14530933919cfcfb86c0542ed2408b8e47675036","2010-06-28 11:21:23+00:00","SCI: Cleanup GfxView code (formatting etc.); also insert some asserts to protect scalingX/Y arrays

svn-id: r50425
"
"12099176f712c65b9822a5874f705d63d82228ce","2010-06-28 11:21:39+00:00","SCI: More formatting cleanup

svn-id: r50426
"
"85038e7d6c272555c54d9f4b87665392bfa96aaf","2010-06-28 11:21:55+00:00","SCI: Change warning back to error in Script::initialiseObjectsSci0

Instead of turning the error into a warning globally, we now have
code which ignores the error in Script 202 of KQ5 French, but will
keep reporting if it turns up in other places.

svn-id: r50427
"
"30218a2c324bc67f724100051ab9884a351928fb","2010-06-28 11:22:20+00:00","SCI: Make Script member vars private; add const qualifiers

Only three Script members remain public (for now)

svn-id: r50428
"
"31b29027144e3a76ab6e8c71a0014ca6121218c0","2010-06-28 11:22:41+00:00","SCI: Revise GC interface: use Common::Array<reg_t> instead of callbacks

This means a little bit more overhead but makes the code much more readable
and understandable.

svn-id: r50429
"
"6c0205b104e30a60b2c5f9ff5c5e417fde497808","2010-06-28 11:23:00+00:00","SCI: Fix DEBUG_GC mode and permanently enable it

svn-id: r50430
"
"e5509d38b609b23c6fa65f0c511baa6895162ec1","2010-06-28 11:23:16+00:00","SCI: More comment rewrapping

svn-id: r50431
"
"6063a9cba32443234be31d77e3a7a57870c88007","2010-06-28 11:40:39+00:00","Bugfix to properly erase text messages when they expire

svn-id: r50432
"
"6981b943b51f4ae1348e06992e8f7333824d05c5","2010-06-28 12:04:35+00:00","SCI: fix regression of r50424, 2x scaling

svn-id: r50433
"
"445bfee08c6d78457514701aaa4701d7883eea15","2010-06-28 12:09:48+00:00","SCI: add const again to newWidth

svn-id: r50434
"
"0f0977535c0fa07ca28ed696c906279153b1c9d8","2010-06-28 12:13:04+00:00","Remove CRs

svn-id: r50435
"
"84d43b9ab4b753195b84143513f32a1f3c4b3355","2010-06-28 12:16:53+00:00","Fonts: Add Russian codepage fonts, renamed existing ones

svn-id: r50436
"
"0d6efb2334aeed7f63ab68538d74021d0491f423","2010-06-28 12:20:15+00:00","Fonts: More BDF font renames

svn-id: r50437
"
"a278c07aa61fb6790b0f0eb57c8b8b0df4ab1b90","2010-06-28 12:27:48+00:00","SCI: get rid of Script::allocateObject

svn-id: r50438
"
"b3011faaef07e607dc3b7a9813d3bd788179a225","2010-06-28 12:28:12+00:00","SCI: Make various SegManager const

svn-id: r50439
"
"4f606cc10df1253cb035e3828f974c03f92e631f","2010-06-28 12:28:29+00:00","SCI: Clarify docs of GC related SegmentObj methods

svn-id: r50440
"
"4fdbd14a60afc72c3b936b02dffd39935594e8e5","2010-06-28 12:28:46+00:00","SCI: Move a few remaining Script methods to engine/script.cpp

svn-id: r50441
"
"8ae9774a009a2c12123d4bc9070a3d8f043a1c34","2010-06-28 12:29:06+00:00","SCI: Turn more warnings into errors.

If one of these is triggered for you, you can add an exception to
the error, together with a comment explaining why this exception
is necessary. Ideally after verifying that the cause is a script
bug and not a bug in our code...

svn-id: r50442
"
"9b4406fd350458e1fe194dadd76a0cb97c2ca324","2010-06-28 12:55:47+00:00","SCI: Some more GC cleanup

svn-id: r50443
"
"ef1ba0ea15435d178da7a834a487caf4ff8ef9e5","2010-06-28 12:58:14+00:00","added code to test timers and mutexes, some issues with mutexes present although

svn-id: r50444
"
"6402d644199e17cbf7770c98ebf8c1edca7c4cca","2010-06-28 14:21:56+00:00","SCI: cleanup of execstack, output of backtrace slightly modified, is now also displaying local calls and exports

svn-id: r50445
"
"66fb9e7a90874e27486db98f0eb8d6f0512a00c5","2010-06-28 14:46:28+00:00","SCI: fixing valgrind issue in Script::initialiseClasses thx to wjp for valgrind testing

svn-id: r50446
"
"8410dbab539a8c278b29e9047bd5c192a3048e32","2010-06-28 14:49:54+00:00","SCI: stupid oversight fix r50446, too hot here :P

svn-id: r50447
"
"0e7ccb896dafb69664fb313c63bdb8fbe0ea82d1","2010-06-28 15:17:10+00:00","i18n: Add support for locale-dependent fonts

Currently it ws not decided where to put fonts, but if you put BDF files into
themepath, they will get picked up.

The font name has to contain same codepage specification as in the .po file,
i.e. fixed5x8-iso-8859-5.bdf for Cyrillic codepage. In case the font does not
exist, default will be used.

All built in fonts get proper names.

TODO: Currently there is a bug with our font cacher. Font clR6x12-iso-8859-5
is empty after loading from FCC file. Reason is unknown.

svn-id: r50448
"
"0a58cdb6e96387eee2853a2cb9c72494cf816b1c","2010-06-28 16:09:54+00:00","common console: also show prompt, if the engine wrote onto gui console since last call - fixes sci breakpoints

svn-id: r50449
"
"e857cc623e86211ae0c59630342cbeea65214e6e","2010-06-28 16:35:20+00:00","SCI: added comment - lsl5 also has too large windows

svn-id: r50450
"
"06648cb186608e845c4dc214249b863632bbbb3c","2010-06-28 16:56:15+00:00","SCI: fix regression of r50422, please no refactoring without proper testing - fixes animations in all sorts of games

svn-id: r50451
"
"a0f42b07ceb836226521fbf90feb50fb470d8ad8","2010-06-28 17:03:04+00:00","KYRA: change audio detection flags setting (since most users don't own a real mt-32/lapc1/cm32l/cm64 device and our emulator is incomplete)

svn-id: r50452
"
"bc777403066e7a14b3b25d1ef4cf038723b85a02","2010-06-28 18:07:40+00:00","SCI: kAnimate resetting _lastCastCount all the time

svn-id: r50453
"
"473c429b5cb7f96112f752a99fc62c7d4d4d55ee","2010-06-28 18:10:21+00:00","SCI: updated comment about transparent pixels in views

svn-id: r50454
"
"e3806003ed95d556c3cbe3f1a996d8e11b2a05f7","2010-06-28 18:14:16+00:00","completed the datetime/timer/mutex tests

svn-id: r50455
"
"d8e4160f34787cb239e8073946249fcbfd8e8a34","2010-06-28 20:17:43+00:00","SCI: remove clipping of volume inside SciMidiParser::setvolume

svn-id: r50456
"
"438e670166768df06025f50c68e2d8fbe0f93407","2010-06-28 20:31:30+00:00","Applied patch #3022511 - 'qfg4 detection cleanup'

svn-id: r50457
"
"e022dd7013aaf007ba7594ecf1e15d4c27502704","2010-06-28 20:55:28+00:00","added template code for testing events

svn-id: r50459
"
"0b33cc0dab3c71d631d38742c3125bd88f4e759a","2010-06-28 20:58:32+00:00","Fixed loading of saved games from the launcher

svn-id: r50460
"
"32a192b79ab8ed37cf0bf6fca5bcaf9ef55b21a5","2010-06-28 21:56:25+00:00","Update German translation.

svn-id: r50461
"
"58732b9df1f0451f03c2ca01e0cab48314a360d3","2010-06-28 22:01:26+00:00","SCI: More changes to the code for loading from the launcher

- Added support for the LSL2 menu bar object
- We no longer need a reference to the init() selector - it's always the first method of the menu bar object

svn-id: r50462
"
"805374ff4eadb42e78dfbda64ad6d308b372fbbc","2010-06-28 22:06:19+00:00","SCI: ignoring set signal on tick 0 directly in parseNextEvent instead of filtering, also now ignoring channel volume changes on tick 0 (fixes lsl5 fading of sound 274, almost at the end), fixing also fading in gk1 and enabling fading in sci32 again

svn-id: r50463
"
"ee6aebc78022008ba31a8a24441eeaeed804fd78","2010-06-28 22:08:46+00:00","Don't initialize graphics again when loading

svn-id: r50464
"
"668d820afd77ed8efd309f1d380005ab828f9cb8","2010-06-28 22:14:03+00:00","SCI: its lsl5 sound resource 294, not 274 (changed comment only)

svn-id: r50465
"
"15f9f37d4d15e8c8972fa0ecdbbdaf138ea2a8da","2010-06-28 22:26:28+00:00","SCI: removing ignoring of channel volume change code from r50463, the lsl5 issue was actually caused by the old volume adjust code that was also causing the issues in gk1

svn-id: r50466
"
"23fa2296c3a3bc009b21684538e73e0520096e68","2010-06-28 23:41:43+00:00","Fix regression from r50382, which triggered an assert when clicking 'OK' in the GMM's options dialog.

The problem here is that our ConfigDialog uses '' as domain name,
this will result in the assert in common/config-manager.cpp:323
getting triggered, when using ConfMan.removeKey.

Since setting the domain to the game's domain does not seem save
according to the FIXME in gui/dialogs.cpp about this domain hackery,
I decided to adapt the OptionsDialog to only call ConfMan.removeKey
for 'music_driver' etc., when the music driver widgets are present.
This is consistent with the over uses of removeKey in
OptionsDialog::close too.

svn-id: r50468
"
"876b6a50060bee23b4b05205a729014a8e5455b1","2010-06-28 23:59:43+00:00","Prevent 'music-driver' to be set to '' on startup.

This is a regression from r50158:
'LAUNCHER: hopefully fixed music driver selection via command line'.

The problem here was that the code used operator[] of HashMap
to check whether 'music-driver' was specified on command line,
but that on the other hand inserted a (key, value) pair with
a default constructed Common::String as value.

svn-id: r50469
"
"5c424cfb41d439db5a0b3c00b7081473aa384ca6","2010-06-29 00:29:35+00:00","Fix detection of invalid music drivers specified via command line.

Along with it documented that '0' is a special device handle
for the invalid device. Now getDeviceHandle returns 0, when
the identified device could not be found.

Also getMusicType now returns MT_INVALID (newly introduced),
when a non existing device was specified.

svn-id: r50470
"
"19abacc77a5e7e00f9315926a19ef2870e87a5d9","2010-06-29 00:29:57+00:00","Fix fallback detection code in MidiDriver::detectDevice.

It formerly only used the global 'mt32_device' and 'gm_device'
values, but we also allow game specific values, thus we take
that into account now.

Also formerly the the check for the first available MT32/GM
device only used the device handle of the mt32_device/gm_device
instead of the list of devices it iterates over. Fixed that too.

Last but not least that whole detection code looks strange to me,
it seems we only use mt32_device and gm_device for fallback
detection, at least when the music_driver matches it will always
be used. So I wonder why we have those at all?

svn-id: r50471
"
"a254d29741681500fffa5609c0a2f6f10339352b","2010-06-29 00:30:16+00:00","Yet another slight fix for the fallback detection.

Before in case MDT_PREFER_MT32 nor MDT_PREFER_GM was specified
the code used 'auto' as key name for ConfMan.get, instead of
passing 'auto' directly to getDeviceHandle.

svn-id: r50472
"
"36e583944fad8658948522566014b79833fc3bfc","2010-06-29 00:38:06+00:00","Return '0' in case no device was detected in MidiDriver::detectDevice.

svn-id: r50473
"
"79aa49a509fd82bd3e4a97056efdc1e26913edd5","2010-06-29 02:55:31+00:00","Fix the load game dialog in Riven DVD's menu, borrowed from Parallaction.

svn-id: r50477
"
"146cc7cb3c3d00ce3d235c877d8e9e1e19434d9d","2010-06-29 03:00:53+00:00","Silence a valgrind warning.

svn-id: r50478
"
"48a107b821c21867a3627ac0cb2d072041ddcc56","2010-06-29 03:04:08+00:00","Update comment on CD swapping in Riven.

svn-id: r50479
"
"59f4c903a6fab1c60e925ce315fc077e1721eab0","2010-06-29 03:53:06+00:00","GOB : Adding workaround for Bug #3018918 UOTODDV Reload Goblin Stuck Issue.

This was present in the original interpreter.

svn-id: r50480
"
"02fb3f88e22b8d11a080bbf3a4db624d97d4bd37","2010-06-29 06:33:31+00:00","unzip.cpp can read uncompressed ZIP archives even when zlib is not linked in

svn-id: r50482
"
"5e030bebcc8e1a1cf918559c729039fc50a470e7","2010-06-29 06:38:00+00:00","enable reading ZIP archives even without USE_ZLIB

our module unzip.cpp can read uncompressed ZIP archives even without zlib.  if some of the files
inside are compressed and zlib is not linked in, an error is returned.

svn-id: r50483
"
"9f1320d5cc1d0892e0b3ea9812b6599125bd1c65","2010-06-29 09:00:08+00:00","SCI: Made the SoundCommandParser a member of the SciEngine class and removed it from the EngineState, since it's static throughout the course of a game

svn-id: r50484
"
"316e96df2b48b1986488bfd57db37b9708f3e4ca","2010-06-29 09:01:17+00:00","SCI: Removed reg_t_EqualTo, since reg_t already defines an equals operator

svn-id: r50485
"
"0b470dde636f4706a9f56c13364d87a76dd9ec86","2010-06-29 09:02:59+00:00","SCI: Some cleanup of the GC code.

The version of push() that pushes arrays inside WorklistManager has been renamed to pushArray(), so that it's more apparent where arrays are pushed.

svn-id: r50486
"
"f75a6a6f479dbde58fc0e9778d4811ca9a05419f","2010-06-29 10:39:13+00:00","SCI: print out actual and supposed parameter types when having a kernel call signature mismatch

svn-id: r50487
"
"b91ba9c56ea0bad8ae194149bfb2b370c8f01a95","2010-06-29 10:40:24+00:00","Bugfixes to reading in the animation font name correctly, as well as converted some Common::String usage to char buffers to fix incorrect String usage

svn-id: r50488
"
"eb4a48bfd99e97540d553ffd51eb5b24d9c05486","2010-06-29 10:52:59+00:00","Reserved palette ranges used by on-screen messages

svn-id: r50489
"
"841356ac80a869b199b65e169ee3aa361d657d37","2010-06-29 11:09:33+00:00","Added loading of the correct DSR file at the start of each animation scene

svn-id: r50490
"
"c1176498f146f01832bc4d98b477f4479302cd4f","2010-06-29 11:15:21+00:00","Removed the old hardcoded calls to loadDSRFile

svn-id: r50491
"
"5f2c184e4ef2e5519645b699b5dafa27148c59f4","2010-06-29 11:26:48+00:00","Changed reading of sprite frame depths to signed bytes - this fixes the problem with the Slippery Pig not showing up in the landing scene in the intro sequence

svn-id: r50492
"
"c96d44d928a2cb47e70e428b4e61bcf80ceda42b","2010-06-29 11:51:05+00:00","Added code to properly detect when an animation sequence is complete

svn-id: r50493
"
"a3a1499444654ed30aa13c0ab753b0916245f865","2010-06-29 12:56:22+00:00","Replace some code with constructs that work on Android pre-1.6.
Add a boolean for disabling the 'no plugins found' warning.

svn-id: r50494
"
"82d0ee7f779ec6db537030e8a5cfe83abc6974e0","2010-06-29 13:16:07+00:00","Update icons to versions with much softer anti-aliasing.
fingolfin++ for his good eyes.

svn-id: r50495
"
"32b69ccd9dc76f5d0750d23150fac5f5783134ca","2010-06-29 14:54:15+00:00","SCI: Simplify GfxAnimate code, get rid of _listData

svn-id: r50496
"
"c8dca083d825779eaecb3eccd04eaa4e2a914d0d","2010-06-29 14:54:31+00:00","SCI: Simplify List::iterator usage in GfxAnimate

svn-id: r50497
"
"b743fcc9f5f7e6428ecfe9fea69dbcc70c523529","2010-06-29 14:54:47+00:00","SCI: Rename listEntry -> 'it' for better readability

svn-id: r50498
"
"1027f870a6d78bfbbf151ca0e65cd915676792b2","2010-06-29 14:55:09+00:00","SCI: Add some const qualifiers

svn-id: r50499
"
"8db0f726c0253300faf8b9691607715fdaa45920","2010-06-29 14:55:32+00:00","SCI: Rewrap more comments

svn-id: r50500
"
"bf2b059a63ff68d2688d48e24f5bdcf97de46335","2010-06-29 18:20:10+00:00","Silence possible use of uninitialized variable warning in g++.

svn-id: r50501
"
"42351265f16779569cf170ff0e85658db26e7ee7","2010-06-29 20:12:42+00:00","Fixed 2 uninitialized reads in SQ6

svn-id: r50502
"
"3a2ac994d4565beff844aa802211099a4785a3e0","2010-06-29 20:13:57+00:00","Handle empty clip rectangles in GfxView::drawScaled(). Fixes an assert in the first room of the game

svn-id: r50503
"
"7951e3ddcf1053686882b6fe4881a4607bcbea05","2010-06-29 20:44:19+00:00","SCI: kernelMap cleanup and making it possible to have version (not implemented yet) or platform specific entries - changing signature for kNewWindow - using old dummy-signature for mac-only

svn-id: r50504
"
"b09996cb5cea63482c16faafb55d83bd50c04c90","2010-06-29 20:50:52+00:00","SCI: Rewrap yet more comments

svn-id: r50505
"
"c536630648ea7232508a477c3e503a0d867e25d9","2010-06-29 21:13:19+00:00","SCI: adding space in kernelmap for workaround table

svn-id: r50506
"
"2e58bdc20237ce328ded894d19f3c27dfa475035","2010-06-29 21:41:36+00:00","SCI: implemented version specific signatures, added special kDrawCel signature for SCI1.1 (PC)/kq6

svn-id: r50507
"
"0f28c799f013372c88dd420d084645b5275edb62","2010-06-29 21:47:34+00:00","SCI: added mac-specific signature for kGetEvent

svn-id: r50508
"
"97186bd5b03e012776bd3894e417a25118444ca9","2010-06-29 21:53:27+00:00","SCI: added sci32-specific signature for kGetSaveDir

svn-id: r50509
"
"7455c3ec3954e068090004369600c03b6ede43a2","2010-06-29 21:56:04+00:00","AUDIO: fixed  bug when device was set to default and only MDT_MIDI flags were passed to detectDevice()

svn-id: r50510
"
"68d691bc3e5ee711daad2979c7db325c16e4c1f0","2010-06-29 22:46:56+00:00","removed all printfs, added logging feature in form of logPrintf

svn-id: r50512
"
"9f1413b338da98139efb68434f7f875e2abbd745","2010-06-30 07:18:43+00:00","When deleting a list node, erase its references to predecessor and successor nodes. Fixes cases where game scripts could reference a list node after it was deleted (e.g. QFG1 intro, Longbow when exiting the cave). Some slight cleanup

svn-id: r50515
"
"7c5b31eb6d6e53a91efb9e0575f07055ea626ed0","2010-06-30 07:28:30+00:00","Also erase the value of the list node itself when deleting it inside kDeleteKey, as it might be referenced again before the GC is invoked

svn-id: r50516
"
"1e8b74f9de0e3a6cf265376a1c4d2c9859f68c61","2010-06-30 07:34:37+00:00","Updated incorrect comment

svn-id: r50517
"
"764aa1a125e913fb6d9800f97136adcd13fff9ae","2010-06-30 08:01:19+00:00","SCI: adding inheritancelevel to uninit workarounds to make them safer

svn-id: r50518
"
"c7f6a5b286bad600c987922396b7328079890342","2010-06-30 08:27:09+00:00","Generalize the sound archive framework to be able to open new formats

svn-id: r50519
"
"7595e7c1bec5e56e9ddaabea4b6af43423e8e002","2010-06-30 09:47:04+00:00","SCI: implementing workarounds for kernel calls, removing original code workaround for kDisposeScript / qfg1 room 64 and adding it to workaround table

svn-id: r50520
"
"8752eed8f241ae2c405a2818b3e30ef735019662","2010-06-30 09:51:21+00:00","SCI: Reverting r50516, SSCI didn't reset the node value when deleting the node. Also, a slight fix in VM debug code.

svn-id: r50521
"
"915b9fa318435df1dc8a9865f5784cb8a9e8e12f","2010-06-30 10:09:07+00:00","SCI: removing full debug output when signature fails to the point where we didnt find a workaround for a signature mismatch

svn-id: r50522
"
"0c283ed197d839cb81e5957424833700ada1c4ae","2010-06-30 10:13:20+00:00","Replaced Y offset from various drawing routines in favour of a viewport sub-surface - this will make it easier to clip sprites to within the drawable area

svn-id: r50523
"
"8de571556012eae3cff13b3b86f8554b5ba070b4","2010-06-30 10:17:54+00:00","Removed deprecated destAdjust parameters from the frame drawing code

svn-id: r50524
"
"c6695b1d6aa778575f4cefc1942253cbb8a65fbf","2010-06-30 10:31:23+00:00","SCI: removing all the remaining debug output from signature matching

svn-id: r50525
"
"dcba035912fb876f1db8da998405a659b9c87d04","2010-06-30 10:42:34+00:00","Corrected font display to properly use both colour indexes

svn-id: r50526
"
"cf5c60ed4f0628496ad97db3c274b7f0325e2440","2010-06-30 11:05:29+00:00","SCI: changing signature of kUnLoad, adding workaround for sq1 ulence flats bug

svn-id: r50527
"
"cb897a1a15bb178f1fdb55378852fb6da707e444","2010-06-30 11:08:23+00:00","Changed an error back to a warning - Torin's Passage calls kAddAfter with 4 parameters, and we don't know what the 4th parameter is yet

svn-id: r50528
"
"bf6acef9a9accb1753f87d34c3d5dddd56e36642","2010-06-30 11:09:49+00:00","SCI: fixed a typo, so that workarounds really trigger an ignore kernel call for now

svn-id: r50529
"
"a14c6d7815e27e76846a2a0feedcbf90785e07c9","2010-06-30 13:31:47+00:00","Fixed the signature for kUnload (thanks m_kiewitz)

svn-id: r50530
"
"bff3e89e48a6f819d5b23ba4cc848cbcf35aa965","2010-06-30 13:49:05+00:00","SCI: Removed the FreeSCI music code

svn-id: r50532
"
"4e999c8295adeade2317d9c486b943d3fd290c2c","2010-06-30 14:26:47+00:00","SCI: support for hires views in gk1

svn-id: r50533
"
"04d8ac41142de7f1a3a732073d1e236c0192f533","2010-06-30 14:39:03+00:00","SCI: removing sq1 workaround for kUnLoad for now, maybe it was originally meant for calling kUnLoad with just 1 argument

svn-id: r50534
"
"bcc010a56e6e58baf1f19f829802e1dbaad83f60","2010-06-30 15:26:45+00:00","SCI: remove some duplicate code

svn-id: r50535
"
"1287e6f252296d4c3fef58b080c4ae2fdef40a73","2010-06-30 15:44:26+00:00","SCI: adjust brRect and nsRect, if sci2 hires views are used, fixes hotspots in gk1

svn-id: r50536
"
"b85fd471a6f64f7f291c7b52e6061b99a26714e9","2010-06-30 17:36:52+00:00","Added support for kAddAfter with 4 parameters (used in Torin's Passage, for example)

svn-id: r50537
"
"3cd5821085817cece98365a28d24aa35a5749689","2010-06-30 17:47:44+00:00","SCI: Silenced a warning about a non game breaking script bug in Castle of Dr. Brain, room 360

svn-id: r50538
"
"31df21be75532e44c7b616eaecc4300b07dfec0e","2010-06-30 22:27:34+00:00","Commit improved italian translation.
Also update the template file and all the other translation files (there is quite a lot of line numbers that have changed).

svn-id: r50540
"
"b0b4f34d276b3451d6d46ac29cab6f5166cea757","2010-07-01 05:33:51+00:00","Added a workaround for an uninitialized temp read in KQ6 floppy, when opening the controls window - from bug report #3023602

svn-id: r50541
"
"b45d2cd92b137dc429f12f67b887a193f601afb2","2010-07-01 07:10:40+00:00","Implement playing RAW/MP3/OGG/FLAC dubbing from ZIP archives.

Playing works well, but I am not enabling it in the game player yet, because
I have not implemented measuring the time duration of compressed dubbing,
which is needed in the (exclusively used) blocking mode.

svn-id: r50543
"
"6c6d8b3fb39afe4a5866348ca2d34a7b13b566bb","2010-07-01 12:01:17+00:00","Introduced a hash for storing all the miscellaneous data values, and used it to more properly implement display of all the wakeup text in the first room

svn-id: r50544
"
"9a4bd4220fa000159cb300b2f66301b7150d0bd7","2010-07-01 12:30:56+00:00","testbed now keeps a list of executed testsuites

svn-id: r50545
"
"e309f05162b3b49b3236ebd8faaed124d9c5862a","2010-07-01 16:04:04+00:00","SCI: Simplify SegManager::findObjectByName

svn-id: r50548
"
"3f429d64a2ef826782bf9af8971ba397b0e2743c","2010-07-01 16:04:29+00:00","SCI: Rename some variables to match our naming conventions

svn-id: r50549
"
"36799dc83f59674de8956ea2ec29029783633f45","2010-07-01 16:04:48+00:00","SCI: Add SegManager::getSystemString() method

svn-id: r50550
"
"c822cd67cbebf22999a6b4d95d965ea5873e1b9a","2010-07-01 16:05:10+00:00","SCI: Make SegManager::_classTable private.

This require a small tweak to the save/load code: I moved the syncing
logic for _classtable from EngineState::saveLoadWithSerializer to
SegManager::saveLoadWithSerializer, which in theory should have no
effect (luckily, _classtable was being synced right after the
segment manager).

svn-id: r50551
"
"b8904a48ed81d04a2cbe84f78d80aaa75344d16e","2010-07-01 16:05:29+00:00","SCI: Make SegManager::_heap private

svn-id: r50552
"
"9d47b191f6302ac8960bb4d91d32104c0993a198","2010-07-01 16:05:47+00:00","SCI: Rename some more stuff

svn-id: r50553
"
"aa6be750fb6c04c06fd7c423b64e445c515b0154","2010-07-01 16:06:04+00:00","SCI: Invoke resetSegMan from SegManager::saveLoadWithSerializer, not from EngineState::saveLoadWithSerializer

svn-id: r50554
"
"e3590a60a02114a7254e4955f8d512bcf76b71c4","2010-07-01 16:06:26+00:00","NDS: Fix compile errors and a warning

svn-id: r50555
"
"78b6e246df844ea7f38d1c879ddc5dbeb767938c","2010-07-01 16:26:00+00:00","Fix configure output (missing newline)

svn-id: r50556
"
"a905327e65be97824e3faf483d3e535e763586cd","2010-07-01 16:26:18+00:00","NDS: Fix typo

svn-id: r50557
"
"2d6f912bd10f70ae556af627f2b4ae6565f904ed","2010-07-01 17:06:14+00:00","Fix playing RAW and RAW80 streams

svn-id: r50558
"
"6859a305553ad3d5e88da1bcdd63aee7c8c44824","2010-07-01 17:16:06+00:00","Fix a typo in the RAW format bugfix :-)

svn-id: r50559
"
"a1dc56429c3d61afe960924abdc4ee241c4c9fe6","2010-07-01 17:42:39+00:00","SCI: Removed duplicate warning for missing audio samples

svn-id: r50560
"
"cc243bae34c9aab022c113d0c09b7a70cb30f0c8","2010-07-01 17:47:46+00:00","KYRA/PC98: implement proper volume control (which distinguishes between music and sfx)

svn-id: r50561
"
"7f3b772938b7b7ab06d764eb47a52d01513f907a","2010-07-01 17:52:50+00:00","SCI: Added workarounds for 2 uninitialized reads in Jones floppy (EGA and VGA), and added information on the SQ6 uninitialized workarounds

svn-id: r50562
"
"eb84a130adabde931f025da93c950638fe0316ef","2010-07-01 18:34:14+00:00","KYRA/PC98: minor cleanup

svn-id: r50563
"
"1a675dcd86d7d3d3cae97c7e7b1bc81555af93f1","2010-07-01 18:47:27+00:00","Add support for the 'fallback' MIDI in T7G's intro when the CD track cannot be found. The intro music in the Mac version now plays.

svn-id: r50564
"
"fa014867cfe6bde10467761e1241b646ecb0460f","2010-07-01 20:16:42+00:00","SCI: Mark the ShiftScreen, ListOps and ATan SCI1 kernel functions as unused (dummy) - we haven't seen them being used anywhere. Added a check and an error in case a kernel function which is considered to be unused is called.

svn-id: r50567
"
"0e3f923f78055d0ffe76d5020392653728496f02","2010-07-01 20:32:41+00:00","The Shivers demo calls the debug kernel function 0x83 (PrintDebug), thus it isn't unused (thanks to clone2727 for pointing that out)

svn-id: r50568
"
"d5e037e703dfa5ab64bb390e31f817deb85cfb02","2010-07-01 21:08:38+00:00","Added some slight fixes for the RAMA demo, which starts now, though it dies horribly when clicking on anything

svn-id: r50569
"
"4c04375c8c39a3be660096d66d9d31dc5dd93a93","2010-07-01 22:09:19+00:00","SCI: added another workaround for uninit temps, this time for jones/cd

svn-id: r50574
"
"32dfd0cedce13f00b512d87b3b9bb7c383cc3b45","2010-07-01 22:23:05+00:00","SCI: adding jones/ega to detection tables

svn-id: r50575
"
"4dd02d2f4ab05839f86db9102c954ca34bfc1c34","2010-07-01 22:38:36+00:00","Support the CD kernel call (stub) and add the TRUE_REG constant.
Would be nice to use this constant in pre-existing code.

svn-id: r50577
"
"e47dee2faaa04286c39ad5e8d2f066157188cb23","2010-07-01 22:44:36+00:00","Accidentally missed this file in commit 50577

svn-id: r50578
"
"21450f1a2e6033c706c7027a255844ae83a51f92","2010-07-01 22:56:02+00:00","Added a workaround for an unitialized variable in GK2

svn-id: r50580
"
"ac351c175f7201e49f175e80105bdc704a9ea02f","2010-07-01 23:05:13+00:00","Fix code formatting

svn-id: r50581
"
"762ff57e0dd906e7a256c1d832c67f345faf8883","2010-07-01 23:12:28+00:00","NDS: Some tweaks for compiling via std build system

svn-id: r50582
"
"4fabca98a58c0a11a056195107822dcbdea79d9e","2010-07-01 23:12:45+00:00","Remove -Wcast-align -- it cause many spurious warnings on several ports

svn-id: r50583
"
"8b0f49b801afbef5ae2523078e82963c1120b3f5","2010-07-01 23:13:42+00:00","Only print the ambiguous object notice in findObjectByName if we didn't specify an index.

svn-id: r50584
"
"5457144f130c5483dc804e61adecb6e3bab426c0","2010-07-02 07:51:44+00:00","added processing of quit event

svn-id: r50590
"
"b252d5f0b97e229e73ed1c63b48d8c2e7896775a","2010-07-02 08:53:51+00:00","getString() on a NULL pointer is an empty string (verified in SCI2.1)

svn-id: r50591
"
"91a414dbc9f712484de2e5dac66ae3dafe467e6a","2010-07-02 08:55:12+00:00","Extended the SCI2 text drawing hack for SCI2.1 too, and added font caching

svn-id: r50592
"
"b8ff75047bdc9dfa591c66ceab6f421cb92ff89f","2010-07-02 09:09:22+00:00","SCI: changing adjusting of upscaled hires box coordinates

svn-id: r50593
"
"7b6be52f227aeaf2b544b3b35dd872f3643b1ff4","2010-07-02 09:50:33+00:00","SCI: added possible workaround or final solution for hires portraits not fully removed from screen in kq6 - needs to get investigated further but this will get a little bit difficult

svn-id: r50594
"
"79768098b13e20bade076b8a36c9d8cd16514b2a","2010-07-02 10:18:11+00:00","Added handling for kLock called with resource id -1 (unlock all resources of the requested type). Happens e.g. in KQ6 and LSL6

svn-id: r50595
"
"dcb92c83521794af87fc64f941e7d3bf71818c36","2010-07-02 10:38:42+00:00","Add checks for null reference to strncpy() and strlen() - happens for example when trying to talk to inanimate objects in KQ6

svn-id: r50596
"
"7fa26648283b1940f952c33251c27eb38d5b89e7","2010-07-02 14:39:13+00:00","Some slight fixes so that Phantom/Dragon start again

svn-id: r50598
"
"c1aecd0b9b32efb3a90f653eb36102f18543b49e","2010-07-02 15:58:09+00:00","SCI: change drawing of fonts, so that we never do triple pixel line duplications. sierra didn't do this, but it looks much better - 'fixes' gk1, kq6 font rendering when running in hires

svn-id: r50599
"
"1beff1a599064d90fd0f1a2accd627e7e780fd68","2010-07-02 16:52:09+00:00","Added a special case for KQ6 hires in the thumbnail creation code, which runs at a resolution of 640x440

svn-id: r50600
"
"e22a75de9981876aafc0b07946c23185d823b190","2010-07-02 19:04:44+00:00","Rewrote the handling of thumbnail creation for KQ6 Windows in rev #50600, so that it recreates the screen buffer like the other workarounds above it (thanks to LordHoto for pointing this out)

svn-id: r50601
"
"5625c6d1ee7f270fa8d6e93b3862a3d8dd7514c0","2010-07-02 19:08:22+00:00","KYRA/PC98: fix sfx volume control

svn-id: r50602
"
"022808fda6ac5419fd16fbd3d47dff16b812c50d","2010-07-02 19:47:14+00:00","KYRA/PC98: cleanup

svn-id: r50603
"
"a6e07f01bb7699162be879abae1d01ab6980f768","2010-07-02 21:27:36+00:00","KYRA/PC98: fix long standing bug were certain sound effects would bring each other out of tune

svn-id: r50604
"
"2662d569d9fb8ee899b0124ebb237be9866b6957","2010-07-02 22:38:42+00:00","Fix long standing regression (introduced with r34053) in thumbnail scaling code for Hercules graphics.

svn-id: r50605
"
"188f8d9a1199f60a1b0ca5a63b45e24813923d92","2010-07-02 22:55:56+00:00","AGI: Fixed bug #3017905 - 'AGI: GR - Crash on start'. A free() was done on an already freed reference

svn-id: r50606
"
"4304a414ab6ab3a46c10ddcd89ff9070caca96d9","2010-07-02 23:12:17+00:00","AGI: Removed the deprecated (and confusing) getGameId() function inside the AgiEngine class, and fixed a related bug, too

svn-id: r50607
"
"aefc42ab0e066b6cd2fa6eaab2471a908d7bb1fb","2010-07-03 00:06:54+00:00","KYRA/PC98 Audio: fix invalid mem access

svn-id: r50608
"
"8d26e7c2d26c0a7c6521631bf861f8613a307dce","2010-07-03 03:48:26+00:00","Dragon History tries uses compressed dubbing when available

Timing of speaking is not fixed yet.

svn-id: r50614
"
"0fd3558986e7c0a0c08f3df18d6c8ce59da79110","2010-07-03 05:05:28+00:00","Finish support of compressed dubbing

Now even the length of a compressed stream is measured precisely and
the dubbing sounds exactly like the original.

svn-id: r50618
"
"42dfdea5df648cbf1a7778ac8848d752d0f144bb","2010-07-03 06:55:10+00:00","SCI: added resetting of SoundCommandParser, so that error()s before that one got initialized wont crash

svn-id: r50619
"
"99939109d75816e434f51479bafdc48a987fb008","2010-07-03 11:50:42+00:00","Adding the beginnings of a player control class, as well as various changes to the other classes to support it

svn-id: r50620
"
"6b152e803967770d3419642b07fbf3a27333e865","2010-07-03 12:33:49+00:00","SCI: fixing #define SIGFOR_ALL, so that amiga games work again :P

svn-id: r50621
"
"88d1155c5e0b265c39466536f572a8aebfef8259","2010-07-03 12:49:42+00:00","Implemented necessary logic for the abort timer/action code, which allows the player manager to be correctly activated when the 'getting up' animation finishes

svn-id: r50622
"
"5872f5bb1fac5a8d4b8ddecf777e22ca23ecca39","2010-07-03 18:44:44+00:00","SCI: adding support to identify uninitialized values, when doing debug output for kernel signatures

svn-id: r50626
"
"9aae29b8d31a960f9ae7d1a870e27049e40445b6","2010-07-03 21:14:44+00:00","added code for mouse and kbd events

svn-id: r50633
"
"10e7581fe1a281f69875a6d76c9c1bf5aafa939c","2010-07-04 00:38:16+00:00","Added support for horizontally flipped foreground sprites, which are indicated by setting the high bit of frame numbers

svn-id: r50638
"
"acecfcaf6906f6640d8418c14a3aa2c8833f76e3","2010-07-04 01:11:18+00:00","Center the surface of a GraphicsWidget in case it is smaller than the widget's size.

svn-id: r50639
"
"336cde4b61df758dd438c9633863d50f5442037c","2010-07-04 01:11:37+00:00","Always use kThumbnailHeight2 (i.e. 120) for the height of the thumbnail widget.

This fixes the thumbnails for games with resolutions != n*200 in the launcher.

svn-id: r50640
"
"052d2ab6f17e6ec239f368ee802a659be46098cc","2010-07-04 01:18:49+00:00","Prevent GraphicsWidget from being assigned a surface which wouldn't fit in the widget.

svn-id: r50641
"
"db01417447a38f66503d33f1fd0b0ec20b5299a9","2010-07-04 01:19:16+00:00","Fix the size of the ScummVM logo in the launcher in the modern theme.

svn-id: r50642
"
"dde6dabac9d6ae6f86cec11607ac15cb748aaf73","2010-07-04 07:32:12+00:00","Cleanup: Treat booleans as booleans, not integers. (I hope I didn't mess up,
because that would cause some nasty regressions...)

svn-id: r50643
"
"587ba8a90ee1d85cab07107293d96311fcc00c50","2010-07-04 12:45:33+00:00","Implemented more of the support methods for player display

svn-id: r50644
"
"7d64f3e34369ef43d6a9e03d9b8cb3752c300afe","2010-07-04 14:55:28+00:00","SCI: Added a short description for all opcodes, so that it's easier to understand what they do without cross referencing the wiki, and removed some obsolete and unused code

svn-id: r50645
"
"6c9e3b01da554b44bd8d5adac11f95ae3aa52599","2010-07-04 15:06:42+00:00","GUI/AUDIO: This change will make individual game audio settings take over the audio device from the global settings if no device config key is found for that game (This should fix the problem reported by LordHoto on devel. It might make sense to implement this behaviour to other settings, like subtitle mode etc.)

svn-id: r50646
"
"8f2c0c2ff0ab33315e04bb49cb98ece01fb4bd7f","2010-07-04 17:40:06+00:00","Cleanup.

svn-id: r50647
"
"da1a8535b4b06072ca99a253aff55da9287672e1","2010-07-04 18:00:46+00:00","More cleanup / readability fixes.

svn-id: r50648
"
"9880017c1120eb7646c1b455a899a0d1498bb05a","2010-07-04 18:03:18+00:00","Prevent the MT-32 Emulator from being displayed in the 'GM Device' pop up.

svn-id: r50649
"
"9cf1cff5fc72468b1af2fc584c8375f509d6437c","2010-07-04 18:07:34+00:00","Whoops, always increase midiId, not only when it's added to the GM Device popup.

svn-id: r50650
"
"2f138f60555b3a2141a582bc561a81108faf6964","2010-07-04 18:24:13+00:00","Simplify audio device settings handling by using the device handle as tag instead of newly created id.

svn-id: r50651
"
"6219ffe52f2f38dfcdf000227554eaa8d9d3098c","2010-07-04 21:31:09+00:00","SCI: Removed the unused line number parameter from validate_variable() and related functions

svn-id: r50654
"
"96dad5be41a99c79587550fc7edd95b6d6c4b319","2010-07-04 22:27:06+00:00","fixed a typo in keyborad events

svn-id: r50658
"
"18b449d4fdcf9651f325259fb7ba1d81135143ff","2010-07-04 23:38:08+00:00","Add a hexDumpReg function to view references that are not raw and fix SCI32 strings/arrays in segmentInfo.

svn-id: r50660
"
"bb300ec671cfcd6fe7461dfd90615acfede2f1b9","2010-07-05 00:09:41+00:00","Skip /dev/sequencer MIDI on Android.

svn-id: r50664
"
"b8778fc7c382ec401409bbaafcb67355f0c566e3","2010-07-05 01:00:59+00:00","Switch Android toolchain prefix from arm-android-eabi to
arm-*-linux-androideabi, since this is what the upcoming gcc-4.6
change uses.
Work around Android 2.0 and newer dynamic linker bug by explicitly
linking plugins against the core libscummvm.so.
Mark Android packages as preferring to be on external storage.
Move -lm from LDFLAGS to LIBS.

svn-id: r50665
"
"830c7611dc76ea94a0869b4943b541035ee28d1c","2010-07-05 01:03:52+00:00","Revert Android libtremor header to standard path, since we now ship
our own statically linked version rather than relying on the system
shared lib that happens to be on most Android systems.

svn-id: r50666
"
"660ffc194d217bdeb61479e5b101e7642319ecb5","2010-07-05 09:53:10+00:00","Bugfixes for new player code - Rex is now correctly positioned when the player manager takes over from the wakeup animation sequence

svn-id: r50669
"
"179a2b4e88842b04eec46aa29c7c4a88123b5a50","2010-07-05 10:06:38+00:00","NDS: Rename backend 'nds' to 'ds' in configure

svn-id: r50670
"
"db1fa71745a6604612f295c4f5a33169bde75a75","2010-07-05 10:07:06+00:00","NDS: Enable compilation of backend specific files

Also tried to enable the conversion of .raw/.pal/.bin files,
but this does not currently work (probably something really
silly, but I don't have the time to debug this right now).

svn-id: r50671
"
"a9af5324489a88b34788baca0c29bbcf3a57f3bd","2010-07-05 10:07:33+00:00","DS: Can now build binaries via our 'configure/make' build system.

Conversion of the old build system is incomplete. Binaries created
using this new build system support most likely will not run!
More work is needed, but the work done so far should be enough
to get basic NDS support on our buildbot working.

svn-id: r50672
"
"9a61be13e6638a5fe9b31d1fdf7fff72bb69bf8f","2010-07-05 10:07:54+00:00","DS: Made some vars static, code formatting, cleanup

svn-id: r50673
"
"cb265ae09ac6282b0a7282f3d3c0d5b5973cac08","2010-07-05 10:08:13+00:00","DS: Fix setShakePos

svn-id: r50674
"
"fcde7221d55849441844d7a7480cf99696417e88","2010-07-05 11:07:24+00:00","DS: Fix typo; change bin2o/bin2h to create taget dir

svn-id: r50675
"
"d4ad7b8a6d159e367bfb5f9e8de92140f3f41e06","2010-07-05 11:53:55+00:00","DS: Add missing .bin -> .elf rule

svn-id: r50676
"
"330e94feeda00ed0d55aaa899349efa26683257c","2010-07-05 13:06:58+00:00","Drop direct use of (private) libEGL.so and call EGL functions via Java.
This removes the final private library - we should be completely above
board now.

svn-id: r50677
"
"5527882daa02eb98f86f7a9904c588ba93821fe1","2010-07-05 14:36:31+00:00","SCI: implemented new kernel call signature format

svn-id: r50678
"
"63c439a858b96adbfb439651047b293d66947f19","2010-07-05 14:46:09+00:00","SCI: fix compilation issues from r50678

svn-id: r50679
"
"47e59d8cc2d4b04a7d16528985a0b52c2edd8a9f","2010-07-05 15:53:17+00:00","GUI/AUDIO: minor fix for the case that after enabling individual audio options for a target the gui tries to select the audio device from global options, but that particular device is unavailable due to GUIO flags settings

svn-id: r50684
"
"00dfb4db2968d46ca8052f2020143254c8926805","2010-07-05 16:08:43+00:00","SAGA: Fix warning on systems where enum's are unsigned

svn-id: r50685
"
"f39f7f3dedbea6543337526607b0b1a477c2e0c3","2010-07-05 16:08:59+00:00","DS: Augment 'clean' target, simplify bin->elf conversion rule

svn-id: r50686
"
"d5c78f78c545cb16e2dd73ab28da1ff6341048fe","2010-07-05 16:09:27+00:00","DS: Fix warnings, cleanup

svn-id: r50687
"
"e4ec2e6403211abd52806d19732ac30d9a874f92","2010-07-05 16:10:22+00:00","DS: Code formatting: 'char* foo' -> 'char *foo'

svn-id: r50688
"
"3d44870c8a64999e5464fc3b09c08f9378c4a2d3","2010-07-05 16:11:11+00:00","NDS: Update GPL/copyright headers; add namespace DS closing comments

svn-id: r50689
"
"782e43591a6eb5995036bebf2dcc2c871e4aed95","2010-07-05 16:11:34+00:00","DS: Cleanup NDS portdefs.h a bit

* Don't #include 'nds/ndstypes.h' everywhere
* Don't #define ITCM_DATA globally, it is only need in one place
* Fix STREAM_AUDIO_FROM_DISK definition (copy&paste error)
* Fix custom assert() implementation by using the do/while(0) trick
for macros. Previously, there could be subtle errors caused by
statements like
if (COND) assert(...) else ...

svn-id: r50690
"
"d2a24c0a9535f1e51c25610de806beeb092b1ec5","2010-07-05 16:11:54+00:00","DS: Remove unused portdefs.cpp

svn-id: r50691
"
"edb5210d382d27c31cca0a48a427735044078ba4","2010-07-05 16:12:10+00:00","DS: Fix error in std_fopen (warnings are great :)

svn-id: r50692
"
"75529dc4022ec52ffba971d532c397aa951c2d5c","2010-07-05 16:12:31+00:00","DS: Fix various warnings and errors in the DS FS code

* Do not modify the strings passed to std_fopen anymore
* Correct signature of std_fread
* Do not cast away constness, nor perform unnecessary casts

svn-id: r50693
"
"776c3a1d519838910732ab31b81b11cc5d122c88","2010-07-05 16:12:47+00:00","DS: Fix MODULE_DIRS value (now dependency tracking works correctly)

svn-id: r50694
"
"68d620ccab1be965c8b0f7373cb1280e11244139","2010-07-05 19:10:20+00:00","DS: Fix warnings, make some vars static, cleanup

svn-id: r50701
"
"5d25d3821a680ba9dd034595638be8c975de3dd2","2010-07-05 19:10:56+00:00","DS: Only include NDS/scummvm_ipc.h where necessary; minor tweaks

svn-id: r50702
"
"0d317c40a2f2354438dff4b8560da24643283dde","2010-07-05 19:31:32+00:00","SCI: fixing kDrawCel signature for kq6

svn-id: r50703
"
"d4bc0f9f10c597cd57de1c1f275cb227dd83eb0c","2010-07-05 19:45:48+00:00","Replace a tab by whitespaces in the help string.

svn-id: r50704
"
"73e51735a4b43a05e3cbd293712b4951c56aaea8","2010-07-05 20:10:28+00:00","Formatting fixes.

svn-id: r50705
"
"1443a2721c77e4336dd894e66a377950b4f23273","2010-07-05 20:10:56+00:00","Fix update of GUI options, which only differ in the language setting.

svn-id: r50706
"
"cffcc3d9360dbbadec4a3e18c3b6ca64dfc27995","2010-07-05 20:25:33+00:00","SCI: fixing signature of kDoSound (fading related) thx to Ceriand

svn-id: r50707
"
"429de8f6efc3d3dcbbdfbc9f7eb53d2d096ca925","2010-07-05 20:36:11+00:00","DS: More formating, made more vars static

svn-id: r50708
"
"edac80ad6bd785e4925764bdd1bea2084aefc143","2010-07-05 20:36:43+00:00","DS: Fix warning about anonymous struct

svn-id: r50709
"
"0c3cbcbfc57c6c355d7106aa6be3faa7dd2f8590","2010-07-05 21:18:25+00:00","Prevent SCUMM from adding gui options based on user flags into the config file (regression from r50706).

svn-id: r50710
"
"f470baa3144115365881a64bbe9bd82ba0e2f506","2010-07-05 21:29:15+00:00","made Quit and RTL features working

svn-id: r50711
"
"a3202eab7c710b63b1ede3acc54c0d87a7d05b1d","2010-07-05 21:29:52+00:00","Note Common::String's behaviour may be undefined with \0 characters.
Also make operator=(char) and String(char) behave the same.

svn-id: r50712
"
"9241e47e9aa4efb1d7c4c25d889b93aed915928c","2010-07-05 21:49:15+00:00","Added couple of checks in Event handling

svn-id: r50713
"
"deb2c189c757b7d3520623a92b7769751eed4717","2010-07-05 23:02:43+00:00","added code to revert back to 8bpp from other formats

svn-id: r50714
"
"0c411d66cef3c79f077df46882518e786ec811f2","2010-07-06 07:42:25+00:00","SCI: Simplified op_div and op_mod, removed some variables and removed the pointless OBJ_PROPERTY wrapper

svn-id: r50719
"
"f3a935351b7977517876e2342471c1330a5db7ff","2010-07-06 11:03:10+00:00","SCI: fix regression of r50599 - broken greyed font drawing

svn-id: r50720
"
"2d5dabee30b842a6670f4d6e956c45e37389e344","2010-07-06 11:16:11+00:00","SCI: implemented pauseSound inside kMenuSelect

svn-id: r50721
"
"3f7dc9e0e2e4d043b2234b7b66981e16eb8a84b1","2010-07-06 11:32:10+00:00","Added extra initialisation code for the game's global variables list

svn-id: r50722
"
"c89fe5f6d56b6d6e11b7d642e85633bc86098ce8","2010-07-06 11:33:09+00:00","Added support for idle character animations

svn-id: r50723
"
"a7cd1534c6d3a325e36db42314e22ff3d8bdc8dd","2010-07-06 14:10:09+00:00","SCI: fix regression of r50721 - pausing/resuming only on actual menu usage

svn-id: r50724
"
"c349d7130c1716b5b87a5cb9f740f8467c16dde4","2010-07-06 14:26:29+00:00","SCI: removing invalid reference error from signature checking, instead adding new type 'invalid', so that full call parameter debug information is available

svn-id: r50725
"
"f145391abb1823489ff03e200c50926b5aa97006","2010-07-06 16:30:42+00:00","some minor fixes in cursor handling

svn-id: r50726
"
"2343f8c60d8291c1cd081339865837c43fe1f55d","2010-07-06 22:13:43+00:00","DS: Add isScrollingWithDPad() to make code more readable

svn-id: r50727
"
"9b927b414aadf954f3f4fce9a80b86f3e26c154d","2010-07-06 22:14:06+00:00","DS: Implemented (ugly, but working) support for optimization level overrides

svn-id: r50728
"
"fe409ea2692db8eb9d95564c03b166fb7baa316e","2010-07-06 22:29:45+00:00","DS: cleanup arm9/makefile

svn-id: r50729
"
"afd285005825926ee4f26b7ca5b20d2450efe211","2010-07-06 23:24:36+00:00","SCI: Add version to obsolete string

This way, if we ever get rid of support for savegames with
version <= 23, we can also get rid of this syncString()
call. Without this change, it would have 'infected' every
new savegame version, forever.

svn-id: r50730
"
"dd5f6f13e292e3ca8c63997fb1360fc39b5426e3","2010-07-07 11:02:11+00:00","Bugfixes and changed field names in the player class to be more explanatory. Implemented Ctrl-T to turn the player - the original game used Ctrl-U, but this is reserved by ScummVM for toggle Mute.

svn-id: r50734
"
"9b14164bfcd9e6fecaecaed3ee5e061d6086bac8","2010-07-07 14:19:36+00:00","SCI: accepting decimal/hexadecimal input on segment_info & kill_segment debug command, cleanup

svn-id: r50735
"
"61a200dcdd03e8b0c1f35dea50842b6356e13e17","2010-07-07 16:51:36+00:00","DS: Remove redundant lines from arm9/makefile

svn-id: r50736
"
"322d57a1dd2f72bb9d5fb4e00ddf82acab637e36","2010-07-07 18:35:07+00:00","SCI: adding support to kernel signatures that invalid references may also get allowed - doing exactly this for kGraph(restoreBox) - fixes castle of dr. brain when quitting the game - maybe a game specific workaround would be better?!?!

svn-id: r50737
"
"9add81aaf2aa992252be36d9a2f9f2cec0e41eea","2010-07-07 20:12:41+00:00","SCI: Dropped support for the very old saved game versions 9 - 11. Rationale: a lot has changed since then, we're still not stable, and this helps clean up the code, thus we're still in a position to drop support for old saved games

svn-id: r50738
"
"00fc80b8d59cacdc93a71e08cb8240392f245e34","2010-07-07 20:31:28+00:00","Added code to draw rainbow palette using HSV and converting it to RGB

svn-id: r50739
"
"71f0f1b25164dcfb8793cbd28f158605a8dc70f4","2010-07-07 20:40:54+00:00","commented out rotation as of now, avoids 6s delay which shows blank

svn-id: r50740
"
"fe72d5dd7842312606b350785f2fac2b2824fcb6","2010-07-07 23:22:53+00:00","DS: Fix some quirks in the NDS build system, remove some dead code

* remove (S)RAM save code (it has not been in use for quite some time)
* remove the lz compressor (was only used by ram save code)
* OPT_SPEED was set incorrectly
* dsmain.cpp was misspelled as ds_main.cpp
* remove unsed arm9 libcartreset (the copy in the arm7 directory
still is around, though)

svn-id: r50741
"
"c4a626931bda67d909f2d836501c3f409cf9b722","2010-07-07 23:23:19+00:00","DS: Code formatting

svn-id: r50742
"
"6aa53ba3b8d7bd207aafd1ab4fa2c68b5f3e50b3","2010-07-07 23:23:44+00:00","DS: Remove cruft from Makefiles

svn-id: r50743
"
"f6afba1f19b3ebf6242940f1f27c063cd34f4995","2010-07-07 23:24:08+00:00","DS: Split buildrule for scummvm.nds and scummvm.ds.gba

This parallels what I did in ds.mk

svn-id: r50744
"
"4237f9a416490137f44928213a4fab090e8438b2","2010-07-07 23:24:29+00:00","DS: Fix OPT_SPEED and OPT_SIZE usage being reversed; add ARM7 files to 'make clean'

svn-id: r50745
"
"b877f3c7115a187acf0fb9fb5fcdacc28ce36ec3","2010-07-08 18:26:05+00:00","SCI: sorted kernel map alphabetically

svn-id: r50746
"
"07fef4c6e6a385732c508fb8129b70dcc4a43571","2010-07-08 18:38:15+00:00","SCI: hopefully fix build :P

svn-id: r50747
"
"333f704513aa59e9d92cae66a8db0d8235975175","2010-07-08 20:30:11+00:00","implemented rainbow palette rotation

svn-id: r50748
"
"d3c42b71ba2b12e3dd7877ec1e28fcaedc5f6a6c","2010-07-08 20:35:05+00:00","restore initial palettes when done with rotation

svn-id: r50749
"
"7e05d6e62bd8e887ccea2302ad191a775150ccf8","2010-07-08 21:22:59+00:00","SCI: part of subfunction signature&mapping implemented, little cleanup

svn-id: r50750
"
"916a0f9cbfa4d133c3e459726d4f4285e177f1fc","2010-07-09 01:08:15+00:00","Added iPad icon

svn-id: r50752
"
"9117eec6a72c9dc4abb72ca45ecebbfb7ee04bfc","2010-07-09 09:26:57+00:00","SCI: getting signatures for subfunctions from previous entries, if needed

svn-id: r50754
"
"ba776fb2934c7124e969d54e559c5136f5a2fc73","2010-07-09 12:06:41+00:00","SCI: implemented subsignatures for kDoSound

svn-id: r50755
"
"125f28c367288ae9fe2992aaa96541ae067d7511","2010-07-09 12:26:54+00:00","SCI: fixing signature for kDoSound(suspend)

svn-id: r50756
"
"b602e7071be26838288d9b8f162a3dff70b7927f","2010-07-09 12:30:34+00:00","SCI: fixing regression of r50755 - fixing kDoSoundSendMidi

svn-id: r50757
"
"b8933d7e8f1886cc22b0ef8face8ead4e890c3e6","2010-07-09 13:01:48+00:00","SCI: removing unneeded mutex locking inside sci0 update cues

svn-id: r50758
"
"aadf2e976555d08b7f8e773cc4d69882fa1c9d3d","2010-07-09 14:11:27+00:00","SCI: added currently commented-out pauseSound implementation for some sci0 games, allowing integer for that subfunction

svn-id: r50759
"
"eddd6d0dba563349b1d3a16bf0251ba9f5f194c1","2010-07-09 16:05:47+00:00","SCI: actually all sound-sci0 games used a completely different kDoSoundPause logic, implement it - fixes all sorts of games not pausing when going to restore menu and more

svn-id: r50760
"
"541daf918aa9734692b7a58ec80ba03a975bd8fb","2010-07-09 16:53:20+00:00","Introduce the RivenScriptManager to keep track of scripts and free them when required. The old way of using SharedPtr was quite hacky and didn't work properly when talking to Gehn in ospit.

svn-id: r50761
"
"0e4bf4aff70846b77bac2f39d0f031cede6afa05","2010-07-09 16:53:50+00:00","Fix some other valgrind warnings.

svn-id: r50762
"
"65d6ce41935f6a137869d4e87bc5690950ae315f","2010-07-09 17:22:02+00:00","Replace _s(test ? 'string1' : 'string2') by test ? _('string1') : _('string2') in two places. With the old code the second string was not detected as being translatable.

svn-id: r50763
"
"abd2057408794c1cb9618532a77e738bda6d7a4f","2010-07-09 17:25:45+00:00","Update template and all translation files following the addition of a new translatable string. French and German translations also have additional updates.

svn-id: r50764
"
"18d1ab8c709602d71ad4175c29d4517f1bc5bbab","2010-07-09 18:11:42+00:00","SCI: move comments and change selector for sci0 sound in kDoSoundPause, also allow pausing everything even for sci1early (qfg2 is using it)

svn-id: r50765
"
"3fe205ba7f376bcc7f4f87226b61918acb9ce925","2010-07-09 18:35:46+00:00","SCI: fixing regression of r50414 - we set volume to standard levels inside initCommands since then, so if we set the actual needed volume before calling that it will get ignored - fixes lsl1demo

svn-id: r50766
"
"d27e4a475bde10c00e7f7f67ce7f4e14cc634db2","2010-07-09 21:10:14+00:00","SCI: removing origName from KernelFunction struct, adding debugCalls boolean for later use

svn-id: r50769
"
"af479a20ae1df5d851a854a1d1906072b50166e3","2010-07-09 21:33:12+00:00","SCI: adding workaround support for kernel subcalls, cleanup

svn-id: r50770
"
"02cac2d5aadaf73385ea979afdf6222a72b026cf","2010-07-09 21:36:59+00:00","KYRA/PC98: fix music volume

svn-id: r50772
"
"0cd97ca5c5394aebf542ad7357d8bb0983b2ea09","2010-07-09 21:51:20+00:00","SCI: improve error message on subcall signature mismatch

svn-id: r50774
"
"de7108054fe802b0fb283bfc7484988a1344b9e1","2010-07-09 22:10:22+00:00","Add detection for 'Little Monster at School' and the bunch of demos that came on the CD (on the demo server now too).

svn-id: r50776
"
"f687a44d2ad911b22408fee0505aab187607b3ef","2010-07-10 10:20:23+00:00","SCI: added kPalVary signatures & mapping, removed debug-warnings

svn-id: r50777
"
"bab61443ac5b59d20f3846518121286338c5724d","2010-07-10 11:15:10+00:00","Fixed warning.

svn-id: r50778
"
"cfc93a7e4dff46e1bca4656c2976c1f3c1e68a87","2010-07-10 11:16:46+00:00","Simplified the expression.

svn-id: r50779
"
"f38348b82e3e6781ae2a166e951fc83f11f8d618","2010-07-10 12:19:32+00:00","SCI: adding kPalette signatures, fixing 3 kPalVary calls, fixing kAssertPalette (we used the wrong parameter number before, maybe the issues were caused by this)

svn-id: r50780
"
"ce6a73adf532045c60f4c4072228b7bfdff87385","2010-07-10 13:19:20+00:00","SCI: updated debug output from kDoSound

svn-id: r50781
"
"e807983e8fd742334348f99fcdb72d351b18d2e6","2010-07-10 14:00:43+00:00","SCI: removed unused debug flags, changed fileio debug prints to only happen on debugflag 'file'

svn-id: r50782
"
"28d07c7e0a8e2e84aa5bba45105dc4091476f4ee","2010-07-10 16:22:08+00:00","SCI: calculate widths for menu after switching to menuport, i guess this was the reason why we sometimes had issues drawing parts of the menu (random issue)

svn-id: r50784
"
"b7906e7feb33cf1b31433f9962bb02b393e1943e","2010-07-10 17:08:42+00:00","SCI: allow invalid handles in kDisplay calls, fixes pq3 intro signature mismatch

svn-id: r50785
"
"790e9b0351a043d2d5e4c048a081f5f6ab24c9a9","2010-07-10 18:21:09+00:00","SCI: added signatures for kGraph, removed isDummy boolean from KernelFunction

svn-id: r50786
"
"a92a8d3c54f1a90c480bddc12d7f48c826bcd684","2010-07-10 18:31:11+00:00","SCI: adding workaround for script error when leaving ulence flats bar in sq1

svn-id: r50787
"
"8b112704b2e840c6b0f789d527c6bc79fcc9c7e9","2010-07-10 18:34:38+00:00","SCI: adding descriptive comments for subop-tables

svn-id: r50788
"
"424c13e9f479a55a57213da9bf1b21621ce715b8","2010-07-10 19:24:12+00:00","switched testbed detection code to advance detector, doesn't bails out when game data not found

svn-id: r50789
"
"5c2489f1533067dcfe303496055e63e8c8d7c189","2010-07-10 19:58:25+00:00","SCI: removing hoyle workaround from kAbs & signature and adding it into workaround table

svn-id: r50790
"
"5e4d4fde678e0fda0bd371770046208d7082b8c4","2010-07-10 20:45:59+00:00","SCI: adding workaround for kGraph(fillBoxAny) in sq4cd when accessing the game menu

svn-id: r50791
"
"09fd47236d82c169a0c2886f6baa752beb401a3d","2010-07-10 20:50:52+00:00","SCI: adding to execstack only right before executing kernel call, otherwise it wouldnt be possible to skip over sub-function kernel calls via workarounds

svn-id: r50792
"
"5721b75205acd15053430f24e92b8f170478ced0","2010-07-10 21:47:37+00:00","SCI: fixing kGraph(updateBox) signature for kq6 hires/lowres (allowing null reference)

svn-id: r50793
"
"df6ead5f93758aa9871594fc3872930eaf9c9d60","2010-07-10 22:27:28+00:00","SCI: calling speed throttler as well from kPalette(setIntensity) if needed - fixes kq6 intro

svn-id: r50794
"
"f9c03dc8db9a745d10e628f778cb4cad0d6f6a55","2010-07-11 06:48:28+00:00","a correction in palette rotations

svn-id: r50797
"
"c77c84f5c52deb34930ed4e7f627ad672579c74c","2010-07-11 10:11:31+00:00","SCI: also sync palette after playing movies, fixes kq6 intro

svn-id: r50798
"
"110d644f492ce624f70c62639b5fb01832022a58","2010-07-11 11:12:03+00:00","SCI: adding workaround for signature mismatch for kDoSound(fade) in kq6 floppy/demo

svn-id: r50799
"
"38d79f60e3217debbf99c971a87ea581c00f007f","2010-07-11 11:52:17+00:00","SCI: changing signature for kDoSound(resume) it seems its called right after restoring to resume music - which we do already automatically

svn-id: r50800
"
"570560e9b5f1b07b20111d58593bbf2f6251bf61","2010-07-11 16:50:18+00:00","improved the scaling test to have a rectangle of estimated size of scaled cursor the scaled cursor should entirely cover that estimated rectangle

svn-id: r50802
"
"30a28ec107dc254d8db0d9361cd0d7d34a089ec2","2010-07-11 16:55:08+00:00","SCI: remove 'a:' from default export hero quest 1 filename 'a:hq1_hero.sav'

svn-id: r50803
"
"219a6627c25e4ee931e3afb1b70a0a4fe83c249d","2010-07-11 18:51:28+00:00","SCI: changing uninitialized workaround for lsl6 narrator

svn-id: r50804
"
"737f2c0fa4b44033a1f6343d5ee700228b00d10d","2010-07-11 19:11:48+00:00","SCI: adding signature workaround for script error in lsl6 during intro, also changing comments of other workarounds

svn-id: r50805
"
"a94b25f99cc29700770089982850eab9d11a3d87","2010-07-11 19:16:16+00:00","SCI: kUnLoad - removing unneeded warnings (signature mismatch will happen now), added information about parameters

svn-id: r50806
"
"115d7d0132bd410f2e1f235740c3ead61de9458d","2010-07-11 21:03:23+00:00","SCI: fix signature loading for subops, fixes kq6 signature mismatch

svn-id: r50807
"
"e3d48dc9c23d7cd090f8ba157710379db5a82b1c","2010-07-11 21:15:24+00:00","Update German translation.

svn-id: r50808
"
"4c9ad98dfef2b643d14a6a55615e2a54e5822f70","2010-07-12 08:38:30+00:00","SCI: returning 0 when parameter reads go out-of-bounds, onto the stack and hit an uninitialized temp, fixes pq2 .490

svn-id: r50812
"
"101498e7701aec9240599122fd161c9b407f28f7","2010-07-12 08:59:43+00:00","SCI: adding 3 uninitialized temp workarounds for kq6 - found and created by Ceriand, thanx

svn-id: r50813
"
"c1e954bdad96b7ae8e518e92aec365c7c26377bb","2010-07-12 09:24:18+00:00","SCI: add workaround for lsl6 restore issue (needs to get further investigated), hunk segment is used but hunk segment isn't existant at that point when restoring the game

svn-id: r50814
"
"21c91066202f58ca50ff26a7c543379c53045fba","2010-07-12 10:31:32+00:00","SCI: added another workaround for lsl6 kGraph(restoreBox)

svn-id: r50815
"
"698a347da6ceeecf922209709ac68eec9ce0e1d1","2010-07-12 10:47:47+00:00","SCI: adding another restore workaround for lsl6

svn-id: r50816
"
"e782fec85aa48b8b32f4e1e1d3677411d99899ae","2010-07-12 11:09:11+00:00","SCI: Remove dead code

svn-id: r50817
"
"20ef5c562335e1f3fa45307b3f43065da0c4dfa4","2010-07-12 11:09:29+00:00","SCI: Fix warning

svn-id: r50818
"
"ad098addd25891daf876a0ac21122d94920b2fcb","2010-07-12 11:20:42+00:00","SCI: adding uninitialized workaround for lsl6

svn-id: r50819
"
"8fa759adb3c9bcb3e8948b31d2deaabd9295dff6","2010-07-12 12:31:13+00:00","SCI: adding workaround for signature mismatch when giving merrily the key to the bungee tower

svn-id: r50820
"
"ac268edafbcaec0dac36d895c71ae1d71ce615b4","2010-07-12 15:50:23+00:00","Consistently use 'MT-32' as short name of the Roland MT-32 in our GUI and credits files.

svn-id: r50821
"
"9644e7fe5f3d152b0f57b18cc5d452094280bdda","2010-07-12 15:50:48+00:00","Properly add Matteo Angelino to our credits for his Italian translation.

svn-id: r50822
"
"9522e68f76e707adb397d0dd37b25bdd1f16eff5","2010-07-12 15:53:24+00:00","Whops. Also now properly add Matteo's nickname to our credits.

svn-id: r50824
"
"8364b0bd29ddcf68cfc9ee53d09eb326703347e9","2010-07-12 17:50:36+00:00","SCI: adding kUnLoad workaround for lsl6 (during end kUnLoad is called with additional 4 parameters, someone thought the API would work differently)

svn-id: r50826
"
"535dbb7f59afe1c0d4576ada41c73cf07632b133","2010-07-12 18:22:24+00:00","SCI: fixing typo

svn-id: r50827
"
"0c42441426a6ade7cf659847dbffb24a63780de8","2010-07-12 19:41:26+00:00","SCI: added TODO for saved games

svn-id: r50828
"
"d52a872724d779b12385aab2925a6b8b7bfcedb4","2010-07-12 19:55:42+00:00","SCI: changing gameid of lsl6 sci2.1 into 'lsl6hires'. We need to keep workarounds etc. separate, scripts are not compatible

svn-id: r50829
"
"8d7bc0eab5b8987829fb78690f0034283e98b549","2010-07-12 20:17:42+00:00","Some documentation fixes.

svn-id: r50830
"
"6ff4dd2d91d5fe05495bec81a91e5c40ccd9b8be","2010-07-12 22:26:48+00:00","SCI: changing how savegame ids are handled internally. Using range 0-999 so that scripts are able to signal us to create new slots, using range 1000-1999 for official slots. fixes lsl6 quicksave overwriting wrong save slots

svn-id: r50831
"
"8e9d933658bce3b613879b4679321b1c71cfffd4","2010-07-12 23:18:44+00:00","SDL: Overhaul OSystem_SDL::getSupportedFormats

* Do not use global constructor for the RGBList and BGRList
tables anymore, by moving them inside a function.
* Update the list of supported formats if the hardware
screen surface changes. Previously, the list of supported
pixel formats (and its order) was computed only once and
then never changed.

svn-id: r50832
"
"e2c1ee853a1cd1ce56536a4b4436a8da5277d0cb","2010-07-12 23:19:08+00:00","SDL: Tweak OSystem_SDL::detectSupportedFormats a bit

Previously, the code in OSystem_SDL::detectSupportedFormats
assumed that the arrays RGBList and BGRList had the exact
same length, and that the entries in each mirrored those in
the other 100%. Instead of relying on that, the code now
simply iterates over both lists separately. This changes the
resulting order a bit, but since we never gave any
guarantees on that, this should not matter.

svn-id: r50833
"
"4f914e7a9f1379f06749b1f01fa83b8464c13d7f","2010-07-12 23:19:33+00:00","TINSEL: Replace global object s_rectList by a TinselEngine member var

svn-id: r50834
"
"dcd520ce310a593e7dbc5ecac60c5f3f3e8363a6","2010-07-12 23:19:56+00:00","Get rid of yet another global object with constructor

svn-id: r50835
"
"1d3a0f6decd54b017d2ca55a95048de4afdbd868","2010-07-12 23:20:33+00:00","SCI: Turn global object g_debugState into SciEngine member var

svn-id: r50836
"
"03c0faa5d76f547603ee6389cdf958e2a6f0f43d","2010-07-12 23:21:03+00:00","SCI: Move breakpoint checks into SciEngine methods

svn-id: r50837
"
"762c569207f778b5b3efad9414a3cfe943424316","2010-07-13 08:00:22+00:00","PSP: Typos in trace.h

svn-id: r50844
"
"d2b47ee775b41779427be111f7a755ee7e796a4b","2010-07-13 15:42:59+00:00","SCI: change handling of priority in combination with embedded cels inside picture resources, change in r49029 was wrong - fixes pq1 (map not changing when driving car)

svn-id: r50845
"
"b97ef271c7f929fea02a1bd05950a61a9c313198","2010-07-13 15:46:21+00:00","SCI: adding comment about GfxPicture::draw() and picture resource formats

svn-id: r50846
"
"8171093614c16db6284a53ce00700aeb115419b4","2010-07-13 15:49:13+00:00","SCI: adding comment about palette formats

svn-id: r50847
"
"44626efdce1856a0986a223d0ef0e9dda209f180","2010-07-13 18:11:50+00:00","SCI: removing old kernel signature stuff

svn-id: r50848
"
"19d4374cbd5c8c7dc6b6b8d59463460fb464ae47","2010-07-13 18:15:19+00:00","SCI: erroring out on unsupported soundversion in midiparser

svn-id: r50849
"
"85958744a2314d5b2556bece162dbf6bc4d54505","2010-07-13 19:26:45+00:00","Added code to enable testsuite selection using checkboxes

svn-id: r50850
"
"a18825519677cc783cab9cebc798797d30bb153c","2010-07-13 20:14:42+00:00","SCI: adding quest for glory 1 export save filename ('a:glory1.sav') for filename fixing

svn-id: r50851
"
"946d69cc5e4877e561fb15069297c187cfa145d4","2010-07-13 20:28:17+00:00","SCI: adding quest for glory 2&3 export save filenames (same types and object names as qfg1)

svn-id: r50853
"
"15f5cc43efed6bbb959b332702d38760c41b8be6","2010-07-13 20:42:42+00:00","SCI: uninitialized workaround for qfg2 when accessing inventory

svn-id: r50854
"
"28fca2dba39000c4ef0b54f0566248784f1ee700","2010-07-13 23:46:17+00:00","Fixed the signature check for DoSound (play) for SCI2.1 games, so that they start again

svn-id: r50857
"
"217af391cdd42b9d97c5836a809fc8585e0ae097","2010-07-14 00:52:21+00:00","SCI: Removed a chatty (and unneeded) warning

svn-id: r50860
"
"2bfee401d225bb0c456eaf8041f166498b8665c0","2010-07-14 00:57:48+00:00","SCI:
- Split SCI2 from SCI2.1 signature checks
- Added signature checking for the subops of the SCI2.1 kernel call kList
- Added support for calls to kAddToFront and kAddToEnd with 3 parameters (unimplemented code uncovered by the signature checks)
- Added a FIXME for a potential incorrect subop (uncovered by the signature checks), which might be related to the crashes in the demo of Torin's Passage

svn-id: r50861
"
"20e672e34dc7f4923fe9b107acbab6439c2fef08","2010-07-14 02:02:03+00:00","Typos

svn-id: r50862
"
"b5d4056e9c0a30d73c5226857d579464d3c2be5e","2010-07-14 02:12:03+00:00","Typos

svn-id: r50863
"
"1cb53050835e443bad589d035b9a5f91b600e338","2010-07-14 02:12:58+00:00","Fixed loading saved games from the launcher, broken in rev. 50831

svn-id: r50864
"
"ab36bdfd003d51d399e7e0c7fbf16390b6253f24","2010-07-14 02:28:17+00:00","SCI: Fixed script bug (invalid call to kStrCpy) in Island of Dr. Brain, room 260 (Hominy Homonym puzzle)

svn-id: r50865
"
"eb617f02db56ae757efc9d7108ee9730003fbd99","2010-07-14 02:34:14+00:00","Whitespace/layout

svn-id: r50866
"
"1ae8d1689d116454f1c6c41391b860bab9bdd9e7","2010-07-14 02:36:49+00:00","Oops... whitespace/layout again (I'm tired...)

svn-id: r50867
"
"bc0c3061100a87d14a75c72296124b741e713218","2010-07-14 04:33:35+00:00","If the ALSA driver hasn't been opened, closing it should do nothing. This keeps
ScummVM from crashing if, for instance, someone accidentally closes the driver
twice.

svn-id: r50870
"
"3cb59d237e85805eeab377ec8d571a76d83cd029","2010-07-14 04:34:57+00:00","Don't close the MIDI driver twice. It's unnecessary, and some of our drivers
may crash. (The ALSA one did, until a few minutes ago.)

svn-id: r50871
"
"67601273002a43134d23202eed759c1691ea16dc","2010-07-14 04:42:27+00:00","The new buffer has to be one byte longer than the length of the 'buffer'
string. (Error spotted by cppcheck.) Also, there's no need to use sprintf()
where a strcpy() will do just as well. (It's tempting, but probably not
appropriate, to use strdup(). I'm guessing the buffer *has* to be allocated
with 'new'.)

svn-id: r50872
"
"d5ff65bc023c5e68db8a3fed4dc4cf6decc6356e","2010-07-14 05:04:55+00:00","Fix valgrind warning.

svn-id: r50873
"
"646ea5828c091ef59c0c97f2cfdc02a67aa99f95","2010-07-14 09:00:44+00:00","SCI: moving hack signature for kDoSound(play) to SCI1LATE only, adding comment about this and changing signature for SCI1EARLY back to what it was.

svn-id: r50874
"
"1ec55288c6bd9f037799446c897240f0b5b88973","2010-07-14 09:04:41+00:00","SCI: replacing fixme with todo

svn-id: r50875
"
"ef0119498b738193757b8e62f90827c5d92589d0","2010-07-14 10:45:42+00:00","SCI: changing SIG_SCI2 back to SIG_SCI32, because all those signatures are meant for SCI2+, not SCI2 only. Changing SIG_SCI21 to only mean SCI2.1 instead of SCI2.1+, making main signature and mapping of kList exclusive to SCI2.1

svn-id: r50876
"
"b1f2ea64a7c1b472114831711a6929d2e761a1e0","2010-07-14 11:10:33+00:00","SCI: replacing some tabs with spaces

svn-id: r50877
"
"539d10ea11b1335613bbf4901f6952c8d97c07d3","2010-07-14 11:29:55+00:00","SCI: adding sound version 2.1, to properly add sci2.1 signature for kDoSound(play)

svn-id: r50878
"
"76f6449431e28b7530c94698467499139ffce860","2010-07-14 11:34:44+00:00","SCI: changing signature of kDoSound(play) in SCI2.1 to 'o(i)' now, because qfg4 still uses 'oi' calling

svn-id: r50879
"
"ede8fead945ea2901d6e812d4d6a8e44b4677c55","2010-07-14 11:41:24+00:00","SCI: changing kList(18) into StubNull, so that torin demo works a little more till we figure out what's supposed to be in there

svn-id: r50880
"
"f456b7cfa242994e156009210102358b66cff9e5","2010-07-14 11:53:12+00:00","SCI: separating qfg1ega and qfg1vga gameids

svn-id: r50881
"
"f796fd6cf39c322b7482faee771be666c217480e","2010-07-14 11:55:15+00:00","Preliminary implementation of lots of code related to player movement

svn-id: r50882
"
"ec65befa3c2b91188d6f7a45acee43b1a325e09f","2010-07-14 14:05:08+00:00","Silence gcc warning.

svn-id: r50883
"
"df49298f39fad9c57d4b68c1ff6c10351080e2f6","2010-07-14 14:09:48+00:00","Update comments about the SCI2/2.1 kernel table. The SCI3 table is also different from both of them.

svn-id: r50884
"
"0b3201e5e3449f90187938e5dd699535fdaadeb8","2010-07-14 14:12:42+00:00","Whitespace cleanup (mainly spaces and tabs at the end of line)

svn-id: r50885
"
"36fdc68b2bdaea952213460ee1475ddea70cc210","2010-07-14 14:18:40+00:00","The LSL7 demo is SCI2.1 so we should detect it even when ENABLE_SCI3_GAMES is not defined.

svn-id: r50886
"
"14e25d138c20060067d0986eeeaf20d912ada0e6","2010-07-14 14:55:22+00:00","SCI: fix regression of r50831 - we want to abort when unknown savegameIds are used, not the other way round :P

svn-id: r50887
"
"25077baf6a665e56806bf6f7d050d6462d39ec5b","2010-07-14 16:55:32+00:00","Moved setTileData() into GdiPCEngine since that's the only class that uses it.

svn-id: r50888
"
"b91ef128975c6f253bed6c7720f4ead9e1ab0dc6","2010-07-14 16:57:16+00:00","Fixed typo in comment.

svn-id: r50889
"
"f98fa72ef38ed2fd0239d59bda07acdb33b831c8","2010-07-14 17:02:14+00:00","Changed abs() to ABS() in a few places.

svn-id: r50890
"
"6c22d599ecf84c9d3a7fbce9203ab67b3974e465","2010-07-14 17:04:53+00:00","Fix non-PCSPK sound types in AGI.

svn-id: r50891
"
"a694c5ddcf213cea56b0ed81334083edaa129f02","2010-07-14 19:12:31+00:00","SCI: adding workaround for qfg1vga script bug (div on object) which occurs when entering inn

svn-id: r50892
"
"555acf4ba17898c0192c262f9dae45ab43a47185","2010-07-14 19:44:51+00:00","Some code formatting fixes

svn-id: r50893
"
"40ed004b18731c873524b4f3d7d6d6551ca00769","2010-07-14 21:00:59+00:00","SCI: removing hardcoded size when drawing list controls - fixes load/save dialog in lsl6

svn-id: r50894
"
"5e2758394cbc767ea1a3f30c7812c5f588346e1d","2010-07-14 21:17:56+00:00","SCI: returning DOS error code on kFileIO(unlink)

svn-id: r50895
"
"3195ab099a10cbe13557064fe58a7cabbb981dfd","2010-07-14 22:07:36+00:00","SCI: added signatures for kFileIO, some changes to actual kFileIO code, removed some CHECKMEs/TODOs

svn-id: r50896
"
"7c210829dd3b4b3078a5c98bda9a7224165daa82","2010-07-14 22:19:05+00:00","SCI: removing #ifdef ENABLE_SCI32 from one single line (just a waste) and adding it to kDoSound (SCI2.1)

svn-id: r50897
"
"12ebe8065e6020415cb3a6df216a4504014371db","2010-07-14 22:43:59+00:00","Fix warnings

svn-id: r50899
"
"72faf78b82a6395a058d89f1e349c6831e9517a7","2010-07-15 06:04:52+00:00","SCI: adding support to qfg4 to import qfg3 character data

svn-id: r50911
"
"13eb510baf70be80afbad8473c6992b5a5119e99","2010-07-15 10:00:32+00:00","Bugfix to the SqrtF16 function to work correctly

svn-id: r50912
"
"43662625111838729d776cd13708382d9ac6b270","2010-07-15 10:51:11+00:00","Implemented the original game cheat key for displaying the current mouse cursor position

svn-id: r50913
"
"20a0ad6833fd50ed32e660a652ab962cb75d92ca","2010-07-15 12:37:46+00:00","Bugfixes to walking code. Rex can now walk about on-screen

svn-id: r50914
"
"407d65068a79693f42836c36d6394ef310b5238f","2010-07-15 18:51:56+00:00","separated testsuite configuration to another class

svn-id: r50918
"
"ddd01ffcb6a5b3766892529523c912c7c623835c","2010-07-15 19:23:18+00:00","SCI: some big changes to kCantBeHere - kCantBeHere returns the actual 'problem' instead of being a plain boolean - part of solving lsl1 casino door / qfg1vga gate

svn-id: r50919
"
"6e5b537aaffab8c734cec394e80ee5ba85b5aa86","2010-07-15 19:39:43+00:00","SCI: r50919 had some temporary test code in it, removing that so it really returns the actual 'problem'

svn-id: r50920
"
"d78eba3d187b77b9843c3cc9b583c97ee7697998","2010-07-15 21:10:50+00:00","SCI: solved lsl1 casino door, lsl6 tram disappearing and qfg1 vga gate issue - i hope this won't cause regressions, but calling the method in collision case is definitely wrong

svn-id: r50921
"
"30238347e9b68a597f395dfe6662557de5ac3cfe","2010-07-15 21:28:48+00:00","SCI: kDoBresen now returns result of CantBeHere() like sierra sci does it, also adding another comment about r50921

svn-id: r50922
"
"d20ae841dd4321cb602139e175bef42f00268fcd","2010-07-16 03:07:30+00:00","Cleanup.

svn-id: r50923
"
"bcb4c49a03a0eb6786ec008da522f1c3314c28f6","2010-07-16 03:14:03+00:00","Cleanup.

svn-id: r50924
"
"992a8bfd3f05fc54aee3e25905d037ad0814a469","2010-07-16 03:14:58+00:00","Cleanup.

svn-id: r50925
"
"b4459fe92338d1d83cac909519174456402d716e","2010-07-16 03:31:45+00:00","Cleanup.

svn-id: r50926
"
"ae1afee564070234afc0a1b4fca619b3231d4e57","2010-07-16 03:32:59+00:00","The standalone MIDI files for one of the re-releases of Inherit the Earth are
General MIDI, not MT-32. (I hope this doesn't break anything else.)

svn-id: r50927
"
"bde1cbd785d14ed8a45a6863aa75ff380a30541e","2010-07-16 03:34:25+00:00","Cleanup.

svn-id: r50928
"
"9fafc859199f16a693ba40d18cd5e93f49d4b2fa","2010-07-16 03:35:44+00:00","Cleanup.

svn-id: r50929
"
"90763f6e24ae1c51f4c8a9d0486a5488ea200f61","2010-07-16 05:46:07+00:00","SCI: kDoBresen - save last position of client inside mover - fixes lsl6 tram still shaking while gotten stopped due ego

svn-id: r50931
"
"3473e8c6da4565d3c0729ba106b5405dc6039d29","2010-07-16 08:03:26+00:00","Clarified variable used for scene node loading, and added in extra blank nodes for player movement like the original game does

svn-id: r50932
"
"5356a6133872c00ce0db904047ce2624bf853e03","2010-07-16 09:51:57+00:00","SCI: only use xLast/yLast in kDoBresen for sci1middle+ only. qfg1 ega has those selector names, but doesn't use them inside mover objects

svn-id: r50933
"
"1e4261bab455a43f23d9b59736c67474a563d703","2010-07-16 10:00:58+00:00","SCI: added comments about when xLast/yLast were exactly introduced

svn-id: r50934
"
"b062488987ed43d10d404f91c52e502fe3c44a37","2010-07-16 10:12:31+00:00","SCI: enable r50931 for sci1late+ only, lsl1vga doesn't like it (ego gets stuck)

svn-id: r50935
"
"379a55f089f70ee961bacf3072eead629cb1d2e3","2010-07-16 13:15:18+00:00","Implemented path-finding logic for accurate player movement

svn-id: r50936
"
"3ceb02f08ac46537ba3bbc092b5b15f2390738c8","2010-07-16 13:37:19+00:00","SCI: adding signatures for 4-parameter variant of kDoSound(sendMidi), needs to get figured out how this works - fixes signature mismatch in lsl1

svn-id: r50937
"
"60363b8a53be77e56b23bca87926d07d3dc56ff5","2010-07-16 14:16:47+00:00","SCI: adding uninitialized workaround for lsl1 when playing at the casino

svn-id: r50938
"
"564b68a9fc85ed5d7ec6c374a0bc604051744e5a","2010-07-16 19:33:28+00:00","SCI: adding fixme and error() to fix crash when trying to run unmodified gk2

svn-id: r50939
"
"92c0e7e800dfcd1bf23febefc1b51fff3e9a57ac","2010-07-16 19:40:51+00:00","SCI: fix console commands so that console gets detached correctly

svn-id: r50940
"
"38fb180edbb02d8c374f16207f595291c4948e38","2010-07-16 20:00:16+00:00","Add entries for the DOS, FM-Towns, and PC-98 versions of RTZ (all on the FM-Towns CD).

svn-id: r50941
"
"e75eee21e38c71ae67382ff83ce926991f58743a","2010-07-16 21:50:12+00:00","Use 'true' instead of '1' in if statements to make clang a bit more happier with -Werror.

svn-id: r50943
"
"587f3cf9586f019b59e7a4145e692ebde73d52df","2010-07-16 21:56:30+00:00","CINE: Get rid of g_saveFileMan

svn-id: r50944
"
"70b6ee0a5bef3701328c456fd6f4c9d95aa47536","2010-07-16 21:56:50+00:00","CINE: Get rid of some unnecessary g_cine refs

svn-id: r50945
"
"30a92bec6be657df29881de8075c5075f2289e28","2010-07-16 23:02:17+00:00","Removed unused variables.

svn-id: r50947
"
"4a52413a46c2b2fe5b81e15fef1ad34ef781bc4a","2010-07-16 23:04:59+00:00","Removed unused variable.

svn-id: r50948
"
"17dcf79936b15bb4f830b3135a239b00edd315af","2010-07-16 23:09:13+00:00","Cleanup

svn-id: r50949
"
"4172a94edd9eaba0d6dc27d09c8858704d7010a0","2010-07-16 23:10:41+00:00","Cleanup.

svn-id: r50950
"
"aa631a64dce17e89cc657b4588af0ba032b9664d","2010-07-16 23:23:30+00:00","Removed unused variable. I believe thread->_instructionOffset serves the same
purpose that 'addr' was inteded to.

svn-id: r50951
"
"bf17cc1053b4273ff21f069e161fdb38b4aec83a","2010-07-16 23:30:29+00:00","In the help of making the new C++ standard a better one, we will now no longer rely on using parent class names in friend classes of a subclass.

svn-id: r50952
"
"ddb364412e3286eb68479285abc567351f4b5b45","2010-07-16 23:30:50+00:00","Fix use of '&&' instead of '&' for bit masking. (This looks much more sensible at least!)

svn-id: r50953
"
"83e2aa236092120bf03efbf38558f69719dda11a","2010-07-17 00:05:27+00:00","Remove extra ';' in class declarations.

svn-id: r50955
"
"e000d2865450090d28f6a72608b963ece6435d4a","2010-07-17 12:06:31+00:00","SCI: fix debugging code of parser, add 0xffe special group into debug support

svn-id: r50956
"
"1d31c278e6234d9624d4698aef9c9e3da8ea8ee1","2010-07-17 12:37:02+00:00","SCI: Fix 'parse' debug command parameter handling

svn-id: r50957
"
"e9ed821953c3008b8bcfd836cd1afaa2428c6c16","2010-07-17 12:46:57+00:00","SCI: add hack for iceman to skip [!*] in kSaid, fixes green board / depth affirmative not recognized

svn-id: r50958
"
"7ac5c3ef4faa91d48953c36693f406a749f80787","2010-07-17 12:57:05+00:00","SCI: added iceman hack to original said.y as well

svn-id: r50959
"
"cb4072f978b46a031b2ffb24e43eee7b76ef815f","2010-07-17 13:27:07+00:00","SCI: added special case for iceman when plotting course inside isSaneNodePointer

svn-id: r50960
"
"8c31dd7e854ef19b28bc5f5ef8b1e5b5073927bd","2010-07-17 13:32:11+00:00","SCI: added gameid for send() sq4 workaround

svn-id: r50961
"
"625af1260b2b6a28b57726564547d740fce35cad","2010-07-17 17:58:50+00:00","SCI: checking if within kernel function before overwrite a save (thx @ digitall)

svn-id: r50962
"
"1d4c82885ddcc0442671c863eef643aef2dc7dda","2010-07-17 18:38:42+00:00","DEBUGGER: Simplify how our console debugger works / is used

* Remove _isAttached member var and isAttached method
* Engines now always call the onFrame method; whether it does
something is decided by the debugger class resp. its subclasses
* Make detach() protected instead of private, so that subclasses
can invoke it
* Remove _detach_now member var (call detach() instead).
* Rename _frame_countdown to _frameCountdown and properly
document it.
* Add more doxygen comments
* Cleanup

svn-id: r50963
"
"0b48a71c9955b39117e2eb35b3e398f5c95c008a","2010-07-17 18:41:38+00:00","Remove PalmOS port

svn-id: r50964
"
"fb206fb7c0227ba24afc7c12cfd55d5219dcbe77","2010-07-17 18:51:54+00:00","SCI: added uninitialized workaround for lsl3

svn-id: r50965
"
"48b288d9aa3fdb6079ec5d5be1cc56f1f446f945","2010-07-17 19:11:59+00:00","Fixing compilation with MSVC

svn-id: r50966
"
"723f15c0848e828a6877365ff0453d16ebcb0589","2010-07-17 19:52:19+00:00","SCI: removing kSetPort 4 argument support from r44938, which was wrong - adding workaround for lsl6 ending - fixes lsl6 ending

svn-id: r50967
"
"880bb9f421811b7c8ff170bc0332201d07b0ee65","2010-07-17 20:29:33+00:00","Add support for the altres.map/altres.000 map/volume pair in KQ7.

svn-id: r50968
"
"88dfa3142f46f1f346614dd9ca298be98023750c","2010-07-17 21:13:37+00:00","SCI: adding uninitialized workaround for gk1

svn-id: r50969
"
"bbcf020457a19bf7fdbc758d5f878554058dbd08","2010-07-17 22:11:35+00:00","SCI: adding detection for SCI01 vocab inside a SCI0 game that's using the SCI0 vocab resource number, fixes pq2 japanese crashing on startup

svn-id: r50970
"
"fd157b47a3ac31cd2d22875b7d0f7bf5c3c0bf49","2010-07-17 22:32:31+00:00","Implemented scrollable checkbox like behaviour using ListWidget

svn-id: r50971
"
"cd0997368cfc9f272888a96e80b1f4cc2379d0bc","2010-07-17 22:59:57+00:00","SCI: adding pq2 japanese pc98

svn-id: r50972
"
"c128b87c779ab74deb494c48782fc8199c9672a5","2010-07-18 00:16:19+00:00","In SCI2.1, the type numbers inside resource maps/patches have changed slightly. We no longer use the number Sierra gives us directly, but use a function to convert to our ResourceType enum based on version. This allows us to read the chunk type from SCI2.1 (a form of script). Also, allow debugging of Mac-specific resources from the console.

svn-id: r50973
"
"4b66b8dd5f73702fb71cda6cc3d7b6f969d242e8","2010-07-18 00:18:27+00:00","Fix typo.

svn-id: r50974
"
"88b2bec07239b2babc7041b1361873fd331ad838","2010-07-18 01:32:48+00:00","Cleanup and simplify resource type remapping.

svn-id: r50975
"
"525794927ed57fd18d3e713a5869f8fcde5ae2a9","2010-07-18 04:25:57+00:00","SCI: fix regression of r50896, behaviour of kFileIO(readString) is supposed to return the string instead of the size, fixes signature mismatch in hoyle 3

svn-id: r50977
"
"59bb9f8fe82432b35de103f7e705d91fde3f3f2a","2010-07-18 04:56:16+00:00","SCI: added uninitialized workarounds for hoyle 3

svn-id: r50978
"
"58a1fbc13c116d3fa69c426c0cdeb459d354fbf0","2010-07-18 06:49:56+00:00","Made memcpy faster but not as fast with uncached mem.

svn-id: r50980
"
"844a332f8de4ab74ec1c739c2ab6f41e8d957d53","2010-07-18 06:59:25+00:00","PSP: forgot test files

svn-id: r50981
"
"30d751734321cc97bd6591af5531ebc5e5f120a4","2010-07-18 07:03:14+00:00","PSP: switched to using my memcpy

svn-id: r50982
"
"07a9a03587ff0df916ac77b9518fdae97ecc4c64","2010-07-18 07:53:05+00:00","a few more modifications in the testsuite selection widget

svn-id: r50983
"
"b6c2be3bb9eed92a6e583844d7197093dd42ef50","2010-07-18 09:08:18+00:00","Some more improvements in the TestbedListWidget and added description method in testsuite class

svn-id: r50984
"
"f17c363683690f25915ee8cb1fef9ad21f76734a","2010-07-18 09:34:31+00:00","Selected entries are now marked as '(selected)', toggled by double click

svn-id: r50985
"
"0ae45ed7ed955f88fc692c1fcdec8771ecbb0071","2010-07-18 09:50:05+00:00","fixed a minor typo

svn-id: r50986
"
"98f0b06fe3afcdff66646cf0f3bee5dd9c0b801e","2010-07-18 12:25:40+00:00","SCI: adding workaround for script bug in lsl6 when looking through tile

svn-id: r50987
"
"f36eb7e2edf5ec6140c1fce136c1804cdf81e787","2010-07-18 12:26:22+00:00","SCI: Fix warning

svn-id: r50988
"
"70dfcdfb54707b95b115fbb60e86cd841cc42ffe","2010-07-18 12:53:24+00:00","trying to fix psp build for case sensitive filesystems.

svn-id: r50989
"
"4595b8818a862649d244687e57f15d0cce7d48c0","2010-07-18 13:08:47+00:00","SCI: adding room numbers to all workarounds

svn-id: r50990
"
"921c9a8e33733f119020abb5d99a1b509b119f69","2010-07-18 13:31:05+00:00","SCI: Add basic debugging command for 'said'

svn-id: r50991
"
"1e72d488678813a3a27ba1266b699e09ea357afd","2010-07-18 13:31:23+00:00","SCI: Work on optional expressions in said rules.

This fixes a number of said specs in Iceman, but has a good
chance of introducing regressions since it's fairly invasive.
It also removes the need for the hack in r50958.

svn-id: r50992
"
"fd27041b3545fdf627ebfe4e6b12d1298f449fa6","2010-07-18 14:21:38+00:00","SCI: disabling saving from scummvm menu

svn-id: r50993
"
"46b27926b21dd1fac3b5948415670054ad67c6b8","2010-07-18 16:02:16+00:00","SCI: adding obj in kDoSound debug output

svn-id: r50994
"
"aa5a1ddb473237b0b7a857c974850424f5c8a576","2010-07-18 16:22:16+00:00","SCI: if game starts fading, stops music and later starts music again don't resume fading - fixes lsl6 music when going in from swimming pool

svn-id: r50995
"
"3189fe4a329ce5d762f8e396d188117f42325fa9","2010-07-18 16:25:23+00:00","SCI: change to r50995 - better stop fading when stop is called

svn-id: r50996
"
"f2496427339e009d17dbe225cd76c55ec1badcc1","2010-07-18 17:18:56+00:00","SCI: making int/uint comparsions more verbose

replacing int/uint comparsion opcode with new code that also displays much more information in case of errors and also add possibility to easily add workarounds

svn-id: r50997
"
"5b4fd084b066d36cc68c7b9a635f10d6fb3c44d7","2010-07-18 17:48:48+00:00","SCI: Fix order of characters when using hexDumpReg.

svn-id: r50998
"
"a2ea3381feadf69ced8107ca19b9ea029f761189","2010-07-18 18:01:52+00:00","SCI: ipToa/ipTos/dpTos more verbose

...and adding ability to add workarounds easily

svn-id: r50999
"
"d2fc68222b68f17d5850cf214a22663cd86807ac","2010-07-18 18:11:37+00:00","fixed some typos

svn-id: r51000
"
"6eedb73dba118910198b5d0d727e56ad91052ee4","2010-07-18 18:14:56+00:00","SCI: Add initial support for SCI0 Mac and SCI1 Amiga/Mac sound.

SCI1 sound is pretty much done, but envelope support is still not 100% complete. SCI0 Mac sound is not complete, but sounds 'ok' for now.

Much thanks to Walter, who did a ton of work on this.

svn-id: r51001
"
"d14635d6b26972f4a0cb7d66ce25090b6157a5cc","2010-07-18 18:18:11+00:00","SCI: Oops, silence gcc warning.

svn-id: r51002
"
"d06603f151f1d66410aaa3f533ff7308c3b60d3a","2010-07-18 18:26:00+00:00","SCI: make bnot/mod/mul more verbose

...and add abitility to easily add workarounds

svn-id: r51003
"
"2127da538de70605f046ba8392ed6b5c6a71ecac","2010-07-18 18:38:49+00:00","SCI: Add Mac signature for kTextSize which can have an extra integer parameter.

svn-id: r51004
"
"b23dd848ed70cf60856d76942b2a58f385be87ea","2010-07-18 18:57:28+00:00","SCI: make the left-over opcodes more verbose

...and add ability to easily add workarounds
remove ACC_ARITHMETIC_L and POP()

svn-id: r51005
"
"0e9de72f626489a3186ee4d8c7c8c1028740445e","2010-07-18 19:01:35+00:00","SCI: Rename the Amiga music drivers to AmigaMac to reflect its current purpose.

svn-id: r51006
"
"fc1e5c8faeedf13217658d22c7f25adce1a9e75b","2010-07-18 19:19:49+00:00","SCI: adding comments about not enabling ScummVM menu saving

svn-id: r51007
"
"8893d4ef2307696a306ab2e643857b17d354228e","2010-07-18 20:14:18+00:00","SCI: add workaround for script 500 lsl3

svn-id: r51008
"
"dbc16076034d23181b4a2ea897afbf6b923208ee","2010-07-18 20:19:14+00:00","SCI: add script number to r51008 change

svn-id: r51009
"
"e4271b0bb09cd80abc49444495aa9a6fac579ab1","2010-07-18 20:36:19+00:00","SCI: fix warning

svn-id: r51010
"
"efbac08e6b5de96436b32ee5e8a79ba7f2b9cb88","2010-07-18 22:11:22+00:00","SCI : Corrected valgrind error on engine exit

svn-id: r51011
"
"75dd75a73767319b2797a140f985dfc356462862","2010-07-19 05:30:40+00:00","SUBSYSTEM: ALSA music driver

We should probably open the sequencer the exact same way, both when
opening the driver and when asking it for available MIDI devices. Not
that I've been able to figure out the difference between 'hw' and
'default' from the fine ALSA manual...

And I'm not sure we really need to try and keep compatibility with
ancient (pre-0.9.0?) ALSA any longer...

svn-id: r51014
"
"d952e48a57a8efb7c6b8fbe8163cbde889b7e88f","2010-07-19 07:29:17+00:00","SCI: change kDoSound(updateCues) for samples

only set signal when sample was/is playing, fixes qfg2 genie intro

svn-id: r51017
"
"9cb23c8a7bcda26196e78af3e28da67db6b987ea","2010-07-19 07:37:22+00:00","SCI: update sample ticker when paused

little adjustment of r51017

svn-id: r51018
"
"abae29a2dccfc132505687e70c220beb2f56defe","2010-07-19 07:47:11+00:00","ALSA: Get ALSA port settings from the new device config settings.

This is also an attempt to make the transition from the old settings to the
new ones a little less rough, by trying to put something sensible into the
first device, which is what's used by default. Currently it prefers 17:x
and 65:x since they're the old defaults, followed by 128:x since that's
probably TiMidity.

The old SCUMMVM_PORT environment variable still overrides any config
settings. I haven't made up my mind whether or not that's a good idea, but
at least it prints a warning message.

TODO: The old 'alsa_port' setting is not handled. It should probably be
used to set sensible defaults for the new settings, but I'm not sure where
this should be done.

TODO: The documentation will need to be updated, once everything is working
the way it should.

svn-id: r51019
"
"6bebc0df452c722de8ce0fd1b7458331f3e13a0e","2010-07-19 08:17:09+00:00","SCI: fixing signature for kDoSound(setReverb)

fixes lsl5 signature mismatch, signature was wrong

svn-id: r51020
"
"b48045662dd4618ec9058bdc05ec50089abf740f","2010-07-19 10:19:13+00:00","SCI: fix ult to work for pq2 japanese

pq2 japanese compares pointers to 2000 to find out if its a resourceid or a pointer

svn-id: r51023
"
"42107e2f5c09d9b25419ea8e2710502ca94b88a4","2010-07-19 10:38:03+00:00","SCI: vocab version change for pq2 japanese

pq2 japanese only uses sci01 vocabulary and everything else is still like in sci0 - fixes pq2 not accepting any input in parser

svn-id: r51024
"
"07009b045e35133b0a398ecc0d78316ed2e01d09","2010-07-19 11:41:20+00:00","SCI: fix parser crash on >=0x80 chars

svn-id: r51025
"
"8ea7eec267d925783e5762f54991e0d3879f7bd9","2010-07-19 13:05:41+00:00","SCI: lsl6 workaround switched on for all rooms

lsl6 workaround also happens later, so we switch it to all rooms

svn-id: r51026
"
"2a0cff5c6ddc8409ef7daeead61b8e89479fe5a0","2010-07-19 13:50:06+00:00","SCI: implement foreign vocabulary support

not fully working, extended chars do not work currently as input

svn-id: r51027
"
"9977e2db90bf26ae4d956d2a61063f2b62b18780","2010-07-19 14:28:46+00:00","GUI: Enhance ThemeEngine to find theme .zip files using SearchMan

This is based on the Android specific patch found under:
backends/platform/android/scummvm-android-themeengine.patch
After some testing we should be able to get rid of that custom patch.

svn-id: r51028
"
"cda55fe770ed71f5d4b00690ba4ea196ad4b533f","2010-07-19 14:50:37+00:00","SCI: parser now matches extended chars too

fixes multilingual games not accepting words that contain extended chars (>= 0x80)

svn-id: r51029
"
"7065c87a0d67ba4ec0536e52a465688edadbc602","2010-07-19 14:54:25+00:00","replaced use of snprintf by String::printf

svn-id: r51030
"
"b7b904f9814ca0644a8fea1a3fb9250a4a4fbbd5","2010-07-19 15:30:27+00:00","SCI: fix regression of r51027

we have to reset the parser when switching vocabulary

svn-id: r51031
"
"95ae668da0399c9cd89bb03d42bdea83eb8829f9","2010-07-19 15:32:26+00:00","SCI: don't initialize vocabulary twice

svn-id: r51032
"
"f4a5714477725b7e3016dd1271f65ee7aac0d91f","2010-07-19 16:01:16+00:00","SCI: make sci0 foreign vocabulary also work

makes pq2 load japanese vocabulary too

svn-id: r51033
"
"f4a32793c0d63aba21c960c02f1eec325a1ede94","2010-07-19 16:47:31+00:00","SCI: dont fix list control in sq4

sierra fixed this problem by having an up cursor starting one pixel-line later, adjusting in that case would be wrong

svn-id: r51034
"
"6240e5353e1b26e78893bf2b7bca182b00fcd379","2010-07-19 17:27:56+00:00","SCI: kDoBresen - check xLast/yLast selectors

fixed mixed-up fairy tales demo

svn-id: r51035
"
"5b4ce3831c91d89c1214f412d90c4d36fc84932d","2010-07-19 19:14:37+00:00","SCI: adding 2 uninit workarounds for hoyle1

svn-id: r51036
"
"cef2e24edc8ec6b8c6d2674eedf3222ab1745d85","2010-07-19 20:13:17+00:00","SCI: fixing comment

svn-id: r51037
"
"f3defb0de13026f37cd69025064513ffc3d63c11","2010-07-19 21:12:17+00:00","added code to display progress of the engine so far

svn-id: r51038
"
"961079ae195c200020b577d8f7f6a87f2eaac03f","2010-07-19 22:11:06+00:00","SCI: disabling kDoSound(StopAll)

this call can't be right, gets called in kq1 several times and would stop background effects

svn-id: r51039
"
"211fcfe7bab49ceeb5e81f4dcb1be7e73c58d7c9","2010-07-20 08:24:34+00:00","MIDI: Build and use ALSA driver if and only if USE_ALSA is defined

svn-id: r51053
"
"e527ad162f3fb69508947f7229d7b98f8aceafed","2010-07-20 08:24:48+00:00","BUILD: Enhance configure code, add (unfinished) USE_SEQ_MIDI support

* Remove unused add_to_config_mk_if_no()
* Add two new functions: define_in_config_h_if_yes() and
define_in_config_if_yes(). These make it much more convenient
to #define something in config.h, or in both config.h and config.mk
simultaneously.
* Convert configure code to use the two new functions, were appropriate.
* Add preliminary USE_SEQ_MIDI support, as discussed on scummvm-devel.
This is incomplete as it does not actually detect anything, it just
allows turning off _seq support.

svn-id: r51054
"
"37aa8a7499e6aa1698beb7e241c42ba19475a83a","2010-07-20 08:25:13+00:00","BUILD: Unify adding -DUNIX to DEFINES; complete SEQ MIDI detection

* Added a yes/no variable _unix to configure, which controls when
-DUNIX is added to DEFINES
* Enable SEQ MIDI via _seq_midi by default on UNIX type systems,
except for those which override that.
* Switch SEQ MIDI code to check #define USE_SEQ_MIDI
(alternatively, we could compile it only conditionally...)

svn-id: r51055
"
"5b3f31feec43db358c1ad9bb38a7e602b5a90bb0","2010-07-20 08:56:53+00:00","General: Fixed building the SEQ MIDI driver

An #include was missing, causing the driver to never be built. Also fixed what
looked like a cut-and-paste error in generating the features string.

svn-id: r51056
"
"35e2c78626b9196bd3c059780e273dd0044c1c26","2010-07-20 10:00:18+00:00","BUILD: Fix fallback readline detection

svn-id: r51057
"
"a24de29358a94941190044aaadaf3d2003486888","2010-07-20 11:17:33+00:00","SCI: renaming kDoSound(resume) to resumeAfterRestore

kDoSound(resumeAfterRestore) is called right after restoring a saved game for sound-sci0 games, we already resume playing music inside restore, so we don't need to implement this at all

svn-id: r51058
"
"3c97772d6e5aa05c7991d4114824fb0d7b5ff551","2010-07-20 11:29:56+00:00","SCI: added workaround for kq1 kDoSound(fade)

gets called with object 0:0 in several scenes, just ignore that call

svn-id: r51059
"
"0b3f816c8b13d1cbc2b121461bdcd8aa2068ddde","2010-07-20 11:45:06+00:00","SCI: change the workaround-types

0 is now don't call
1 is do call
2 is don't call and fake acc

makes more sense

svn-id: r51060
"
"6ebcb5326585a3ec2e2708f8a943c86ce6c9d40f","2010-07-20 12:50:13+00:00","SCI: fix regression of r51060

svn-id: r51062
"
"ef69fb1af5e30fa5f6450ea74837086ea3624d37","2010-07-20 14:27:30+00:00","SCI: adding uninit workarounds for cnick games

longbow and king's quest
KQ has the same issues as hoyle 3

svn-id: r51063
"
"90d45aaa7d6aa0b63505e034430293c7b3fe352c","2010-07-20 14:53:55+00:00","SCI: adding workaround for sq1 in bar

kGraph(drawLine) gets called sometimes with additional parameter

svn-id: r51065
"
"14c2fb2f08df8cb8e600734400ffc0c750cbcf7d","2010-07-20 16:05:25+00:00","Implement PlayNote/StopNote and PlayTele/StopTele for The Manhole.

svn-id: r51066
"
"f771a2bbc78b2119d9666c112e6f49d7f13e2e3a","2010-07-20 17:28:10+00:00","SCI: fix regression of r50463

also check delta, because _play_tick does not include delta at that point - fixing sq1 ship takeoff

svn-id: r51067
"
"a0ce89d2e987197df321d0f0fa40b1f4d77f9ba9","2010-07-20 17:58:04+00:00","SCI: clean up workaround tables/code

svn-id: r51068
"
"70ed9dfc70ac5b19e1e648e562ab091598a5e4b7","2010-07-20 18:00:45+00:00","SCI: tiny comment change

svn-id: r51069
"
"102b8c9efd4bad7330428c705fb574285bb6a0d3","2010-07-20 18:18:36+00:00","SCI: adding multilingual mixed up mother goose

sci32

svn-id: r51070
"
"c2577da7e0ef92a5a8586a83ffa710863a2a4f3f","2010-07-20 19:42:48+00:00","SCI: fixed jones/ega/vga port issue

getPortById() error was caused by us remembering port when going interactive, restoring it and restoring it all the time afterwards as well

svn-id: r51071
"
"8e24b7930cd306d84288a3d085dfc99d6fb19f4e","2010-07-20 20:17:23+00:00","SCI: adding lsl6hires uninit workaround

svn-id: r51072
"
"f6be0274df5c9dbdf6de262d310460e2d1d8b2e0","2010-07-20 20:20:44+00:00","TESTBED: added preface to tests, can skip tests now.

svn-id: r51073
"
"2a47f573ddad57655556ccc9b91753987aedb681","2010-07-20 21:22:39+00:00","SCI: some sci32 fixes

kOnMe, kLocal2Global, kGlobal2Local now hires capable, hotspots seem to work in lsl6 and sq6, although pressing on start in sq6 doesn't work yet, you need to click on the rightmost/bottom area

svn-id: r51074
"
"e7abc6da4fe164e1ba7e86a16dc3bf774392a3e9","2010-07-20 21:53:58+00:00","SCI: Fixed an off-by-one error in the resource manager - it tried to load patches of type kResourceTypeInvalid

svn-id: r51075
"
"d53e5fbfb7a3cafff6f21a6d656428f670256e9f","2010-07-20 23:15:07+00:00","SCI: Removed the restoring parameter of the run_vm() function

svn-id: r51076
"
"15fc39589d109245fd66d5cee6319ee19bb8e4d2","2010-07-21 12:05:10+00:00","SCI: more work on coordadjustment sci32

svn-id: r51084
"
"54c516b3bf34ce2f6f4e7f499839dfad2d5fa68a","2010-07-21 12:41:17+00:00","SCI: kSetNowSeen sci2.1

fixes hotspots

svn-id: r51085
"
"e1bc084547ff6235fe35e8f9830f34859c255db7","2010-07-21 13:13:55+00:00","SCI: fixing hires background pictures sci2.1

svn-id: r51086
"
"51258a723c1e5ab2e761556795974b40843553e8","2010-07-21 13:52:41+00:00","SCI: adding lsl6hires uninit workaround

svn-id: r51087
"
"3184aac398bb1bc1df6251d5db878a833c799c10","2010-07-21 14:18:26+00:00","SCI: Moved all the workaround tables in a separate file, to keep them apart from the actual code

svn-id: r51088
"
"2ed45d3719a9d75f35aff7cc80b23468e1ceac3e","2010-07-21 14:50:31+00:00","SCI: Moved all the static kernel-related tables in a separate file. Also, moved kStub, kStubNull and kDummy inside kmisc.cpp, together with the other misc kernel calls

svn-id: r51089
"
"175d6e297d5d50a96f1af6ddc2e37c7c56f84763","2010-07-21 14:54:06+00:00","SCI: More rest of the workaround defs to workarounds.h

svn-id: r51090
"
"bb1c722a0b2b9e35f21ddef8109c443d6b69a620","2010-07-21 17:42:51+00:00","SCI: adding workaround for sq3

fixing off-by-one error when initializing script 93

svn-id: r51091
"
"fcc9de35e254d62d58aac0c68b314bb2f7b5b6db","2010-07-21 18:15:39+00:00","Strip trailing whitespaces.

svn-id: r51093
"
"e5e94d45118781902465024fc9a85c7aa0bfd3ce","2010-07-21 18:17:51+00:00","Strip trailing whitespaces in our common code base.

svn-id: r51094
"
"780b04367738c42f5b1704b495248894f132deb7","2010-07-21 18:59:23+00:00","Janitorial: Removed extra semi-colon.

svn-id: r51096
"
"472dbc9f7d60d873c0979dbb779344937a57261f","2010-07-21 19:19:33+00:00","SCI: fix initializing script 99 of sq3

svn-id: r51097
"
"e95ef4f5f8f007763cf13fd718b6a2b4cdbb5711","2010-07-21 19:20:10+00:00","KYRA: Respect mute setting on engine startup.

svn-id: r51098
"
"a97d8875f5d921a6e6b2583ebe07f75b6989633f","2010-07-21 19:59:33+00:00","SCI: Rewrite said spec handling.

We now use a manual parser instead of a bison-generated one, and the
new code to match said trees with parse trees matches sierra's more
closely.

Also change the parse/spec tree nodes to use direct pointers to
their child nodes to make it more convenient to manipulate the trees.

This has a high potential for regressions.

svn-id: r51099
"
"4d437bafd8be1966df8d690d46d2bebf78380ed1","2010-07-21 20:12:09+00:00","AGOS: Make AGOS respect the mute setting.

svn-id: r51100
"
"e3d1ec482c510d0b7a851cb0d2a675bad79a2ec9","2010-07-21 20:12:35+00:00","LURE: Make LURE respect the mute settings.

svn-id: r51101
"
"97870a220de94ded0d7f0c70a6008c4d47b424ed","2010-07-21 20:12:57+00:00","AGOS: Make the 'm' hotkey respect the mute setting.

svn-id: r51102
"
"ab655ba01fb0eef4864401ab9cd023bd42f6c318","2010-07-21 20:13:24+00:00","SCI: terminating at another resource of sq4cd

contains broken data as well, room 35

svn-id: r51103
"
"0d1c44301ab51ad375e88479b3f965cfccc53a45","2010-07-21 20:22:24+00:00","SCI: halfing kCelWide for sci2.1

fixes lsl6 inventory icon placement, ffs. see comments

svn-id: r51104
"
"44aab95eb9c2b8e8777a50d80d4edbf462762d47","2010-07-21 20:26:40+00:00","KYRA: Fix mute setting with MIDI and FM-Towns/PC98 output.

svn-id: r51105
"
"781aee909bd029f51fe8348dc1158f6835fc7d5b","2010-07-21 20:28:53+00:00","SCI: r51104 adding #ifdef and check for hires

pq4cd is probably low-res, so adding check for hires and adding #ifdef as well

svn-id: r51106
"
"41190f8a7bf74087b113227fb831780d647ade05","2010-07-21 20:37:46+00:00","GUI: Properly show external MIDI devices.

Formerly in case a game only specified GUIO_MIDIMT32, only the MT-32 Emulator
was shown, since that is the only device which is of type MT_MT32. All
external MIDI devices are currently only flagged with MT_GM.

svn-id: r51107
"
"9862f3fe247420832fcc7bd082dcb6f73158843b","2010-07-21 21:18:21+00:00","SCI: Moved the SCI32 kernel functions out of kernel32.cpp and into their respective files

svn-id: r51108
"
"a1dab5f9232d5d72721e6c20b6d20821ea6026d2","2010-07-21 21:37:30+00:00","SCI: Moved all the video related functions in a separate file

svn-id: r51110
"
"e20288fd4f61f7cc0f5c22af4c4762f8fd277dbe","2010-07-21 21:52:15+00:00","SCI: Fixed signature of kFileIO subop 19 for Torin (full version)

svn-id: r51112
"
"093800dc1cfa795ed0b58a0e9be99479f42d2d5e","2010-07-22 08:57:25+00:00","Silenced a known warning in SQ5, after the intro

svn-id: r51131
"
"87e4823c752ce617668a0ad87f810ef274b67ef6","2010-07-22 08:58:59+00:00","SCI: Moved the actual workaround arrays inside a cpp file

svn-id: r51132
"
"66115d697e78c3ff3d9e253c49174e46f50bd62d","2010-07-22 09:36:04+00:00","SCI: Remove '#define FAKE', make SCI_WORKAROUNDENTRY_TERMINATOR 'private'

svn-id: r51133
"
"15ef4b23a0f864a8788be57a118f75bdc6e383fa","2010-07-22 10:24:08+00:00","SCI: some work on priority in sci32

svn-id: r51134
"
"ed1ae39e4685e000cac0810ffeea01356fa55146","2010-07-22 11:11:31+00:00","SCI: removing priority hack for gk1hires

also fixing base picture drawing

svn-id: r51137
"
"68783fa01cb144e676137444126e3c9d6caf0fa9","2010-07-22 11:20:16+00:00","MADE: fixed bug 3029750 caused by caching from commit 46102.

Cache needed to be cleared every time we load a game. Otherwise, those platforms that happen to use the exact same addresses (PC) were ok, but those platforms that had different addresses (PSP for example) would get messed up.

svn-id: r51138
"
"a01152a3bacdeec06a4206b939bcfc1dc2c8ee65","2010-07-22 12:36:58+00:00","SCI: some more work on priority sci32

svn-id: r51139
"
"8eca9d6acb55ae121145ca5779c493244a6499f3","2010-07-22 12:38:48+00:00","SCI: Fixed a bug when loading some saved games (sometimes, the execution stack wasn't cleared properly when loading and you couldn't save or restore)

svn-id: r51140
"
"debe58cd3871882caec7188dc51707bf616ffe35","2010-07-22 13:19:59+00:00","SCI: Added workaround for Engine Abort when rummaging in Software Excess bargain bin.

svn-id: r51142
"
"ede85a539afae551a0e325b92968c2532bd1d358","2010-07-22 14:29:00+00:00","Silence gcc warning

svn-id: r51143
"
"c1ad4a1110e7f5a9b9e8e88015052cf51abda1a3","2010-07-22 14:33:14+00:00","Use new[]/delete[] instead of malloc/free

svn-id: r51144
"
"6c41ca440509d2f965c71d8fcd0502b4d042d0a6","2010-07-22 14:43:19+00:00","SCI: Adding workaround for sq4 room 411

kGraph(RestoreBox) is called with an additional parameter

svn-id: r51145
"
"28bc31a13991b71d7007eaaf82c6f80f09144734","2010-07-22 15:56:26+00:00","When modifying variable selectors with argc > 1, don't throw a warning, but use a debugC instead. These are usually typos in the original scripts, and aren't fatal

svn-id: r51147
"
"b587bf35c8207a71b894d60edba7b30bab84adde","2010-07-22 16:01:32+00:00","SCI: changed the comment about the palette merging (it's not a workaround anymore). Also, changed the warning when a picture has a broken palette into debug output - these pictures (which can be found in other games too) are usually meant to be blank, thus don't have a palette

svn-id: r51148
"
"34c8f5dcc5e1b63b1d97e836fdaabc4e9810acce","2010-07-22 16:12:04+00:00","SCI: Added another workaround to SQ4 Skate-o-rama area.

svn-id: r51149
"
"529af0fc3e4e537d81c3baf445885d87d5dacab1","2010-07-22 16:22:48+00:00","Extended the 'version' console command to also show the game version found in the VERSION file

svn-id: r51150
"
"756ab24f3203837f1101b995c90d1ebbdb4e54b2","2010-07-22 17:12:51+00:00","SCI: Added remaining workarounds to SQ4 Skate-o-rama area.

svn-id: r51151
"
"634d959897695bda9371411ebb9ffda9a09f18d9","2010-07-22 17:25:21+00:00","SCI: Fixed the crash in LSL2, room 42 (when arriving at the island). kAnimate may refer to unfrozen objects which have been deleted, thus handle that case accordingly.

svn-id: r51152
"
"b4a704c342929c5739a56d35b4035b24330380d0","2010-07-22 17:41:42+00:00","SCI: allow isSaneNodePointer to handle invalid node references itself

svn-id: r51153
"
"91e909a25cf056dba37eb6a68bd9ba957cd18175","2010-07-22 17:53:32+00:00","SCI: Added a sanity check for rev 51152. If a node has been deleted, it shouldn't have a successor node

svn-id: r51154
"
"c030858cf130a20179368fb231371ae348d8fda4","2010-07-22 17:59:59+00:00","TESTBED: added deselect capabilty in GUI, removed redundant code, testsuites now all enabled by default

svn-id: r51155
"
"50c2fbbb487fac48cfa9e38ae698cb0be6e77cc6","2010-07-22 18:13:05+00:00","SCI: Also allow checkListPointer() to check the result of lookupNode() itself

svn-id: r51156
"
"aa15d5fcd10301b1a7f1817df541e5658c7f90da","2010-07-22 18:14:43+00:00","SCI: Remove sanity check introduced in rev 51154. When a node is deleted via kDeleteKey, the successor is set to NULL, thus list processing stops (which is what SSCI is doing).

svn-id: r51157
"
"49c41ab166b66f650f91c5710e5329b300fc433d","2010-07-22 19:20:26+00:00","SCI: some changes to kFrameout for sci32

cels are now clipped correctly against plane boundaries, nsRect is also set now, fixes some hotspot issues and larry disappearing when going to the left/right of screen

svn-id: r51158
"
"0848e3dd93034406852cf50423d595d0d50781e7","2010-07-22 19:30:20+00:00","SCI: doing res correction on text as well

'fixes' lsl6 abort intro dialog

svn-id: r51159
"
"12275cd36edec4b73211e6d0458ee68afe0c1d09","2010-07-22 19:59:11+00:00","TESTBED: some changes in interaction messages, couple of fixes

svn-id: r51160
"
"9b347782ed5946cf04256be549a1c82fa9aa14ce","2010-07-22 20:11:09+00:00","Display the MacPlay Gold logo for Macintosh versions which include it.

svn-id: r51161
"
"0e9291e929b61a355013a5abceb9d4a7bf16ff01","2010-07-22 20:11:53+00:00","SCI: fixing mirrored sci32 pictures

fixes lsl6, also slight cleanup and adding comments about sci32 picture resources

svn-id: r51162
"
"2e1486986728e30d480d73d944059c3fdcb75925","2010-07-22 20:34:09+00:00","KYRA: Properly short-circuit after the SC/MP logo on quit.

svn-id: r51163
"
"9dcbff72596094e44bea0b59701830b59e92fad9","2010-07-22 20:38:28+00:00","SCI: Hopefully fix compilation when ENABLE_SCI32 is not defined

svn-id: r51164
"
"665ae8de9d04caa56646d00193b685008125fb1c","2010-07-22 21:06:45+00:00","SCI: fix signature of kStrCpy

disabled workaround for island of dr. brain, seems to work w/o and was probably caused by bad signature

svn-id: r51165
"
"688416ca3089909a025c0297a6f765bdcb95f8cc","2010-07-22 21:13:06+00:00","SCI: Swap suffix' class_mask result_class

Now 'coldly' is correctly recognized as the adverb form of 'cold',
and 'attained' as the adjective form of 'attain'.

svn-id: r51166
"
"198986b25b948986fda248367b114e3efbf9bd48","2010-07-22 21:16:36+00:00","SCI: Add more parser test cases

svn-id: r51167
"
"ba47a427b2d8c511a2e9ebbddce28dce0c8d19d8","2010-07-22 21:40:10+00:00","SCI: sci2+ has a different kSetCursor order

fixes gk1 mouse cursor issue
thx to wjp

svn-id: r51168
"
"f48cb3cbb5dde861c859ee9029dbe3b3d37b824f","2010-07-22 21:45:12+00:00","KYRA: Remove superfluous palette update on quit.

svn-id: r51169
"
"a3b3febb969912ce8083b43c8c641eb1bd06fc66","2010-07-22 21:45:33+00:00","KYRA: Prevent fast fade to black when skipping the intro.

svn-id: r51170
"
"9f1c8f149db0c27fa737b4a058a610d36e816e01","2010-07-22 21:45:55+00:00","KYRA: Free hand shapes after the Kallak writing sequence.

svn-id: r51171
"
"4e02acec85a5844def84e8092e543e4e7c710092","2010-07-22 21:46:17+00:00","KYRA: Implement proper fade out when skipping the intro at any position.

svn-id: r51172
"
"d77649828237a71f383b791f9ae87c17c8cc67bc","2010-07-22 21:46:39+00:00","KYRA: Cleanup.

svn-id: r51173
"
"d2ab37529e141fcedf0fb855c00ba66dab979e6c","2010-07-22 21:55:45+00:00","SCI: kSetCursor change for sci32

we use the movezone like any other rect, but sierra sci actually specifies bottom/right as being the last possible coordinates

svn-id: r51174
"
"7fb37db81ea56f35251a189ace9dcee964d74c36","2010-07-22 22:00:46+00:00","KYRA: Move LoL specific static data to its own file.

svn-id: r51175
"
"a9414ebb08feea0353ab32b97f5e1234f232f302","2010-07-22 22:04:40+00:00","SCI: Some slight work on robot files

svn-id: r51176
"
"53893341fb150378f332e9150dc3c5a678e6d6f7","2010-07-22 22:13:25+00:00","SCI: kSetCursor works the same in sci16

(coordinates are not a regular Rect, but bottom/right is the last allowed coordinate)

svn-id: r51177
"
"1f60595cdcbc99c9e0ca55d7907bb853690df510","2010-07-22 22:13:28+00:00","SCI: Cleanup leftovers from the FreeSCI sound code

svn-id: r51178
"
"4b2fca203e19b831b76a7d0ec0ee3c5235ed89ee","2010-07-22 23:16:33+00:00","KYRA: Implement missing dialog code.

This finally enables animations for all of Darm's talk sequences.

svn-id: r51179
"
"a2f6fd976b09985ac5414e4665018f1b8cd7716e","2010-07-22 23:54:19+00:00","SCI: Added Workaround for SQ4CD Droid in Supercomputer Maze.

There are about 20 screens, but all screens seem to share the same script, 704, so have added a -1 general exception.

svn-id: r51180
"
"795062d8e75851d8d5ac337edaa55834cfc6adee","2010-07-23 00:12:29+00:00","KYRA: Cleanup.

svn-id: r51181
"
"6cf1b59742fda8dbed4df8750eba1569dd2e6315","2010-07-23 00:12:52+00:00","KYRA: Implemented some missing timers for object creation.

svn-id: r51182
"
"ba8ec806ba2746210217950b12c6dce9a5bb1696","2010-07-23 00:13:21+00:00","KYRA: Cleanup.

svn-id: r51183
"
"577e99c4323de51dedeff41fd47aea0b8bdbdcab","2010-07-23 00:17:08+00:00","KYRA: Mention the minor fixes for Kyra1 in the NEWS.

svn-id: r51184
"
"cef77cdae271c4d67ec7615069cee774b2c64e3d","2010-07-23 00:38:52+00:00","KYRA: Formatting fixes.

svn-id: r51186
"
"6da04bc13bdd76ae0230d9eeb3e00eb11b55b20a","2010-07-23 00:39:23+00:00","KYRA: Implement support for selecting the VQA quality via 'video_quality'.

svn-id: r51187
"
"3aa4f76ee422b42b6588296862e01eb3e8a50357","2010-07-23 07:36:55+00:00","SCI: Now saving the kPalVary state inside savegames

svn-id: r51194
"
"15eebdb0618c82f80e7cdf83141552ff8da228b4","2010-07-23 08:08:27+00:00","SCI: some changes to kPalVary saving

still needs to get tested

svn-id: r51196
"
"9db77be9d42b05edd4f76fb1b2ed99e02aa43a8f","2010-07-23 08:22:13+00:00","SCI: Dropped support for the very old savegame versions 12 and 13 (hopefully, the last ones to be dropped)

svn-id: r51197
"
"19042d78737ba1517f0b5e409730ed7f9703ed5c","2010-07-23 08:26:20+00:00","SCI: Actually sync kPalVary data when saving/loading

svn-id: r51198
"
"05999d1e5907747a39d3f3e4b73bac1929031600","2010-07-23 09:13:54+00:00","SCI: adding workarounds for lsl6hires

svn-id: r51199
"
"42851e047f9c8bef8d20a1854ff50dfd11a41741","2010-07-23 09:49:40+00:00","Lots of action related fields added; scroll over default action is now displayed on-screen

svn-id: r51200
"
"b062b413aab72035996d71d274e3f6a6f8702e15","2010-07-23 10:53:21+00:00","Removed some old deprecated code that was drawing the status text a second time

svn-id: r51201
"
"8e04d25be6455d7cd38cd0b300fd0ddead2b4f99","2010-07-23 10:58:06+00:00","SCI: support kSetCursorSci11(-2)

svn-id: r51202
"
"7b485a797884dc24ddcde990dba450ca610875d9","2010-07-23 12:09:54+00:00","GP2XWIZ: Fix warning

svn-id: r51203
"
"32c81fa9183a574adeb766d9dbc265f665978153","2010-07-23 12:37:58+00:00","SCI: fixing kNewWindow (SCI1.1)

check differently for null restoreRect, fixes pq3 some windows not getting fully removed
calling showBits on actual dims and not on restoreRect, fixes lb2 about window issues (and possible qfg1vga window issues as well)

svn-id: r51204
"
"a92576f08b566b92e4121b9415b47b74c903bd83","2010-07-23 12:56:57+00:00","GROOVIE: Optimize the VDX player.

- Make some small optimizations to the VDX player. The changes aren't
noticeable on desktop computers, but it showed changes on the profiler.
Let's see if it helps limited platforms.
- Clarify a few variable names and clean their usage.

svn-id: r51205
"
"8cc6d8d0eb71c176cbe5f98385dd658e8228a17d","2010-07-23 13:05:16+00:00","GROOVIE: Fix compilation.

svn-id: r51206
"
"0bcc3af422754525304203edca34a3e6f44f5cfb","2010-07-23 13:57:45+00:00","SCI: adding workaround for sq4/room 391

kDisplay is called with an object as opcode, we simply skip over it

svn-id: r51208
"
"20b1d80d598e6f741e28c9a85d186e463d111816","2010-07-23 14:32:24+00:00","SCI: adding table for kDisplay workarounds

and removing hardcoded checks, adding another workaround for kGraph(drawLine) in island of dr. brain (also gene explanation chart)
Moving trackOriginAndFindWorkaround() into workarounds.cpp

svn-id: r51209
"
"11a17b3908400904288432cfdd7b60c7e44ec0cb","2010-07-23 16:38:06+00:00","SCUMM: Fix subtitles for Russian The Dig

It is a long standing bug which was revealed by r31784. With that commit
Kirben switched DIG code to newer one. Russian version used 0x03 as
placeholders for keeping string widths. Original did not copy those
characters but we did hence the bug. Based on study of original.

Restrict it to Dig-only in order to avoid regressions.

svn-id: r51211
"
"b3f08d183b5fdafa850dc87401fc74d71476ef5d","2010-07-23 16:38:31+00:00","SDL: Fix bug #3025258

Bug #3025258: 'Cursor Leaves Trail in GUI when Screen is Shaking'. Based
on patch provided by eriktorbjorn but extended with another edge case.

svn-id: r51212
"
"deef8bb650e980140a731490e3f6519a4ae4da60","2010-07-23 18:42:54+00:00","TOOLS: Fix MSVC 2010 project files.

Formerly the MSVC 2010 project files did not respect the global include/library/executable directories of the user, but used custom paths for that. This resulted in headers and libraries not be found by the MSVC, in case they were not stored in %(SCUMMVM_LIBS).

Additionally it overwrote the executable MSVC used when compiling for x64, thus breaking the x64 target.

svn-id: r51213
"
"824a3c3ca1c1a0587a24db0e5b1ca6db6849aae4","2010-07-23 19:06:38+00:00","TOOLS: Preliminary SCUMMVM_LIBS support for msvc8/9.

Currently %(SCUMMVM_LIBS)/bin is not added to the executable path, since I can not find any easy way to do that. The libs and include setting should be fine though.

svn-id: r51214
"
"7094936e50c30108fb35aab3be43fcbe4814612a","2010-07-23 19:07:57+00:00","SCI: adding lsl6hires workaround

svn-id: r51215
"
"0e5aa06db03e782137a40942b1d5fe97dfbcfad0","2010-07-23 19:20:28+00:00","TOOLS: Formatting fixes.

svn-id: r51216
"
"d6695e180cfedb723a670d94d8ed132ed896498d","2010-07-23 19:36:47+00:00","GUI: Fix tooltip drawing

With help of Tanoku tooltips were switched from widgets to dialogs
which helped to fix nasty bug with background not being restored.
Although it is basically a hack around inconsistent font backbuffering
in our GUI code, for the time being it is feasible.

The patch was extended with way to specify tooltip background in the
theme file.

svn-id: r51217
"
"cc6f4f4cdc1acd407cccd061e73b0ddb63f4b5ab","2010-07-23 19:52:58+00:00","SWORD2: Improve sync between local and global 'mute' settings

Broken Sword 2's options dialog allows you to mute any of speech, sound
and sound effects, whereas ScummVM's options dialog just has one
'master' mute setting. This is an attempt to keep them better in sync,
though it's not perfect. Still, it may be good enough to fix bug
#3032763 ('SWORD2: Mute setting does not work').

svn-id: r51218
"
"3a45e47c5c92435353d7524fea56dc7d30788dcf","2010-07-23 20:47:15+00:00","SCI: adding new debug command logkernel

svn-id: r51220
"
"9fc67f5c0b3eb7ad377372da7ccff87d5203de0c","2010-07-23 20:55:44+00:00","KYRA: Mark Kyra 1 Mac as General MIDI only.

It might be noteworthy that we do not support the music yet, but that might
change one day. We also do not mark the Kyra 1 Mac CD as GM only, since
that uses the included DOS sound files for now.

svn-id: r51221
"
"b984d9afc09369f505482bfef9cda26a53efb572","2010-07-23 20:59:27+00:00","SCI: logkernel changes

removing old manual debug code, use logkernel * on/off to log all calls

svn-id: r51222
"
"afc872cba8e577f54af2457c4e457e1489fafcbc","2010-07-23 21:11:56+00:00","AGI: Fix bug #3017911

Bug #3017911: 'AGI (Fan): SQ0 - Ego flickering'. It is a regression from r49745,
as it appeared, some of the screen updates were too much.

svn-id: r51223
"
"d92cece58a039b77f6dc8039a453d896dd6f9800","2010-07-23 21:13:57+00:00","SCI: some small logkernel changes

svn-id: r51224
"
"d73c8578ff0d707fbf2992162971a7eeb2067ffa","2010-07-23 21:20:35+00:00","SCI: result now displayed in decimal for logkernel

svn-id: r51225
"
"1867b44bf4fd9e1cfb9861f7e0e3ed65ba5144a7","2010-07-23 21:26:30+00:00","GUI: Fix bug #3024930

Bug #3024930: 'GUI: GMM errors out in Hercules mode'. Fixed by switching
Hercules resolutions to lowres GUI.

svn-id: r51226
"
"cd66b7d11b4a1f3082b62d440e1b010a40be94b5","2010-07-24 01:07:04+00:00","M4: Enhanced the show_codes debug command to also show a scene's walking points

svn-id: r51230
"
"ec460ca2cabf426a6b3591d32a68872897c00ac3","2010-07-24 05:56:06+00:00","M4: Implemented lots of support code for pre-action handling

svn-id: r51235
"
"bc04a8377be36480b4a4b737e7f3ca14cde62e6e","2010-07-24 07:45:47+00:00","SCI: adding workaround for room 150 sq4

svn-id: r51237
"
"c8cde0735fdc1ccbcdeb9075433d9f31bf03f86f","2010-07-24 07:55:29+00:00","SCI: adding workaround for sq4 room 391

svn-id: r51238
"
"0191f8fd7157e29e92f89f82cb15e44949c11357","2010-07-24 08:08:19+00:00","M4: Bugfixes for depth ordering to fix the Z order of on-screen objects

svn-id: r51239
"
"c8dc2e4b8b9b82e9eeb2d3dabedc125bbb6818df","2010-07-24 08:20:54+00:00","SCI: locking picture resource

fixes sq6 crashing with resource data NULL pointer

svn-id: r51240
"
"9672c757d6e86c98ce968008f1b04f5adda443fc","2010-07-24 10:12:56+00:00","SCI: adding 1 to planeRect bottom/right

svn-id: r51241
"
"d49d1d60feabe7f3fe7691ed27b2627e35de848a","2010-07-24 11:51:09+00:00","SCI: added said spec dump ability to logkernel

svn-id: r51242
"
"63c945f93ae01d046b092e783154d57609d68a79","2010-07-24 11:59:40+00:00","SCI: fix warning and remove duplicate code

svn-id: r51243
"
"5a5f8387addfc15d5b1f755b89e45ab046653742","2010-07-24 12:03:30+00:00","SCI: removing some debug stuff from sci32 gfx

svn-id: r51244
"
"2047e75d2b3ac553acd54e31fd9725d6821668ae","2010-07-24 15:15:38+00:00","SCI: kCelWide/kCelHigh now adjust on hires views

somewhat fixes gk1 hires inventory issue

svn-id: r51245
"
"d643928d0d443b2ad27b2a974f6e34f1da0e80b5","2010-07-24 15:25:29+00:00","SCI: delete hidden planes in kFrameout

svn-id: r51246
"
"72388cc638f2c358f6d3a77d75abd47f51cd5e0a","2010-07-24 15:30:06+00:00","SCI: adding sq4 workaround room 150

svn-id: r51247
"
"3f2527a48aab2d98bab252a4e77e55c7dcae0e67","2010-07-24 16:05:19+00:00","Implemented selection of tests using a config file, config file layout resembles to that of .scummvmrc on linux

svn-id: r51248
"
"9bea286e494f81ac7cf0482b05b9f4080f6c3806","2010-07-24 16:47:12+00:00","SCI: cache Planes for sci32

svn-id: r51249
"
"f0a2c10c92163917697ba83000f67132fa1f087f","2010-07-24 16:52:08+00:00","SCI: enable speed throttler for sci32

svn-id: r51250
"
"353b0d29938690b0cff4c032febcc8375b1c17d8","2010-07-24 17:43:56+00:00","SCI: support useInsetRect in kFrameout

svn-id: r51251
"
"252e7736e59cdb2c57aa3a67396327d8e82c7742","2010-07-24 18:06:49+00:00","SCI: honor given order of screen items in sci32

fixes gk1 game menu slider controls

svn-id: r51252
"
"e515bc56d1911f8931b7b0fce2a7e38ae3b29425","2010-07-24 18:35:39+00:00","SCI: fix warning

svn-id: r51253
"
"97025ec7c1f2e9936cf8a435b65d03645d54a427","2010-07-24 19:19:09+00:00","SCI: removing sci32 gfx debug messages

svn-id: r51254
"
"f3f3f1d6db885c5f100d91a59e30ae41f56e6528","2010-07-24 19:38:13+00:00","SCI: adding kOnMe transparency support

and disabling speed throttler for poor clones computer :P
fixes some hotspots in gk1 only supposed to react on actual pixel clicks

svn-id: r51255
"
"b0af2dc95b4125c9c7f4ff6d6246667c812b79f4","2010-07-24 19:57:58+00:00","SCI: adding workaround for castle of dr. brain

room 320, for kUnLoad

svn-id: r51256
"
"50b163a106fba1dea763030727765f4f3fe311bb","2010-07-24 20:36:36+00:00","SCI: adding workaround for castle of dr. brain
room 420, alien card game

svn-id: r51257
"
"89988af11ddf2feb0a028230d544b39c5cdc96bd","2010-07-24 21:02:21+00:00","TESTBED: reimplemented the config functionality using ConfigFile Class

svn-id: r51258
"
"adf4195e0b47b2b80b612e4b96b9b42f9be45d1e","2010-07-24 21:18:07+00:00","SCI: changing how insectRect gets applied

svn-id: r51259
"
"c675c1fe296f3fad5e11fca8671fa4c6cd11c3be","2010-07-24 22:01:15+00:00","TESTBED: added a test for checking cursor trails in the GUI, fixed some display stuff

svn-id: r51263
"
"7457011a87cb54c4d6b7cc6bc7b4719b1c9a2b99","2010-07-24 22:29:17+00:00","GUI: Fix bug #3027772 by adding MT-32 tab

Bug #3027772: 'Can't switch between Text and Speech'. The problem was in
overcrowded Audio tab in any resolution with height < 480.

Solved by adding new MT-32 tab and grouping all relevant widgets there.

TODO:
- The problem still exists for 320x200 resolution where Subtitle speed
control is not accessible
- Apparently nobody tested tab control scrolling after switching to new
GUI, and now there are artifacts

svn-id: r51265
"
"d88ffa13416ace695eb217541e57031c92d9bde6","2010-07-24 22:31:31+00:00","GUI: Update built-in theme

svn-id: r51266
"
"184b704ddfeb9ad687c51cfa125108fcbdec863b","2010-07-24 22:32:08+00:00","TESTBED: removed unnecessary code from config file implementation

svn-id: r51267
"
"ccbb12b1cbcf1221c0464c5d46a7cefb38420781","2010-07-24 22:54:56+00:00","GUI: Fix overdrawn tabs

If tabs are scrolled, do not draw those which are supposed to be invisible.

svn-id: r51268
"
"b90493bba0f860608ee32834774e56def66eafaf","2010-07-24 23:11:24+00:00","AMIGAOS4: Patch #3033938: 'Configure change'

AmigaOS4 core devs tell that the special directory 'SObjs' (that holds
the shared object files) should only be used by the end user (games,
apps, etc.) but not by projects that are to be build.

This patch fixes it.

svn-id: r51269
"
"3090ee6ee710bf7c2c43a69e36740a829852f65d","2010-07-25 04:45:28+00:00","SCI: sci32 changes

- mouse position now gets adjusted inside kGetEvent
- priority is read out during kFrameout
- check planeRect
- check if plane picture resource actually exists

fixes sq6

svn-id: r51270
"
"c641731a4c9775685d0f2b79bf837b237128523d","2010-07-25 11:40:47+00:00","SCI: signature change for kPalVary(8)

svn-id: r51271
"
"da5f1506e322a4c33067f6130cb5bc53367b477c","2010-07-25 12:48:48+00:00","SCI: adjust z coordinate for views (sci32)

fixes gk1 newspaper

svn-id: r51272
"
"246a157d1ef05cceebbb29aa9f5380ea3c98564b","2010-07-25 13:11:28+00:00","SCI: adding separate kCantBeHere32 (stub)

svn-id: r51273
"
"8145fea6b9afdc90f1a24ce845133e46ac3f68ff","2010-07-25 13:32:15+00:00","Silenced false positive warning in MSVC

svn-id: r51274
"
"b3949cf4be02136c633becd841a4a5e45033f8d5","2010-07-25 16:31:46+00:00","SCI: sci32 coord adjustment changes

- fixes lsl6hires inventory

svn-id: r51275
"
"d5ced8ab9e6a3b089792d27741699c1928e7fc58","2010-07-25 16:37:36+00:00","SCI: using coordadjuster in GfxView

svn-id: r51276
"
"dec30186eb4892598a5d522633060cc20208dff1","2010-07-25 16:38:25+00:00","GUI: Fix MIDI gain position in MIDI tab for lowres classic theme.

svn-id: r51277
"
"633d13faee65eb7922ce2eb35e9e267e66747e85","2010-07-25 17:01:54+00:00","SCI: removing onControl from coordAdjuster32

svn-id: r51278
"
"62e6780188748164b4c8422142a87a6961ddbda9","2010-07-25 19:01:22+00:00","TESTBED: minor addition of code to enable logging

svn-id: r51279
"
"33c34456fb9305c13dd91a3c3b29b072da95cfd8","2010-07-25 19:28:58+00:00","SCI: adding gk2 uninit workaround

svn-id: r51280
"
"c721b4d612a52600f6aae539e91f1d6bd03fcb13","2010-07-25 19:47:12+00:00","SCI: some changes for kq7
- resetting negative plane left/top
- kSave(0) returns SIGNAL

svn-id: r51281
"
"9b1d691594e2dc36de5851d7062289665b6497e5","2010-07-25 19:56:44+00:00","SCI: blacking out planes that got deleted

svn-id: r51282
"
"e3866046af852a465acabdc018bc1adf97767ac9","2010-07-25 20:41:23+00:00","SCI: adding kAddPicAt dummy

svn-id: r51283
"
"a9941138dadd796ca2a8fbd6e2c9c66436a48c4b","2010-07-25 20:50:59+00:00","TETBED: fixed the boundary error in palette rotation, added colored progress bar now

svn-id: r51284
"
"fed9541f475f4781dca28fa1d4cc94b36402dc62","2010-07-25 22:47:17+00:00","Fixed LSL6 hires resources, speech and lip sync work now (thanks to a discussion we had with clone2727)

svn-id: r51287
"
"b28b290c7086b1d16df3403b727bc9686d006f13","2010-07-26 05:40:58+00:00","SCI: Fixed bug #3034464, 'ECOQUEST2: Crash near beginning'

svn-id: r51293
"
"27ce375a9526effe904b1d2c36f862043c516fd3","2010-07-26 05:49:00+00:00","SCI: Fixed bug #3034507, 'PQ2 Demo: Non-existant menu item'

svn-id: r51294
"
"02a2f084080ba92f85e937dac5618bbda19e4ec4","2010-07-26 06:10:47+00:00","Janitorial: Fix punctuation in error/warning

svn-id: r51296
"
"9074103d4402d1be5758da9bdbbdd87a9189f2de","2010-07-26 06:19:57+00:00","MIDI: Make it possible to specify MIDI device by music driver id

If getDeviceHandle() gets a music driver id it will pick the driver's
first device, which should hopefully be a sensible default. E.g. it's
once again possible to use '-e alsa' rather than the much more
cumbersome '-e 'alsa_Emu10k1 WaveTable''.

svn-id: r51297
"
"703c8b665a42a7cb5356e6a8d019d9863d420535","2010-07-26 06:30:15+00:00","SCI: Fixed bug #3034490 , 'signature mismatch in laura bow 2 introduction'

svn-id: r51298
"
"efa0f664029151f213c3a73a54bfd48ebf844981","2010-07-26 07:31:51+00:00","SCI: Fixed a script bug in the intro of LB2 (invalid call to kMemory), room 220 (while talking to Mr. Augustini)

svn-id: r51301
"
"a278e01998aeda10d22b6edb1e9be23c81abf033","2010-07-26 07:40:51+00:00","SCI: Fixed bug #3034536 - 'AMIGAOS4: SCI - Compiler error'.

svn-id: r51302
"
"8d04588880548ef25102f15343ad970f274f6e09","2010-07-26 07:55:50+00:00","SCI: Added room number to signature mismatch errors

svn-id: r51303
"
"d85e01640609f59bd1b3a8e9ffb3f16677832fac","2010-07-26 08:21:43+00:00","SCI: Fixed bug #3034506, 'QFG4 Demo: kPalette Subfunction Sig Mismatch', plus another sig mismatch on kDrawCel later on, when Dr. Cranium talks

svn-id: r51304
"
"e1314408213860cb7a3b859ee2e985a2a8294668","2010-07-26 09:16:57+00:00","SCI: Fixed bug #3034519, 'GK1 Demo: kIsObject Sig Mismatch'.

svn-id: r51305
"
"9da4c3f883892d753ba31526aa7183300ffcd27c","2010-07-26 09:18:04+00:00","SCI: Some cosmetic changes to the warning thrown when fixing invalid windows

svn-id: r51306
"
"ea8271f3cb3af273842d9848d6dde9b222e5cf40","2010-07-26 09:34:15+00:00","SCI: combined lb2 workaround

svn-id: r51307
"
"c0d915b616b7f50e9feec2afb2969f23c79a9ffb","2010-07-26 12:20:07+00:00","SCI: some scrolling support for sci32

not fully done yet

svn-id: r51308
"
"284377fc247aa876e6f342250e66bf8a8bbd800c","2010-07-26 13:40:07+00:00","SCI: Fixed menu reset in SCI0/SCI01 games when restarting

svn-id: r51309
"
"aea09cb3a0e0fcb5209b568ea2edd2e974e4ad3a","2010-07-26 14:21:18+00:00","AGI: Fix spelling and formatting

svn-id: r51310
"
"e4bc0c3a18eee3c4a64fc58b55517af510a220c0","2010-07-26 14:21:59+00:00","AGI: Fix crash on exit thanks to valgrind

svn-id: r51311
"
"756d5e28479bb74ad011be3fc3aff50a222b6325","2010-07-26 14:22:16+00:00","AGI: Fix valgrind warning

svn-id: r51312
"
"e3e2ae799e59a6245a43c21629313ee3a948e9ce","2010-07-26 14:41:19+00:00","SCI: adding scrollcapability to sci32

svn-id: r51313
"
"31828d093c2974f600e201d3b1915565eaa1e9bf","2010-07-26 14:44:28+00:00","SCI: commenting out picture cel debug msg

svn-id: r51315
"
"faf0d5c2e31bb015ec9c6c8a5a68d761ad39e549","2010-07-26 15:40:12+00:00","SCI: adding workaround for island of dr. brain

room 290 elevator puzzle, solves bug #3034485

svn-id: r51319
"
"f5f8d8580484882e07d716f04c9c4f06ff75e740","2010-07-26 15:43:39+00:00","SCI: forgot one workaround for r51319

svn-id: r51320
"
"24c21a9960f9cc815433648b958f4c8cdea57d7b","2010-07-26 15:50:31+00:00","SCI: making kq5 workaround work in every room

fixes bug #3034700

svn-id: r51321
"
"f6e0c2dd2c3eb6b9cde166497a8286f9d3fea543","2010-07-26 15:59:04+00:00","SCI: adding workaround for castle brain room 320

solves bug #3034473, happened also in DOS version of the game but only when exiting the puzzle before solving it

svn-id: r51322
"
"18a54f086f4b1e0edb16a887cc1a556b4ca86fb6","2010-07-26 16:49:04+00:00","SCI: fixing transition 9

fixes castle of dr. brain intro on amiga

svn-id: r51323
"
"3c0765ae7849a9ca9962c5a3c6c83c5bcae506f8","2010-07-26 17:03:45+00:00","KYRA: Fix assertion when using 'enter' to scene with instant death.

svn-id: r51324
"
"9daa2472d05e9f656d03a80c9999b4e2d1ff9b68","2010-07-26 17:51:50+00:00","SCI: adding workaround for kq6 room 210

fixes bug #3034565

svn-id: r51325
"
"5fb760b053db695fdcf2222ae8e462bc5b300663","2010-07-26 17:55:54+00:00","SCI: extending rats workaround kq6 to all rooms

fixes bug #3034597

svn-id: r51326
"
"7a86204e5cc1e38d0ce6a6095d339cda83f4704c","2010-07-26 18:13:35+00:00","SOUND: Move the Mac snd decoder from SCI to /sound

For use with Kyra1 Mac instrument samples. T7G Mac and Loom Mac also use this format for their custom instrument samples.

svn-id: r51327
"
"85f9bb1e0c9d55a053378d02095ed1f3aa38aea9","2010-07-26 18:18:25+00:00","SOUND: The rate in Mac snd's is fixed, not floating point (fix the comment)

svn-id: r51328
"
"4940819df6d7eee7a5b6b1ebcc08e8ac35ad0268","2010-07-26 18:40:49+00:00","SCI: reverting r51304, broke kq6 hires

svn-id: r51329
"
"9be3c6943810a9a2a15a3acf42f18df661be5eee","2010-07-26 18:41:19+00:00","GUI: Fix regression from r51265.

This makes the GMM's option dialog work again.

The fix itself is exactly the same like I made in r50468, which
also broke the GMM's option dialog.

svn-id: r51330
"
"95c68f029181875bcfe58c8b26358c20a5d358c4","2010-07-26 18:45:32+00:00","SCI: changing CRLF to LF

svn-id: r51331
"
"57136cd86a66459a1ef5f2b6d02a7662714c7f3b","2010-07-26 19:25:56+00:00","SCI: implement scaling for kDrawCel

fixes qfg4 demo properly (bug #3034506, previous commit r51304)

svn-id: r51332
"
"39780f4a6801091fc680c7d55d2a1f7a0a4356be","2010-07-26 20:59:50+00:00","TESTBED: implemented some sample beeps using PCSpeaker emulator for testing sound subsystem

svn-id: r51333
"
"ea5f8049a2a3af836c81fb4698317b999c152459","2010-07-26 21:25:07+00:00","SCI: fixing scroll transitions for kq6 hires

fixes bug #3034587

svn-id: r51334
"
"a27f30fa15db7def6c5e6d44703427254baec4ae","2010-07-26 22:58:06+00:00","SCI: fixing text fonts not working correctly

fixes sq5 and bug #3034766

svn-id: r51335
"
"04d2ed5a7f74f58683cdc8e3d0d23d33d8410973","2010-07-26 23:38:17+00:00","SCI: Add workarounds for the LB2 demo

svn-id: r51336
"
"3b231665b1bcca92539b08521727f31d717d4300","2010-07-27 00:03:45+00:00","SCI: Add workaround for LB1 demo

svn-id: r51337
"
"1dc36141a270525e972976d6b09e0909393b4daa","2010-07-27 01:05:38+00:00","SCI: Add two more uninited workarounds for Jones/CD

svn-id: r51340
"
"89c9425eef092a7d9482d7512841151932a6a2e3","2010-07-27 01:51:10+00:00","SCI: Add a 0x prefix to localCall to show it's a hexadecimal number

svn-id: r51341
"
"280204bd12852109ac3202659c2c1b71a922a6c8","2010-07-27 01:52:52+00:00","SCI: Add workarounds for the camelot demo

svn-id: r51342
"
"03fe34df73286046fbb16d9ebbfc6580e206d914","2010-07-27 02:46:06+00:00","SCI: Fix bug #3035033 - ISLANDBRAIN demo: Crash

The demo needs the 'init' selector so that the workaround for the full game will also work in the demo.

svn-id: r51343
"
"8312feec502255b329f827edb46b3f2998c4a631","2010-07-27 08:08:04+00:00","SCI: Fixed bug #3034567, 'KQ6CD: Crash on taking piece of paper from spider web'

svn-id: r51347
"
"6c36c06f7aacb3fc2f1993f8f98039f817d795ba","2010-07-27 08:27:32+00:00","SCI: Fixed game script bug #3034985, 'LB1: Crash on Intro'

svn-id: r51348
"
"3da0c0794f151084f7552708c35beb92bd2f3725","2010-07-27 08:43:10+00:00","SCI: Fixed bug #3035149, 'Camelot: Crash at launch'

svn-id: r51349
"
"4fb7b0657048cc3a368258cd4ca2f922fd888eeb","2010-07-27 09:17:57+00:00","SCI: translating nsRect back to actual plane coordinate

on scrollable planes

svn-id: r51350
"
"26c0547e6741fd57ddce8c2cfcccbe6dd2b54322","2010-07-27 09:32:19+00:00","TESTBED: Updated the progress bar to show count of enabled test/testsuites instead of entire list size

svn-id: r51351
"
"35ecdd59ad9befbb9e6611160a9996055dbba07e","2010-07-27 09:38:04+00:00","SCI: adding workaround for sq1-spanish

svn-id: r51353
"
"742a226312a8d4f31705a65bdd3c960ae007e8b3","2010-07-27 09:40:29+00:00","SCI: Fixed bug #3035057 - 'ECOQUEST demo: Crashing menu'. EcoQuest 1 demo is using an in between SCI1-SCI1.1 interpreter. It's SCI1.1, but it calls kNewWindow with the SCI1 semantics.

svn-id: r51354
"
"6ff286c1f40fea7b7db92b44f45a8f3b31d53dc3","2010-07-27 09:55:43+00:00","SCI: fixing workaround from r51353

svn-id: r51355
"
"14c059100c1505d2aedcea781c07756c9b5bcf30","2010-07-27 10:00:17+00:00","SCI: Fixed script bug #3034610 - 'KQ6CD: Crash in endgame (short path)', and removed a relevant TODO

svn-id: r51356
"
"d6aed46c3a07f4a5a51ec77115764902c5d63e82","2010-07-27 10:10:49+00:00","SCI: Complete the workaround commited in r51355.

svn-id: r51357
"
"d4774577251908e2a71cde67fc9704b2f9c6fcaf","2010-07-27 10:20:38+00:00","SCI: Fix indentation and alignment of some entries

svn-id: r51358
"
"a50d9dea91cf4e8c5b9b012a2884132eb5979fae","2010-07-27 10:22:41+00:00","SCI: Added room number for the KQ6 script workaround during the ending

svn-id: r51359
"
"eef7417487a657b14fa1204a009556bbb6e1c295","2010-07-27 10:40:14+00:00","TEENAGENT: Sort the object files alphabetically.

svn-id: r51360
"
"114f4dfb0a1b9bea16ec51fc3d0cc866779f3c44","2010-07-27 11:11:47+00:00","SCI: adding scaling code in kBaseSetter

and fixing palVary timer crash when exiting engine during palVary processing

svn-id: r51361
"
"d508ba67663c3150d2c7052cf568234e8739bdfb","2010-07-27 11:16:44+00:00","Remove Android themeengine patch - an improved version is now part of
the main ScummVM codebase thanks to fingolfin :)

svn-id: r51362
"
"d013be51e535ff05b2f3f54c448b50b655bceaf3","2010-07-27 11:18:51+00:00","SCI: reverting part of r51361

breaks qfg3 right after intro

svn-id: r51363
"
"601fe8ee7d5c2bffdc117ee6ff97d2d2df373d6c","2010-07-27 11:38:24+00:00","SCI: adding workaround for qfg3 (kIsObject)

svn-id: r51364
"
"890ec11a49fb670b49d70c024318194253b4a908","2010-07-27 12:56:30+00:00","TESTBED: added finish zone in mouse event tests

svn-id: r51365
"
"2db4e71b6693f47f2fc48c78e8cff5e570c1f8d1","2010-07-27 13:01:10+00:00","ALSA: Simplify device querying code.

Thanks to eriktorbjorn for some quick testing.

svn-id: r51366
"
"6925518143332099fcaf86bbab9f446063d206cb","2010-07-27 13:06:52+00:00","SCI: Fixed bug #3035068 - 'LB2CD: Crash in first room, asking about burglary'

svn-id: r51367
"
"93e8daec20c45bfaee3422480fe85cadbd844436","2010-07-27 13:25:35+00:00","KYRA: Formatting.

svn-id: r51368
"
"596e10bb42c8b83802759ea272acb5af13df0d18","2010-07-27 13:31:28+00:00","SCI: Fix PCjr sound

svn-id: r51369
"
"bdf4ed9abb45225bacfc6b9a4a3212000a706957","2010-07-27 14:31:33+00:00","Updated xcode project

svn-id: r51370
"
"5b686b539abe6ff876bb3479636741628fcdf11f","2010-07-27 14:48:22+00:00","SCI: adding workaround for sq5

entering the bridge makes the crew goof around, we are getting Osc::init with an object as cycle count

svn-id: r51371
"
"bc6baef0c0e6d952f5ac2eca2ccb1352cb9444b7","2010-07-27 14:51:08+00:00","SCI: Fixed bug #3035186 - 'ECOQUEST2: Crash When Receiving Ecorder'. Also removed the now obsolete kStringCpy workaround table.

svn-id: r51372
"
"349d3765e3e65bec4c198fe833e0ebe6e8478323","2010-07-27 14:51:36+00:00","SOUND: Only dispose the input stream in makeAIFFStream if requested

svn-id: r51373
"
"780cb85cce441c07540ec707e40eeef0d10e0420","2010-07-27 15:10:41+00:00","SCI: Fixed bug #3035262 - 'ISLANDBRAIN: Crash on 'info' selection'

svn-id: r51374
"
"7024991cc99bf5a964fceeae62057a1d5e501c51","2010-07-27 15:29:58+00:00","SCI: Removed the room number from the two workarounds for Hoyle 3 (Character::say) thus fixing the crash in dominoes observed in bug #3035080. Some whitespace fixes.

svn-id: r51375
"
"cf26b88e54983f8a8d73b640f817967c6fcd5d89","2010-07-27 15:45:21+00:00","SCI: Fix bug #3035058 - ECOQUEST demo: Missing subtitles

The demo uses a special version of kMessage to get its messages.

svn-id: r51376
"
"4fa22695908e4dae587959c70713fe119091a475","2010-07-27 16:09:18+00:00","SCI: Add detection for some more EGA versions of games

See bug #3035349 (MD5 Checksum for Castle of Dr. Brain - EGA), #3035350 (MD5 Checksum for Mixed-Up Fairy Tales EGA) and #3035354 (MD5 Checksum for Mixed-Up Mother Goose (1990 EGA, SCI01))

svn-id: r51377
"
"47f93e9d07e64b8746d9008afb1234744e095914","2010-07-27 16:35:28+00:00","ALSA: Tweak capability and type flags for the MIDI port

This keeps ScummVM's own port from being included in the list of
available MIDI devices.

svn-id: r51378
"
"7424d39a980848e9c6783aae039aae28a4fa2b5a","2010-07-27 17:14:33+00:00","GOB: Respect mute option on startup (bug #3032781)

svn-id: r51379
"
"bbd3f0dbb3f76417237882ae8dfe5acfab73b50b","2010-07-27 17:18:02+00:00","ALSA: Be more intelligent when picking MIDI port

Often, a client has more than one available port. Pick the first one
that isn't already in use. For instance, on my computer client 17 is
the 'Emu10k1 WaveTable', and it has four available ports. If, say,
aplaymidi is already playing on port 17:0, ScummVM will use port 17:1
instead. Otherwise the two programs will mess up each others
instruments and controller settings.

Of course, in reality I doubt that anyone will run two different MIDI
playing applications at once.

svn-id: r51380
"
"c422e39bf8caa0e95b3202e444cc0190d4708248","2010-07-27 17:51:44+00:00","SCI: implemented kPalette(save/restore)

svn-id: r51381
"
"a8574a37eec7f6fa91972e32482f49114df85553","2010-07-27 18:17:47+00:00","SCI: Add second KQ5 EGA entry (from bug #3035421)

svn-id: r51382
"
"3cae0f3452233bc03ce5964e0bf7567798f35856","2010-07-27 18:45:32+00:00","SCI: kCheckFreeSpace support for sci1.1

and possible sci32

svn-id: r51383
"
"828434456f49587e64c85d8117323411542e759f","2010-07-27 19:07:39+00:00","SCI: Better fix for bug #3035058 - ECOQUEST demo: Missing subtitles

The demo really uses kGetMessage and not kMessage. We now detect which version of the message function is used. Thanks to Walter for pointing this out.

svn-id: r51384
"
"b873cf2ebf036a255c9729e0132db51e3de106a6","2010-07-27 19:09:57+00:00","SCI: changes for mother goose sci2.1

changed signature for kSetCursor sci2.1
added workarounds
added separate gameid for mother goose sci2.1

svn-id: r51385
"
"20ced61f2823b7a90724ea5c73f26f320467de1a","2010-07-27 19:35:18+00:00","SCI: adding workaround for kq6 rats in catacombs

solves bug #3035495

svn-id: r51386
"
"b12424741cae1821ce1b5115ce38591177d8c1af","2010-07-27 20:11:00+00:00","SCI: The mothergoose demo is really for Windows, so make that the platform

svn-id: r51387
"
"5787c8bb88eeb6ecccf8e28d8302bbdac4a1bbaa","2010-07-27 20:17:29+00:00","GUI: Rename Font cache to match new font naming scheme

svn-id: r51388
"
"2df946f837ca7a3c721de27868de9e73241bc6a2","2010-07-27 20:20:00+00:00","SCI: Add an uninited workaround for the mothergoose demo

svn-id: r51389
"
"7e545888fd82755403ef03c364ab67a6360bf4b9","2010-07-27 20:46:12+00:00","SCI: moving some fileio warnings to debug level

svn-id: r51392
"
"11de85026d8c57ee64611770aad442226ec502db","2010-07-27 21:04:02+00:00","SCI: found out interpreter version of lsl5g

svn-id: r51393
"
"6e8b11867f471682ccab841da08d97575753c54f","2010-07-27 21:30:15+00:00","SCI: fixing signature of kCheckFreeSpace

svn-id: r51394
"
"97b1cd34cf5b41c08e3e80f3dd9ce59db9865093","2010-07-27 23:20:43+00:00","SCI: sci1.1 priority bands now changing in kDrawPic

fixes qfg3: right guard on top of the palace having wrong priority
fixes sq5 and all sorts of sci1.1 games: when loading wrong priority for some actors that fixed itself after one frame

svn-id: r51397
"
"50e493f3ef368847b95d443bee13f6918bbab34e","2010-07-28 03:54:14+00:00","SCI: Fix bug #3035720 - SQ1SCI demo: Menu crash

kCelWide and kCelHigh are called with the second two parameters as objects instead of integers. We fake return the real width/height of the view in question to allow the quit menu to work. Values found by examining the view  passed as the first parameter.

svn-id: r51401
"
"ea2256c05b500fb036101f0d99aed7a6ebe8b96e","2010-07-28 05:03:23+00:00","SCI: changing workarounds of r51401 to stillcall

svn-id: r51402
"
"558fc88cc68b0c4780caed9ecd546187de46c662","2010-07-28 05:55:09+00:00","SCI: Initialize _resourceData to 0 in GfxRobot. Fixes PQSWAT demo.

svn-id: r51404
"
"61b63d9e4df160f54e64b567f65dcd80f0dc0b98","2010-07-28 06:03:52+00:00","SCI: Add 'robots' subdirectory (PQSWAT demo stores them there)

svn-id: r51405
"
"764b8419900135cadb2f6d228811113c1ce6429c","2010-07-28 07:13:40+00:00","Fixed bug #3035694 - 'LB2: crash to console when selecting in-game load/save menu'

svn-id: r51406
"
"3c8a606e7191391857640c507c85c8a57154d5a7","2010-07-28 07:51:49+00:00","SCI: Added bug report numbers for all the recently fixed bugs

svn-id: r51407
"
"817170bbb6b1f889063bebbf3e5694d57dadee00","2010-07-28 08:05:16+00:00","SCI: Sorted workaround tables alphabetically by game ID

svn-id: r51408
"
"bae197c489346f7373a5f6b877456eaa1b2530d8","2010-07-28 09:21:58+00:00","SCI: Changed a warning into debug output

svn-id: r51409
"
"eb1cdc2c49ca17deac34563b9aad1e20cab18a27","2010-07-28 09:34:31+00:00","SCI: Some workaround fixes

- Merged all of the different workarounds for
the rats in the KQ6 maze in one, thus fixing
bug #3035824 - 'kq6-win: more crashes on rats
in catacombs'
- Merged 4 different workarounds for LSL3 in one

svn-id: r51410
"
"c0474c91c4e290edd8dab5808ce8a3854ac5fa45","2010-07-28 11:22:58+00:00","SCI: fixes for qfg2

adding workaround
changing signature for dummy kDoSound call

svn-id: r51411
"
"16f042270d885b96c5e93d99755c2c8997fb7e36","2010-07-28 11:31:13+00:00","SCI: Fix whitespace

svn-id: r51412
"
"e0f6bb2e7aa27f9d1ac214bb7f68e0b6bb8a5f78","2010-07-28 11:37:22+00:00","SCI: Adding the room number to some more errors

svn-id: r51413
"
"0e47192346904858f0cbbc197d957cb68b777ad8","2010-07-28 12:28:35+00:00","SCI: priority handling for sci1.1 add-pictures

fixes battle cruiser mini game in sq5 (at least we get something displayed now)

svn-id: r51414
"
"dc9c6276815731e976972747bcd9fd761dfee3d1","2010-07-28 12:41:24+00:00","SCI: adding header comments about sci1.1 pictures

also fixing some of the offsets (those are DWORD instead of just WORDs)

svn-id: r51415
"
"df3decc14c16ec242795d4649de1b6e9df0a3c55","2010-07-28 13:16:36+00:00","SCI: adding workaround for eq1cd

svn-id: r51416
"
"ebd3356e89904e821e5b4f8a54b8c6c9831d7c52","2010-07-28 13:34:14+00:00","SCI: adding workaround for eq1

svn-id: r51417
"
"8b22fd921ffead15a4b85b9791638f49216e0608","2010-07-28 13:35:24+00:00","SCI: Add detection entries for newer SCI fan games

svn-id: r51418
"
"15bff499790c56407f8edc85963f5f18c7154c44","2010-07-28 13:54:04+00:00","SCI: adding workarounds for eq1cd

svn-id: r51419
"
"67f4784f32f455c1a217ec48facc042e39712c9b","2010-07-28 14:15:10+00:00","SCI: adding workarounds for eq1cd

svn-id: r51420
"
"00ff92e9e0b112a3016f93c837d918a7b9163b47","2010-07-28 14:34:32+00:00","SCI: Remove SCI01 vocab warning, this behavior is normal

svn-id: r51421
"
"8a843b6c2152ef0019dfbf864fb250af308b6f9e","2010-07-28 14:57:35+00:00","SCI: adding support for middle mouse button

svn-id: r51422
"
"191d50171a1afe358be2a56d26c0c50c36231df2","2010-07-28 15:34:34+00:00","SCI: Fix bug #3035737 - SCI Fan Games: Incorrect Version Detection

If we have a vocab 900 resource with the new decompressors, it can also be SCI0 late. If there is no parser vocab (with new decompressors), it is SCI1 early.

svn-id: r51423
"
"e85cf6bfbb01f2691dd7215d765a1f8db81e3159","2010-07-28 15:48:07+00:00","SCI: adding eq1cd workaround

svn-id: r51424
"
"3f5958af78797e1b99ebefafbce38fecfbb27d39","2010-07-28 16:00:13+00:00","SCI: Fix compilation when DEBUG_PARSER is defined

svn-id: r51425
"
"163f0cf7b5e1f6c21d75e31483bc1b23f7a74bfb","2010-07-28 16:18:03+00:00","SCI: eq1 workaround compression and new ones

svn-id: r51426
"
"cfb1f53d5978d27295b48a77cf67023d955d2969","2010-07-28 16:58:34+00:00","SCI: making a global eq1 workaround :P

svn-id: r51427
"
"f302469a77c394bb5c4feee915c71370700af63f","2010-07-28 17:39:47+00:00","SCI: Add workaround for a KQ7 uninitialized temp

svn-id: r51428
"
"515cc3c369551b15503b982a007b645843a781a1","2010-07-28 17:45:19+00:00","SCI: Set the LB2 floppy open selector so we don't have to have duplicate workaround entries

svn-id: r51429
"
"78f0e4ce408a3cb76fcdfc8c102c169d1dba43de","2010-07-28 18:23:43+00:00","SCI: Add updated detection for al pond 2/new year's mystery (fan games)

svn-id: r51430
"
"9a1afc5a2473b29a288a808917ed522ac3fac531","2010-07-28 18:37:13+00:00","SCI: fix typo in comment

svn-id: r51431
"
"07b67fe44b20f8f1c9dcdf659f5e2666d69834f4","2010-07-28 19:03:49+00:00","SCI: Fix using the parser in SCI Fan Games

Get a pointer to the said spec instead of copying to a buffer. The fan games use a said spec with size < 64. Also, make said() take a const pointer as the spec cannot change. Thanks to waltervn and wjp.

svn-id: r51432
"
"abf53f839a090fe6535390a27142964cd44f2566","2010-07-28 21:47:15+00:00","SCI: implement additional variants of kRandom

fixes pq1vga poker game (bug #3036125)

svn-id: r51435
"
"021c5d11dba67951113e293a14347869316c47e1","2010-07-28 21:55:40+00:00","SCI: changed kRandom signature

accepts 1-3 parameters now for all SCI versions (shouldnt hurt and argc 3 will error() out anyway)
changed comments a bit

svn-id: r51438
"
"fb35d46c1d5a2dd1b1b35d3a5a173b7a896c56c6","2010-07-28 22:36:22+00:00","SCI: Extended the LB2 workaround for bug #3035068 to all rooms. Fixes bug #3036274, 'LB2CD: Crash in Police Station, asking about Ziggy'

svn-id: r51443
"
"a2b6b84bfb43266a30dd9106148fe5a469181d7f","2010-07-28 22:41:03+00:00","SCI: Changed a warning into a debug message

svn-id: r51444
"
"9e164f429da370244f92486cacde2e5ef9e25a46","2010-07-28 23:01:28+00:00","SCI: Changed another warning into debug output

svn-id: r51445
"
"09ae3b7ca4132ca2a2ba466272d5744f0de7aaff","2010-07-28 23:09:42+00:00","SCI: Fixed bug #3036291, 'LB2CD: Crash in Docks, actor animation'

svn-id: r51446
"
"b3230b26a1343afd55e310520208b6424c89e3ea","2010-07-28 23:21:27+00:00","SCI: Added forgotten bug number to the previous workaround

svn-id: r51448
"
"c099127c3dee1eddcb725415e2bf831674da87f3","2010-07-28 23:30:59+00:00","SCI: Break out instead of continuing when an end point is contained in multiple polygons, while running the avoidpath algorithm (or we'll end up in an infinite loop). Fixes bug #3036299 - 'LB2CD: Game Hangs at Speakeasy'

svn-id: r51450
"
"b19433e6d38c520f5d774c5f9a1dc19e065fb0be","2010-07-29 01:05:11+00:00","SCI: Re-enable the throttle for kFrameout, I must have been asleep that day

svn-id: r51451
"
"3e6f3716acfcc042816f12a9321ad009b389aaf6","2010-07-29 07:17:42+00:00","SCI: Fixed bug #3036390 - 'QFG3: Crash when talking to King Rajah', along with a similar problem later on while talking to the king

svn-id: r51455
"
"c40b9801dfbde95761521aa560ea1425fded527b","2010-07-29 07:58:48+00:00","SCI: Silenced warning when exiting in LSL6 (bug report #3035533), and commented out a related unused variable in kSetQuitStr

svn-id: r51456
"
"5d72193c512559394258051208b05f7089bb4c06","2010-07-29 08:03:16+00:00","Oops, removed leftover code

svn-id: r51457
"
"82bf2437e34434a05392754b53853e21d27cfdd5","2010-07-29 09:08:20+00:00","SCI: also break in AvoidPath instead of continuing, when the start point is contained in multiple polygons, otherwise we'll end up in an infinite loop

svn-id: r51458
"
"6b63c951eb3cd218b496c190359ad705ee043791","2010-07-29 10:48:54+00:00","SCI: updating screen within kAnimate as well - fixes pseudo hang in eq1 credits (bug #3036154)

svn-id: r51459
"
"f22821af666fe89a3635d53f02351273b435c952","2010-07-29 10:58:01+00:00","SCI: Added back debug output to sound commands

svn-id: r51460
"
"fd804eb44b3e0f952efc2ffd3c66303e4a1c882c","2010-07-29 11:04:54+00:00","M4: Further work done on the setup and starting of actions

svn-id: r51461
"
"28de229b518c91f46fd03758df0fb5d7553c7c02","2010-07-29 11:41:51+00:00","M4: Added further code fragments to enable player to move again

svn-id: r51462
"
"a64131ec0f588fca6dfadb2a52a5e8f9eb739bba","2010-07-29 12:43:33+00:00","SCI: Fixed script bug #3036483 - 'LSL2:  Crash at the ship'

svn-id: r51463
"
"7364b9bb2f695918729606a716547d74b62b479c","2010-07-29 13:01:39+00:00","BUILD: Remove redundant MODULE_DIRS modification

svn-id: r51464
"
"264d17ccc7644440d4cd3dc64e14f3e0bd431fd4","2010-07-29 13:02:14+00:00","BUILD: Compile & link certain files only for specific BACKEND values

svn-id: r51465
"
"2692e55208d8945b24d9a6c451a61856ed601a94","2010-07-29 13:02:30+00:00","BUILD: Fix MODULE_DIRS for WinCE port

svn-id: r51466
"
"d22ebd358dec75762c97f30d8a2fa8630e4268c2","2010-07-29 13:03:21+00:00","BUILD: Unify how MODULE_DIRS is computed for backends

This should help avoid situations where MODULE_DIRS is not set to a
complete list of build dirs (which causes troubles with the automatic
header dependency detection logic).

On the long run, we should replace the relevant code by a macro or also
use rules.mk for this (with yet another if/else case add to it).

svn-id: r51467
"
"4814db3a6a99f0a8920968e736494571b25d225b","2010-07-29 13:09:14+00:00","TESTBED: implemented gui of Sound Subsystem tests

svn-id: r51468
"
"a113986dc29ec6a6d53d48af7e06212a42be0c46","2010-07-29 13:45:52+00:00","SCI: Add detection for the April 2010 competition template (fan game)

svn-id: r51469
"
"9b6c78a4fed90b5b9fa98e77994f74645ee5fb47","2010-07-29 15:24:19+00:00","SCI: Fixed bug #3036331 - 'KQ5: Floppy version
crashes after title', together with a related
problem (kRedrawBox is called erroneously with
an additional parameter when any dialog is
closed)

svn-id: r51470
"
"123d1f6bf6a489fc7333292e2c34b8ff38276097","2010-07-29 15:40:09+00:00","Extended the workaround for KQ5 French floppy for the German floppy too. Fixes bug #3035396 - 'KQ5: Crash when start the game'

svn-id: r51471
"
"c61ed6e3aafeb6bd3ef200ee81b9912291b224a7","2010-07-29 15:50:53+00:00","SCI: Removed the language check from the
KQ5 workaround, as there could be an issue
with other non-English versions, too (e.g.
the Spanish floppy version)

svn-id: r51472
"
"8de57b0b2942cfd039c5bef47699809f2b5ccc60","2010-07-29 16:24:08+00:00","DS: Get rid of DS_NON_SCUMM_BUILD and DS_SCUMM_BUILD

svn-id: r51473
"
"148c830d769aaf4fd4e08e46284d419ff0c93f18","2010-07-29 16:24:25+00:00","DS: Add WRAP_MALLOC support to ds.mk, update comments

svn-id: r51474
"
"41ed8b438944025628b2e5a002ea3815b694fd22","2010-07-29 17:22:38+00:00","SCI: some subfunction support for logkernel

svn-id: r51475
"
"483f25b9e68daf41800e4dd51b7740e010782b18","2010-07-29 17:26:56+00:00","SCI: fixing qfg1 workaround

svn-id: r51476
"
"bc54fde8e1f58b910026644d606ba140aa3032c4","2010-07-29 19:08:07+00:00","SCI: Ignore setAttribute() on any non-existent menu items

This fixes two fan games: Al Pond 2 and Aquarius. The original interpreter did this as well.

svn-id: r51477
"
"3e8a972602663810465414cd9aad6dddab6a2f14","2010-07-29 19:11:49+00:00","DC: Specialize createConfig{Read,Write}Stream

Implement platform-specific variants of createConfigReadStream()
and createConfigWriteStream(), instead of inheriting the BaseBackend
definitions.  Nonstandard behavious is as follows:

* createConfigWriteStream() always returns 0 (read-only filesystem)

* createConfigReadStream() returns an empty MemoryReadStream instead
of NULL if scummvm.ini does not exist.  This is to make sure that
loadDefaultConfigFile() always clears out any old config data, as
I'll want to restart config parsing from scratch after a disc
swap.

svn-id: r51478
"
"e9234b61d671141761ea77e88302180d9d55b2f9","2010-07-29 19:48:17+00:00","SCI: Fixed Hoyle 3 bugs #3035077, #3035080, #3035081 and #3035242, by using the 'completed' case removed in rev #50921 for Hoyle 3

svn-id: r51479
"
"630127bc077e56c619c816a89e1d577c38b5eafb","2010-07-29 20:37:56+00:00","DC: Let scummvm.ini override autodetect of games

If a game CD has a scummvm.ini file with at least one game domain in
it, the normal autodetection is now bypassed and a menu of only the
games in the .ini file is presented instead.  The descriptions of the
games are taken from the .ini file, but icons are still scanned for
in the old fashion.

Note that previously ScummVM would read global options from the
scummvm.ini file on the boot disc (if present), but now global options
are instead taken from the scummvm.ini on the game disc (in case of
a disc swap).

svn-id: r51480
"
"1c24f2ca8fc333e5cf4df29dfbca83a9eb50bf3f","2010-07-29 21:12:16+00:00","SCI: midi hold behaviour fixed

we shouldnt react on hold midi data when no actual hold was called, fixes eq2/amulet problem (bug #3035392)

svn-id: r51482
"
"4101d4095716fee32ff1f3a4583d4b17eb7bab2f","2010-07-29 21:33:42+00:00","SCI: finished logkernel command

use 'logkernel DoSound' on to log calls to all kDoSound subfunctions. use 'logkernel DoSoundPlay' to log calls to kDoSound(play)

svn-id: r51483
"
"df9f4b5bfeee75319440cab3b2cd54a6ed1ef8f8","2010-07-29 22:04:23+00:00","SCI: reverting r51479 and adding TODOs for fixing the hoyle issue (fixing this properly should make credits etc. appear and solve all the other issues that clone submitted)

svn-id: r51484
"
"2c9d30290e1bdeef0407dc8061c7a9ca3abb9542","2010-07-29 22:52:48+00:00","SCI: fixing hoyle 3

hoyle 3 is using kCanBeHere, but it has cantBeHere and canBeHere selectors so our auto detection would fail
it also has a cantBeHere stub in Actor, thus it won't set acc at all. We reset acc because of that before calling cantBeHere selector (!) of the actors (canBeHere isnt used) so that we wont get a collision otherwise because acc is non zero when calling kDoBresen (fixes all sorts of bugs, clone2727 should clean it up :P

svn-id: r51485
"
"a17e3c444917ca90dfd537c2102a6150e7ffe977","2010-07-29 23:58:47+00:00","SCI: Fixed script bug #3036601 - 'LONGBOW: Druid hand code brings up ScummVM console', along with a related bug after giving an answer through the hand code

svn-id: r51486
"
"ffe7dcaa6b24efe7ee33483f0427c5094898656a","2010-07-30 05:25:09+00:00","SCI: Fixed script bug #3036918 - 'HOYLE3: Uninitialized read for temp 1'

svn-id: r51494
"
"d4aa4bc4d49e01d2e66cace53d3194a9d51a4b91","2010-07-30 05:31:20+00:00","SCI: Fixed script bug #3036942 - 'KQ4SCI demo: Menu crash'

svn-id: r51496
"
"c77eefad2481320f59f015b81abb59d67d997556","2010-07-30 06:18:28+00:00","SCI: Added a case for 10 params inside kSetCursorSci11(), thus fixing the crash from bug #3034973 - 'PHARKAS: Crash early in game'

svn-id: r51497
"
"7c190074c19c500533619246069f22d997ddbbaf","2010-07-30 07:05:40+00:00","SCI: Added PQ2 1.001.006 from bug report #3028479

svn-id: r51498
"
"a9a0451b15779bc7e9b792a49ff07bb0cff8d3fb","2010-07-30 07:11:57+00:00","SCI: Updated some comments related to Freddy Pharkas and silenced warning for kDoAudio subop 13

svn-id: r51499
"
"034fb5343fcc71b095d8d29c3d3c4586c38ac9c9","2010-07-30 08:21:54+00:00","SCI: cleaning up kSetCursor

showing warning about unsupported mag-cursor when argc = 10 is used
removing argc = 9 support, must have been a script bug somewhere

svn-id: r51500
"
"2fc1461f2bee59da2517a2373005deaae3dd6e0b","2010-07-30 08:44:40+00:00","SCI: arguments of mag-kSetCursor documented

adding primitive support to just set the cursor to the required view resource, nothing else implemented yet

svn-id: r51501
"
"1532685d821322549a448e15fb438e7a96d82c33","2010-07-30 09:32:54+00:00","PSP: optimized memcpy some more and fixed memcpy testing

Found that the particular implementation was producing messy assembly for misaligned copies. Improved it and also fixed up wrapping the memcpy, which would cause endless prints in case memcpy testing is asked for.

svn-id: r51503
"
"241e76d19d15a07d378e642effea28cc256ff47c","2010-07-30 12:40:06+00:00","SCI: Fixed script bug #3036263, 'LB2CD: Disappearing Journal Entries' by changing the return value of the workarounds made for bugs #3036274 and #3035068. The game scripts perform lt on the uninitialized temp, and if it's smaller than expected they start removing journal entries

svn-id: r51504
"
"28eea504e9518baed9862037b16fbaf66ceab106","2010-07-30 12:46:47+00:00","SCI: Adjusted return value of the script bug workaround in rev #51504 to a bigger number, just in case

svn-id: r51505
"
"c665b9e9a7c7e860119cdd2b4fae76d39d276a81","2010-07-30 13:29:33+00:00","Merged the two QFG3 workarounds and the two SQ1 workarounds

svn-id: r51506
"
"a6e84128c975a220f4c2800a1d937c37e34b6cec","2010-07-30 13:54:25+00:00","TESTBED: generalized the GUI, added code for the end text gui message and option to rerun tests

svn-id: r51507
"
"5b401215d9e0a31687c27b8b56ba3d651b89e000","2010-07-30 14:56:38+00:00","SCI: Added handling of negative numbers to
op_mod for SCI01 and newer games. Fixes the
battlecruiser mini-game in SQ5. Many thanks
to lskovlun, wjp and m_kiewitz for their
joined effort on this issue

svn-id: r51508
"
"cbbafc138b897387f702e541a0bf873348604179","2010-07-30 15:19:21+00:00","SCI: Updated the op_mod changes and added a link to the original bug report

svn-id: r51509
"
"c785645123493b8087a869e9f96e645898d51bfc","2010-07-30 15:26:30+00:00","SCI: adding workaround for kSetCursor kq5cd

adding comments as well

svn-id: r51510
"
"6dd5dfb7d0aa7e1d64f2e49ed3017dcceef6dbb1","2010-07-30 16:08:27+00:00","SCI: fixing font code handling in kTextSize

fixes incorrect window proportions in sq5 when hailing ship at clorox II

svn-id: r51511
"
"6aa228ccd8343b865f1ace5f0d404ee4714df5ed","2010-07-30 16:23:09+00:00","SCI: fixing another text color code issue

(sq5 some dialog boxes again using wrong font in rare cases)

svn-id: r51512
"
"839ba339ed58d66b7cb6f1fd69b0a85294f6f51f","2010-07-30 16:55:36+00:00","SCI: finally fixing font codes

fixing regressions of r51511&51512 and cleaning up as well - for sq5

svn-id: r51513
"
"75b5ac38fbd2c75fab5d0f794a44ec906ee48c05","2010-07-30 18:45:28+00:00","SCI: Fix saving/restoring games in fan games

The SCI Studio function library incorrectly calls kDeviceInfo with one parameter to get the current device.

svn-id: r51514
"
"9d6d0f8b3586c094f2f269394c8e8715c5e31db8","2010-07-30 20:10:30+00:00","TESTBED: added code to enable the mixer to simultaneously play channels, pause/unpause some of them using GUI, couple of fixes as well

svn-id: r51515
"
"8e705bb2e26f0900416e5649b869ee43706eeee5","2010-07-30 20:35:09+00:00","VIDEO: Fix FLIC looping

Thanks to salty-horse for finding this. Also, use Common::Rational directly to hold the frame rate to avoid rounding.

svn-id: r51516
"
"757f787a270676a38b165705c2e8b118bd5ca96d","2010-07-30 21:07:27+00:00","VIDEO: Ignore requests to unpause when video is already unpaused

Previous behavior was to assert

svn-id: r51517
"
"685c124a8e91dcec656258e7d8c11e1a735fe1cf","2010-07-30 21:29:45+00:00","SCI: speed throttler cleanup and iceman comment

svn-id: r51518
"
"062d9eedce06e79526b478441d2eefe85cf41113","2010-07-30 22:44:23+00:00","SCI: fixing view scaling code

fixes crash in sq5 with elevator on goliath

svn-id: r51520
"
"e29d6e681a2eccbfbedaf584f4cc530311ce1eb0","2010-07-30 22:47:01+00:00","SCI: Switch to Common::RandomSource.

Since I got no response to my mail to -devel, I just assume that there is
no specific reason for using rand() in SCI.

As explained in my mail to -devel about why SCI uses rand, this might allow
SCI to work with our event recording, when that ever gets finished.

I adapted kRandom so that it also supports negative random numbers. And
furthermore that the toNumber argument is smaller than the fromNumber
argument. I am not sure whether that really happens though, but it should
be safer to have this. I marked that place with an TODO/CHECKME.

svn-id: r51521
"
"8e8023d7cc24991f5ccf86734a8f95da6ac92f50","2010-07-30 23:24:22+00:00","JANITORIAL: Add comment about the stability of Common::sort.

svn-id: r51522
"
"fd0f5696a53dd990ff23525ec6eb2576a61e4bfb","2010-07-30 23:24:45+00:00","SCI: Add comment about stability requirements in makeSortedList.

svn-id: r51523
"
"f75d84cbdd2baa9633a5c20bdf8742425df8f19d","2010-07-30 23:42:50+00:00","JANITORIAL: Some small explanation about stability of sorting algorithms.

Special thanks to lskovlun for his suggestion to add this.

svn-id: r51524
"
"5dac7ba6ba8da1bfea07e8f696d230a8eea593b0","2010-07-31 00:48:03+00:00","SCI: fix kAddToPic called with view data

and adding workaround for pq2 when showing windows with pictures
change to kAddToPic fixes bad coordinates of cels when restoring the game (should also fix lsl2)

svn-id: r51526
"
"43e82aa895ae4e08cdb860fdfb7aa129ecf56d9b","2010-07-31 00:54:32+00:00","SCI: Fix walking in GK1 later in the game

The Feature class uninit'd workaround needs to be extended to all levels of inheritance.

svn-id: r51527
"
"cc575359dfc3a729296600c3d5e9cc19e3e1cfe7","2010-07-31 02:11:05+00:00","SCI: Whitespace cleanup.

svn-id: r51532
"
"9deb52fba60f73be7d09406bd4dd89385b95742a","2010-07-31 07:37:06+00:00","SCI: fixing stupid typo

svn-id: r51533
"
"e40ee138af219f934d8d420afd16e2713cb75aa9","2010-07-31 08:05:23+00:00","SCI: kAnimate - limit update of nsRect when scaled

only set nsRect when being drawn later (scaled only), fixes sq5 instant-death in elevator shaft

svn-id: r51534
"
"3a75d0fbe0e9cc6b3564c617338d4a14a59bb431","2010-07-31 12:37:49+00:00","SCI: adding polish lsl1

svn-id: r51535
"
"fec3ab7bee659f2cb2214cee2f88020b95f4fe8e","2010-07-31 12:42:23+00:00","SCI: updating comment

svn-id: r51536
"
"fd7bc295367f848b3a8f0658f65adb6a8447710a","2010-07-31 13:13:46+00:00","SCI: adjusting inside view::getCelRect for sci0early

fixes cels being placed wrongly, sci0early didnt have the z adjust.

svn-id: r51537
"
"2d76fe009206f5a064c3e21485743e433aa8ac3c","2010-07-31 14:09:42+00:00","SCI: kGameIsRestarting returns 2 when we restored

fixes castle of dr. brain save issue in puzzle room, fixes island of dr. brain save issue when saving in first room

svn-id: r51538
"
"7f3ce51031a02d2b54e9cee3aaa7a35bce3c7a92","2010-07-31 14:29:22+00:00","SCI: little cleanup

svn-id: r51539
"
"f54b9e3527ac89f1030795a97b787fef4a047850","2010-07-31 14:38:28+00:00","SCI: removing warning about uninitialized parameters

didn't cause any harm till now and it seems testers get irritated by it. Switching it to VM debug level 2.

svn-id: r51540
"
"5ea840283934938110f21fc04e3071b94c076765","2010-07-31 14:44:00+00:00","SCI: changing laurabow1 workaround to all rooms

fixes bug #3037410

svn-id: r51541
"
"1c6b339bbc2f9ee0624f7777e5950417a66a3286","2010-07-31 15:46:43+00:00","i18n: use user friendly language names in GUI

The GUI now uses the content of the Language field from the po file
header if it is present and not empty for the language selection
PopupWidget. If not present it uses the file name as before (e.g.
ru_RU).

Also update all the translation template and all the translation files.

svn-id: r51542
"
"e932270c0b1b5e6ba93011e5542591a5c5d94148","2010-07-31 16:20:16+00:00","SCI: Add uninit'd temp workaround for Grotesteing (fan game)

svn-id: r51543
"
"3e29e9ffaeab91b1ddf8e02b90bb65a087f89979","2010-07-31 16:41:42+00:00","SCI: adding detection for benchmark views

and enable speed throttler when just one regular cel was drawn, fixes eco quest 2 ego getting light-speed fast in village (bug #3036805)

=this could cause regressions like disabled animations in games=

svn-id: r51544
"
"142fb8a1f122f7dbeedc9df1e9de770c325d08ca","2010-07-31 19:18:35+00:00","SCI: Don't include the time running the debugger in the game running time

svn-id: r51548
"
"4afbfbf355d70df9ba7e2a33fd77685cf3e5399c","2010-07-31 19:35:53+00:00","SCI: fixing CR/LF, adding info about polish lsl1

svn-id: r51550
"
"450b82355d05f52bb900bcd4656ea850442b5140","2010-07-31 22:42:42+00:00","DS: Fix custom DS build system

svn-id: r51555
"
"4b9df2203f065293ac4067f76fd58afe87d4e3c8","2010-07-31 22:43:09+00:00","DS: Add shell script which emulates old DS builds using configure&make

svn-id: r51556
"
"d5e4efa0258ff27b48dd4ce5bb12bc05787098cb","2010-07-31 22:45:38+00:00","SCI: fix lofs autodetection

makes polish lsl1 work (its game superclass name got translated, so no 'Game' object available) - bug #3037194 thx to dam-soft for his patient help

svn-id: r51557
"
"57ad0408461b5551ae16962940e7f8e57fa43522","2010-07-31 22:48:49+00:00","DS: Remove now redundant ds-fs.o from PORT_OBJS

svn-id: r51558
"
"8851c2016fea54d564d3c5717c35633a3517ef25","2010-08-01 01:00:30+00:00","SCI: Fix uninitialized variable warning in g++.

Thanks to clone2727 for suggestion to initialize the default new plane
priority to 0xFFFF, which means that the plane should be invisible. I added a
FIXME there though. So please re check this change. In case that is fine just
remove the FIXME, in case some other default value should be chosen, please
change the value and also remove the FIXME.

svn-id: r51561
"
"2b7e58ae9b38778c15024c38b840b2f4255c8ebf","2010-08-01 04:22:34+00:00","SCI: Add another KQ5 VGA floppy entry (bug #3036996)

svn-id: r51564
"
"b02a326b893318dbf58eb3b383d8b0208ec8e8c2","2010-08-01 04:40:46+00:00","SCI: Add another LB2 floppy selector name for an uninit'd workaround (bug #3036291)

svn-id: r51565
"
"8f04aff6dccd4abffc707ec11d365362044fcae5","2010-08-01 07:02:05+00:00","QUEEN: fix for bug 3036170. File name test supports upper case for transferring from Windows to other systems (e.g. PSP)

svn-id: r51566
"
"0db8427f46674f8a835e606aa01eef4b50bf0f22","2010-08-01 07:15:43+00:00","iPhone: changed GL_NEAREST to GL_LINEAR in miniaturization filter as per forum post 29/7/10

svn-id: r51567
"
"d628562071cc8dd8475e0dd2bdf43601fdecb888","2010-08-01 08:56:24+00:00","TESTBED: fixed a typo, due to which the config file size was increasing if a rerun is made from the current menu

svn-id: r51568
"
"68f7b9be4c415186e2aebd749f978f31c0661ead","2010-08-01 09:20:21+00:00","SCI: reading the actual priority instead of guessing

svn-id: r51569
"
"4bb9157d81940fc353faac4fcc1cceb9aa347164","2010-08-01 10:07:24+00:00","SCI: adding audio directory searching for patches

fixes bug #3037768

svn-id: r51570
"
"af76912e873df1acb39714d1aa9479bb777591f9","2010-08-01 10:17:31+00:00","i18n: Added Cyrillic fonts to theme packages

This fixes ScummVM startup on systems with Russian set as locale.

svn-id: r51571
"
"9699f8291d4ec254d165954b5d4751cba93a8fe1","2010-08-01 11:10:14+00:00","SCI: Ignoring non-critical script bug in QFG1VGA, when closing any conversation dialog with esc (doesn't affect gameplay in any manner)

svn-id: r51572
"
"03f48560a9ab3d3ff972058dd184fcf60e872454","2010-08-01 11:10:47+00:00","SCI: adding workaround for hq1/qfg1

fixes bug #3037659

svn-id: r51573
"
"a0c58778f1c065c1fbe64a15fdc26fd6cef3efb2","2010-08-01 11:23:04+00:00","i18n: Update Russian translation

svn-id: r51574
"
"b0889cfd016e3e1f34466357384c2197366397cd","2010-08-01 12:00:36+00:00","SCI: adding workaround for lb1

fixes bug #3037694

svn-id: r51575
"
"83e51b0e92b401fb117d40d9eaaf2cafe30ecbd2","2010-08-01 12:38:07+00:00","SCI: removing pirated sq4 version from detection

'fixes' bug #3037800
fixing warning in seg_manager

svn-id: r51576
"
"7207290dc36c05f73693cf8107303ea49d9e0d63","2010-08-01 13:11:24+00:00","SCI: Enabled the 'Return to Launcher' feature (needs testing)

svn-id: r51577
"
"88438ce118c38e3179bd4dac56aa95c54f8215b6","2010-08-01 15:31:23+00:00","SCI: adding workaround for pq2 kDisplay

in room 23

svn-id: r51578
"
"193d3212da5f5356cc531e2cbfe06e061caefdc7","2010-08-01 16:23:44+00:00","SCI: adding 'audiosfx' to directories

svn-id: r51579
"
"adde79f1cbed9c0e4900ac305145ee22aae49d20","2010-08-01 16:43:49+00:00","SCI: fixing regression of r51520

svn-id: r51580
"
"2e94391d982656a9120483796c36fd8d46529a36","2010-08-01 17:16:39+00:00","CONFIGURE: add support for N64 port to configure

svn-id: r51581
"
"f3851674f38bfc5a799dd52e2ef2617517280c5f","2010-08-01 17:51:21+00:00","SCI: changing noname selector names

removing space from previous name

svn-id: r51582
"
"79bf94c87729506b556f66d15ea30827b509451a","2010-08-01 17:54:48+00:00","SCI: Move kernelShakeScreen to GfxScreen so it can be used in SCI32 (it's used in GK1)

svn-id: r51583
"
"4423ad9333c000861fafb485c975dbac47e154ac","2010-08-01 17:59:14+00:00","SCI: Cleanup.

svn-id: r51584
"
"2095ce31bde18f6b3a153d7479467eb13ed009ff","2010-08-01 19:31:18+00:00","GUI: Fix loading BDF fonts from theme archives.

svn-id: r51585
"
"c8aabe77e8858b68c5458888a01e5aeb3f5ffb2d","2010-08-01 19:31:37+00:00","GUI: Fix font cache.

The bounding boxes of the glyphs use signed coordinates. We stored only
unsigned coordinates, which resulted in incorrect glyph positioning.

Conrecte example: the bounding box of the glyphs for clR6x12-iso-8859-5.bdf
used:

x y  w h
0 -3 6 12

We on the other hand interpreted that as:

x y     w h
0 65533 6 12

when loading the font from our font cache.

svn-id: r51586
"
"55d7af07662802ad3bc04be6676aa2eb3932595e","2010-08-01 19:57:03+00:00","SCI: kDoSound(mute) behaviour change

svn-id: r51589
"
"312db66d5f369436690e75f51a33a48ba501b824","2010-08-01 20:47:46+00:00","AdvancedDetector: Introducing AD_LISTEND, another convenience macro

svn-id: r51590
"
"00e67c1f86ad5b6de203a9168f152bdc7f9e9a44","2010-08-01 20:48:25+00:00","SCI: Use new convenience macro and shorted the detection table a bit

svn-id: r51591
"
"7c5c3faae2b1d54887059bc29e3d8515648f1837","2010-08-01 21:17:00+00:00","AdvancedDetector: Introduce new flag GF_ADDENGLISH

It is convenient for localized games which always have English
as fallback, thus English will be selectable from GUI.

svn-id: r51593
"
"e0fb6b0bbfafc1377f002e3807ba96f0fb6bf0af","2010-08-01 21:18:08+00:00","SCI: Use new AD flag for German LSL5 which is dual-language

svn-id: r51594
"
"f2838316cb55fc743e68ff1768350fcca5ce08fc","2010-08-01 21:30:15+00:00","create_msvc: Fix SCUMMVM_LIBS support for MSVC2010.

svn-id: r51595
"
"575d38f602f7d9356f1849f5599008b2fef0e81a","2010-08-01 21:41:43+00:00","i18n: Adding Spanish and Ukrainian translations

svn-id: r51596
"
"afe35f5fb3a6f7df09a3ab751d3d475f5c4f49ab","2010-08-01 22:11:21+00:00","SCI: adding ADGF_ADDENGLISH to multilingual games

Most of the games are guessed, i assume that SCI01->SCI1 games are multilingual, SCI1.1+ are not. I'm definitely not sure about the amiga games, can't check them though

svn-id: r51597
"
"716f08a8ffcb77a1c488b1e4cc88f2be8af97a2e","2010-08-01 22:41:06+00:00","SCI: honoring english selection for multilingual games

svn-id: r51598
"
"75ff5360e22b2e8c6d796d064eb93751e6da522e","2010-08-01 22:54:34+00:00","SCI: adding workaround for pq3

svn-id: r51600
"
"ddd2bd6a1cc3e8b599e4398b61bc8e6e45ebb805","2010-08-01 22:59:58+00:00","SCI: switching to upscaled hires on pc98 games

instead of checking the language to be japanese for that

svn-id: r51601
"
"717e5f619b6a383cc96cbcd1d87f2584e0a89463","2010-08-01 23:26:38+00:00","TESTBED: implemented the exit dialog using ListWidget

svn-id: r51602
"
"55ada2315a269ee5dd2777652dc622c5b1c70b2e","2010-08-02 08:36:33+00:00","AdvancedDetector: Fix ADGF_ADDENGISH implementation

svn-id: r51606
"
"52c9c7b445f430879cadf06277a0da8fb499e4d8","2010-08-02 08:47:06+00:00","SCI: fixing getting selected language

for multilingual games

svn-id: r51608
"
"f434f901bdafc119454a119e94ea5dfba4b6ec5c","2010-08-02 09:04:14+00:00","SCI: Fixed script bug #3038077 - 'PQ3 : Engine Abort While Plotting Crimes', together with 2 subsequent similar bugs

svn-id: r51609
"
"f0d7808b2ad8054a7c557dffbe2ac8c95ebd1ad9","2010-08-02 09:10:20+00:00","Added another version of Castle of Dr. Brain (bug report #3037942)

svn-id: r51610
"
"065d32ec0025a12276957277798464a62bd88094","2010-08-02 11:46:03+00:00","SCI: Fixed script bug #3037835 - 'ISLANDBRAIN: Crash when breeding second-generation hybrid'

svn-id: r51611
"
"81aeb6a125947dc8ae7456c7f5898d41d6d1a86c","2010-08-02 12:18:22+00:00","SCI: Actually fake a return value for rev #51611, instead of ignoring the call completely

svn-id: r51612
"
"e59db80dec9460356a4c30c737b605ccf4720d1d","2010-08-02 12:39:01+00:00","SCI: qfg2/3 import

- change directory button disabled
- showing message where to put characters, if saved from original sci interpreter

svn-id: r51613
"
"b914ad3e843b208fa897b1916ae187559b1b3f71","2010-08-02 12:48:28+00:00","SCI: fixing typo

svn-id: r51614
"
"50b8073bab18e1a5f8c620468bc97bb1e9369148","2010-08-02 13:41:58+00:00","SCI: clipping plane rects for sci32

fixes crash in hires gk1 on cemetary

svn-id: r51615
"
"7ad434c592787969138b506eae5381c99c4d3909","2010-08-02 13:45:51+00:00","SCI: adding workaround for kq5 floppy

should fix bug #3037003, i dont have english floppy, can't test.

svn-id: r51616
"
"8cfce68c087d75b96524aee36b85364074bf4574","2010-08-02 13:49:08+00:00","SCI: adding bug id inside comments

svn-id: r51617
"
"c715f18273a51629d73cd185b94f8c036d5c15de","2010-08-02 14:14:06+00:00","SCI: Fix bug #3037055: Jones in the Fast Lane EGA - fails to start

A regression of r51423. Jones EGA has a non-parser related vocab.900 resource, so we can't detect the fan games based on not having an SCI1 vocab.900 resource. Fan games are now detected on whether or not vocab.0 exists (the parser vocab for SCI0).

svn-id: r51619
"
"94e8c3a1a85c6939aa205fa504fc06fdaf7fd8f9","2010-08-02 14:38:20+00:00","SCI: Add fallback detection for Mac SCI0 games

svn-id: r51620
"
"c5959bb179201d3c4eda48968c57468a01664a4d","2010-08-02 14:39:46+00:00","SCI: Add Hoyle 2 Mac md5's

svn-id: r51622
"
"8686be738b8c72824bec8b00d003b975965206b5","2010-08-02 15:17:18+00:00","SCI: Enable the Lighthouse demo SCI2.1 entry even when ENABLE_SCI3_GAMES is not set

svn-id: r51624
"
"84999b2daa85e67ea945af87c23ce418d69a4c03","2010-08-02 15:23:23+00:00","SCI: adding workaround for lsl6

when touching fence

svn-id: r51625
"
"6792193c892d68fc8a5b104c580a644635e576c6","2010-08-02 15:26:19+00:00","SCI: adding bugid again :P

svn-id: r51626
"
"e14033c6c5a12c74f56091a0f53e113fbe2ad279","2010-08-02 15:42:51+00:00","SCI: adding kq5 english floppy workaround

solves bug #3037594

svn-id: r51627
"
"cad3ea9f78b1765676ab35727622979b4cf65fec","2010-08-02 16:38:48+00:00","SCI: extend workaround for qfg2

fixes bug #3038367

svn-id: r51628
"
"d82e106d8117233e11875eafa323e845149339ee","2010-08-02 17:11:12+00:00","DS: Disable scalers and SID

svn-id: r51634
"
"5fb1bfd5a692c9b8a38b431d64958b3c3ffcb92c","2010-08-02 17:11:25+00:00","BUILD: Order host names (in particular ds and android) alphabetically

svn-id: r51635
"
"2682721aac813939f61105c40584373e3a30053c","2010-08-02 17:11:43+00:00","DS: Reorder & complete list of OPT_SPEED files; some tweaks

Add -mno-thumb to OPT_SPEED to override the -mthumb from OPT_SIZE.

svn-id: r51636
"
"8a3a41bc2b14c9eedeafc588de42e05860809045","2010-08-02 17:12:03+00:00","DS: More closely immitate CXXFLAGS of custom DS build system

svn-id: r51637
"
"8d1890d9313bab67997353e68241a1ceb8d15fb2","2010-08-02 17:12:20+00:00","DS: Disable debug mode in setup-builddirs.sh

svn-id: r51638
"
"8aae4aaaeef199f65522f94fe906449e3e626e75","2010-08-02 17:12:34+00:00","BUILD: Unify how we set vars to yes/no

svn-id: r51639
"
"2f4d2b58de1e4109cb454180b402708146476a8c","2010-08-02 17:12:52+00:00","DS: Allow disabling assert via NDEBUG; cleanup

svn-id: r51640
"
"bcfb8a030ae03b777ae2dbddfea0567509fb200f","2010-08-02 17:13:09+00:00","SCI: Rewrap overlong lines; improve dialog text slightly

svn-id: r51641
"
"512fec56c7bc3095463c4eaaf4c8e84d3113b151","2010-08-02 18:04:23+00:00","SCI: adding offTop = 0 for mother goose sci1.1

fixes graphics in that game

svn-id: r51643
"
"180f188b88dd7be12df5152f52f95b9b7039f012","2010-08-02 18:25:48+00:00","SCI: Cleanup SCI0 late version detection

After discussing with Walter, we should be able to detect SCI0 late on the presence of a SCI0 vocab.999 without checking if we're using the old decompressors.

svn-id: r51644
"
"9c8b4655053063fcdd5311ee0e5df5a4bd19cf92","2010-08-02 18:30:25+00:00","KYRA: FM-Towns audio driver rewrite

- FM-Towns euphony driver completely rewritten based on KYRA FM-Towns and LOOM towns disasm.

- Split all the emu and driver code from sound_towns.cpp into different files to make things a bit less confusing.

- Move the driver code to common space since the exact same euphony driver is used by LOOM which means we could get rid of the outdated and incomplete ym2612 driver/emu implementation (which doesn't even do things like instrument loading, pan position, etc). I haven't tried to add this to the Scumm engine yet, since I am not  familiar with it and my priority was to get the driver finished first. But from the look of disasm it shouldn't be difficult to do.

- Introduce a generic FM-Towns audio interface based on FM-Towns system file disasm which was necessary for the euphony driver rewrite. Every FM-Towns game I have seen so far seems to access the audio hardware via these system functions. This interface implementation will also allow reasonably simple creation of new FM-Towns audio drivers (e.g. this could be used for Kings Quest 5 FM-Towns or others).

- Move the PC98 driver to common space, too, since I have a strong feeling that this driver is also used in the PC98 version of Future Wars

- This also improves KYRA FM-Towns music quality, sound effects accuracy and music fading.

svn-id: r51645
"
"bed1e3c164771f4108ebab3d5aaf688e29e8118f","2010-08-02 18:30:37+00:00","SCI: Fix bug #3037401 - LB2Floppy: No SFX

Laura Bow 2 floppy and Mixed-Up Mother Goose SCI1.1 use an 8-byte entry 0.map format to store their entries.

svn-id: r51646
"
"d2019b9b8d2095c6a9ddd3114d282edfd6e9fcb4","2010-08-02 18:37:37+00:00","KYRA: forgot to update Kyra.dat in last commit

svn-id: r51647
"
"add6d6772ad6c2160bce854fc13694feb16e0d06","2010-08-02 18:53:23+00:00","KYRA/TOWNS AUDIO: try to fix last regression

svn-id: r51648
"
"7575c2be0b337cb88df0fe59ca297f38c34879c5","2010-08-02 18:56:51+00:00","KYRA/TOWNS AUDIO: and another fix

svn-id: r51649
"
"2964e9213de9d81e901156a76ee1fdad6707a268","2010-08-02 19:00:46+00:00","KYRA2: fix warning

svn-id: r51650
"
"f14940cbb577648bad3a9495e02e335aa6f8952e","2010-08-02 19:05:12+00:00","FM-TOWNS/PC98 Sound: Strip trailing whitespaces/tabs.

svn-id: r51651
"
"7f2e880f705937702bbddf8c224e0574e7a85d56","2010-08-02 19:27:44+00:00","TOWNS/PC98 Driver: Some formatting fixes.

svn-id: r51653
"
"7f1f4c8b07973782a0a56ff530e11cfb631a6a75","2010-08-02 19:36:49+00:00","TOWNS/PC98: Replaced some tabs with spaces.

svn-id: r51654
"
"20d6173ee060d73202945dce9a142943491b085c","2010-08-02 20:17:05+00:00","TOWNS AUDIO: fix typo

svn-id: r51655
"
"bde60490adf6ef10cfe68460b12c310377641c4a","2010-08-02 20:28:14+00:00","N64: mention hkz-libn64 download location in port readme

svn-id: r51656
"
"a46f69570f5307ed962e92db9d858783b93ef098","2010-08-02 20:38:06+00:00","CONFIGURE: cleanup of N64 port sections

svn-id: r51657
"
"2b73c50a476a20864f3631e3d3c2ac24710fe3a3","2010-08-02 20:43:42+00:00","GUI: Fix valgrind warning.

svn-id: r51658
"
"e52128706303a3016e3ac0c69a88477c93bfc78c","2010-08-02 20:45:17+00:00","CONFIGURE: drop hardcoded endianess and hq scalers from n64 section

svn-id: r51659
"
"09f4562551c6f26f5eac8a048051cd379ef93a2d","2010-08-02 21:04:09+00:00","SCI: adding non-scaleable view capability

fixes laura bow 2 (especially floppy but CD is also affected somewhat by this)

svn-id: r51660
"
"5ca6b33ba7bd9b6c5c35635d8f56f695ca931ce1","2010-08-02 21:20:43+00:00","SCI: Silenced some sound related warnings. Added an empty function for kDoSound(Restore), called when restoring games

svn-id: r51661
"
"7da703f0af8cf85d7f961d43becee616dffa28aa","2010-08-02 21:37:43+00:00","SCI: adding workaround for qfg2 (restore game)

svn-id: r51662
"
"d42d7ad6c52ad90c53b510f10611cbbb6eb56f5b","2010-08-02 21:44:41+00:00","SCI: allowing kCheckSaveGame with id 0

qfg2 - when trying to restore from an empty saved game list

svn-id: r51663
"
"0f339921edc7908fafa4a9098211255abd6ee13c","2010-08-02 21:57:17+00:00","SCI: only display qfg-import information dialog once

per room usage

svn-id: r51664
"
"a1001731fa50c730dcf834b724edfb89a8352298","2010-08-02 22:12:45+00:00","SCI: fixing leak kernel subfunctions

svn-id: r51665
"
"dd38e424e7ec87990019f4a811fdc25c62fe1729","2010-08-02 22:27:26+00:00","SCI: Fix leaks in ResourceManager::listResources caller code.

svn-id: r51666
"
"0dba655085e3c5f025ae111be4929d5a9250d95a","2010-08-02 22:27:50+00:00","SCI: Fix memory leak.

This was a quite bad leak in gamestate_restore. It was caused by the code only
deleting the Graphics::Surface object but not its data.

I changed the code to use skipThumbnailHeader now, since the code actually
ignores the thumbnail anyway.

svn-id: r51667
"
"4e33b7a3befbc4d14cdb57ac8da8c205ca724cb0","2010-08-02 22:28:30+00:00","GRAPHICS: Renamed skipThumbnailHeader to skipThumbnail.

svn-id: r51668
"
"92b0b384eaea0540bf7c06652d799b616ebf4c3c","2010-08-02 22:35:29+00:00","SCI: Fix memory leak.

svn-id: r51669
"
"a76f5449bc741d35a76ed9173350b3c18dbb87bd","2010-08-02 23:03:04+00:00","SCI: Yet another slight leak fix.

svn-id: r51670
"
"39846310d79e75faf55482a239ec5ca8eaf34c2b","2010-08-03 00:02:46+00:00","SOUND: Constify waveform table; slightly simplify code

svn-id: r51671
"
"0437ffa75c510f0bb8a3a5cd580b79008446522e","2010-08-03 00:03:04+00:00","N64: Error out in configure if N64SDK is not set

svn-id: r51672
"
"02cca98ed6fce6d7aced41974eaf2fd1622f207c","2010-08-03 11:25:20+00:00","SCUMM: Add posibility to disable NES APU which is CPU demanding

svn-id: r51679
"
"5d212755ced446403739a229277b0087c9f8ec08","2010-08-03 11:25:37+00:00","NDS: Disable NES APU for the platform

svn-id: r51680
"
"1ec8a75ef6a07436d8e143fba7662a00ac39afd8","2010-08-03 11:25:52+00:00","N64: Disable CPU-hungry sound chips

svn-id: r51681
"
"ed9c3093b5cf041b8ddb304a5a03ec6dad3575f6","2010-08-03 11:26:10+00:00","PS2: Disable CPU-hungry sound chips

svn-id: r51682
"
"3932ebfaf04e7c759b672170692ae39ee03c6159","2010-08-03 11:26:32+00:00","PSP: Disable CPU-hungry sound chips

svn-id: r51683
"
"bcd6dd26278a2c29209ac1505c655e846f01daf9","2010-08-03 12:03:36+00:00","PSP: Enable 'CPU-hungry sound chips' again, the PSP is fast enough.

svn-id: r51684
"
"3b4b00cf5099e3720ae93bff17c7778389b5ff62","2010-08-03 12:29:08+00:00","PSP: Factored out thread creation routines into PspThreadable class.

This should aid in further optimizations.

svn-id: r51685
"
"425b90f6d21c8fec27565b649f8d6bc10d926719","2010-08-03 12:39:11+00:00","SCI: adding kDoSound(fade) workaround table to sci1early

fixes kq5 bug #3037594 thx to [md5] for testing

svn-id: r51686
"
"32807512d949f482814ddda7d7625192cdc0f8ef","2010-08-03 12:41:36+00:00","SCI: Cleanup

svn-id: r51687
"
"a1730b4b34d4893f2ada108928b43058648a8c62","2010-08-03 12:46:18+00:00","SCI: adding workaround for sq5 on the bridge

fixes bug #3038563

svn-id: r51689
"
"8e08c432da73e014c7759f2f18019ddc3870771c","2010-08-03 13:12:42+00:00","FMTOWNS AUDIO: minor layout change

svn-id: r51691
"
"a02d9d656b8a066f362dd872d094dd4d849a8537","2010-08-03 13:15:34+00:00","GRAPHICS: Fix a typo in a comment.

svn-id: r51692
"
"4c7a6ac2d56e9fa136663028d6be45c01d53d321","2010-08-03 13:17:30+00:00","SCI: adding workaround for pq3 inside kMemory

fixing plot crimes warnings and bad text on screen

svn-id: r51693
"
"221934ea9374bb1248784d4e88a78c36b881f3fb","2010-08-03 14:10:25+00:00","SCI: Add detection entries from bug #3037054, bug #3038720, and bug #3038761

svn-id: r51694
"
"5962b0bbe27b8d32dbbad1e8c3d36906dc391dd2","2010-08-03 14:58:01+00:00","KYRA/TOWNS: implement music/sfx volume control via GUI/GMM

svn-id: r51695
"
"44f12117f2f3d842f455d3bea1554904199b73e1","2010-08-03 14:58:57+00:00","SCI: Add support for SCI2.1 chunk resources

And if no scripts are present, but chunk 0 is present, load resources from there. This fixes the Lighthouse SCI2.1 demo.

svn-id: r51696
"
"65e215628d26397ed23ef53db46fb2b8a5203eb3","2010-08-03 15:04:56+00:00","SCI: dont clip plane during frameout.cpp

disables scrolling capability
(regression of r51615)

svn-id: r51697
"
"b149ca89d518feb470ffc71893c5e0717b7482da","2010-08-03 15:09:39+00:00","KYRA3: Fix bug in Screen_v2::generateOverlay.

Uncovered by a valgrind warning.

svn-id: r51698
"
"20002588e66036fc992d60d44381a53650fd9d01","2010-08-03 15:33:35+00:00","SCI: Hopefully fix signedness warning with some compilers

svn-id: r51699
"
"6665bf4a0194e1199c3005b12986f5fa87847608","2010-08-03 15:34:28+00:00","CONFIGURE: removed two useless definitions in N64 sections

svn-id: r51700
"
"ee28c2eb54b3b02643a2e46d793acdf0843596a0","2010-08-03 15:51:31+00:00","SCI: adding workaround for pq3

fixes bug #3037565

svn-id: r51701
"
"14e7ba5d91be70e4c4479916875a0d782c02b1ee","2010-08-03 16:03:22+00:00","SCI: kMemory issue in pq3 only for multilingual

adjusted comment accordingly

svn-id: r51702
"
"14c9522d776a6a7ceb01b9b3076d43729e7780f4","2010-08-03 16:21:45+00:00","KYRA: Fix Screen_v2::generateOverlay implementation.

svn-id: r51703
"
"64585b40ebd8fac26d151aa12e6c6a22f631c20c","2010-08-03 16:22:12+00:00","KYRA: Get rid of Screen_LoL::generateLevelOverlay.

This function is actually exactly the same as Screen_v2::generateOverlay,
after I fixed the implementation of the latter last commit.

svn-id: r51704
"
"13824582d1dc3d1d6df6b57e171f6357799e0489","2010-08-03 16:43:57+00:00","LOL: Minor adjustment to latest generateOverlay changes.

svn-id: r51705
"
"824a5f32a043486b3e15b9a01f0651ac7ae6a372","2010-08-03 16:54:39+00:00","LOL: fixed possible crash in environmental sfx code

svn-id: r51706
"
"3d228f270f380d5b74becfb3e3598d0ef1ed5c8c","2010-08-03 17:09:27+00:00","DRACI: recognize German translation

svn-id: r51707
"
"3fc3a59139b52828fa06f8f3e22f068c004fd469","2010-08-03 18:19:25+00:00","KYRA/TOWNS: replace some music stops with fadeouts (based on original code)

svn-id: r51708
"
"449927abcf3c7c5b7346b6483375f19150ebc3bd","2010-08-03 19:06:27+00:00","FMTOWNS AUDIO: fix typo

svn-id: r51709
"
"fcede4680a03e4f7a389a43f71d1484794e8dead","2010-08-03 19:06:40+00:00","SCI: adding bpk debug command

currently removing or listing such breakpoints is not yet supported

svn-id: r51710
"
"9dbe6fdb078809fc156974ea242bd8ccfa513593","2010-08-03 19:24:09+00:00","TESTBED: Implemented audioCD tests

svn-id: r51711
"
"2e11c1cf9642de2db81ea0a25541872c20f28b8e","2010-08-03 19:43:16+00:00","SCI: reset ports when restoring

fixes qfg3/fairy tales restoring (bug #3035626)
also fixes ScummVM menu restoring while a window is shown (e.g. sq5)

svn-id: r51712
"
"fee1bb28bd54f77edbe1e85135384ba9d1af9fa2","2010-08-03 20:26:28+00:00","TESTBED: added audiocd test sound tracks as the testbed engine data

svn-id: r51713
"
"dc08c733db190ea9f1814e49cd4ed5a7525a96b0","2010-08-03 20:46:28+00:00","SCI: adding jones/talkie speed throttler view

fixes bug #3038989, regression of r51544

svn-id: r51714
"
"7487b51e873bdb9b919641ab84cfa1225cd465ed","2010-08-03 21:38:26+00:00","SCI: not error()ing out on no free channels

instead we just ignore such channels. I'm not sure how sierra sci behaved in that case, they ignored channels as well, but maybe they removed them from earlier music

svn-id: r51715
"
"bde4012f464a47ebe43a5f0498c7a18c40889140","2010-08-04 00:33:54+00:00","SCI: Silence valgrind warning (thanks to syke for pointing out)

svn-id: r51717
"
"cbe07a07b7bad5dec7630d85675128cd5f7ece51","2010-08-04 05:06:41+00:00","SCI: Fix SCI32 texts that are in Str objects

The text selector of the text bitmap object can contain either a Str object or a raw string. Handling the Str object case fixes the Torin demo. Oooh! Vertical scrolling!

svn-id: r51722
"
"0eaa9bddb6beb605ef602dffb4da6dae9713ac50","2010-08-04 05:15:01+00:00","SCI: Fix restoring SCI32 games (a regression of r51712)

svn-id: r51723
"
"154c589f188914e79ba10da1de947a5ae2c0427e","2010-08-04 08:23:48+00:00","GRAPHICS: Fix FlicDecoder::hasDirtyPalette signature

Add const qualifier to FlicDecoder::hasDirtyPalette to make it
match that if VideoDecoder::hasDirtyPalette.

svn-id: r51724
"
"0e2807dc27af89c46a191834e5e623a9e77e9187","2010-08-04 08:25:05+00:00","GRAPHICS: Change signature of VideoDecoder::load()

Now takes a pointer to a stream, instead of a reference.
The rational is that in all instances, callers have a pointer
(and dereference it to call load), and all load implementations
turn the reference back into a pointer.

svn-id: r51725
"
"5ed9ddaa2c0ba1df52b72799c6fbd35a566e6960","2010-08-04 08:25:39+00:00","SCI: Remove reference to common/serializer.h from vm_types.h

svn-id: r51726
"
"fcf3ea61fef643231076ce9b3d6e160f74015477","2010-08-04 08:26:09+00:00","SCI: Simplify code (let the compiler interfer types where possible)

svn-id: r51727
"
"b45f2fcb972d18808db80c51280f2f132150ef06","2010-08-04 09:15:37+00:00","SCI: fix fadeout on workarounds

svn-id: r51728
"
"975e3bf83e2ddd985906930d5c0e6f5b07afc134","2010-08-04 10:11:06+00:00","SCI: fixing a scrolling issue in sci32

svn-id: r51729
"
"8d3086d3016477e070c434db2ddc915c9ac53284","2010-08-04 12:02:50+00:00","SCI: Fixed the two script bugs described in bug #3039294 - 'SCI: HOYLE4 - Uninitialized Read(s)'

svn-id: r51730
"
"74304fb790759a1dc4dc9b078565b9eba0fe2c34","2010-08-04 12:11:23+00:00","SCI: Fix infinite recursion when saving.

This was a regression from r51727.

svn-id: r51731
"
"624107319ef8d57854b6b8e4d264831697d5d00e","2010-08-04 12:41:00+00:00","SCI: Fixed an off-by-one error in GfxPorts::getPortById() and moved the error checking code outside the function. Also fixed script bug #3039305 - 'HOYLE4: segfault'

svn-id: r51733
"
"2b1f366e19f19ba5316fe7af95bd77176178d801","2010-08-04 12:54:16+00:00","SCI: Added detection entry for Hoyle 4 (Hoyle Classic Card Games) from bug report #3039291

svn-id: r51735
"
"4db52c1ce13fa6b621ba77949b0a34c8881ff997","2010-08-04 13:35:56+00:00","SCI: Turned a warning into a debugC

svn-id: r51738
"
"a5056cde9812a18dd76e3c453ba4bb62b9d303ab","2010-08-04 15:17:09+00:00","SCI: Add 'movie' subdirectory for VMD's

The Torin's intro movie now plays. Minor kPlayVMD cleanup.

svn-id: r51739
"
"fbd7c8456705442f12c9c798c58ec146f0a85063","2010-08-04 16:13:26+00:00","SCI: Add Hero's Quest demo detection entry (qfg1 ega)

svn-id: r51740
"
"e5ffc7847cb70f792b4658aa032959949e849669","2010-08-04 16:53:09+00:00","AUDIO: Implement volume and balance control for the AudioCD manager (needed for music fading in Kyra 1 FM-Towns and probably other FM-Towns games). This addition applies to emulated CD audio only for now.  I haven't found a way to implement this for real CDs yet. SDL doesn't seem to support this (but it might be just me? If anyone knows more about this, just tell me).

svn-id: r51741
"
"642b03fb44a19109d8f098174fdfa326d2ae5ee5","2010-08-04 17:50:09+00:00","SCI: Add kDisplay workarounds for the Hero's Quest demo

svn-id: r51742
"
"ed741dc96c2369bfc6abf29704108bc29e5ba9a9","2010-08-04 18:11:11+00:00","SCI: Fix bug #3038913 - SCI Fanmade - The Legend of the Lost Jewel: Crash by bugs

Added workaround for calling mul with an object and kSetAngle with two objects as parameters.

svn-id: r51743
"
"79882783369235ae815a5f00d5c7d9d281b9fb7b","2010-08-04 18:19:18+00:00","SCI: Add uninit'd workaround for bug #3038757

svn-id: r51744
"
"4a2ab850192eeec9df486d920b0cb769081d2b03","2010-08-04 22:45:10+00:00","SCI: Fix size of wave files inside audio volumes (thanks to LordHoto for pointing out)

svn-id: r51745
"
"8e6d2eb5a37a0887ec569699118486cbf78ab5f5","2010-08-05 05:27:55+00:00","SCI: Extended the QFG3 workaround in room 330 (speaking with King Rajah). Fixes bug #3039774 - 'Uninitialized Read'

svn-id: r51751
"
"1b6925765469de2e96bfa44f5b0c739309f982cf","2010-08-05 07:49:19+00:00","SCI: changing hoyle 4 workaround

fixing hoyle 4 detection entry (not a demo)
adding direct selector fix, maybe we should replace this later with a script patch
adding detailed comment about the issue

svn-id: r51753
"
"c71f1f1612eb87e04f8fd55b7982d99594f93c43","2010-08-05 07:54:33+00:00","SCI: actually enable hoyle 4 workaround

and adding additional comment

svn-id: r51754
"
"33f2bc65a66ee20ad51f4a614820d5a1f19dff29","2010-08-05 11:19:32+00:00","SCI: Fixed bug #3039477 - 'KQ5CD: No speech after restoring from ScummVM' and added a TODO for loading through the game launcher

svn-id: r51755
"
"ff2ad216b1e4042e8b64323998605d2d83e36427","2010-08-05 14:40:22+00:00","GUI: Fix classic theme's GMM in 320x200.

svn-id: r51756
"
"9cd333152b763a109cf5b88af508678c1ea3fba7","2010-08-05 14:41:00+00:00","KYRA: Add support for subtitle options changes via GMM.

svn-id: r51757
"
"19e624ae5be72bfe1dc677911d656871737dd371","2010-08-05 16:58:59+00:00","SCI: Changed the warning when a script can't be found from a segment into an error

svn-id: r51758
"
"e36abee963c2af73981db0dea42eb39d504a7f0c","2010-08-05 20:12:40+00:00","SCI: Applied patch #3040164, '3 Workarrounds for QFG4 floppy'

svn-id: r51762
"
"0f27a860491ded3631db18a954dd4b46677c4965","2010-08-05 20:21:28+00:00","SCI: Fixed script bug #3039656 - 'CASTLEBRAIN: Crashes in robot room'

svn-id: r51763
"
"b69469a75d6a4247df0632fa8862398179540704","2010-08-05 20:32:18+00:00","SCI: Fixed script bug #3039891 - 'QFG2: Crash in thief's job'

svn-id: r51764
"
"6c0855f3d3efc52478ba9ce019fbd4c9287f4691","2010-08-05 21:36:17+00:00","TESTBED: playing audio output with variable sample rates

svn-id: r51766
"
"4ae7427eed781613e2cda096d0f61c77883bca05","2010-08-05 21:48:30+00:00","Added a sanity check inside kDoBresen, thanks to lskovlun. Fixes the random crashes in the floor scrubbing scene in SQ5

svn-id: r51768
"
"e82194e4c5e03d4f3786ec17e3f091c5ac92ce3b","2010-08-05 22:39:54+00:00","KYRA: Fix compilation of create_kyradat.

svn-id: r51769
"
"0850f3dcea0f2d6e7f11f0caf4ffc11ebd404901","2010-08-05 22:58:16+00:00","SCI: Added bug number for the floor scrubbing bug

svn-id: r51770
"
"b7aa748dd203cf066bab384cca49dc49056b07d5","2010-08-05 23:04:57+00:00","KYRA: Append newline in help string of create_kyradat.

svn-id: r51771
"
"6c8bcd2ba1cad1312f0a588ca284110bbbb81ccc","2010-08-05 23:08:05+00:00","SCI: Added a workaround for a script bug in QFG2, room 200, when talking with the astrologer. Fixes bug #3039879, 'QFG2: Crash at astrologer's'

svn-id: r51772
"
"5216d816168072bf2c2587eacb970abb92762513","2010-08-06 10:15:27+00:00","Don't include engines/sci as userinclude path, causes conflicts with graphics/ inclusion

svn-id: r51779
"
"0c940edb711e6e1a59b25d907425bed5fbcb8e1a","2010-08-06 10:58:51+00:00","Start to support Flac when building!

svn-id: r51781
"
"ffbecee1d7178109b27a5809d53c8d51b6267955","2010-08-06 11:02:52+00:00","SCI: adding workaround for qfg3

when importing character and choosing previous profession (bug #3040460)

svn-id: r51782
"
"9013c154800a2216b9ce3e36f019f0871d8deeb4","2010-08-06 11:45:32+00:00","SCI: properly implementing qfg2 astrologer workaround

svn-id: r51783
"
"39e6bb3257e279c60bdf473015d080363ea67945","2010-08-06 13:55:16+00:00","Enabled translation by default. Include common/error.cpp in uiq3 makefile

svn-id: r51784
"
"4d03efe855bd3bce1c7e061287b4f201b28d28fa","2010-08-06 14:54:00+00:00","SCI: Fix whitespace

svn-id: r51785
"
"eb112d671103b7021e466fd0b160efab7a91a26a","2010-08-06 15:05:05+00:00","SCI: Rewrote the Mother Goose workaround to be like the others, some cleanup

svn-id: r51786
"
"2a4768401eeef5ec688524a24aba0740db0abf34","2010-08-06 15:06:42+00:00","SCI: some work on the script patcher

signature matching is working (added hoyle 4 signature)

svn-id: r51787
"
"afed447b6fd3f52e7958c5ce499f84939f2e79e3","2010-08-06 15:12:03+00:00","SCI: fix warnings

svn-id: r51788
"
"8ca076fb3adbe5d0b8d781ed2a8ac78b22090a38","2010-08-06 15:30:23+00:00","SCI: fixing another warning

svn-id: r51789
"
"7c70e488ea74008300e54258c8fe81dded274913","2010-08-06 16:43:59+00:00","SCI: Fixed script bug #3040624 - 'QFG3: Crash after any combat in jungle'

svn-id: r51790
"
"91753047be66bdedb3f6e626f3c1f7f123364dc4","2010-08-06 17:00:23+00:00","SCI: Fixed script bug #3040565, 'QFG3: Crash when looking at stats'

svn-id: r51791
"
"993c8b70f29a90ecfc9b663836302af7f50afd2b","2010-08-06 17:29:17+00:00","SCI: Fixed script bug #3040469, 'QFG2: Second crash in thief's job'

svn-id: r51792
"
"753c431937ce3cb080b24c6a79f5e90548bfe431","2010-08-06 18:54:58+00:00","SCI: adding script patching

including a patch for hoyle 4 and commenting out the workaround code inside kDisposeWindow

svn-id: r51795
"
"7b0a5ec099df23c5b6662a09aeb54b9666c07ee1","2010-08-06 19:13:19+00:00","SCI: adjusting patch to write 0 instead of 1

patch still worked, but 0 was meant to be there thx to lskovlun to point this out

svn-id: r51796
"
"7e126ed299cb789340cb2f8d409338dbdd6c8235","2010-08-06 20:13:41+00:00","TESTBED: Merged changes from trunk to my branch

svn-id: r51798
"
"346bc3f7e0bbad741f529d7a5bafeedffc9d67b1","2010-08-06 20:29:27+00:00","SCI: Added a workaround for kAbs to properly support patched scripts by NRS in QFG1VGA. Properly fixes bug #3037218 - 'QFG1 VGA: kAbs signature mismatch' (thanks to wjp for his help on this)

svn-id: r51799
"
"d0ff92e2a0c96dbea82989cf94aacc28430dcfa4","2010-08-06 21:18:43+00:00","SCI: Fixed an off-by one error in the kDoBresen sanity check

svn-id: r51804
"
"96fd9e6c8273715c48556bdc6e150908f0fa04c7","2010-08-06 21:21:39+00:00","SCI: Added support for scripts that have more than one export table. Fixes bug #3039785 - 'Conquests of Camelot: Crash in Glastonbury Tor'

svn-id: r51805
"
"8ddcf3942bbc03225ff6a3ce8c577bbfc791f1c1","2010-08-06 21:51:45+00:00","SCI: adding patch for lsl6 issue

fixes crashing when dieing at least in german lsl6, caused by temp memory space corruption. Also happened in sierra sci.

svn-id: r51807
"
"92dfff36bf6c6e1c7e2a1c215ef9c5dc8a4709e8","2010-08-06 21:52:16+00:00","SCI: Fixed script bug #3040844 - 'QFG3: Crash near the end'

svn-id: r51808
"
"dfe4c8d9a079c01d4a6cfdf5290da2a0af941c8a","2010-08-06 22:14:38+00:00","SCI: fixing typo

svn-id: r51809
"
"57fd5883277b258eba73bfec98a27503223569ff","2010-08-06 22:36:46+00:00","SCI: Split the new script patch code in a separate file

svn-id: r51810
"
"ab0d57d73d434c3523e5b44ed5f4ce95b895c8a0","2010-08-06 22:51:25+00:00","SCI: Some cleanup of the script patch code. Added a PATCH_MAGICDWORD define to make the patch tables easier to understand

svn-id: r51811
"
"cb0aa8679828709b4a7fb8756f1d9d6685cc6b54","2010-08-06 23:56:19+00:00","SCI: Fixed 2 SQ1 script bugs (#3040894 and #3040905)

svn-id: r51815
"
"7935ebf4a32fe340de2220c2c90f76f06c9c7472","2010-08-07 00:22:57+00:00","SCI: Converted an error back into a warning when loading games

svn-id: r51816
"
"53474618ac82fe74ed6637a19e1dfb4b655e994c","2010-08-07 00:34:38+00:00","SCI: Fixed script bug #3039036 - 'Castle of Dr. Brain: Crash at robot jokes'

svn-id: r51817
"
"0cb8e130d891cfe2418e2792c490f73544cb6689","2010-08-07 00:59:40+00:00","SCI: Changed a warning into a debugC

svn-id: r51820
"
"ab79d581531355f76f90ce0668e012ffbfa201f5","2010-08-07 01:09:32+00:00","SCI: Fixed script bug #3040142 - 'PEPPER: Crash on Pugh's office'

svn-id: r51821
"
"978e52379f50cb787000bbfdfca804e25a59783a","2010-08-07 01:14:58+00:00","SCI: Fixed script bug #3040012 - 'PEPPER: Book crash'

svn-id: r51822
"
"7b7364a80f8db29b8b36f419cf47b0097358af6d","2010-08-07 01:27:14+00:00","SCI: Fixed script bug #3039395 - 'KQ5: Crash when opening leather pouch'

svn-id: r51823
"
"421ac2562879d6bae8c01536273cca3c89dbd603","2010-08-07 08:59:43+00:00","SCI: Added support for the inbuilt leftover parser in XMAS1990

svn-id: r51829
"
"8e7cce6e5bbca78556c96ead341e04dfa839ae78","2010-08-07 12:13:12+00:00","fixed a typo with hotkeys in ButtonWidget

svn-id: r51830
"
"9aa3f25499e7a7454fc56b17e005842415ac2113","2010-08-07 12:36:17+00:00","SCI: Improve output when VM_DEBUG_SEND is set

svn-id: r51831
"
"1c1eff9ec56147a94aab5148994a39d72cb67e53","2010-08-07 13:40:14+00:00","SCI: adding sq5 scrubbing patch

(for testing only, i'm not sure if it works because i'm unable to reproduce the bug anymore)

svn-id: r51832
"
"d2d22de9115fe803870d7ca1d06ece1ab5f77f45","2010-08-07 13:56:31+00:00","SCI: removing kDoBresen hack for sq5

adding detailed comment about sq5 scrubbing issue
not 100% fixed (waltervn should look into it), but at least it works now

svn-id: r51833
"
"f4d38ccd407f2a007050d69e4841ba7fc53cd401","2010-08-07 14:38:07+00:00","LOL: added english floppy version

svn-id: r51834
"
"adc243c5aca723a625d9a6240241a66a421abeb9","2010-08-07 15:02:08+00:00","SCI: changing kBaseSetter behaviour when scaled

fixes lb2 docks issue (bug #3036306)

svn-id: r51835
"
"a4a28eb16e3f2c9d1f4e79120b359821d731eecf","2010-08-07 16:17:12+00:00","TESTBED: fix in fs tests

svn-id: r51837
"
"d365b71945c8d31fd19b4de638cc26db617fd5a5","2010-08-07 16:42:10+00:00","SCI: Turned a warning into an error

svn-id: r51838
"
"dab72c519c7aa4ba1e7bc451222e8d0ac3367ac3","2010-08-07 20:35:50+00:00","TESTBED: fixed default disabling of FS testsuite when game data files are not found

svn-id: r51840
"
"37d28b35b9b7ed2c71af7ea59b7bc4706412192c","2010-08-07 21:01:31+00:00","TESTBED: added checks to make sure the object is acquired before use, fixed a typo

svn-id: r51841
"
"b5b47d50c8984361965c49eead999eb7bc672171","2010-08-08 00:33:13+00:00","VIDEO: Make Indeo3 a proper video codec

This way, Indeo3 is properly usable in various container VideoDecoder,
for example AVI, and not just VMD.
Since VMD is not yet ready for this, we're disabling Indeo3 in VMDs
for now.

svn-id: r51849
"
"a802e1e64f56b5c6b0534a481e84418078b2699f","2010-08-08 00:33:59+00:00","VIDEO: Stub a VideoDecoder-like CoktelDecoder

This creates a new CoktelDecoder class using the VideoDecoder
interface, which will eventually become the new way to decode
PreIMD, IMD and VMD videos.
Since the VideoPlayer in gob is not yet ready for this, we're
disabling all video playback in the gob engine for now.

svn-id: r51850
"
"f8a43ee35f4ca2a409558fbb6bf978cc2ae54ab4","2010-08-08 00:34:33+00:00","GOB: Stub the new VideoPlayer interface

This is will be the new, less convoluted interface for playing videos
within the gob engine. No actual functionality is implemented yet, and
old functions are mostly commented out for now.

svn-id: r51851
"
"44159533936ff68da1d92639003ae30fc7611cf1","2010-08-08 00:35:18+00:00","GOB: Add constants for different surfaces/sprites

Add
static const int kFrontSurface   = 20;
static const int kBackSurface    = 21;
static const int kAnimSurface    = 22;
static const int kCursorSurface  = 23;
static const int kCaptureSurface = 30;
to class Draw and substitute the raw numbers in other files with
those aliases, for readability.

svn-id: r51852
"
"59b9b3bc2bd1c057a6b0f56d2b49a46ff37e00b6","2010-08-08 00:35:50+00:00","GOB: Implement the new VideoPlayer::openVideo function further

svn-id: r51853
"
"167c6e8787811910d2e62393231dc98f14d70d15","2010-08-08 00:36:19+00:00","VIDEO: Bare PreIMD decoding

Implemented bare PreIMD decoding using the new CoktelDecoder interface.
No fancy stuff yet, only basic vieo frames.

svn-id: r51854
"
"9c2172b90149d5c164f26444c021488f6656ef55","2010-08-08 00:36:47+00:00","GOB: Fix an copy&paste error

Fixing an accidentally overwritten video file name

svn-id: r51855
"
"863872216f1f0e987640633d339ef62e314d15d4","2010-08-08 00:37:19+00:00","GOB: Basic video playback using the new interface

Implement basic video playback using the new VideoPlayer interface.
Still quite stubby, still lots of stuff missing.

svn-id: r51856
"
"9255d2e2179ee6a2cd63b6d8f521e3b9d8543be6","2010-08-08 00:37:52+00:00","VIDEO/GOB: Add setSurfaceMemory() to CoktelDecoder

This allows the video player to directly draw onto its own video
memory without having to blit each frame another time.
Will also be needed for proper handling of transparency in Woodruff.

svn-id: r51857
"
"12c9e895b559d1ca2780b5b8f156b0451eb11f11","2010-08-08 00:38:26+00:00","VIDEO/GOB: Add CoktelDecoder::setXY()

This allows for positioning the video within the video memory.

svn-id: r51858
"
"f7363fdb10675bf27c1a1d37d23a25590bdc344c","2010-08-08 00:39:03+00:00","VIDEO/GOB: Add CoktelDecoder::getDirtyRects()

This allows for the client code to only update the parts of the
video frames that actually changed.

svn-id: r51859
"
"aa113e5ab3b6e96ff6d2b56839b7ac08ec0617cc","2010-08-08 00:39:32+00:00","VIDEO: Add CoktelDecoder::setFrameRate().

Allows client code to overwrite the video's frame rate.

svn-id: r51860
"
"bb746b5b619b439669c878f218b9be91faff549a","2010-08-08 00:40:00+00:00","GOB: Properly utilize FixedRateVideoDecoder::getTimeToNextFrame()

svn-id: r51861
"
"dcf8298a75cfeb44c6059f03b57f0a61bc062ac0","2010-08-08 00:40:24+00:00","VIDEO: Stub IMDDecoder

svn-id: r51862
"
"160172d0e8c3e2cd031fcbe559ebc743e644fc65","2010-08-08 00:40:52+00:00","GOB: Hook the new IMDDecoder into VideoPlayer

svn-id: r51863
"
"31ecaa52759e7f471da049bda0162316655a00b8","2010-08-08 00:41:22+00:00","GOB: Make o2_playImd use the new VideoPlayer interface

svn-id: r51864
"
"f19be90c37c3aa402ea7efdc0fc02595fe68a122","2010-08-08 00:41:56+00:00","VIDEO/GOB: Implement IMD loading

svn-id: r51865
"
"6172fe8ea7cf8046e5048e56a512ad0f847ac324","2010-08-08 00:42:30+00:00","VIDEO/GOB: Implement IMD frame decoding

Rendering the frame video data is still stubbed out.

svn-id: r51866
"
"fecbdf60a98d2cbadfc26b406b7076ae74424066","2010-08-08 00:42:59+00:00","VIDEO/GOB: Implement IMD frame rendering

svn-id: r51867
"
"a824bcefaaaff0acac79722e867875b9cb35e681","2010-08-08 00:43:22+00:00","GOB: Make playImd() use the new VideoPlayer interface

svn-id: r51868
"
"6e5518271b893b7b6fd81bc71f72bb40b660e059","2010-08-08 00:43:45+00:00","GOB: Use the new VideoPlayer interface for coktel.imd

svn-id: r51869
"
"2bcc02a27a5261fab4d769e3160ff490573a6be1","2010-08-08 00:44:05+00:00","VIDEO/GOB: Fixing the frame rate for mult'd videos.

In the gob engine, some videos are opened, and then played, at
a later time, one frame at a time. In this case, we need to
emulate the original's video player's behaviour, not calculating
any 'lag' for videos without sound.

svn-id: r51870
"
"2296aad042aad1c9983b4a9bf2e187912c361407","2010-08-08 00:44:33+00:00","VIDEO/GOB: Fix IMD playing

Fix IMD playing for some fringe cases, especially when seeking
beforehand.

svn-id: r51871
"
"61739bc180731c22ee8008d7f47bf3f399fed358","2010-08-08 00:44:56+00:00","GOB: Fix video workaround detection

svn-id: r51872
"
"f956f059e3fcdbf4da29f6f5ecec2339f5b89e78","2010-08-08 00:45:27+00:00","GOB: Minor cleanup

svn-id: r51873
"
"933ffcaa60e8eea09054038887f9dcd2e2772473","2010-08-08 00:45:58+00:00","VIDEO: Make getFrameRate() protected again

svn-id: r51874
"
"737ef0270718c2f7fb92784f337a308967d57ce3","2010-08-08 00:46:34+00:00","VIDEO/GOB: Stub hasEmbeddedFile / getEmbeddedFile

Stubbing CoktelDecoder::hasEmbeddedFile() and
CoktelDecoder::getEmbeddedFile(), formerly hasExtraData/getExtraData.

svn-id: r51875
"
"8f621b3d2c3ac97f2c769bf795d22884a7a0d387","2010-08-08 00:46:57+00:00","GOB: Make o4_playVmdOrMusic use the new VideoPlayer interface

svn-id: r51876
"
"53b67deaf0332f598168af4cbccc61ff4e5944c3","2010-08-08 00:47:25+00:00","VIDEO: Fix another IMD seek issue

svn-id: r51877
"
"7fe406a5ddbde7c46605437c13a9d79c6178f28e","2010-08-08 00:47:54+00:00","GOB: Fix video continuing

svn-id: r51878
"
"8a09b25f7b64f1ac506dc7ade7dd98690fd44635","2010-08-08 00:48:23+00:00","GOB: Make the Bargon Attack intro use the new VideoPlayer interface

svn-id: r51879
"
"688ae2bfff418d19e117d0f827e855b48d2a9a9d","2010-08-08 00:48:51+00:00","GOB: Another VideoPlayer interface adaption

svn-id: r51880
"
"d1d772367b63a760e45ff270186215511fd936c6","2010-08-08 00:49:15+00:00","VIDEO: Fix another IMD seek issue

svn-id: r51881
"
"f2e5eb78bb3bc223a67e69b42c0013548b26884d","2010-08-08 00:49:38+00:00","GOB: Play 23 frames backwards, not back to frame 23

svn-id: r51882
"
"c812fedb5d47a01daa7a824f1cf56563ff50d5e6","2010-08-08 00:50:12+00:00","GOB: Fix another another with continuing videos

svn-id: r51883
"
"0cf837c1af4e55c32dff91ff88632cd0260858f5","2010-08-08 00:50:35+00:00","VIDEO: renderBlockWhole2Y still works

svn-id: r51884
"
"285ba14e233c20ad5753f779f6717f591ea0a83a","2010-08-08 00:51:09+00:00","GOB: Make the demoplayer use the new VideoPlayer interface

svn-id: r51885
"
"66aeee8ddc3affec0708e51c2ab78cad2f6b7440","2010-08-08 00:51:33+00:00","VIDEO: Don't crash when sound is disabled :P

svn-id: r51886
"
"f61a3c53151ffd9d0a7c59a5d4f7226d08ff404c","2010-08-08 00:52:01+00:00","GOB: Fix videos with the kNoVideo flag

svn-id: r51887
"
"a57e53c986f8a2d67902b5ed9079112b0f69260a","2010-08-08 00:52:30+00:00","VIDEO: Add some comments, fix a style issue

svn-id: r51888
"
"6ebec969c57029e8191689589237c1c5dd9917ee","2010-08-08 00:52:59+00:00","VIDEO: Fix deLZ77'ing video data directly onto the video surface

svn-id: r51890
"
"3295d6ec6ba15afa8d6f1118e916c40ad9bd2f72","2010-08-08 00:53:27+00:00","GOB: Make o6_playVmdOrMusic use the new VideoPlayer interface

svn-id: r51891
"
"3c5e02900f6397add6365bea819987bf9d6e89e6","2010-08-08 00:53:55+00:00","VIDEO: Add getSurface

svn-id: r51892
"
"424e802bb92119ce9a8f95b2399a23d911d061e7","2010-08-08 00:54:24+00:00","GOB: Add copyFrame

svn-id: r51893
"
"a2847e853b9b87f53185b6e6dd0f9ab0d3aae587","2010-08-08 00:54:52+00:00","GOB: Make o6_loadCursor use the new VideoPlayer interface

svn-id: r51894
"
"bab55f3a1d8f24e959fa98bda3a775452cc14198","2010-08-08 00:55:27+00:00","GOB: Adapt the remaining bits to the new VideoPlayer interface

svn-id: r51895
"
"1f630094268a76fd73e7a1f01e725aef2aa61e8e","2010-08-08 00:56:04+00:00","VIDEO/GOB: Stubb VMDDecoder

svn-id: r51896
"
"d081c2e20f5eb5c55de4aa6722b9ae1f57648425","2010-08-08 00:56:29+00:00","VIDEO: Move the frame calculation out of seek()

svn-id: r51897
"
"41f5d7812836f3c60532802780d93d5545b2258d","2010-08-08 00:56:58+00:00","VIDEO: Implement VMD loading

svn-id: r51898
"
"b13afba0536d16c3e37a2a887d582d9eeb42c8d1","2010-08-08 00:57:27+00:00","VIDEO: Implement embedded file handling for VMDs

svn-id: r51899
"
"f447ddb36a2bf8b923083e96b51279d72306d22a","2010-08-08 00:58:00+00:00","VIDEO: Fix compilation after the VideoDecoder::load signature change in r51725

svn-id: r51900
"
"74bec1696b60ebe881972af24066fa34f37b9957","2010-08-08 00:58:29+00:00","VIDEO: Implement VMDDecoder::seek()

svn-id: r51901
"
"0886f7e33cbb800c93caab79aedbef2d1cd64967","2010-08-08 00:58:59+00:00","VIDEO: Implement VMD frame decoding

svn-id: r51902
"
"6d31b1768500f03734d4e24dc13d088215071bde","2010-08-08 00:59:28+00:00","VIDEO: Implement VMD sound

svn-id: r51903
"
"506c1e7d85773b2fe7e8a8d69edde7fc8f88fe10","2010-08-08 00:59:58+00:00","VIDEO: Change the CoktelDecoder::renderBlock*'s signatures

Change CoktelDecoder::renderBlock*() and IMDDecoder::renderFrame()
to receive a Common::Rect instead of mucking about with _dirtyRects.

svn-id: r51904
"
"b796c39645276958d1e5dcd63ac13d5dde0ab7e8","2010-08-08 01:00:23+00:00","VIDEO: Implement VMD frame rendering

svn-id: r51905
"
"b2aba5970e09aa5c862f1c0eb4ae9ab8565a5849","2010-08-08 01:00:53+00:00","VIDEO: Fix VMD seeking

svn-id: r51906
"
"6d03ddef0bcc06041b385224c003d78c8214cf4f","2010-08-08 01:01:17+00:00","VIDEO: Implement CoktelDecoder::renderBlockRLE()

svn-id: r51907
"
"eed41aa22337571c18e08abfdf00d19fd2a5121d","2010-08-08 01:01:45+00:00","VIDEO: Fix a failed assertion in VMDDecoder::readFiles()

svn-id: r51908
"
"945103a43c9a15a4a9a07765197b0551593b4236","2010-08-08 01:02:19+00:00","VIDEO/GOB: Implement and use CoktelDecoder::getFrameCoords()

svn-id: r51909
"
"5dc322454de75e25d5db8b8f284131a166d558e7","2010-08-08 01:02:49+00:00","GOB: Fix playing of sound VMDs with a starting frame != 0

svn-id: r51910
"
"cebc1aca818eb3912feaee12716e78d6d8210b48","2010-08-08 01:03:21+00:00","GOB: Fix playing of slot videos

The actual frame content is still not there, though :P

svn-id: r51911
"
"af96a0fa3bfe0509efbdf99d15b1dd0d146f8968","2010-08-08 01:03:50+00:00","VIDEO: Implement VMDDecoder::setXY()

svn-id: r51912
"
"f40b128bd9dc1356666ee81c5db9689aea762786","2010-08-08 01:04:19+00:00","GOB: Partly fixing VMD slot playing

svn-id: r51913
"
"e6f57854363452f3189e547ca945790d030ef409","2010-08-08 01:04:46+00:00","GOB: Fix a VMD slot seeking regression

svn-id: r51914
"
"0be37b6b28bf0089dd1f23bc6b81fb256c2cb4ae","2010-08-08 01:05:16+00:00","VIDEO: Implement VMD subtitles

svn-id: r51915
"
"a78ddb8488de0b6928b0135dfbd461e39380c436","2010-08-08 01:05:46+00:00","GOB: Handle VMD subtitles again

svn-id: r51916
"
"4133ef90bc35fe7e627dba8cb82bee3950e2329e","2010-08-08 01:06:15+00:00","VIDEO: Make CoktelDecoder::getFrameCoords() virtual

Like it should have been in the first place...
Fixes Woodruff slot-VMD positions.

svn-id: r51917
"
"f7c23d28e73af5a5fe290512d933e2f233e7debb","2010-08-08 01:06:44+00:00","GOB: Reactivate the Coh-Cott-workaround

svn-id: r51918
"
"dc3a41769976c5d25206f8a8b649ef36a4a1b51f","2010-08-08 01:07:17+00:00","VIDEO: Change the mixer parameter from a reference to a pointer

To match the other VideoDecoder classes with sound support.

svn-id: r51919
"
"8186214bc9348514c5020f4449cea2ecfb599a8a","2010-08-08 01:07:45+00:00","VIDEO: Set _paletteDirty in VMDDecoder::load() when there is an initial palette

svn-id: r51920
"
"1151676d8215f411718a28f2d2f58961560efbd1","2010-08-08 01:08:17+00:00","VIDEO: Use proper palettes in CoktelDecoder

Not just the 6 bits per color component used in VGA

svn-id: r51921
"
"96e079a9f78d20344ff5699182194a5b35691e5e","2010-08-08 01:08:48+00:00","SCI: Directly use the new Graphics::VMDDecoder class

svn-id: r51922
"
"f5d1482c64d1969bf77f5107a792bff84dc7e903","2010-08-08 01:09:20+00:00","SCI: Remove the now useless Sci::VMDDecoder wrapper

svn-id: r51923
"
"609dc65df6f84cf6cf59ee06047569e269814a73","2010-08-08 01:09:45+00:00","VIDEO: Remove the now obsolete CoktelVideo classes

svn-id: r51924
"
"3016de7197bc3b2d21341ddddf1a7534942c03ff","2010-08-08 02:55:45+00:00","VIDEO: Fixing typos ('Unknow' -> 'Unknown')

svn-id: r51926
"
"5f8947c21dab2cc66e23cf5a2d96511e0fd0b5c8","2010-08-08 02:56:11+00:00","VIDEO: Use tag2str

svn-id: r51927
"
"27c79d51d43b95c72b80c8aa5ccc70a2d29a34b0","2010-08-08 03:33:44+00:00","VIDEO: Cinepak cleanup

svn-id: r51928
"
"054c586bcc74de047536b5d4f2fdc4540dce24f3","2010-08-08 17:34:32+00:00","KYRA/TOWNS: some minor sound improvements

(some cleanup to internal driver volume control, minor frequency change for fm-towns)

svn-id: r51930
"
"27f6e7106dad4c1d3ade5239ffb1a3e96ce9222b","2010-08-08 17:51:50+00:00","VIDEO: That should fix compilation with MSVC

svn-id: r51931
"
"a06dcea2e57ac3d26ee4b92b8d85ab55535d732f","2010-08-08 18:26:40+00:00","SCI: kDisposeWindow changes

kDisposeWindow doesn't free windows immediately anymore. We free them after some calls to kSetPort, so the handle will be valid for a short time. Fixes sq4cd and hoyle 4 (commented out patching of script for hoyle 4)

svn-id: r51932
"
"00fa8a17c51e83ba9f4d0115b78796d4977bb0e4","2010-08-08 18:36:07+00:00","SCI: adding workarounds for lb2

bug #3041257

svn-id: r51933
"
"15b881386aa81bf60919486c5eab9f81c6b9d6ae","2010-08-09 10:30:40+00:00","CRUISE: Eliminate global constructors

svn-id: r51936
"
"327d30d71962d793e773b147d940e50d06539364","2010-08-09 11:38:01+00:00","CINE: eliminate global variables

svn-id: r51937
"
"5611507156f5f25b7c2dcba341e920d23afb93cb","2010-08-09 14:06:24+00:00","DOCS: Explicitely mention that LGPL does not apply to all files.

svn-id: r51938
"
"b8b4b4257762c02a244147844d1b954a3da1c891","2010-08-09 14:31:59+00:00","LEGAL: Add COPYING.BSD file

Reword the disclaimer at the top of COPYING.LGPL, as it sounds a bit
awkward to me.

Move the BSD-like license to the top of mpeg_player.cpp (it still
points out that only parts of the file are under that license) because
that's where COPYING.BSD tells the reader to look.

svn-id: r51939
"
"0fe49fde684d709615085371124a7ed07f5edf5d","2010-08-09 14:36:35+00:00","LEGAL: Add COPYING.BSD to DIST_FILES_DOCS.

svn-id: r51940
"
"33b9705af0f767e47693bac225e54834b6bcb5bd","2010-08-09 16:13:42+00:00","SCI: extended workaround of kq6 to all rooms

fixes bug #3041734

svn-id: r51941
"
"d88928b1be8b59d16d402585aaa78c117ac2db36","2010-08-09 18:42:07+00:00","SCI: adding script patches for gk1

day6 issue in police department

svn-id: r51942
"
"4e92b3a17ea963d3c006c93abd28287e0fac153a","2010-08-09 20:10:53+00:00","TESTBED: Some refinemnts related to skipping tests and display in GUI

svn-id: r51945
"
"acb32580ce440aa687309999ed11ee6e5ca1fa72","2010-08-09 21:18:27+00:00","TESTBED: Some more refinements to the GUI and mouse event tests

svn-id: r51946
"
"fffec23a02cc88ed8daba0a3b50007b7e220c075","2010-08-09 21:43:31+00:00","SCI: adding gk1 patch for day 5 freeze

svn-id: r51947
"
"f4f61145836e862ae325b54d711e0da4c7e0f392","2010-08-09 21:50:21+00:00","SCI: fixing signature for gk1

day6 police sleep issue

svn-id: r51948
"
"98effc462e4df5b61f1496b08b88a42638326758","2010-08-09 21:57:49+00:00","SCI: changing patch message slightly

svn-id: r51949
"
"197f6c222848174703c229382f2534ff0bc08f11","2010-08-10 13:18:13+00:00","SCI: adding workaround for kq5

when giving the tambourine to the monster - bug #3041262

svn-id: r51950
"
"3b9ebd6353857a7dda4a0a6361fc95a7a98c6174","2010-08-10 15:18:18+00:00","SCI: adding patch for eq1cd

fixes ego swimming left/right of room 660 and getting a 'message not found' error and a GE? signature mismatch - in sierra sci this also resulted in 'message not found' and a hang afterwards - bug #3038387

svn-id: r51951
"
"684afb62362b7aff8380d08aa54cc6a24878bfbf","2010-08-10 15:54:34+00:00","SCI: add scaling support to kAddToPic

fixes laurabow2 bug #3041226

svn-id: r51952
"
"2db12a1ae7f0dffd4384e71df577a407f2a35f44","2010-08-10 16:24:00+00:00","GUI: fix broken MT-32 tab

svn-id: r51953
"
"a201b2e506be4adbacb0b7ffa9d40a94a4842e3e","2010-08-10 17:16:38+00:00","SCI: kAddToPic(list) set fixed priority flag

svn-id: r51954
"
"9be20d5f0a5d9cfd433ba89f25d321efd82b0a7f","2010-08-10 18:00:27+00:00","SCI: adding displaceY adjust for sci1.1 views

sierra sci did this in their getCelRect(), we are doing it while loading, fixes laura bow not appearing in taxi (bug #3041220)

svn-id: r51955
"
"d154361e894b132034179b714ade6c3ecfa00159","2010-08-10 18:05:04+00:00","SCI: improving comment about r51955

svn-id: r51956
"
"32553308cffd5d2f936f6143e89db703afeb0036","2010-08-10 20:20:28+00:00","TESTBED: basic template for midi tests

svn-id: r51957
"
"9e9809276c51cd262e9726483f00ee9956a6639a","2010-08-10 20:49:40+00:00","SCI: adding workaround for qfg3

awari minigame, fixes bug #3040579

svn-id: r51958
"
"145969c35b97f8aa9a12eb25477052949c533ea5","2010-08-10 20:54:02+00:00","SCI: improved random actors workaround lb2

svn-id: r51959
"
"7a7916421ab9d38fea89d9510f85c942d665c6be","2010-08-11 03:39:51+00:00","SCI: adding workaround for hoyl4

bug #3042756, although there is another bug shortly after

svn-id: r51968
"
"42c3cc4c08ed720b39fedbc4463c07f31fefa4ef","2010-08-11 05:20:29+00:00","SCI: kAnimate invalid loop/cels now correctly fixed

fixes kq5 trunk getting closed again during intro - is actually a script bug that sets cel to some really high number - bug #3037578, may also fix other similar issues

svn-id: r51969
"
"c70f16c55dbe1550ad6f6c850b06bc1239d48408","2010-08-11 06:13:08+00:00","SCI: making camelot fix camelot-only for now

fixes kq6 getting assert as well (bug 3042866)

svn-id: r51970
"
"ab35ae03c3bd4c34933385658aeffb37053a178a","2010-08-11 12:01:56+00:00","SCI: kAddToPic only wrote nsRect in sci1.1

fixes regression of r51952 and bug #3042957

svn-id: r51971
"
"63e3082e34a9327bbb6f72ba0b23e0b6284f9aa4","2010-08-11 12:48:43+00:00","README: Fix dmedia env var description; tweaked some wording

The IRIX dmedia driver documentation incorrectly asked the user
to use SCUMMVM_PORT to override the sequencer port, but the
driver actually checks SCUMMVM_MIDIPORT.

Also tried to clarify some MIDI related wording

svn-id: r51972
"
"aa9f9c7e7e68df016d39a163f6f0b121afa2e4e3","2010-08-11 12:48:57+00:00","README: Mention that TiMidity driver also supports SCUMMVM_MIDIPORT

svn-id: r51973
"
"b8ee574e40676a711e07312f859c11da988e517a","2010-08-11 12:49:16+00:00","SCUMM: _resultVarNumber and related methods are specific to v0-v5

svn-id: r51974
"
"aa265f1541a2633d01a686eaa272d15fc7364a5e","2010-08-11 12:49:28+00:00","BUILD: Add -Wglobal-constructors to default warnings

svn-id: r51975
"
"9829bb13f5ad2f7b465f1bdb981464ac50a1f187","2010-08-11 12:49:44+00:00","GP2X: Do not include base/internal_version.h

svn-id: r51976
"
"01c8e02e60530b70dba26cdaf707710aa41f94c7","2010-08-11 12:50:00+00:00","LINUXMOTO: Do not include base/internal_version.h

svn-id: r51977
"
"1b1044437716dd0f4dc1e591ba8f442fd85911e1","2010-08-11 12:50:18+00:00","BUILD: Limit scope of SCUMMVM_SVN_REVISION and SCUMMVM_VERSION macros

Only #define SCUMMVM_SVN_REVISION for base/version.cpp (at most), to
avoid having all source files implicitly depend on the SVN revision.
Also add a safeguard to prevent code from accidentally using the
internal header file base/internal_version.h.

svn-id: r51978
"
"8795b926e032f6556b4a5c8225a91ba4cff7180b","2010-08-11 13:29:49+00:00","Disable -Wglobal-constructors by default

svn-id: r51979
"
"fa5157deeabfb3cedc07042b458e84794d720e62","2010-08-11 13:32:10+00:00","Remove obsolete devcpp files

svn-id: r51980
"
"3d56859fc9ca988531db98846e840ee1a4114dac","2010-08-11 14:16:08+00:00","SCI: fixing slater&charlie go camping entry

bug #3042547

svn-id: r51981
"
"f242451da1b3b631f8f26d6f21a5726e438ff806","2010-08-11 14:28:23+00:00","SCI: cleanup of slater detection entries

svn-id: r51982
"
"2b77ffcc17518adc99b773000f0b8771c779e1db","2010-08-11 14:32:33+00:00","SCUMM: possible fix for bug # 3041539

enable PCJR sound for Maniac Mansion v1 and v1 and Zak McKracken v1 and v2.

svn-id: r51983
"
"8889a6574de0b1da2302ea7f51c806407abeb908","2010-08-11 14:35:42+00:00","SCI: adding workaround for sq1

when restoring on arcada in some rooms (bug #3040908)

svn-id: r51984
"
"324e9373477532468ca8723f165a4ac595653223","2010-08-11 15:04:26+00:00","SCI: not pausing kDoSound samples anymore

but pausing looped samples only
fixes 'I'm melting' sample in sq1 death (bug #3038048)
added detailed comment about this change

svn-id: r51985
"
"1302ccb464964ca806343d85fd3d128df0a839de","2010-08-11 15:09:07+00:00","SCUMM: Add missing 'break' in music setup

This once again makes it possible to select PC Speaker music in Indy 3.

svn-id: r51986
"
"10b6a395cf4665c115b3e8bb233bd8842acf1724","2010-08-11 15:16:55+00:00","SCUMM: Add missing case in sound initialisation

If the mixer isn't ready, we probably have to check for PCjr as well,
so add that case.

svn-id: r51987
"
"416b56874490fae9aeba76bc7603313b59f24df7","2010-08-11 15:36:29+00:00","SCUMM: Re-enable PCjr music for Indy 3

Apart from adding the necessary detector flags, in cases where we used
to only check for PC Speaker we now also need to check for PCjr. Note
that I have only tested this with the VGA version. And even with that
one, I've only given it the briefest of tests.

svn-id: r51988
"
"5c8e23f772b5149d9acb0560e716114c74ff25c2","2010-08-11 15:41:32+00:00","SCUMM: Re-enable PCjr music for EGA Loom.

svn-id: r51989
"
"d781c4bbaad0cfff6150c90e2c96b17c3647860e","2010-08-11 15:52:49+00:00","SCUMM: Re-enabled PCjr music for some more games

At this point, there's little point in doing them one game at a time.
Re-enable PCjr music for old Monkey Island, and for the Passport to
Adventure demo. Again, I don't have all the relevant versions to test
myself, so keep an eye out for regressions.

At this point, only the Apple II and C64 versions of Maniac Mansion
have the MDT_PCSPK flag, but not the MDT_PCJR flag. I don't know a
thing about these versions, so I'm leaving them well enough alone.

svn-id: r51990
"
"38f34465b720272586d3df41ef23f9b03d72945c","2010-08-11 16:58:44+00:00","SCI: workaround change kq5

svn-id: r51991
"
"0c7932cc7cd54ea8fdee9d12663657d67eaa7639","2010-08-11 18:19:58+00:00","SCI: fixing kGraphFillBoxAny implementation

working now like in sierra sci, when using priority/control - fixes pepper adventures in time - no failure screen - bug #3040185
cleanup of GfxPaint16::fillRect

svn-id: r51994
"
"4a159bcb1e086d03c7bd1216694552ed5a83103e","2010-08-11 18:54:56+00:00","GUI: add music devices for c64, amiga and apple II gs

These devices are not able to create appropriate drivers.
The only purpose for now is having proper gui options and flags and music types for the device detector.
The corresponding GUIO flags for the new devices have been added, too.

svn-id: r51995
"
"581935dda41a40d4862ceb28f2afac8e3d766fea","2010-08-11 18:56:50+00:00","KYRA: add new GUIO_MIDIAMIGA flag to amiga targets

svn-id: r51996
"
"ff8b296c299d01dd1e7670e6c6d38e12b4c1f3e6","2010-08-11 19:32:07+00:00","Use tabs instead of spaces for indentation.

svn-id: r51997
"
"60b27502092eb149271715e3c3a5d8ab0cbc4308","2010-08-11 20:39:13+00:00","SCI: adding patch for kq5 harpy volume

fixes actual game bug #3042277 - sierra switched in that case to highest volume possible

svn-id: r51999
"
"7e3b2bedb6bcffb172dda4f4436dc3dc89a0a649","2010-08-11 21:16:45+00:00","SCI: revert r51969

broke laura bow 1, need to figure out whats exactly wrong

svn-id: r52004
"
"06139e2be77960df89f3ca88223035add9802835","2010-08-11 21:47:44+00:00","SCI: properly doing kAnimate loop/cel fixing

really weird, but it works now. Bug #3037578 (kq5 trunk), bug #3043286 (lb1 knight)

svn-id: r52007
"
"53f11373d491d34ee735dcb99106926c9e6af342","2010-08-11 21:51:34+00:00","i18n: Update all translations.

Template and all translations were updated from source code. The
German and French translations contain additional changes.

svn-id: r52008
"
"f6a1cb991fef5de697d97af1418e719592fbcee6","2010-08-11 21:52:28+00:00","TESTBED: enable playing MIDI through testbed

svn-id: r52009
"
"75117d787514192c20788efb5c62997c1b1b514c","2010-08-11 22:50:13+00:00","FMTOWNS AUDIO: fix cda volume and balance control

svn-id: r52013
"
"629042a07cae1ee101b1fea64d9025f2498b7d3a","2010-08-11 23:21:53+00:00","i18n: Update German translation

svn-id: r52014
"
"91c2c7f40176105330c5efe2ac52ad62aa6d872c","2010-08-12 09:52:00+00:00","SCI: fixing text color support

fixes some words not being red in pepper (part of bug #3040039)

svn-id: r52031
"
"91cfd044384442243af492a4fb976c231cf6e2f0","2010-08-12 13:45:39+00:00","SCI: adding patch for laurabow2

painting closing immediately
(fixed properly here, the NRS patch just nukes the whole routine)

svn-id: r52038
"
"e5a8c8c544ad0773f3456d3d1e3ace1924be1c2f","2010-08-12 13:52:03+00:00","SCI: laurabow2 patch is lb2cd exclusive

svn-id: r52039
"
"bb932595d844c86cd3d775d316c2285ef73f0df8","2010-08-12 14:01:28+00:00","SCI: adjusting laurabow2 patch signature

for laurabow2 floppy. In floppy the bug doesn't occur, we fix the code nonetheless

svn-id: r52040
"
"4c3ea30e329be219fe916f633fb880f3cec83f92","2010-08-12 14:47:25+00:00","TESTBED: disable tests when required data is not found

svn-id: r52041
"
"f9005dd4b3c362ec4dedeace7d288a3da16d04e6","2010-08-12 15:19:04+00:00","TESTBED: display appropriate message at begining if game-data files are not found

svn-id: r52042
"
"4be0eb985e8a8b0505077308b084937b930ef156","2010-08-12 15:45:53+00:00","SCI: queuing signal, if signal not passed to scripts

fixes laura bow 1 when knocking at the door in the attic, scripts wait for 0xb in that case, sound resource sets 0xb and then immediately ends. This resulted in the scripts only getting the termination signal, so they waited endlessly. (bug #3042981)

svn-id: r52043
"
"49c7ebf72ff9e01af78c760bffd2d26bc8ff0b6c","2010-08-12 21:20:01+00:00","SCI: adding pq2 workaround

we had this workaround before, this is for a different pq2 version - bug #3043904

svn-id: r52044
"
"f1ad1f1738976fc33c0797f60eb89475bd70b39e","2010-08-12 21:33:23+00:00","SCI: 'version' now shows cantBeHere selector

svn-id: r52045
"
"4309d8c00c05def81b921f76ece023cf6d3ab7bc","2010-08-12 22:25:15+00:00","SCI: adding patch for sq4/floppy

fixing endless flight, is actually a script data bug - there is an additional property, which is not included in property count. It's used. We return 0 in that case, because we don't know about that property, resulting in nest::x never get changed and the scripts check that for advancing

svn-id: r52046
"
"df04f81466881a774db8045edf25f261e5c89d07","2010-08-12 22:27:28+00:00","SCI: adding bug id to sq4 patch

svn-id: r52047
"
"797012eb5ca6056d771ed81fd8704975aa55313e","2010-08-12 23:09:38+00:00","i18n: Fix link error when localization is disabled

This fix a regression introduced in revision 50448 ('Add support for
locale-dependant font'). When disabling localization a function was
declared, called but not implemented.

svn-id: r52048
"
"05e139dd0248abecfd507dc23d5c2fc2341542aa","2010-08-13 09:56:07+00:00","i18n: Update Russian translation

svn-id: r52062
"
"b62d3bdd0a894a161a5235f6ef93bb84e3b40736","2010-08-13 12:14:53+00:00","SCI: adding workaround for sci1.1 mother goose

bug #3043955

svn-id: r52063
"
"aab9fcae451cd9d766c27ad83cc2e903912925c8","2010-08-13 12:32:14+00:00","SCI: adding workaround for sq4/floppy room 397

bug #3044044, didn't occur for me, needs testing

svn-id: r52064
"
"ae32b8b3e5fae39e216c73ef26a5f0cd1e6c5cd1","2010-08-13 12:44:20+00:00","SCI: adding pharkas workaround room 540

bug #3044218

svn-id: r52065
"
"c6337c4e6e3658ad09d6ea56310668b7afb89960","2010-08-13 12:46:40+00:00","SCI: adding bugid to pharkas workaround

svn-id: r52066
"
"56c4fc7a70a28ff7d0b1e1deca8d53db639ef24e","2010-08-13 13:33:29+00:00","SCI: commenting out sq5 beta detection entry

svn-id: r52067
"
"6181241f576aa6aaa2b9e426a64d26297c5847e5","2010-08-13 18:25:16+00:00","SCI: extending life of port for sq4 gum wrapper

fixes bug #3044507

svn-id: r52068
"
"da543ce36c8d84b6c89ec6ef6ba980fb44eca33c","2010-08-13 20:08:57+00:00","SCI: adding workaround for sq4/floppy

bug #3044046

svn-id: r52070
"
"c09a968fc021a8ba58c6746680ab5bc5183e1d17","2010-08-13 21:09:10+00:00","SCI: adding switch to sci1mid for lsl1/spanish

makes it work, bug #3043270, added FIXME

svn-id: r52071
"
"185da189265a7388792fdc042214b6be93a083f9","2010-08-14 00:25:10+00:00","SCI: Add the detection entry for GK1 mac

svn-id: r52072
"
"c58e2707ffa147f099e3eaf32c941da9cdc47dda","2010-08-14 00:56:12+00:00","WII: Update port for the current versions of the base libraries. Enable DVD access for the GameCube port.

svn-id: r52074
"
"d882661aecbe8dc27979f15fadfc83882fe58a8d","2010-08-14 04:03:36+00:00","COMMON: Cleanup MacResManager::convertCrsrCursor a bit

It's now a static function since it doesn't require any local variables and is really separate from the resource fork code. Also, actually assigning the keycolor (which was just being ignored).

svn-id: r52075
"
"f252c0b67ef74da5376fcf3a08d514fb311c4316","2010-08-14 04:21:09+00:00","SCI: Add support for Mac 'crsr' cursors used in SCI2+ games

svn-id: r52076
"
"512bf22af689a9fec0f1dc3a637f6f2e084b06a7","2010-08-14 06:05:54+00:00","SCI: adding workaround for camelot during ending

fixes bug #3044734
also fixing heap corruption during the ending

svn-id: r52077
"
"169d1eb0cc52438b00ad204a407b6eeb93fb8614","2010-08-14 06:06:41+00:00","TESTBED: some more refinements with handling Quit events in GUI

svn-id: r52078
"
"f8697e20b50607e93df0cf3ddf725d6fee6360cf","2010-08-14 08:03:32+00:00","SCI: now reusing window ids on kNewWindow

sq4cd recreates the inventory window several times, but also reuses old window ids, causing kernelSetActive errors. fixes bug #3044757

svn-id: r52079
"
"0a7bda50cca6ac76245254c6eb0de84547a018c1","2010-08-14 08:32:39+00:00","TESTBED: formatting fix, deleted spaces/tabs at end of line

svn-id: r52081
"
"b7ab1d41bfaffa1e8e9342d83ee1ee7b6e59b4d9","2010-08-14 08:44:29+00:00","SCI: Silence shadowed variable warning of g++.

svn-id: r52082
"
"7f68e8429362c7e64f751d8118b3c164bcf98f1f","2010-08-14 09:06:06+00:00","TESTBED: modified the Keyboard test Look-up table to include all alphanumeric characters

svn-id: r52084
"
"cb8a7a343058f15b46efddbb3a8c9a03ce26d0a9","2010-08-14 10:36:13+00:00","NEWS: Mention new Wii and GameCube port features.

svn-id: r52087
"
"5731bce2e323fc594165592222bb98ce1793b357","2010-08-14 10:45:36+00:00","NEWS: Fix typo.

svn-id: r52088
"
"af3dd709382b1462780e196dc3b866ff36975651","2010-08-14 11:01:00+00:00","WII: Fix compilation of the GameCube port.

svn-id: r52089
"
"6ff151b9ef704ae76fa9a4284f6ad7a9c75e1d14","2010-08-15 11:37:57+00:00","SCUMM: Fix bug #3024173 - LOOM-PCE: Music stops prematurely

Apparently, the original interpreter hard-coded the lengths of the
audio tracks on the CD, and in this particular case it makes a
difference that one of the tracks is slightly longer on the disc
than the scripts assume it is. Thanks to hennymcc for doing all the
hard work in figuring this out.

svn-id: r52098
"
"023ca7962a3a1916c13f834aa63062379a805808","2010-08-15 15:31:24+00:00","PSP: slight fix to ME MP3 player

A bad function call during initialization of a stream was causing rare instances where the ME failed to decode some MP3 data.

svn-id: r52101
"
"f078363c7eb2973c44e56d2b5c51e7c6b8afe8e4","2010-08-15 16:24:43+00:00","SCI: adding workaround for island dr. brain

fixes bug #3045225

svn-id: r52102
"
"3fd7468cbcc3612cadf07741626be5ca67f1c6f4","2010-08-15 18:46:00+00:00","Fascination - Add handling for window funcLeave on close. This fixes (at least) the picture problem in the lab, and the game is now completable (VGA floppy). Thanks SylvainTV for the debugging help

svn-id: r52103
"
"4b1d78694e5d0a1d58be9258db2b812b8d0a684f","2010-08-15 18:46:28+00:00","Suppress some debugging warnings

svn-id: r52104
"
"b49761b6eae3a0aadefef4c4ffee6a7b583cc3ac","2010-08-15 19:01:18+00:00","SCI: Change abs() to ABS()

I'm not sure why we define our own ABS(), but I assume we have some
compelling reason for it.

svn-id: r52105
"
"58987824c2846f127ced4902ab37098e34662b20","2010-08-15 23:37:56+00:00","Gob - Follow cppcheck advices

svn-id: r52106
"
"8b649178ce7aaabaf9f37a9d6274ef747b509e1f","2010-08-15 23:40:24+00:00","Fascination - Add workaround for script bug: wrong track name is called in storage room

svn-id: r52107
"
"e26da1a6349ae6f46ec98d1557983594e9389612","2010-08-16 00:29:05+00:00","Fascination - (SylvainTV) Always free anims when initializing the scenary. (Hopefully) Fixes every window display issues in lab, villa, picture labo, and lounge.

svn-id: r52109
"
"5e26238916ae9c22286bd8beaa2d1a139697878d","2010-08-16 04:27:05+00:00","TESTBED: disable aspect ratio correction while running scaling tests

svn-id: r52111
"
"bfabe2af97a72ac701644538baa661867dafeeec","2010-08-16 13:00:41+00:00","OSYSTEM: Fix file archive for non-flat directories

svn-id: r52120
"
"535d8e12bddb31127dd784ff4df4eaa2d0a7992b","2010-08-16 13:19:21+00:00","OSYSTEM: Add directories to archive list just as in other variants

svn-id: r52121
"
"c284e78cc0bbb0e861162c4c4cc8c765ec60d5f1","2010-08-16 15:22:43+00:00","SCI: adding patch for eq2 / ecorder

initial title now gets removed

svn-id: r52122
"
"7b51537be2341b62795c308c140faca387fa04e6","2010-08-16 16:01:31+00:00","Common: Fix bug in lastPathComponent.

Prior to this change lastPathComponent would not create a correct result,
when the input of lastPathComponent did not contain a single separator.

I also added a test case for this in our unit tests.

svn-id: r52123
"
"d8726d8058de846604810f5ab1c1193ea34ff388","2010-08-16 16:50:45+00:00","SCI: sci1.1 pictures w/o cel don't set palette

even if one is present in the picture, fixes some transitions looking weird in eq2 - bug #3037126

svn-id: r52125
"
"4c3618e6457341d3e65ac7501ef1fbdc479c13be","2010-08-16 17:02:35+00:00","SCI: Fix uninit'd temp in longbow. See bug #3046200

svn-id: r52126
"
"eff2623f1042ea88df8c748ccae7fffca591bb87","2010-08-16 18:07:21+00:00","OSYSTEM: revert r52120 and r52121. Introduced regressions

svn-id: r52127
"
"5602b2cf8127bb5dd9df23dd833e18070d60c568","2010-08-16 19:57:35+00:00","SCUMM: Move setResult/getResultPos to script_v5.cpp

svn-id: r52129
"
"8a5705132d236f9bce49a420ddfff94157eabcb5","2010-08-16 19:58:01+00:00","SCUMM: More finely differentiate opcode tables between v3, v4 and v5

This has been tested and verified as much as I can, but has a small
risk of leading to (easily fixable) regressions.

svn-id: r52130
"
"861e5205792673f74b382589a4bd1088abf30608","2010-08-16 19:58:20+00:00","COMMON: Try to clarify and update some Common::Archive docs

svn-id: r52131
"
"97943cef457f57a12ed34aef5eb755f772e72b17","2010-08-16 21:16:13+00:00","Fascination - (SylvainTV) Replace DRAW_DRAWLETTER by DRAW_BLITSURF. It makes a difference for Fascination, not for the other games using mult_v2. This fixes the refresh of all the little animations in Fascination.

svn-id: r52132
"
"0bfb74fd5723c8bd6aba30a67fdcd73fd5fc5d9b","2010-08-16 21:18:38+00:00","Fascination - Suppress a debug warning, and replace several warnings by errors.

svn-id: r52133
"
"81a646c9bd32662f2a72fc0b3db32105857b9416","2010-08-16 22:04:15+00:00","TESTBED: added a README file, some description fixes

svn-id: r52134
"
"8ed0a70b0622bcb1daf86975f18a9b932eccd8de","2010-08-17 07:41:15+00:00","Fascination - Fix the texts not cleaned up (eg Hotel Hall). Thanks SylvainTV for identifying the problem

svn-id: r52135
"
"e075f0539568c5d14a61889a0233558376cdb5ce","2010-08-17 08:33:50+00:00","Gob - Clean up: suppress blanks and tabs present at the end of line

svn-id: r52136
"
"06960d33e15bc80f9912fa92f11dd82388199bd6","2010-08-17 09:28:20+00:00","HUGO: Adding engine to the main tree

svn-id: r52137
"
"aa16c9e04699e9f441db071d7e27ebfcad17074c","2010-08-17 09:45:14+00:00","PSP: changed display options to Full Screen, Keep Aspect Ratio and Original Resolution

This greatly simplifies the display options and makes them more practical. Original resolution will try to fit the game to the screen pixel-to-pixel, and will revert to full screen if it fails. Keep AR maximizes height and adjusts the width accordingly. This works very well with 320x200 games (AR of 1.6) which is close to the PSP's 1.7, but not so well with 320x240/640x480 (AR of 1.3). Full Screen is still default.

svn-id: r52138
"
"7d7acd704210c2f0a0c4c3edb10625178053b1da","2010-08-17 09:47:46+00:00","HUGO: Fix warnings

svn-id: r52139
"
"c6a1a746df2fab01ab00d70d0e4588f72b0a1eba","2010-08-17 09:52:34+00:00","Hugo: Fix very minor typo.

svn-id: r52140
"
"ef21077b81ce3298b42dfed861a0d98e4209348e","2010-08-17 10:09:50+00:00","create_hugo - Add MSVC9 files

svn-id: r52141
"
"b6d1c45bb7ece9eab12f3bc958923112662232fb","2010-08-17 10:19:06+00:00","GOB: Fix warnings about potentially uninitialized vars.

svn-id: r52142
"
"db8b322219b39b7f5ef3049d39b3fd92939643a2","2010-08-17 10:26:12+00:00","SCI: commenting out hoyle 4 script patch

svn-id: r52143
"
"2a3f98556660f0471609a3897a570ea10b339857","2010-08-17 10:59:11+00:00","DRACI: Fix warnings

svn-id: r52144
"
"789219022ac353ec72086d96c45a958c856abef2","2010-08-17 11:00:00+00:00","HUGO: Fix game restoring

svn-id: r52145
"
"2c545ae1f38e479f2df1d270170bc9708b93a824","2010-08-17 11:00:29+00:00","HUGO: Fix warnings

svn-id: r52146
"
"4d64004aa7897ca99299a6154c99e3ada350b9d3","2010-08-17 11:00:53+00:00","KYRA: Fix array index out of bounds

svn-id: r52147
"
"ee23fe34b07effcf394ca43044270af0e2ebd4af","2010-08-17 11:01:20+00:00","M4: fix warnings

svn-id: r52148
"
"4a0cdf00e1d90ee6a7baf74190f9e85f0a4eec27","2010-08-17 11:01:41+00:00","TINSEL: fix warning

svn-id: r52149
"
"a9d947135761190b7fc26941223151d6839eeafc","2010-08-17 11:02:02+00:00","SAGA: fix warning

svn-id: r52150
"
"554add088694acbe3c2713e170f0cd42c1999e2c","2010-08-17 11:02:27+00:00","SCUMM: Fix warning. On WinCE HIBYTE and LOBYTE are already defined.

svn-id: r52151
"
"981abdd08bf47fff9a237056cdf82aa11cca60b1","2010-08-17 11:19:34+00:00","CONFIGURE: Remove trailing space (and kick buildbot)

svn-id: r52152
"
"56ec4fc353fc0fddaa3d046cbeeb9393c16c453a","2010-08-17 11:40:48+00:00","CONFIGURE: Add plugin support for the GP2X backend.

I'll switch the GP2X to use plugins by default for new releases after some additional testing.

svn-id: r52153
"
"1ac434165d047c0b61cd77c4ba4e206172ca511d","2010-08-17 11:42:47+00:00","HUGO: Fix even more warnings

svn-id: r52154
"
"7dfd8f9ce25ec16255f298127319a3888daa6d60","2010-08-17 12:47:18+00:00","COMMON: Remove redundant include from str.cpp

If it is needed for your specific platform, then readd it,
but for that platform. Although to me it looks all redundant.

svn-id: r52155
"
"c6d56f2c02ae8a2b24c52c4284eba69dea242934","2010-08-17 13:00:48+00:00","CONFIGURE: Add -Wglobal-constructors to Darwin builds.

svn-id: r52156
"
"bec56837ebc5919d7d421e99252f38c2a19c1d6e","2010-08-17 13:51:36+00:00","CONFIGURE: Properly detect -Wglobal-constructors

svn-id: r52157
"
"9698f34d9231b306ee4eed912e5fdb580502eac3","2010-08-17 14:21:04+00:00","Hugo - Fix the sprite modification of the hero (quickest test : H1, entering the machine)

svn-id: r52158
"
"0290faeaa30df4062c39d4b92f7bbba1ebe9fdfb","2010-08-17 16:02:46+00:00","HUGO: Remove svn:executable property from hugo.dat

svn-id: r52159
"
"b37b0d9b0ccb534f619c2090255bd685b6d85699","2010-08-17 16:27:56+00:00","Fascination - Suppress some debug messages

svn-id: r52160
"
"b2cbc3a42905b16589e1e5e93a119b84bf0f2f22","2010-08-17 18:44:16+00:00","WII: Bump the sfx buffer size to fix MT32 emulator hiccups.

svn-id: r52161
"
"bdedf90c59ef28a999a3d13d8d2987f896cf31a6","2010-08-17 19:04:04+00:00","Suppress one more useless debug message

svn-id: r52162
"
"478f6bfc6f4649b24fe5547b85d052b6afcff451","2010-08-17 19:15:55+00:00","SCI: Fix for bug #3046800 - 'SCI Fallback detector crashes with several games'

svn-id: r52163
"
"22210187a99d375a4dfddc2dc9ab084b8819d392","2010-08-17 19:22:34+00:00","SCI: Added the EGA version of LSL5

svn-id: r52164
"
"9b80709ed6a2c27cb2dff2e5d3841b06f8a6486e","2010-08-17 19:27:51+00:00","SCI: Added the EGA version of Space Quest I

svn-id: r52165
"
"918847360ef1c752e9ff82fc1a444e43bfa0a604","2010-08-17 19:33:13+00:00","SCI: Added the EGA version of PQ3

svn-id: r52166
"
"02f08d41a16af9133446c9b638b63677a9c1c97d","2010-08-17 19:37:43+00:00","SCI: Added another EGA version of Longbow

svn-id: r52167
"
"aeb62b5db590ed3266b5264de8545eba1c3e7ad2","2010-08-17 19:41:27+00:00","SCI: Added another EGA version of KQ5

svn-id: r52168
"
"bf694bf271b87ccfe3a7c5258808b4a50b34ca5c","2010-08-17 19:45:51+00:00","SCI: Added the EGA version of SQ4

svn-id: r52169
"
"0106a3785727ca7fe1116a8492847c86a55af7b0","2010-08-17 19:50:23+00:00","SCI: Added another French version of LSL3

svn-id: r52170
"
"397df8f35090fd0b4815cec8809739de559882c4","2010-08-17 20:33:22+00:00","SCI: added a wrapper for GUI::MessageDialog

svn-id: r52171
"
"9df74402e5474652b7a041bc4f9d9ec4ac6a0db6","2010-08-17 20:36:28+00:00","SCI: Added a warning dialog on game startup for versions of Longbow with known buggy scripts (containing game stopping bugs), which have been patched by Sierra

svn-id: r52172
"
"b480f0f2f093e5606501cca455a77735693ce07e","2010-08-17 20:58:01+00:00","COMMON: fix MSVC assert when using umlauts (or other characters > 127) in the global save/load menu

svn-id: r52173
"
"3c010fc2f9542c892c78f3f0df3b32e2b88d6a5d","2010-08-17 22:51:24+00:00","SCI: Fixed bug #3034501 - 'LSL6: Segfault while leaving the penthouse'

svn-id: r52174
"
"d8b0b445f3cd0189de5a3cfa92ec68283e9f49d7","2010-08-17 23:11:30+00:00","Limited the sanity check in rev #52174 to invalid segment types only (apparently, polygon data may be placed in non-dynmem segments too)

svn-id: r52175
"
"e32010392665f3e12ad2defa7d3db09d9eb614e7","2010-08-17 23:55:07+00:00","SCI: Refactored readPoint() to accept a segment reference to the polygon data, thus removing the check for invalid segment types. Also, added a sanity check to verify that the memory reference to polygon data is big enough to hold all the expected polygon vertices (thanks to waltervn)

svn-id: r52176
"
"54c1a1463f2eadb8bf48c234f2474d395b7d62a6","2010-08-17 23:55:31+00:00","HUGO: Fix file permissions

755->644

svn-id: r52177
"
"f23cc57ad5eb461ea7a85cc40ba2de37a721a6c9","2010-08-18 00:03:58+00:00","Fascination : Avoid to set _showCursor in initCursorAnim as it enables the cursor all the time, which is wrong. This fixes the bad icon while loading issue, and the weird icon in the lab. Thanks SylvainTV for solving it.

svn-id: r52178
"
"190043e6b7249a2669e07264cced434e5b5acd61","2010-08-18 00:04:21+00:00","SCI: Resolved a FIXME concerning scripts with more than one export table (it only makes sense for SCI0-SCI1 games)

svn-id: r52179
"
"d0d677ab756bece6e2c7ff06690c2c41ae7f019c","2010-08-18 05:27:13+00:00","SCI: Fixed bug #3042964 - 'KQ4: Signature Mismatch'

svn-id: r52180
"
"1ca946caf0a29ae8c3279f8c9519bbcfa62ee310","2010-08-18 06:59:31+00:00","SCI: Cleanup

svn-id: r52181
"
"98a8c01dbb4498edfb4f310b15334d6139f614c3","2010-08-18 07:14:17+00:00","SCI: Fixed bug #3038433 - 'HOYLE1: Crashes'

svn-id: r52182
"
"135b9ee63cacfd6cfefa976609914cb30c144f63","2010-08-18 07:58:38+00:00","SCI: Changed a warning into a debugC

svn-id: r52183
"
"ff8cfd3d9bc12fe0ca3ceeab5ea3615801e41957","2010-08-18 11:03:12+00:00","SCI MIDI: adding some asserts as well as proper initialization for _velocityMap

svn-id: r52184
"
"330d467b512e3e4064d7552a43766085afd4602b","2010-08-18 13:44:22+00:00","HUGO: Move engine object creation to more suitable place.

svn-id: r52185
"
"3b81b301716bd2426eb455db254f085c94cc66ce","2010-08-18 14:12:09+00:00","HUGO: Fix intro crash in H3

svn-id: r52186
"
"ab5bb86e207c3af61d713d72121232a7ac1dd3bc","2010-08-18 15:33:59+00:00","No longer error when BSF file is not found in H1 Dos, as it may be a freeware version.

svn-id: r52187
"
"fc94562c771a528ba6be57504c9bc097cac9d426","2010-08-18 15:39:40+00:00","H3 win - Suppress an enum and use directly the screen number, with a comment

svn-id: r52188
"
"fa41f9ffd05a97c90a59fb629a7b6e61abf231fa","2010-08-18 16:14:38+00:00","Hugo - Check double F1, display properly the content of help.dat if present

svn-id: r52189
"
"844b4665738b7946b072c55ad257ed535f8399ca","2010-08-18 16:44:12+00:00","Hugo - Add F6 Inventory. This is a DOS only feature, but quite convenient as the iconic inventory is not available atm.

svn-id: r52190
"
"70cd6cfda52ed4feca562aa1b52d3a6c52a4ccba","2010-08-18 16:58:32+00:00","PSP: fixed issue in ME MP3 player that prevented different MP3 layers and versions from working.

MAD doesn't give enough information to decide the length of the PCM data -- it provides the Layer but not the MPEG version. I had to read the MP3 header directly to figure it out. This fixes issues with any MP3 files that might be used in any of the games.

svn-id: r52191
"
"7f97d568298b51370fef3d25b847268416849694","2010-08-18 17:51:44+00:00","HUGO: Fix GCC warnings.

svn-id: r52192
"
"c969090ef873ca8884908a1f30d2e37397905bd8","2010-08-18 20:00:18+00:00","SCI: Only perform queuing of song signals for SCI0, where we handle the updating of song queues ourselves. Newer games handle signaling on their own, thus we shouldn't interfere with this. Fixes bug #3045913 - 'PHARKAS CD: Crash at the start menu' (a regression from rev #52043)

svn-id: r52195
"
"3268238364d929863606821b2162604fa3cc2250","2010-08-18 20:28:48+00:00","SCI: Fixed script bug #3048054 - 'LONGBOW: crash when opening hand code' (German version)

svn-id: r52196
"
"c04d3e46899194af3558f611af634dc7124ab7c2","2010-08-18 20:41:03+00:00","SCI: Fixed bug #3041232 - 'LB2Floppy: Crash at Museum'

svn-id: r52197
"
"29a5c6a45b90e64cf5d618da4cdcd6e6da3425fb","2010-08-18 21:38:43+00:00","SCUMM/FM-TOWNS: start rewriting audio code

- Start rewriting audio code for FM-TOWNS versions of Loom, Indy3 and Monkey Island 1 using the recently added code in towns_audio.cpp (Zak should work the same way, but I can't test, since I don't own that one).
- All sound types (pcm, euphony and cd audio) now support volume and balance control (e.g. try walking into/out of the kitchen and opening/closing the door in the Scumm Bar in Monkey Island 1 or walking into/out of the circus tent).
- Pcm sounds now support proper loop start/end and note offsets (e.g. try out the hammer sound in the forge in LOOM for example).
- some other minor improvements
- The FM-Towns versions of Indy 4 and Monkey Island 2 are not affected. I don't have Monkey Island 2, but I presume that it will work like Indy 4. Adding support for these will be a separate task, since they work quite differently.

svn-id: r52198
"
"2b778891ea08240daf029aea9547ee35e46d4b50","2010-08-18 21:58:58+00:00","SCI: Fixed bug #3039679 - 'SCI Fanmade - The Gem Scenario: Crash at the start'

svn-id: r52199
"
"2985d27e40666316485cd36d2788757227daa650","2010-08-19 02:38:42+00:00","KYRA: Cleanup.

svn-id: r52200
"
"d8d885727650b01deed9b5f1aa2d28850d984543","2010-08-19 02:39:07+00:00","KYRA: Remove superfluous music fade out on Kyra 3 startup.

svn-id: r52201
"
"2bd5077d2ee711dc4224fe97c69479c36b190c6f","2010-08-19 10:15:12+00:00","COMMON: Add caching to ZipArchive. Patch #3048388

Based on patch #3048388: 'Hash map for ZipArchive class', though
I made the hashing by default and removed the old code.

It is a really good thing and will speed up any archive operations.

svn-id: r52204
"
"aa3cefa2c6826ab250562e60423890b0ebe93318","2010-08-19 11:41:13+00:00","SCI: Fixed bug #3039768 - 'QFG3: Glitch When Making Thief Sign to Rope Maker', by fixing the implementation of kSetJump, based on Greg's SCI code. kSetJump returned an incorrect result, causing the actor to jump outside the screen

svn-id: r52207
"
"040dfff8ce1eec4754c606b393fc4542db78c6d5","2010-08-19 11:46:55+00:00","i18n: Move translations to standalone file. Patch #3044975

svn-id: r52208
"
"6682659da059267a806db744ea35638348c872c3","2010-08-19 11:48:27+00:00","i18n: add translations.dat file

svn-id: r52209
"
"26dc4c24256472898f4388de73699a5f54f4a2cf","2010-08-19 12:43:37+00:00","DINGOO: new port. Patch #3039277

svn-id: r52210
"
"37d2f102061cbafdde3060bbe1d7165817ffb676","2010-08-19 13:52:21+00:00","SCI: Added checking for the existence of a GM track, to determine if device ID 7 or 12 should be used. Fixes the GM music in the demo of QFG3, which is using an in-between version of SCI1 and SCI1.1

svn-id: r52211
"
"c427ecb7ccdd88b02712eb2f357d44fb999236df","2010-08-19 15:13:03+00:00","DINGUX: disable check for vorbis, because of terrible performance compared to tremor

svn-id: r52212
"
"780dacf48d7c0a4912036762bfa5ffc93bbe2429","2010-08-19 15:58:39+00:00","SCI: Fixed one of the bugs in hoyle3, from bug report #3038837 - 'HOYLE3: EGA/VGA Crashes' (that report includes more issues)

svn-id: r52213
"
"6dcdc72fdafe1a6ac0cd63adb1570f0dca48f469","2010-08-19 16:21:31+00:00","SCI: Fixed bug #3038228 - 'MOTHERGOOSE: Crash at the castle'

svn-id: r52214
"
"ce9afcfab13bbbfe6ef5fe384a249a218067774a","2010-08-19 17:33:10+00:00","MOHAWK: Draw in the telescope combination in Catherine's journal

svn-id: r52215
"
"5bd2a99717c04ade090a4be77da74ff99a8b0ce3","2010-08-19 18:04:11+00:00","MOHAWK: Draw in the dome combination in the lab journal

svn-id: r52216
"
"67c1997bf4cb154d0fb59290d96fa4d5c439581c","2010-08-19 21:32:54+00:00","Fascination - Fix protection screen (and several other glitches like in the very last screen behavior)

svn-id: r52217
"
"af46e0fdc0ac4cc0523df9baa1b4961cbf480e4c","2010-08-19 22:21:03+00:00","SCI: disabling EGA mapping after sci1ega

fixes vga conversion games graphic glitches, some views have bad mapping tables

svn-id: r52218
"
"4625defaa46b438a0e70365773f9c54e887149b0","2010-08-20 05:06:07+00:00","CONFIGURE: force disable seq midi for dingux port

svn-id: r52219
"
"849ccc9eab10e74886f20ed8d407783676bc6230","2010-08-20 07:38:33+00:00","SCI: Changed a warning into a debugC

svn-id: r52220
"
"588472a8e69e2ecc98e3bf03c62bff029e715b81","2010-08-20 07:59:23+00:00","Fascination - Add a delay before entering the lab. This was a script issue only present in the Amiga and Atari ST versions

svn-id: r52221
"
"31c889d7ce26c0386b39ee8664d05e87c53b8381","2010-08-20 09:35:20+00:00","SCI: Fixed the GM detection introduced in rev #52211 to check the first available track, instead of track 1 (which doesn't always exist, e.g. in Pharkas). Also, added a comment inside applyPatch()

svn-id: r52222
"
"087a15ae0ea6b8869fe6613652781fa82c8140b3","2010-08-20 10:49:01+00:00","SCI: Fixed bug #3049146 - 'MOTHERGOOSE CD: Rooms 7, 23 crash', merged some similar workaround entries and added a comment for invalid rects received in kCan(t)BeHere

svn-id: r52223
"
"273a9eb036eb9d7144614731394b06468131c6ac","2010-08-20 12:24:48+00:00","SCI: Fixed bug #3041153 - 'SCI Fanmade Games: Message window glitch'

svn-id: r52224
"
"dd1708a1f12d1911a785cafdf7344d72065a1086","2010-08-20 15:17:19+00:00","Reverting r52224, as it was incorrect - fanmade games use the same interpreter as normal ones, so this doesn't make sense. Added a FIXME with a description about the graphics glitch in fanmade games

svn-id: r52225
"
"0b4fef3aa745a873deb99ca9ff95e33d12770f2c","2010-08-20 15:30:30+00:00","Hugo - Move DOS hardcoded inventory strings to Hugo.dat

svn-id: r52226
"
"30f1312386e8b6ae0156e48eaac2d54c53985b51","2010-08-20 15:55:56+00:00","Hugo - Add handling of 'turbo' key (F8)
- Modify the score line so it looks like the DOS one

svn-id: r52227
"
"48c9b4855bd9481f88912333aae0bf4aa3b0978c","2010-08-20 16:02:00+00:00","Hugo - Fix a problem in the F1 behavior

svn-id: r52228
"
"53bf93a8847c47f983a3ee25bffa8f6072ad82d4","2010-08-20 16:25:48+00:00","Hugo : Add toggle sound, plus little clean up

svn-id: r52229
"
"e81eab613374655022a592a055e7afe106765147","2010-08-20 16:35:20+00:00","Hugo : Style - Add parenthesis around condition when conditional operator is used, as mentioned in Code Formatting Conventions

svn-id: r52230
"
"9d5dada110c5563fd77ed19b061ee1a92cde952c","2010-08-20 16:40:13+00:00","Oups - Fix compilation

svn-id: r52231
"
"b55a70acb88a7375ac21351450ea99ed2f72d820","2010-08-20 17:04:32+00:00","KYRA/TOWNS: fix memory leak and some cleanup

svn-id: r52232
"
"5dae3780a4640231a77ecbf524f57a3888e5d752","2010-08-20 17:14:46+00:00","i18n: Do not use fuzzy matching when updating po files.

When updating the template pot file from source code and then
merging it with existing translations po file, it was trying to translate
automatically new string using a fuzzy matching. I have never seen
it work, so I am disabling the option. I prefer to have an untranslated
string rather than a wrongly translated string. And after discussing
with another translator it seems I am not the only one.

svn-id: r52233
"
"f7314a1e5638139779dad4f8516d223a4d654ae0","2010-08-20 17:37:06+00:00","SCUMM/TOWNS: fix minor bugs

svn-id: r52234
"
"3d913042c0a3dda52028b7b56b0a3fddbc0db5fc","2010-08-20 18:18:52+00:00","SCI: Fixed bug #3049435 - 'QFG3: Crash at Simbani warrior challenge'

svn-id: r52235
"
"45f1a5d4506f4d0d4c2564614e0e6e209fba08ae","2010-08-20 18:43:00+00:00","Fixed bug #3049361 - 'Hoyle4: Game is falsely detected as DEMO'

svn-id: r52236
"
"8d037cd5afa9545d80ca5c04c96df0d19ae3906c","2010-08-20 18:52:21+00:00","SCI: Fixed bug #3039308 - 'HOYLE4: Rules Dialog missing background'

svn-id: r52237
"
"b6c929a02a7a35e0b7024b6badb1b1588c45d706","2010-08-20 20:31:05+00:00","Fascination - (SylvainTV) Implement window traces

svn-id: r52238
"
"d00b8a5753a15314630efaeea804e701fc837cd0","2010-08-20 20:42:13+00:00","i18n: Sort the list of available languages alphabetically

svn-id: r52239
"
"29adf97a141324f9a98cc0e8d128a2a711ea46e3","2010-08-20 21:02:24+00:00","SCI: Reverted kRandom to use unsigned integers again (used e.g. in LSL5) and added a temporary hack for the special case in Hoyle 4 (0x0, 0xFFFF), till we find out how this is handled correctly

svn-id: r52240
"
"9015a145319b5ce9357a5a47e89854f7d0b82ba4","2010-08-20 21:04:39+00:00","i18n: Fix previous commit when translation support is disabled

Previous commit of translation.cpp introduced a defined but not
implemented operator when the translation support was disabled.
This was probably fine since it was not used, but not very clean.

svn-id: r52241
"
"f8957603e624ed98a712b61634c80428eaad9e3a","2010-08-20 21:05:56+00:00","SCI: Fixed typos in kRandom()

svn-id: r52242
"
"769ad3109dfd54a61ffc9ebc02333986d9a3d8a4","2010-08-20 21:50:58+00:00","GUI: fix crash when localized font could not be found

The ThemeEngine had a fallback implemented to use the
non-localized font if the localized one (e.g. for Hungarian) could not
be found. However the fallback was not working. Now it is working.

svn-id: r52243
"
"1b9d95e43c1dce369d8a929ede4b144290729e96","2010-08-20 21:59:14+00:00","SCI: kRandom now exactly behaving like sierra sci

hoyle4 and lsl5 door code work now

svn-id: r52244
"
"74b6fdcae4b82fe77906e1811c03c2ec43c4cc98","2010-08-20 22:10:15+00:00","FM-TOWNS AUDIO: fix possible crash

(This crash might have occured on very slow machines or when using valgrind)

svn-id: r52245
"
"3e427b725b3974a6b13f0790457198a8fbb21cf2","2010-08-20 22:14:48+00:00","SCI: added another comment to kRandom

about hoyle4

svn-id: r52246
"
"10066443b06cb0f47f0f3b4bb107ee94439e030a","2010-08-20 22:23:12+00:00","GOB: Add an initGame() for Fascination.
Added in order to suppress the speaker and the adlib flag. When the speaker flag is set, some sounds are skipped. The adlib flag will be required the day the MDY/TBR player will work: SB music for the moment

svn-id: r52247
"
"5c30303794da71a4f48704d2b4e7e04e7ddce178","2010-08-21 08:17:06+00:00","COMMON: Added equality operators to Common::Rect

svn-id: r52249
"
"7890bf484fb9a0a805fff43b3ec2631a013e28cd","2010-08-21 08:25:36+00:00","SCI: Added a detection entry for LSL5 (bug report #3049771)

svn-id: r52250
"
"107c39910da802c10498501139b545e71cd94daf","2010-08-21 09:19:34+00:00","SCI: Fixed bug #3050122 - 'QFG3: Crash after throwing the spear of death'

svn-id: r52251
"
"dcd6c9eaf0129fe804f50534aed7dc6eafdaf2bd","2010-08-21 10:46:35+00:00","SCI: Fixed bug #3048911 - 'Keyboard discrepancies in all SCI games' by handling synthetic (keyboard repeat) events and adding support for Control-C

svn-id: r52252
"
"c4d58a8d886b79c74f555523e21b1b2aa8dd5081","2010-08-21 11:03:09+00:00","SCI added the 'init' selector to the list of static selectors of LB2 floppy (which has no selector vocabulary), so that the workarounds of the CD version match with the ones from the floppy version

svn-id: r52253
"
"2c8946f392f08b05c023b5ed3a92319ca2401dae","2010-08-21 11:11:54+00:00","SCI: add support for Control-C in earlier SCI games, too

svn-id: r52254
"
"f9d9fe8f1295f557fdf51f48b5e9f806c8190ca2","2010-08-21 11:34:19+00:00","SCI: Added support for the DEL key

svn-id: r52255
"
"d986a7883423ec6eb50021714e449421256a7ade","2010-08-21 13:03:35+00:00","SCI: Fixed potentially undefined behavior

svn-id: r52256
"
"a53d4dde6670947aa0943665e5786c482dd404b4","2010-08-21 13:21:09+00:00","i18n: Style fixes.

svn-id: r52257
"
"3faae2a83126a4bb731a49d731f1f6da407549ab","2010-08-21 13:24:09+00:00","Reverted part of r52256, it's not really undefined behavior (the two parts of the bitwise OR aren't reading from the same source)

svn-id: r52258
"
"864b067f6693867844feec6b56fa5fc8dd124a33","2010-08-21 13:36:09+00:00","SCI: fixing resourcemgr for pharkas/german

pharkas/german has duplicate resource entries inside the main resource files and we used the first ones. This results in half of the game being english and umlauts missing. We now use the last entries, which will fix all those issues (fixes bug #3039551)

svn-id: r52259
"
"7fd76893704259cf66a731486025e5632c37bb5e","2010-08-21 13:38:08+00:00","i18n: Formatting fixes.

svn-id: r52260
"
"ff06f0c9d5fc42c437f2a569cd6ad7acba1081ea","2010-08-21 14:05:38+00:00","i18n: Changed wording of messages about translations.dat file.

svn-id: r52261
"
"882ed43427f3700404578d29648dd2f2596e8c1f","2010-08-21 14:36:40+00:00","N64: Remove some unused variable and silence some signed/unsigned comparison warnings

svn-id: r52262
"
"ff24ae66fb5ab92d76c3c954653c56281a556cf7","2010-08-21 14:53:14+00:00","SCI: removing debug output from r52259

svn-id: r52263
"
"4742b4d728ba772d47cc497681c9bfb0144475bc","2010-08-21 14:54:57+00:00","SCI: now fading color 255 as well in sci1.1

looks better, although sierra didn't do that (examples: qfg3 demo/intro)

svn-id: r52264
"
"1a0d7c87d36a9bf1aa27186b1299b3a5348656b6","2010-08-21 17:27:48+00:00","Hugo: Some formatting fixes.

svn-id: r52265
"
"ee6f972247ccd47e6db9451fef2604ce219ade23","2010-08-21 17:49:59+00:00","SCI: improving delaying transitions

should hopefully make them run better on different platforms (some platforms dont update on every updateScreen call, so the transitions worked much faster there (e.g. wii) and some other platforms dont have that much power, so transitions were slower on those)

svn-id: r52266
"
"5cd3ea41db71b4521954cd65bc9775c1bbeabb9f","2010-08-21 18:16:04+00:00","GOB: Clean up of Fascination code
Move Fascination specific function to appropriate classes, plus some style modifications

svn-id: r52267
"
"c8a9eb9c3211fd9e2343d4759a25386658670d82","2010-08-21 20:14:46+00:00","GRAPHICS: Extend Surface::fill() method to support 32bits. Looks ugly

svn-id: r52268
"
"3677a8a382d0a0c551f8ef075164bc0b765d2bca","2010-08-22 03:50:42+00:00","SCI: Fix a bug in kFileIOWriteString. The first return statement should go inside the if-statement.

svn-id: r52269
"
"43349a4cbfda23eb1beba3c6df35090f6a6a63a0","2010-08-22 09:59:46+00:00","N64: fix some signed/unsigned int comparison warnings

svn-id: r52270
"
"a503f9223a4b87320f30f7264994a55a265a4f78","2010-08-22 10:48:13+00:00","PSP: switched from stdio to psp functions -- dramatic speed improvement

Turns out that stdio is about 30x(!) slower than using the PSP's functions. Very significant optimization.

svn-id: r52271
"
"5969138eda602048c8537b960b08d130a703d51c","2010-08-22 12:04:44+00:00","MP3: Fix seeking.

Formerly we did not read the first chunk of MP3 data after seeking. This
resulted in incorrect sound output in the Freddy Pharkas demo when the
sound was compressed with MP3 for example.

svn-id: r52272
"
"c31eba471d10cbe6d3f03de3a955f25d3e4a1527","2010-08-22 14:15:39+00:00","N64: small fix to the port readme

svn-id: r52275
"
"9349bec6db2618cdfdee0aeee1ea2a4f6066d05f","2010-08-22 14:23:37+00:00","N64: add some comments to code

svn-id: r52277
"
"b5cb6b7c98a89d0ae23067c01e6a5325a9349b2d","2010-08-22 16:07:04+00:00","DINGUX: whitspace commit to start buildbot

svn-id: r52280
"
"68f3cc944cbdcf6f5997700f996971087937a72e","2010-08-22 16:30:33+00:00","SCI: Reimplemented the kShow kernel command, used by the inbuilt SCI debugger. There is no real need to implement kernel debug commands, but since this one maps almost directly to our own 'show' debug command, it has been reimplemented (was removed in rev #45310). Normally, there is no real need to implement kernel functions for debug functionality, since there are advanced tools for this purpose nowadays (plus, ScummVM's debugger). Fixes bug #3050616 - 'QFG1 EGA: priority/control/view functions crash, debug mode'

svn-id: r52281
"
"c85939597786466fea057c65cfb4be8f0023f9b9","2010-08-22 17:17:53+00:00","NEWS: Mention dingux port

svn-id: r52282
"
"66f7e4306c8159a7125d349bdb4208234d08cceb","2010-08-22 17:55:29+00:00","SCI: Add uninit'd workaround for the SQ6 demo

svn-id: r52283
"
"c89462c2a63f1419f389190c058c0d18a2d09118","2010-08-22 18:49:19+00:00","i18n: Implement po file parsing in create_translations tool

Until now the parsing was done by the po2c perl script, which
generated a messages.h file. The create_translations executable
had then to be recompiled before being executed. This commit
removes the po2c perl script. The parsing is now directly done by
the create_translations tool.

The parsing has also been extended to support the msgctxt strings.
This is not dumped yet in translations.dat but will be once I have
finished implementing context support for the translations.

svn-id: r52284
"
"083faee7c1d4b3cfc82bd271a96827f9102c913a","2010-08-22 19:47:07+00:00","i18n: Formatting fixes.

svn-id: r52285
"
"4109b40d88991a77e78ae2e6181fdb551f18d19c","2010-08-22 19:54:12+00:00","GOB - Add detection for all the languages on Fascination CD
Add detection for Spanish, Italian, German and French

svn-id: r52286
"
"0348ca3e65292784126920eae38c9376aa113f8a","2010-08-22 20:37:48+00:00","SCUMM: fix CD audio regression in Monkey Island 1 DOS/CD

svn-id: r52287
"
"c8005dfb75d07ecc3db98562263c7b96feb19638","2010-08-22 23:11:29+00:00","GOB - Fix 2 bugs in Fascination Hebrew, now playable.
Again, thanks SylvainTV for the debugging efforts

svn-id: r52288
"
"11d5f5ac06679c4a6feb5faeb3a52179f974c520","2010-08-22 23:11:55+00:00","SCI: Fixed bug #3050856 - 'SQ3 : Crash at intro'

svn-id: r52289
"
"704ee45b989e56f4425f04240aa8b3a8a8b95d35","2010-08-22 23:21:48+00:00","GOB - Suppress debug comments

svn-id: r52290
"
"542711cea7211a283800cff8e2392ff7eb3e714b","2010-08-22 23:55:29+00:00","SCI: Fixed bug #3048908 - 'PQ3EGA: Wrong speech bubble background colors' and added a FIXME inside kGraphDrawLine

svn-id: r52291
"
"8d0b207dd5b450b70de7f98404a28266a3153fb4","2010-08-23 04:14:30+00:00","MOHAWK: Add initial work for the dome sliders

While the sliders cannot move yet, the game now knows if the puzzle is complete and whether you're over a slider or not. Drawing the sliders and moving the sliders will come next.

svn-id: r52292
"
"f960f5da2345986ee76a46d923cce22be1bb9ce3","2010-08-23 08:29:16+00:00","SCI: Fixed bug #3051163 - 'MOTHERGOOSE: Crash at the very end' and merged 2 SQ6 workarounds

svn-id: r52294
"
"7a125f85fef404b9e3af2db5ddd26eff96c25a00","2010-08-23 10:00:19+00:00","SCUMM: cleanup

svn-id: r52295
"
"db7e69b258f422228220cbb04110b63173ab52a3","2010-08-23 10:00:40+00:00","CONFIG: Always sort 'scummvm' and keymapper domains first

svn-id: r52296
"
"eeff13d7474e9fa288528a61a5068852ae337598","2010-08-23 10:18:06+00:00","SCI: Fix whitespace

svn-id: r52297
"
"23d4177d207c4797106a7a0ddb2a9dd5c8d5c539","2010-08-23 12:56:41+00:00","SCI: Check for EOF and errors when reading from a file. Fixes bug #3049360 - 'SCI: Bug in file read/write operations'

svn-id: r52298
"
"d6fc42ebc9835d5807b9c0f80abfebe8e23320a1","2010-08-23 13:57:00+00:00","SCI: slightly changing msecs for scrolling

svn-id: r52299
"
"c1e63b55e408ebbc3b4b969b9b7792065cb2a099","2010-08-23 14:41:25+00:00","MOHAWK: Print the rect of the hotspot in the 'hotspot' command too

svn-id: r52300
"
"7b8add291ebae5360bc8a68a3cc6bc1edae9a998","2010-08-23 16:33:19+00:00","SCI: multiple changes for mother goose vga

which is sci1 and sci1.1
fixes bug #3051145
- separating this mother goose from ega and sci2.1
- adding workaround when restoring saved games in these games, games try to calculate restored savedgameid instead of looking it up, we patch this code out and also set the global to the current savedgameid
- adding workaround for scripts checking savedgameid to be below 13 (our savedgameids begin at 100 now)
- changing official range for savedgameids from 1000->1999 to 100->199, otherwise mother goose would have required much larger patches and this range should be fine even if we replace savedgame dialogs later

svn-id: r52301
"
"9f5f27b42e8c4e23ec7d8341b5b03c4f53b88f3f","2010-08-23 17:01:33+00:00","MOHAWK: Fix xgwatch in the DVD version, which uses sounds in a different location

svn-id: r52302
"
"45a87ffe3fb76ae4e75d97271c0567809bd088d0","2010-08-23 19:10:06+00:00","SCI: some work on replacing sierra restore dialog

svn-id: r52305
"
"bc821136fdf2c82c1877c8ae0e607bcbe784dab1","2010-08-23 19:45:14+00:00","i18n: Add support for context in translations.

This change means there can now be different translations for the same
english string depending on the context. It is based on gettext msgctxt feature.
There is a new macro _c(msg, ctxt) that should be used instead of _(msg) in
the source code when we want to add a context to the message. For the
moment I have added contexts to only one message ('None') so that I could
test the changes. Context could be added also to get shorter translations when
GUI is in 1x mode.

I have also added back the fuzzy option to msmerge since it is useful when
adding contexts to populate the translations for the new contexts.

svn-id: r52308
"
"edea88cf54056d4c903977525d19071097efdd93","2010-08-23 19:49:51+00:00","dingux: Add standard ScummVM copyright headers to the dingux backend.

svn-id: r52309
"
"0c5561105cd0b3255a26549f2752db8f9ffdd277","2010-08-23 20:29:13+00:00","SCI: storing game super class address now inside SciEngine

svn-id: r52311
"
"8c08e6e80cdfc196d4c82087d639f8c621472534","2010-08-23 22:46:05+00:00","I18N: Do not translate 'English' in the language selection PopUpWidget.

svn-id: r52313
"
"e93eaa0d95381573bfa5986216a18a871ae02412","2010-08-23 23:04:07+00:00","SCI: some more work on replacing restore dialog

svn-id: r52314
"
"a484a99e9f27753ef1aaebb3b54159316410aed2","2010-08-24 06:25:08+00:00","GOB: Avoid a crash in the protection screen of Fascination (PC).
When failing the protection check, the script of the PC version was writing on purpose everywhere in the memory to hang the computer. This resulted in a crash in Scummvm, fixed by this workaround. (Tested on the 256 Col version french and german)

svn-id: r52316
"
"f1f24b7b28995ef78886c6a55a93ec2f13e62465","2010-08-24 08:31:57+00:00","SCI: bit more work on restore dialog replacing

(works now, if enabled - but music isn't yet paused)

svn-id: r52317
"
"d5d8434fd65dd201118ec54e1dd2ee2cbba653bd","2010-08-24 09:00:53+00:00","SCI: now pausing/unpausing music in replaced restore dialog

dialog will not get replaced in sci32, nor in mother goose. Enable by adding 'scireplacedialog' inside scummvm section of scummvm.ini file. Note: this feature is experimental

svn-id: r52318
"
"d828b36d766af974c0ba3655730e2703ad588f5b","2010-08-24 09:05:54+00:00","SCI: changing maximum slots from 0-999 to 0-99

svn-id: r52319
"
"b192de5423f0823b2431b102fe1d1b752f30b29e","2010-08-24 09:11:53+00:00","SCI: changing signature of kRestoreGame

and changing patch code accordingly

svn-id: r52320
"
"c2ad45a5cf24d5180e2f4f9f7692ed0ed4fe773b","2010-08-24 09:29:30+00:00","GP2XWIZ: Graphics code cleanup and start to add support for the GP2X Caanoo device.

svn-id: r52321
"
"95748c07cc2f6962ba3910e633f948bde6263549","2010-08-24 09:46:17+00:00","TINSEL: Partial fix for MIDI in German release.

Bug #2827022: 'DW: Enhanced music doesn't work'. This release
has completely different MIDI.DAT file. So far offsets and detection
for this version were added. The mapping has to be confirmed with
James Woodcock.

svn-id: r52323
"
"cb93679ea24c8304da7ebc8870ea2421a94f044e","2010-08-24 09:47:04+00:00","TINSEL: Fixed final track mapping to Ench soundtrack.

For some reason it referred to non-existent 3141. Changed it to
correct 3142.

svn-id: r52324
"
"efdbb076a2c33623a06f4cb02a333655c96de3f8","2010-08-24 11:18:48+00:00","COMMON: implemented BufferedWriteStream and fixed bug in BufferedReadStream

I need the write buffering for the new version of the PSP streams and thought the simplest way to implement it would be along the lines of BufferedReadStream. Sadly, I found a nasty little bug in BRS but that's taken care of.
Also, I adapted these streams for target-specific memory allocation by using virtual functions for allocation/deallocation.

svn-id: r52325
"
"347accf2d77729f95f4cefe73df10d198e915e85","2010-08-24 11:21:32+00:00","SCI: dont load target palette when gameIsRestarting != 0

fixes sepia palette getting applied when loading in pharkas (part of bug #3051905)

svn-id: r52326
"
"b88f341b8000bd5a8844f7fc4b69692459302f19","2010-08-24 11:24:34+00:00","PSP: switched to using BufferedSeekableReadStream and BufferedWriteStream

The last PSP optimization made reading much faster, but writing isn't buffered so saving the config file was VERY slow.
I decided the cleanest way to do this would be to add BWS and use BSRS.

svn-id: r52327
"
"9e04bc7643bc2cbcf7e2decedd60ca89a732b053","2010-08-24 12:12:23+00:00","NEWS: updated with latest PSP changes.

svn-id: r52329
"
"066174ad75c513bef640a28b56eedc1c1c0d8473","2010-08-24 12:24:23+00:00","SCUMM: Change palette for C64 games.

Based on bugreport #2847001: 'SCUMM v0: Wrong palette colors'. Old
palette is #ifdef'ed for reference.

svn-id: r52330
"
"808e36541e306c3bb77bb8748b4dc6f40ad3c796","2010-08-24 12:27:22+00:00","TINSEL: Removed the hardcoded MIDI offset arrays.
MIDI offsets for the enhanced music soundtrack
are now calculated on the fly

svn-id: r52331
"
"663a606602c697cd1c8b1f510e062e62d39ed55f","2010-08-24 12:41:56+00:00","AGI: Fix bug #3017908: 'AGI: No music with the new MIDI patch'

Fixed by performing proper MIDI initialization.

svn-id: r52332
"
"3082354fa42c52317edd0e21703275e4e5b1493c","2010-08-24 12:45:19+00:00","TINSEL: Adjusted the commented out music debug code for the latest changes to
the lookup tables

svn-id: r52333
"
"a85cb60e001cd20553536d0c8852b8d0286a088a","2010-08-24 12:50:12+00:00","GOB: Two fixes for the Fascination delay issue.

Add two more workarounds for the delay issue between the storage
room and the lab. This fixes the PC Floppy Hebrew and german
versions.

svn-id: r52334
"
"a551faa8a41541fd5529a64d8a6d21844d920569","2010-08-24 13:10:48+00:00","COMMON: Constify directoryGlobs variable in ADParams.

svn-id: r52335
"
"c913ffe83f1b5c7653a060ad489e80c86c3e715a","2010-08-24 13:11:12+00:00","KYRA: Add support for playing KYRA3 from CD.

svn-id: r52336
"
"2d615944fb82cdc40b385c22993a00d09902268a","2010-08-24 13:11:29+00:00","NEWS: Mention that Kyra3 now supports the original file layout.

svn-id: r52337
"
"83c8ed97e3e5204e408e4ec8b73068142891ea25","2010-08-24 13:31:44+00:00","TINSEL: Code cleanup, fixed potentially undefined behavior

svn-id: r52338
"
"10a1806f32a3fc67f8deb6adb496919793977440","2010-08-24 13:37:24+00:00","SCI: fixing const cast warning

making clone happy :D

svn-id: r52339
"
"feff6fecdffa16a541f9658ad611745188596692","2010-08-24 13:41:24+00:00","KYRA: Cleanup.

svn-id: r52340
"
"af6492fa4577df301abaf76c040cd70d26073009","2010-08-24 13:50:55+00:00","SCI: some work on replacing save dialog

svn-id: r52341
"
"5fbe5f049bfe26a2a788dc8736b3186b53d52248","2010-08-24 14:40:18+00:00","SCI: more work on replacing save dialog

also removing some previous code, because it wont work that way

svn-id: r52342
"
"ff9b897d8c6cd2bfcd0ca260977004470d92e026","2010-08-24 14:54:16+00:00","SCI: Define xLast/yLast for LB2 floppy (which has no selector
vocabulary), since they're used inside kDoBresen()

svn-id: r52343
"
"cd61674010a1e539d0ff5eac69a0bd44c43dff09","2010-08-24 14:58:29+00:00","SCI: Check for the existence of script 180 before accessing it.
Fixes the Longbow demo

svn-id: r52344
"
"01a8fc604b00279be181c0ce8decfc8e44242270","2010-08-24 15:11:53+00:00","SCI: replacing save dialog as well

experimental feature - enable by putting 'scireplacedialog=true' inside scummvm section of scummvm.ini

LSL6 currently loses the ability to quicksave, when using the feature. Although i don't see it as a huge loss. That way it's now possible to save to up to 100 slots instead of just 20.

svn-id: r52345
"
"501d7cbb84d33fbbbe40431ca66285dfefe5d5b1","2010-08-24 15:47:53+00:00","KYRA: Simplify PAK/INS/TLK loading.

This also reduces the number of seeks done while loading TLK files.

svn-id: r52346
"
"51939fe743fa0682a2a037352565dfb8d2aea4dd","2010-08-24 15:48:17+00:00","KYRA: Implement new handling of KYRA3's TLK files.

This speeds up loading of KYRA3's TLK files by a lot, since only the index
table will be load now. This should help the startup time for KYRA3 when
playing from CD or other slow storages.

svn-id: r52347
"
"c23f597f50fdb0c4ee81a4f9de6e915b362afdc2","2010-08-24 15:48:43+00:00","KYRA: Cleanup.

svn-id: r52348
"
"d1e45fd5d9f3404d5b9cc703fdb715f3edc46c54","2010-08-24 17:12:31+00:00","SCI: Removed a now unused selector from the selector cache

svn-id: r52349
"
"d48e173da1e8c278123353694ef23de024e3c850","2010-08-24 17:17:13+00:00","SCI: added another version of Hoyle 1 (bug report #3052366)

svn-id: r52350
"
"3e6fb233ac33d74e7045fc8e172e4ac86f5f682c","2010-08-24 17:22:05+00:00","SCI: fix race condition in sierra kPalVary code

we are loading pictures very fast, this results in a kPalVary race condition, because sierra set timer to 1 tick, when it was getting called with 0 ticks and required the timer to occur before the transition. Fixes freddy pharkas nighttime being daytime during transitions (bug #3051905)

svn-id: r52351
"
"27fbfcc34eb3daf557092c5d926567071a3917a6","2010-08-24 17:28:52+00:00","SCI: Fixed bug #3052359 - 'Hoyle1: Hearts Crash'

svn-id: r52352
"
"85c35f41ca2d871280bb8f99929ee1bf88d3cbeb","2010-08-24 17:33:35+00:00","SCI: fixing comment of r52351

svn-id: r52353
"
"f2ed796ba3502ec914044eb6ada905329eea3692","2010-08-24 17:56:33+00:00","CONFIGURE: don't force vkeybd for n64 port

svn-id: r52355
"
"922510df7e1b80c998532da66ae621ecacaed0f2","2010-08-24 18:44:14+00:00","SOUND: New global define AUDIO_REVERSE_STEREO.

This reverses the stereo channels for all sfx streams, meant for
hardware devices which expect an inverse order. Use it for the Wii
and Gamecube port since it's reversed since day one :P

svn-id: r52357
"
"b563a9d26589ad928f70b8fb1a8b7d5f4ece2e43","2010-08-24 21:25:19+00:00","GOB: Little cleanup of Fascination detection

svn-id: r52359
"
"eface88e31f46331537d4d9b8942076eee9ce6c3","2010-08-24 21:30:44+00:00","GOB: Add information about a cracked Fascination

Add a comment about a cracked versions of Fascination. The crack used
is based on the original executable's tolerance, it crashes in
Scummvm.

svn-id: r52360
"
"4a6553098f65a72418966f7306efc249a836e3e3","2010-08-24 21:53:06+00:00","SCI: adding qfg1vga patch for fight issue

fixes bug #3036756

svn-id: r52361
"
"9ca51656060345ecc2fe2e5248d02e64ce8bbfc6","2010-08-24 22:24:25+00:00","SCI: adding pharkas patch for ladder issue

in room 320, fixes bug #3037192

svn-id: r52362
"
"4c215fc9a01008fd93bb6d717bb705462b435de4","2010-08-25 06:02:18+00:00","SCUMM: Fix bug #2702847 - PUTTZOO: Graphic glitches on dancing penguin.

svn-id: r52363
"
"212479ab79cfabade43222e1295aa402435d55d9","2010-08-25 06:42:54+00:00","M4: Implementation of script engine

svn-id: r52364
"
"4395e75aef8572ef3fa06fd44cd8129dea2d91c8","2010-08-25 06:55:11+00:00","M4: Fixes for compiler errors

svn-id: r52365
"
"540cff87dca6bd80bc90f3b7175cd9fe74b780d4","2010-08-25 07:27:17+00:00","SCUMM: Implement keyboard-driven inventory scrolling in v2

Bug #2828383: 'ZAK V2: no inventory keyboard shortcuts'.

svn-id: r52366
"
"d2cf99f67daeb23767f9df82398417c2dff5e1da","2010-08-25 07:39:08+00:00","GUI: Fixed bug #2505686: 'GUI: minor artifacts in rounded corners'

It is practically not possible to get rid of those completely
due to rounding errors with 16-bit surface.

svn-id: r52367
"
"30d8dda86796fe385c3ff53e395fe77a92da9fc8","2010-08-25 07:39:31+00:00","AGI: Reset controllers on game restart

svn-id: r52368
"
"349b89adce911b451501ba9c2f6b7d9f95b0af80","2010-08-25 07:39:50+00:00","AGI: Fix bug #3034370

Bug #3034370: 'Manhunter: New York keyboard unresponsive'. Actually
the keyboard was made responsive after June implementation of set.key,
still the game speed was increasing. Fixed that too.

svn-id: r52369
"
"503cfd304bc230d7e1b44d7586344cb5d9f6a5e9","2010-08-25 07:40:13+00:00","SCUMM: Fix bug #3049323

Bug #3049323: 'SCUMM: Detects games in wrong places'.
I must admit: A seriously stupid bug.

svn-id: r52370
"
"386e38faa5b7ff53a474f63cbf431ca7e7e2a6ce","2010-08-25 07:40:32+00:00","AD: Fix in-depth search.

svn-id: r52371
"
"c4299cc0c7b789158ebc1e549d02292d2b64f30e","2010-08-25 07:40:52+00:00","SCUMM: Fix bug #3032758: 'SCUMM: Mute setting does not work'

svn-id: r52372
"
"fcdb349fa2bf4d93254ca38037483010e6a6c819","2010-08-25 07:41:14+00:00","AGI: Respect mute setting

svn-id: r52373
"
"99c9ba697c0ae0296a3042166e09171123000525","2010-08-25 07:41:35+00:00","TINSEL: Fix bug #3032780: 'DW: Mute setting does not work'

Bug #3032778 was fixed too as it is the duplicate.
Since there is no engine-specific logic, rely on superclass'
setupSoundSettings(), and use it on startup too.

svn-id: r52374
"
"3e4f6b4a2409512eed7d0ef048b7d6adb0ea3715","2010-08-25 07:41:54+00:00","SCUMM: Fix bug #3039004

Bug #3039004: 'MANIACNES: Ed does not appear at doorway.'
Actually whole thing is a gross hack on top of SCUMM v1.5 hack
with extra wide screen. It all calls for review and writing
specified methods.

svn-id: r52375
"
"b2ebb62e117e50cb52db64983b5093b2b256867e","2010-08-25 09:02:43+00:00","SCI: Make assert stricter.

(Thanks to fuzzie.)

svn-id: r52376
"
"4368d3c5749faadb89262dfa869d9a9d3b60a4c8","2010-08-25 09:14:41+00:00","COMMON: fixed EOS handling in BufferedReadStream and BufferedSeekableReadStream

EOS problem was causing Discworld to crash and zip files not to load on the PSP.

svn-id: r52377
"
"5e66329117625f53c9a9c0cb1e55d01c585237f5","2010-08-25 09:28:29+00:00","LURE: Workaround for bug #3047234 in English EGA version

svn-id: r52378
"
"a55dbc831db197408729296fd01a5852de49d9ce","2010-08-25 10:38:09+00:00","SCI: making loading from ScummVM menu work correctly

using a trick for indirectly calling GameObject::init and then restoring, fixes text color/font code issues, also removing all the hackery

svn-id: r52379
"
"def042e412b3758415aca095206aba9695962b30","2010-08-25 11:00:48+00:00","SCI: md5s from Bug #3049193

svn-id: r52380
"
"3900aa96b67298bb50b3a1aaf4c7ac5a0b5cc35a","2010-08-25 11:28:27+00:00","SCI: apply qfg1vga fight patch on weapon master

fixes fighting the weapon master as well...

svn-id: r52381
"
"8cd0cfe5eb5778e51d51d25494bf278b475f7092","2010-08-25 11:46:50+00:00","COMMON: Add test for BufferedReadStream's eos

This test is currently failing.

svn-id: r52382
"
"1d7566f371c804c894417b74b14e4bab43a1038e","2010-08-25 11:50:23+00:00","AD: Print out infromation about unknown version in better format

Now it is suitable for direct copy/pasting into detection tables.

svn-id: r52383
"
"78278db7ed5d6ab992d4344c385bd1ae072c447a","2010-08-25 11:51:06+00:00","AD: Implement AGDF_PIRATED flag.

svn-id: r52384
"
"15e50a64b8c4cb09f3e43c81cc1bd7e16b9a0335","2010-08-25 11:51:26+00:00","SCI: Make use of new ADGF_PIRATED flag

svn-id: r52385
"
"4135dc7a7c7584f38404d8f859a3258fa08e0475","2010-08-25 12:03:43+00:00","AD: Fix infinite loop in cleanupPirated.

svn-id: r52386
"
"89b34faa5aa85f8e7f7e5ec54f14246e639c9e6f","2010-08-25 13:26:30+00:00","PSP: fixed flag to open()

I was missing a flag (PSP_O_TRUNC) causing the config file to be opened on top of the old file, causing file corruption.

svn-id: r52387
"
"b1532eca9fcd86273a6ed72394129467bc4d00fe","2010-08-25 13:31:14+00:00","M4: Silence gcc warning

Original warning: 'format not a string literal and no format arguments'

svn-id: r52388
"
"05c2cc4d1d15fbf4c7a4997b83f60978164a7110","2010-08-25 14:43:42+00:00","COMMON: Fix eos handling in BufferedReadStream

This makes it pass the test added in r52382.

svn-id: r52389
"
"088da9e698f64343b33763c6af52bde02e7e3750","2010-08-25 17:03:24+00:00","HUGO: Fix invalid usage of snprintf with va_args

svn-id: r52390
"
"1b2ae60e2728acada1acee1329d797142a51666c","2010-08-25 17:07:47+00:00","HUGO: Use GCC_PRINTF on functions with variable arguments

Two instances commented out with a FIXME for Strangerke :P

svn-id: r52391
"
"6de3b6c55cc118a9f34c8dea394d89b821b21f7b","2010-08-25 17:49:03+00:00","SCI: adding detection for freddy pharkas 'fred'

fixes blop not appearing during intro song, because game thought we were too slow (bug #3051514)

svn-id: r52392
"
"2506560bda8dc43dfe996533e359323e3d344c2d","2010-08-25 19:41:59+00:00","TOOLS: const correctness to fix compilation.

svn-id: r52394
"
"bbab21300abebbd74f002d89ebaec525ed82b88a","2010-08-25 20:10:45+00:00","GOB: Detection of pirated games

Add detection of the known cracked Coktel
games with the appropriate ADGF_PIRATED flag

svn-id: r52395
"
"ca81bdde9b84f6b0c909f02f69812cb1912fc1c9","2010-08-25 22:05:10+00:00","SCI: Return empty string from fgets with maxsize 1

This should fix r3049360 in Hoyle4.

svn-id: r52396
"
"c0f81439dc4ef1155d7b07d93fa9bb5bfeea7c2b","2010-08-26 07:26:30+00:00","SCI: kFileIOReadString/kFGets return byte count

in sierra sci of read bytes

svn-id: r52397
"
"f8276a36fb598190ae93489ef7d7049a90ec4e52","2010-08-26 07:31:54+00:00","SCI: adjust r52397

actually they return 0:0, when no bytes were read, otherwise they return the destination pointer

svn-id: r52398
"
"1fea42949796cb341067b17000569554c5861b6e","2010-08-26 11:24:26+00:00","GP2XWIZ: Add initial support for the GPH Caanoo.

Most of the codebase is the same, but the toolchain and libs are different.
Support for Caanoo specific features will follow, I just want to get the build support into trunk for now.

svn-id: r52400
"
"c36ba08424342fb0567651442edd3f9c289ca9a3","2010-08-26 11:28:30+00:00","CONFIGURE: Add support for building for the GPH Caanoo.

The Caanoo is based on the GP2XWIZ backend but needs to be a seperate
target as it uses a different toolchain/libs etc.

svn-id: r52401
"
"09f42e24eb6b4d31f4f0e89dca815b19bafbbcb9","2010-08-26 11:32:10+00:00","NEWS: Mention new Caanoo port and GP2X plugin support.

svn-id: r52402
"
"98400327c3d2e497bba04f22dd096fcca4eeb255","2010-08-26 23:13:17+00:00","HUGO: Implemented basic MIDI support.

svn-id: r52403
"
"a7541810b4c4b991267ce7a63c6c4ad25e79e080","2010-08-26 23:41:39+00:00","HUGO: Removed some dead code and redundant indirection

svn-id: r52404
"
"fd574d5e24ce10cd10f75b73f6f98327f4ce79ce","2010-08-27 07:11:31+00:00","Add support for HUGO game engine

svn-id: r52405
"
"ec9708694e886746af0d45d30bbf271c2061053f","2010-08-27 09:48:53+00:00","HUGO: Hopefully fix GCC_PRINTF issue in util

* Add a mask in each call of Warn(), Error() and Box() not using one
* cleanup: use the same wording for 'End of namespace Hugo' in all files

svn-id: r52406
"
"03fe16087e514dccddd5417010e5a0723958f6ea","2010-08-27 10:01:09+00:00","HUGO: Fix previous commit (bad format used)

svn-id: r52407
"
"4d15e5f31c86d82d0fff31b95aa36cc453d8889c","2010-08-27 10:45:19+00:00","VIDEO: Change decodeImage() around a bit, plug a leak

Indeo3Decoder::decoderImage() was leaking inData

svn-id: r52408
"
"91f567427c03b28fdfafd1d4a0ed7c9683e7775f","2010-08-27 14:03:20+00:00","TOOLS: Fix some warnings in create_hugo

svn-id: r52410
"
"0bc33f000f74c1984076e02a5a3fa34adbd6c84f","2010-08-27 14:21:08+00:00","SCI: Possible fix for bug #3053268 - 'QFG1 VGA: Fetch spell crashes game'

svn-id: r52411
"
"b5b4ecbed6428f9a96900b084239e274ae1cdf4b","2010-08-27 15:09:54+00:00","SCI: adding kq4 0.247

svn-id: r52412
"
"b442ee701046ecbad9ff210ab9b9463f6a9fcce4","2010-08-27 17:26:34+00:00","SCI: Fixed potential memory leak in convert_polygon()

svn-id: r52413
"
"c4db714e3569f0b0dc77a834ea885450192249af","2010-08-27 21:13:47+00:00","HUGO: Fix a bug in creation tool in act14 (H1 Dos)

Fix a bug (missing character id in initialization) in creation tool
and silent some more warnings.

svn-id: r52414
"
"065087220319096fd7a527218270544cf701975d","2010-08-27 22:13:30+00:00","HUGO: Silence some const cast warnings in create_hugo.

svn-id: r52415
"
"24449579863efe419f06114d42ad33db8d609fd5","2010-08-27 22:24:15+00:00","HUGO: Fix 'UNIX' redefinition on Unix-like systems in create_hugo.

svn-id: r52416
"
"32734897a8d3828c2c8defe994263eaa05d918b0","2010-08-27 22:29:51+00:00","HUGO: Fix some action types in the creation tool

svn-id: r52417
"
"234b8e4f794d414fbafc1b2b42897c58b3f86a72","2010-08-27 23:11:29+00:00","HUGO: Fix GCC warnings in objects_xx initialization

svn-id: r52418
"
"fa04c9dd38ec560427298a705037076a32a9c27a","2010-08-27 23:21:08+00:00","SCI: Fixed bug #3054613, 'QFG character saves, naming convention'

svn-id: r52419
"
"51b88a69b8a2d8d169e6baf980c29be1410098f1","2010-08-28 00:47:17+00:00","HUGO: Some fixes for the create_hugo tool

svn-id: r52420
"
"1185c2b8bea17c155eb55d8aff572b2cabbdf828","2010-08-28 07:42:54+00:00","HUGO: Remove executable flag in create_hugo source

svn-id: r52421
"
"12e0d8997b80e4fdc497c28606c9eaaca8fe5764","2010-08-28 08:07:10+00:00","DINGUX: disable aspect ratio correction for some resolutions

Disable aspect ratio correction for games which have a native 240px
height res, this fixes Maniac Mansion NES on dingux.

svn-id: r52422
"
"c2f29ba22d664f542de9246e43c46ab12430ea97","2010-08-28 12:36:19+00:00","GOB: Change detection of Fascination CD
At the opposite of the other versions, the real name of the first
stick file in Fascination CD is intro.stk, not disk0.stk.

svn-id: r52424
"
"a2a30735626f8b4440f2a3128e0568c55b840b30","2010-08-28 15:51:23+00:00","I18N: Look for translations data file in Themes path

If the translations.dat file is not found using the SearchMan, it now looks
for that file into the themepath directory and sub-directories (if the path is
defined).

svn-id: r52428
"
"3f1f894e8eeb091153963b8b936b533f78f17e4a","2010-08-29 00:17:56+00:00","SCI: Added proper handling of QFG exported character files.

Now, QFG2, 3 and 4 may read exported characters from all
other QFG games, like the originals did. Fixes bug
#3054692 - 'QFG2/QFG3 Import issues'.

svn-id: r52430
"
"9096848e4b0411daa3cd54a677bafc13e2312082","2010-08-29 00:39:33+00:00","SCI: Throttle the invocations of Engine::shouldQuit()

SCI constantly invoked Engine::shouldQuit(), which in
turn called 2 virtual functions. This added a significant
overhead, as this was called constantly without any
throttling whatsoever. Now, the invocation of shouldQuit()
is throttled to be on each frame update (i.e. at a rate of
60fps). Thanks to wjp for profiling this.

svn-id: r52431
"
"b0b4ddcc5232485100fd42dcd14d164a8d2eaeac","2010-08-29 00:58:27+00:00","SCI: Fixed bug #3037874 - 'SCI1.1: High cpu usage when a textbox is displayed'

svn-id: r52432
"
"a32926147c9a29dd9ee5b27fdf21c9ea26d38bae","2010-08-29 02:31:18+00:00","SCI: Fixed bug #3051475 - 'MOTHERGOOSE CD: Crash after giving the pipe to the king'

svn-id: r52433
"
"33886e22afae11209f20bfe86fc8c2dcc4429d64","2010-08-29 08:26:59+00:00","Build a couple of different variant to split engines in two.

svn-id: r52435
"
"9e9db758fb6600cf6dfb8a1ba10996de6e3425c9","2010-08-29 10:39:34+00:00","SCI: changing scroll transition behaviour

makes scroll smooth on linux (and maybe others too)

svn-id: r52436
"
"6a058892fbc00821c05703a1aa980ee763c3e673","2010-08-29 11:08:27+00:00","SCI: Throw a warning in QFG import screens for unmatched files

The original SCI games supported up to 12 characters for file names, thus we
use the file name returned as a mask to find the actual file, as we don't
wrap/unwrap save file names in these screens. If no files match, or if more
than 1 files match, throw a warning.

svn-id: r52437
"
"99d2f23ab3bc45a14e7ada54b32fa5f99fe21f8e","2010-08-29 11:10:18+00:00","SCI: fixed debug output

svn-id: r52438
"
"8ba02169f849b4f18a2a93aeb6c163cdeb4ce176","2010-08-29 12:54:15+00:00","SCI: Properly fixed bug #3053268 - 'QFG1 VGA: Fetch spell crashes game'

svn-id: r52440
"
"ff7476d9f17c84623d544a2bb68b4cebe9d79fa4","2010-08-29 15:13:25+00:00","SCI: adding virtual lists for qfg-import rooms

now lists import files of all possible games, adds game title before that, removes game prefixes for all files

svn-id: r52441
"
"357fb5c60438e1ec495a1ce9c7d149034bfa6cd2","2010-08-29 15:18:24+00:00","SCI: fix build

svn-id: r52442
"
"2fb722056c94ee8d2b14ef195bb910fb6bef9587","2010-08-29 15:23:08+00:00","SCI: fix warning (thx wjp, thank you not msvc)

svn-id: r52443
"
"fc3dfd1bf7fe319c8ab29b9b1991b798c6b83109","2010-08-29 18:19:11+00:00","SCI: adding comment about invalid rect return val

svn-id: r52444
"
"4f8daaf596be6560917545d1d366ad9b217b1d43","2010-08-29 20:26:30+00:00","SCI: fix typo in comment

svn-id: r52445
"
"b53d4dcd964ac5ac33d81e82d87477838c617afa","2010-08-29 21:11:36+00:00","SCI: cleanup kDoBresen (no real code change)

svn-id: r52446
"
"e004831576355d689c1e045e84659e7b16b1feb6","2010-08-29 23:25:30+00:00","SCI: Fixed bug #3038767 - 'SCI Fanmade - Cascade Quest: Crash when restoring a game'

svn-id: r52447
"
"3e6d55aee72743f5224401071f9081f0a06d7fad","2010-08-29 23:35:23+00:00","SCI: Only show exported characters in the QFG import screens.

QFG can't import saved games, thus there is no point in including them in the
character import screens.

svn-id: r52448
"
"6d7d0ee94086d532b6263ff86705d8952aa20c49","2010-08-30 08:47:57+00:00","SCI: reverting r52448

broke importing, also savedgames are named 'qfg1.0xx', so they werent showed before anyway and '.sav' is not mandatory for exported character files.

svn-id: r52449
"
"154099d0a4fac94a5e9ae811a4e14d1d8e3e0244","2010-08-30 10:14:50+00:00","SCI: check filesize of qfg import files

filter out files that are larger than 1k, actually removes real saved games from the list

svn-id: r52450
"
"1067a72769d93e6eff77d0c968a7c3926e663087","2010-08-30 10:18:31+00:00","SCI: adding comments for r52450

svn-id: r52451
"
"80b405ecb47c2bc088ce90453d888aaf22fe7d22","2010-08-30 10:49:32+00:00","SCI: adding comments for kDoBresen

svn-id: r52452
"
"d02628a0dcbade4419c6c653cb65899b98c9cb86","2010-08-30 14:06:18+00:00","SCI: freshly reversed kDoBresen/kInitBresen

fixes qfg2 walking against wall, etc. BUT its currently disabled by default. You need to comment out the #define USE_OLD_BRESEN line in kmovement.cpp

svn-id: r52453
"
"6d0902860740290159ac5c81d5b8594aefc17563","2010-08-30 14:36:37+00:00","SCI: ability to ignore movecount for new DoBresen

fixes later sci games, when using new kDoBresen/kInitBresen

svn-id: r52454
"
"2f3edeedc923d3a478f44762720fee27237fc897","2010-08-30 16:52:23+00:00","WII: Abuse pollEvent() to update the screen of skipped frames.

updateScreen() itself skips redraws when called too frequently. With
the right timing and number of consecutive calls this can result in
missing gfx updates, so lets abuse pollEvent() to check for overdue
redraws.

svn-id: r52456
"
"4f70b6814b35475fc7a86fdc840da38f7c737c43","2010-08-30 17:06:11+00:00","SCI: fix warning

svn-id: r52457
"
"8ee7867831a1b9ed9dc27be4bf927d9be70ee2bf","2010-08-30 17:12:41+00:00","README: Improve formulation for Reporting Bugs paragraph

svn-id: r52458
"
"fc05e8a4ff8cc1f67d1ee1690bb6ef3ed8fd9a83","2010-08-30 22:10:32+00:00","I18N: Modify create-translations tool to remove duplicate translations

The TranslationManager in ScummVM will pick up the translation associated
to no context if present and if a translation could not be found for a specific
context. Based on this, the create_translations tool will now remove the
translation associated to a specific context if the same message has the
same translation associated to no context. This generate a smaller
translation.dat file, and this should also slightly improve performances (less
strings to load from the file and smaller list in which to look for a translated
message).

svn-id: r52459
"
"bf9404485e566714958896f6737fa94f63b5ed85","2010-08-30 22:20:16+00:00","I18N: Add a macro to define a context for a translatable string.

Currently static strings are marked with the _s() macro so that xgettext knows
the string needs to be translated. But there was no way to tell xgettext that
the string could get translated in different contexts. This is the role of this new
macro.

svn-id: r52460
"
"37027d653128796434b47a327ae99d96c078088d","2010-08-30 22:24:40+00:00","I18N: Add 'lowres' context for several GUI strings when in 1x mode.

This enables translators to use a different translation for these strings in
1x mode (e.g. 320x200 or 320x240) and in 2x or 3x modes.

svn-id: r52461
"
"3c7a068682e8c042e998c410f5a9c007ccc8b20b","2010-08-30 22:27:51+00:00","I18N: Update translation template and all translations.

svn-id: r52462
"
"ffb414d2655737a78fb192feb4a2828160dd99ad","2010-08-31 05:18:38+00:00","AGOS: Add Polish version of Swampy Adventures.

svn-id: r52464
"
"07e4fe9fdcb2a42f1c3d0de08aa9e92d0f98aba8","2010-08-31 09:45:36+00:00","SCI: Disabled some debug related GC code, which effectively
wastes cycles if we're not debugging the GC

svn-id: r52465
"
"7e6141dcfa880b5d24032351a4a0bffd2f47d3f8","2010-08-31 10:12:35+00:00","SCI: Added automatic detection of some static selectors
which keep changing location in each game

svn-id: r52466
"
"839945795e25fee251c76e7d88b2a667a8349252","2010-08-31 10:53:27+00:00","SCI: enable new kDoBresen/InitBresen

enable replacement of save/load dialogs per default
add config-var 'sci_originalsaveload' for not replacing dialogs
add config-var 'sci_dither' for enabling dithering in EGA games
new kDoBresen fix qfg2 walk against wall bug (#3053131) and hoyle3 unreadable dice bug (#3036922)

svn-id: r52467
"
"737b9bc632e1d70ae331a53b07411f9efd6c9eee","2010-08-31 11:27:01+00:00","SCI: Remove duplicate comment line.

svn-id: r52468
"
"aae0d9284e96196d96ed76c4bdf0b5086acbe28e","2010-08-31 11:38:07+00:00","SCI: renaming config-variables

'sci_dither' got removed, 'undither' renamed to 'sci_undither'. Also changed logic for handling 'sci_originalsaveload'

svn-id: r52469
"
"55f841518787c751c39bf0358c82df4ec04ac411","2010-08-31 11:43:56+00:00","SCI: forgot one rename of 'enable_fb01'

svn-id: r52470
"
"4ecb2b6047744bf5675529b1d6df8b46ef55ac20","2010-08-31 11:51:43+00:00","SCI: renaming fb01-enable to 'native_fb01'

svn-id: r52471
"
"c0b119feda86ea4bc3246868e59e583354656d70","2010-08-31 13:05:15+00:00","SCI: still set game cursor, when mouse outside

of ScummVM window. Just don't change actual mouse position

svn-id: r52472
"
"b5a17ca628e984fa13190c64fb5caef6108369ca","2010-08-31 15:24:08+00:00","PSP: fix BS2 crash by disabling strict aliasing

The problem that caused the crash in BS2 had to do with GCC making improper assumptions about our code. Specifically, the alignment trick we use for READ_UINT32/16 allows some targets(e.g. MIPS) to generate better code, but it also goes against ANSI C aliasing rules, which prohibit the sharing of addresses between a struct and another variable value. Using -fno-strict-aliasing tells GCC not to assume strict ANSI C aliasing and also unfortunately prevents it from making some good optimizations.

This change is probably needed for other platforms as well -- the crash on the PSP was simply a very rare coincidence.

svn-id: r52473
"
"fa7c6a9969806d2163d81153a3b3610b65ea12e4","2010-08-31 15:50:46+00:00","SCI: adding workaround for platform-specific

incompatibility with some sierra games. Some games open a new menu, set mouse cursor within that menu and expect the mouse cursor to be in there and will close it, if it's outside. In case of Wiimote/touch interfaces this logic won't work of course. Fixes island of dr. brain and QfG1VGA on Wii and touch-interface platforms

svn-id: r52474
"
"25d267888f3a4c6405d9fe534b051ed93126fa64","2010-08-31 20:03:47+00:00","I18N: Add 'lowres' context in one place for the Add Game button

svn-id: r52475
"
"cfbbc3928ae20f0477488d7b3b13ccf780603f9d","2010-08-31 20:05:00+00:00","MOHAWK: Implement functionality for the dome sliders

The sliders are now movable and reset properly. The combination defined in the lab journal works on all the domes too.

svn-id: r52476
"
"7dffcf43c2a2df7fe13dade5c36ce0a659c4864b","2010-08-31 21:18:20+00:00","SCI: Added a workaround for bug #3056811 - 'SQ5: Game crashes while playing 'Battle Cruiser''

svn-id: r52477
"
"5666df7b3824789bda5462c75b69a9333e55b495","2010-08-31 21:22:52+00:00","SCI: Added the Italian version of QFG3 (bug #3053457)

svn-id: r52478
"
"81eb3cfba157b3c45095734d5e9177a199d0c351","2010-09-01 09:48:00+00:00","SCI: disable dialog replacement for jones

fixes odd crash right at the start, although you can't save/restore in jones o_O (fixes bug #3057080)

svn-id: r52479
"
"cdd27ca9438906e8bd9d1942fecd69881ff14418","2010-09-01 12:41:16+00:00","COMMON: changed read/write endian function to use __may_alias__ attribute

This is a better solution for the gcc aliasing problem that happens when aliasing a struct onto something else. What happens is that the compiler assumes no aliasing can happen when -O2 and -O3 are activated, and a call to READ_UINT32() followed by WRITE_UINT32() and another READ_UINT32() will be optimized to return the original read value instead of re-reading.

svn-id: r52480
"
"43bbfa5ca8d384f601ef91f69d7d6bd6f3bba5cd","2010-09-01 12:56:34+00:00","PSP: removed strict-aliasing

It's no longer needed after adding __may_alias__ flag in endian.h.

svn-id: r52481
"
"649e275ca622b0e6b84181cb23dfc714270346d3","2010-09-01 13:28:12+00:00","MOHAWK: Implement xbookclick

It is now possible to trap Gehn in the trap book. Side note: Riven is now completable from the beginning provided you know the D'ni number system already (and the marble puzzle is just hacked to always work).

svn-id: r52482
"
"4b9a8d8899f3e8946f066e6c8d788f9b45418683","2010-09-01 15:46:44+00:00","i18n: Update Russian translation

svn-id: r52483
"
"64313cd7f10267c29d7e3b963c7bd0ff2e1c7f1a","2010-09-01 19:20:17+00:00","SCI: set master volume correctly

and merge it together with global volume, fixes bug #3053104)

svn-id: r52484
"
"ca74eb3e8b77cd49bad7a0fa6e261531ea8c0f44","2010-09-01 22:11:01+00:00","HUGO: Fix labyrinth bug in Hugo 2 for Windows

svn-id: r52485
"
"f36f8270cd6d1ce54bcd1c9afac3b21b8b851713","2010-09-01 22:15:10+00:00","HUGO: Updated Hugo.dat with the fix for labyrinth bug

svn-id: r52486
"
"a053ef7cd18400058af9ec39e53481ba88455b96","2010-09-01 23:22:12+00:00","MOHAWK: Cleanup mouse cursor position handling in Riven

This fixes some cursors showing up incorrectly if the cursor moved during ie. a video and then the card changes. Also, remove an unneeded rect check in loadHotspots() that's from the ancient times before script size calculation was fixed and some warnings that don't affect gameplay.

svn-id: r52487
"
"1475f756539e81182cb9aaa8188ddb354ea7769f","2010-09-01 23:39:25+00:00","MOHAWK: Update videos when the delay opcode is called

The fixes a couple scripts which decide to delay through a background video turning into a virtual blocking video.

svn-id: r52488
"
"9324a80d93621894ce6f618778015944f3c72b11","2010-09-02 05:12:07+00:00","JANITORIAL: Remove extra semi-colons.

svn-id: r52489
"
"cf3289ee3f11f37a2459da34d45c868a07133e76","2010-09-02 09:05:08+00:00","SCI: adding 'bpr' and 'bpw' debug commands

'bpr' breakpoint on reading of selectors
'bpw' breakpoint of writing of selectors
'bpx' is now breakpoint on executing of selectors only

svn-id: r52490
"
"82f138b728229291d6aa4c6daf2ed916054667c6","2010-09-02 10:21:20+00:00","SCI: fixing debug output for bpx

svn-id: r52491
"
"fd23ab2e17da6f74efdc94ed1b19ec4dd81da558","2010-09-02 10:41:26+00:00","FMTOWNS AUDIO: fixed divide by zero exception from commit 52013

Also removed 1 or 2 float operations.

svn-id: r52492
"
"d74e82fe7fdc467dbebab704a7ace2de57395147","2010-09-02 10:52:29+00:00","HUGO: Fix loading of config file during game init

Add a check on CONFIG.DAT size in order to avoid loading crap into
the _config structure during the initialization of the engine.
The game no longer starts in turbo & mute mode

svn-id: r52493
"
"e284852b64cc772c6475fc9d2db35122bea090f8","2010-09-02 11:43:00+00:00","HUGO: Fix warnings

svn-id: r52494
"
"21a09427de2cc8b251a13150d6d4ba8576fa1430","2010-09-02 12:50:10+00:00","HUGO: Cleanup and fix mouse pointer issue

- Suppress commented code
- Suppress readConfig() and writeConfig()
- Fix the disappearing mouse issue

svn-id: r52495
"
"054a95498e4470acb99672f49ecbeeff58d014d8","2010-09-02 12:52:03+00:00","TOOLS: Suppress some dead code reported by Cppcheck

svn-id: r52496
"
"a816a27928d2686a27c9600bb93e39a557131a17","2010-09-02 13:50:49+00:00","SCI: Added a FIXME for bug #3038870, related to kParse()

svn-id: r52497
"
"2f88eec7139fa07a277f21586ecf078e67a7b179","2010-09-02 18:58:25+00:00","SCI: Fixed compilation when VM_DEBUG_SEND is enabled

svn-id: r52498
"
"3606e51e76a82d8f73c9ea4f4c6996896b9f5594","2010-09-02 19:34:23+00:00","i18n: Update German translation

svn-id: r52499
"
"d87fa1c8903ba21a2ce5d5946947a50af841700a","2010-09-02 21:50:00+00:00","SCI: Show a warning window regarding GM in some games.

Sierra has released a patch adding after market General MIDI support for 8 SCI1
games (LSL1, LSL5, Hoyle 3, SQ1, SQ4, Eco1 floppy, Longbow and Fairy Tales). If
the user has selected the General MIDI music driver in one of these games and
no associated MIDI patch is found, show an informational dialog on game startup
in order to inform the user to download Sierra's MIDI patch, together with some
short instructions.

svn-id: r52500
"
"ace44770416d9f6614c6e0f19b933a3915f58ae0","2010-09-03 08:46:07+00:00","SCI: Rewrote the game name IDs of the Mt32MemoryTimbreMaps array to be like the game IDs we use

svn-id: r52504
"
"f78b4b9f85d9cc8cef217bd5c1a1e632c95f09cb","2010-09-03 12:42:35+00:00","SCI: Added a warning when using GM with SCI1 games

The MT-32 <-> GM mapping has only been worked on for
SCI0/SCI01 games. Throw a warning when the user
chooses GM in a SCI1 game, and there is no after
market GM support from Sierra for this game

svn-id: r52505
"
"b7a2fd899e07c3ae47bf5c845aadba6991c33666","2010-09-03 17:49:22+00:00","SCI: adding mother goose title

svn-id: r52507
"
"87b78b1673037409604cdb4a1a5d6884af71bac1","2010-09-03 18:14:59+00:00","SCI: kClone/kDisposeClone behaviour more accurate

now also checking -info- selector, if object is supposed to get freed. Fixes kq4 early hanging (in intro, when opening door, etc.)

svn-id: r52508
"
"8a168f028bfdf084892abd623942a0c3f9f8de58","2010-09-03 19:13:58+00:00","MOHAWK: Improve support for the Riven Demo

- The exit button now appears and is functional
- The intro movies now play on start up
- Add shortcuts for returning to the menu/playing the intro videos again
- Make the text when hitting a boundary match the original
- Change the wording of the browser button message
- Note: The demo's extras.mhk (not the full game's!) is required now

svn-id: r52509
"
"e4c07925ecde598507c27b5be5a373bf333e70dd","2010-09-03 22:15:08+00:00","SCI: kDirLoop freshly reversed

svn-id: r52510
"
"976458058d354942ceddc18643748cd0e1adf0be","2010-09-03 22:51:27+00:00","SCI: Fixed bug #3058865 - 'Jones in the Fast Lane CD: Graphics Missing'

svn-id: r52511
"
"acc294c7a8ef32a6f5c054797185d859f99988a7","2010-09-04 07:29:27+00:00","SCI: properly reversed kDoAvoider

getAngle()-code is missing though. Still fixes lsl2early hang on airport (bug #3037036), fixes kq4early unicorn doing moonwalk (kq4late still works as well)

svn-id: r52512
"
"92c3a4b5aab20786ceceb62458142561bc569b64","2010-09-04 08:28:53+00:00","SCI: lsl2 early uses sci0late sound

fixes bug #3037012 and lsl2 now has music everywhere

svn-id: r52513
"
"89d4e44281b7bf05b9ad234bdf242de32a47c688","2010-09-04 08:51:10+00:00","SCI: doing detectDoSoundType() properly sci0early

checking, if sound resources are sci0early or late for sci0early games instead of hardcoding lsl2

svn-id: r52514
"
"f95a2ac499171faad0bd3ce7622ef0e25dd26db7","2010-09-04 09:20:38+00:00","SCI: removing non-sierra sci code in kDirLoop

svn-id: r52515
"
"c34cec4e15a8edac0020ad4c6a291f960632d506","2010-09-04 09:41:39+00:00","SCI: Fixed bug #3037595 - 'KQ4: Crash reading message in the bottle (whale mouth)'

svn-id: r52516
"
"afada2b60d636e21000e8bde3b760241afb1a223","2010-09-04 09:58:37+00:00","SCI: fixing comment

svn-id: r52517
"
"e7f834e1030fadd0bc8dd0ace0a0f2c47e5765ba","2010-09-04 10:39:22+00:00","SCI: delete on textedit control now checks string

svn-id: r52518
"
"7836bb87fda6d166786036a33987c5c75bfbce15","2010-09-04 11:27:03+00:00","SCI: fixing typo in kDoAvoider

svn-id: r52520
"
"37d28b2fe506a7ef93315c934d3813c71bc5f882","2010-09-04 11:40:24+00:00","FM-TOWNS AUDIO: minor fix in cd audio volume setting

svn-id: r52521
"
"b876527014ffbd1dd47eb735a77cca9a241175b9","2010-09-04 13:19:49+00:00","SOUND: Remove semicolon

svn-id: r52522
"
"8a93da0516c5d35bc2581fe50602dd53fc101d70","2010-09-04 14:46:29+00:00","SCI: Updated comment concerning kCantBeHere and removed a wrong check for Hoyle 3

svn-id: r52523
"
"34195238bb6cc3ff1051230c4acbe3669f082e0e","2010-09-04 15:38:24+00:00","SCI: Don't try to initialize non-existent scripts, error out instead

(Invalid scripts may be requested to be loaded when warping to an incorrect room)

svn-id: r52524
"
"a29ae442965bdef0b2a4a0e4df8638a37adcde82","2010-09-04 16:02:16+00:00","HUGO: Fix decryption in H2 DOS, plus some cleanup

svn-id: r52525
"
"98f36800e3f0eb5c27696207cb6536fe5f01c33f","2010-09-04 17:10:27+00:00","SCI: Added another version of Hoyle 3 (bug report #3038837)

svn-id: r52526
"
"3daf588e0801d5aae3c7aed3d9bbb1771e4023f2","2010-09-04 17:16:41+00:00","SCI: Janitorial - fixed spaces and typos

svn-id: r52527
"
"871064b3c71a3eac02575ec2190ea381de9c2794","2010-09-04 17:22:27+00:00","HUGO: Add destructor to Scheduler class

GCC complained, and I think this is what it wanted.

svn-id: r52528
"
"8733cdb900d7a4ab869a69a9351516c466af7f37","2010-09-04 17:30:39+00:00","HUGO: Formatting.

svn-id: r52529
"
"397209173425ed522ac9c86d8775df1dd4fbc624","2010-09-04 18:03:35+00:00","SCUMM: Patch #3059327

Patch #3059327: 'Remove untrue 'not yet implemented' from inventory controls'

svn-id: r52530
"
"e55c928075c7ad53d478f0dfca0a4e7bbffb27ff","2010-09-04 18:23:37+00:00","SCI: kDoBresen changes for sci1early+

including change to compare dest and current position directly, otherwise we would trigger ::moveDone one cycle too late in case the current move completed - fixes lsl5 patti upside down bug #3059336 and lb2cd (cd only!) laura bow getting transformed into a boiler-flame (bug #3050602) - lsl5 was not a real regression, the timing of previous kDoBresen way just off, so it didn't happen in that scene, but happened in lb2cd

svn-id: r52531
"
"aa5cd3e6825f50e574804455e6b5a3fbe2070062","2010-09-04 21:43:16+00:00","MOHAWK: Ignore invalid Riven hotspots again

There is at least one example of a bad hotspot in Riven (tspit
371 (377 in the DVD version), hotspot 4). This particular hotspot is a zip hotspot which looks like it has its left and right coordinates reversed. However, the zip hotspot would only take the player to the same card as the non zip hotspot so it seems they removed this hotspot with a hack. This fixes a regression from r52487.

svn-id: r52532
"
"7248efb178cdb33c107cc0ff183eb74c79236a59","2010-09-04 22:19:20+00:00","DS: Enable stdout/err via nocash when DISABLE_COMMAND_LINE in not set.

svn-id: r52533
"
"a960ac66cea3ff1a9ea4b7acd02e4cd30ce20594","2010-09-04 23:45:23+00:00","COMMON: Fix Rational::operator!=(int)

svn-id: r52535
"
"f8ff771b8edc97861efb127a4bccc43e1acef5bc","2010-09-05 00:36:27+00:00","WII: New disttarget 'wiiloaddist'

Uploads a .zip file to HBC to unpack to the used storage media.

svn-id: r52536
"
"34f570419ad49550c6a7790e2a97a7d88d02fbac","2010-09-05 00:48:38+00:00","MOHAWK: Cleanup

- Split the main Riven event loop into a separate function for readability and for use in the sunner external functions eventually
- Some minor function signature changes (const!)
- Rename matchVarToString() to getVar() (I have no idea where that original name came from, considering it takes a string and returns a variable
- Use solely Common::String in getVar()

svn-id: r52538
"
"16bed5046994634d786fd070312058ea30ff97df","2010-09-05 09:27:41+00:00","SCI: Fixed script bug #3059544 - 'KQ6CD: Error when looking at rotten tomato'

svn-id: r52539
"
"7dcb19e41b0db4e7ce606759e2e897ee8b2b4192","2010-09-05 10:55:25+00:00","SCI: Added a workaround for the non-interactive demo of Pepper

svn-id: r52540
"
"913f39da19f3f527b81131844f713097b4a99800","2010-09-05 10:59:44+00:00","SCI: Some cleanup of the static selector code

- Added more static selectors, for debugging
- Added some needed selectors for the non-interactive demo of Pepper

svn-id: r52541
"
"047979b4093c376e4cd82da0e2debf43e0de5b91","2010-09-05 11:10:49+00:00","SCI: Fix for alignment exception issue, reported by Bluddy

svn-id: r52542
"
"f17a9f9fb09d4eaac333514bae70e770c5378b76","2010-09-05 11:30:40+00:00","SCI: Changed consecutive ifs to a switch

A table would be better, but the switch will do for now

svn-id: r52543
"
"fe2924d50d874108be7d7587b30b3a13d7636464","2010-09-05 12:33:27+00:00","SCI: initialize members of the Object class when it's constructed

svn-id: r52544
"
"d5d5dde56be6d7ff6c0b180f9f49df9bb95724e7","2010-09-05 12:55:15+00:00","SCI: dont do global scaling on non-scaleable views

lb2floppy: scripts get confused in the rat scene, when scaleX/Y are set with applied global scaling. This results in kInitBresen to get called almost endlessly, which results in ego slowing down to a crawl and not being able to reach the upper right exit - fixes bug #3050606

svn-id: r52559
"
"4766cc5bb5c872e7ba7e787ec512bc16388e3b24","2010-09-05 13:51:47+00:00","SCI: reuse kGetAngle from kDoAvoider

svn-id: r52560
"
"2a08124f0f9274dd442b7154e3b72dd981a7e2e7","2010-09-05 14:59:09+00:00","SCI: Fix bugs #3035650 and #3039566, crash in PEPPER demo and LAURABOW2.

The actual names for the bug reports are:
#3035650 'PEPPER non-interactive demo: Crash'
#3039566 'LAURABOW2: Crash during introduction'

Those crashes were caused by an invalid memory dereference in kClone. This
in turn was happening, because the parent object pointer might have been
invalidated in cases where the parent object is also a clone.

svn-id: r52561
"
"d817bec4fddf5d808d2a0d630bb9057610267386","2010-09-05 15:09:50+00:00","SCI: merging -info- stuff in Clone/DisposeClone

svn-id: r52562
"
"13e24af0cace8599d31c8bb7381fa9fce49a8e6e","2010-09-05 15:11:22+00:00","SCI: adjusting comment on kClone change

svn-id: r52563
"
"49c8d1a549deb7abdb49339c81031ea46c7716b5","2010-09-05 15:34:25+00:00","SCI: kClone cleanup

and fixing possible crash & typo

svn-id: r52565
"
"6ffbe90130b30b19783b7c200a971c32cf42cb70","2010-09-05 19:25:08+00:00","SCI: sierra sci ignores vol for kDoSound samples

now 'score' is halfway playing, but it's cut so only 's' is played. Needs to get further investigated

svn-id: r52568
"
"1856723a9e68dd18386fdc0b7ac2345341c8368d","2010-09-05 19:34:26+00:00","SCI: ignore kDoSound volume changes on samples

svn-id: r52569
"
"9b594965330cede661db9c022c33c1daa42ed123","2010-09-05 20:04:46+00:00","SCI: adding patch for script bug in pharkas/cd

patches out bad code that would dispose score sound immediately, 'score' sound plays now for pharkas/cd - finally fixes bug #3037161

svn-id: r52570
"
"8bd741d41b6fc796fce03e3cda1228b57ac57bce","2010-09-05 20:37:38+00:00","HUGO: Add support for multiple scenery files

This is used by H3Dos only.

svn-id: r52571
"
"b6663bb942780ed9786992ca1fd757fc96f1412d","2010-09-05 22:56:03+00:00","KYRA: Constify some tables.

svn-id: r52578
"
"f69bfaf355b2544bf8ca8cc6cf3209773b8ad005","2010-09-05 22:56:25+00:00","KYRA: Get rid of local static non-POD object.

This fixes crashes with the plugins branch for dhewg.

svn-id: r52579
"
"fddb0f6c1536d3e75223740de64c552e5d480433","2010-09-05 23:14:42+00:00","Partial fix for bug #3059871 - 'SCI Fanmade - Ocean Battle: Crash while playing'

The fix is partial, as the game will crash when losing and attempting to
restart (for a different reason - there's an issue when uninstantiating a script)

svn-id: r52581
"
"f51c3ad62e5ea1ef2f3d0695065e0aab17f7e3fd","2010-09-05 23:17:52+00:00","BUILD: Don't pass -fcheck-new to clang.

svn-id: r52582
"
"e3e9bac6f6e0a9174e56afdd3e6a497baf979852","2010-09-06 10:11:07+00:00","SCI: Clear class bit when cloning objects.
This fixes a regression affecting many SCI32 games and possibly other games,
looping or recursing endlessly.

svn-id: r52583
"
"c342c0e3d8d3cc551fa3cc3b12a039f9a0303d66","2010-09-06 10:39:42+00:00","SCI: fix regression of r52565

remove class bit when marking as clone

svn-id: r52584
"
"bab5050531b7d026d0688ef0eebaf9608c687eb1","2010-09-06 10:41:14+00:00","SCI: fixing code

thx to tortoisegit and broken conflict managment

svn-id: r52585
"
"397f88369816ca28414c3255e81ecdc454c8f3cb","2010-09-06 11:30:26+00:00","SCI: Fixed an off-by one access error in the static selectors of some games

svn-id: r52586
"
"da45fcfeb2bf59d201e866362eb98e4b2c2443c6","2010-09-06 11:58:28+00:00","SCI: add patch for cannister lockup pharkas/cd

scripts disable icon 7+8 when entering the room. When taking the cannister they will disable all remaining icons, resulting in the disable-code running endlessly, also happend in sierra sci - fixes bug #3046367

svn-id: r52587
"
"2bea43357fa29027a2532289f539ac2d5583fa26","2010-09-06 12:09:11+00:00","HUGO: Add hints in DOS versions

In DOS versions, display hints when mouse is over a
hotspot. This behavior is based on the one of Hugo Win
versions.

svn-id: r52590
"
"6eecc485d2728e2a314d52a6adc385a23908d30f","2010-09-06 12:16:21+00:00","SCI: fix warning (and actual error)

svn-id: r52591
"
"df7158c0ee9cd6fde0183b2841d1c918f5c8ab7b","2010-09-06 14:59:13+00:00","COMMON: Add a debugPrint function to Rational

svn-id: r52593
"
"c54a97005f3c03a6ab8585f7c4fb7d7a6912918e","2010-09-06 15:15:59+00:00","VIDEO: Apply patch #3057924 with some changes

Patch #3057924 is 'QuickTimeDecoder: Scaling x and y separately'. Thanks to kreegee for the patch and fuzzie for fixing a couple bugs with it.

svn-id: r52594
"
"ba6bc8f17b99055212abfa8c836ab7e34f4a24ad","2010-09-06 16:09:19+00:00","SCI: AdLib: process patch change commands when playswitch is off.

svn-id: r52595
"
"be5314109197d0333f10fdf7cd279f41a950d0a9","2010-09-06 16:09:56+00:00","HUGO: Clean up creation tool

Fix typos and suppress all identical noun arrays.

svn-id: r52596
"
"c87b7aafd874bbec29fdd109f0e9a442e8418834","2010-09-06 16:50:20+00:00","LOL: Add md5 for another English floppy version

svn-id: r52597
"
"e81dad8e61fca9ca740051fcfcec639354689875","2010-09-06 17:22:22+00:00","OPENPANDORA: Commit basic version of the OpenPandora backend.

Overload of the SDL backend.
Basic functional backend with support for most main ScummVM features and engines.
Supports building to a .PND OpenPandora bundle for ease of use on the device.

svn-id: r52598
"
"2e1b4278e2aa188e67c20b88d78260fd6dd6b429","2010-09-06 17:28:17+00:00","SDL: Add masks to the SDL backend to support the OpenPandora backend.

svn-id: r52599
"
"fdb2a58bc2cc93e1c9af023f182f9da38974731b","2010-09-06 17:35:27+00:00","CONFIGURE: Add support for the OpenPandora backend.

svn-id: r52600
"
"871aa65a833ecd1115dc93ae83132ce43c7d417f","2010-09-06 18:06:47+00:00","CONFIGURE: Remove 16Bit graphics support from the GP2X backend.

This should not have been committed with r52600,
the GP2X backend refactor it needs is not yet ready to commit.

svn-id: r52601
"
"6c980b3593d6f428aac618888224a0be4d279fef","2010-09-06 18:13:39+00:00","CONFIGURE: Wrap usage help around 80 columns

svn-id: r52602
"
"c78a63460be88bce41125f8555bf1d5ffdfa9ad0","2010-09-06 18:15:51+00:00","VIDEO: Skip multiple tags in a QuickTime stsd entry

Fixes crashes when playing two videos in Riven DVD (card 262). Note that the videos still don't display properly because of a bug in QTRLE 16bpp. For the record, FFmpeg doesn't handle this properly either.

svn-id: r52603
"
"2bf82a8354df9bbf4ef5ebaedc928ad10c7c986c","2010-09-06 18:23:03+00:00","SCI: fix regression of r52569

fade in/out of samples

svn-id: r52604
"
"d6186789828e186c828a1909115296582ec20651","2010-09-06 19:00:43+00:00","SCI: dont play audio on kDoSound in hoyle4

hoyle4 has garbled audio data

svn-id: r52605
"
"624d06b6848541c60ff0787cd9e3b9cc604a5576","2010-09-06 19:03:55+00:00","SCI: extending comment for prev. commit

svn-id: r52606
"
"f56f09377039fa6f8f10a4f13c2208a6a5147fdc","2010-09-06 21:04:12+00:00","CINE: Get rid of needless static variable.

svn-id: r52608
"
"15b57549ad18902b998969e388fd0613578bbd7a","2010-09-06 21:04:33+00:00","COMMON: Some style fixes.

svn-id: r52609
"
"c42e2f3a551d18f24ad05ebb8008e300ed4da3ed","2010-09-06 21:17:26+00:00","PARALLACTION: Use a char array for static data instead of String.

svn-id: r52610
"
"b2464a9bd15556de586a2936f96c2515e84ae050","2010-09-07 07:41:28+00:00","SCI: Slight change in GfxPicture::vectorFloodFill()

Changed bitwise XOR operations to bitwise NOT AND, to make the code a bit easier
to understand

svn-id: r52614
"
"dd0095f1a210aa54f379fe51967def65a0dc5fdf","2010-09-07 08:12:59+00:00","SCI: Added parentheses inside GfxScreen::isFillMatch() to make the code more
readable

svn-id: r52615
"
"8f1143bfdc972d86cf5fbbf85a0084a9d0c71447","2010-09-07 09:02:46+00:00","COMMON: Remove Rational::operator int/double

This prevents accidental implicit rounding
and might also fix compilation on AmigaOS4 (bug #3060981).

svn-id: r52616
"
"0e80aa708802eb38e45820cbf0efaf6b7c1581fe","2010-09-07 09:19:25+00:00","TESTS: Add more Rational (in)equality tests

This tests for the bug fixed by r52535, among other things.

svn-id: r52617
"
"532663c742150b341de22a65da4fd761da6f497a","2010-09-07 11:40:44+00:00","COMMON: Fix edge case for wildcard in matchString

svn-id: r52618
"
"fd407eeca3f2d50bc1a005bbcfd171369daa4f5f","2010-09-07 14:17:31+00:00","GP2XWIZ: Refactor backend.

* Add support for TouchScreen 'Tap Modes'
Left Click, Right Click and Hover.
* Rename OSystem_GP2XWIZ to OSystem_GPH to
start the work on supporting a unified
backend codebase for the GP2X, Wiz and
Caanoo.
* Sort out bugs in Caanoo input code.
* Rework GP2XWiz input code to support
switching new TouchScreen modes.

svn-id: r52619
"
"cb0e54034dbed6a3fc34b391f42ff5a97b2e26e0","2010-09-07 15:09:59+00:00","SCI: Now distinguishing between native MT-32 MIDI from GM devices when checking
for the existence of after market GM patches

svn-id: r52620
"
"f27a0b2c4371ba882aef869091949e4d6e7c9072","2010-09-07 15:27:06+00:00","MOHAWK: Fix the boiler puzzle videos

svn-id: r52621
"
"771d2274dd0e4f875544a7f3c69d5d398ecfd155","2010-09-07 17:38:21+00:00","CREDITS: Thanked for Drascula and Hugo sources

svn-id: r52622
"
"29afa3094d222f7ae4ab29e3d5db8aca4cf828ec","2010-09-07 17:45:36+00:00","CREDITS: Fix typo

svn-id: r52624
"
"009889dd13c9a9ddb535864ef75a19a886dc7d28","2010-09-07 17:58:10+00:00","MOHAWK: Implement xgplateau3160_dopools

The pools of water will now always show the video of returning to the 'off' state.

svn-id: r52626
"
"8448c50c712604d172e66ae2a1c42ca7d8bd3389","2010-09-07 18:50:48+00:00","LOL FLOPPY: silence pointless warnings in character selection

svn-id: r52627
"
"87a6b631bf77a82c967d5ae68d888535c556a9cf","2010-09-07 19:00:55+00:00","MOHAWK: Add stopping sounds to the telescope functions

svn-id: r52628
"
"56b09b605dcae91a1d5e12c0c377d6b10985556e","2010-09-07 19:02:07+00:00","GP2XWIZ: Clean up input code.

* Clean up the if/switch mess.
* Also add missing Caanoo icon.

svn-id: r52629
"
"4c107cc97a0d393508d570d7374a3304f564defe","2010-09-07 20:14:05+00:00","GP2XWIZ: Reformat switches to code guidelines.

svn-id: r52630
"
"58139baf3710160c8382db14df26291d176e70cd","2010-09-07 20:18:30+00:00","MOHAWK: Sound cleanup

Merge the Riven sound file code with the main Riven resource code and remove the mainSoundFile parameter from Sound::playSound(). Reasoning: The sound id's do not collide with the sound id's in the main data files. The sound archives only exist because the original CD version had the ability to choose between low and high quality audio.

svn-id: r52631
"
"690fea29333daadd79d7bc305ee7fff040613b9f","2010-09-08 08:26:20+00:00","DINGUX: Add dingux.mk with specific 'dist' targets

svn-id: r52632
"
"806ee79a7be5ca0dcb0e03d16021ed5eb92f0f27","2010-09-08 09:37:33+00:00","GROOVIE: Improve sound handling.

- Obey the mute setting.
- Report the supported music types.

svn-id: r52633
"
"06afbd7fbbdb0c581103591dd130d5847966395c","2010-09-08 10:49:12+00:00","SCI: dont remap to channel 9 (fix real mt32)

svn-id: r52634
"
"3e4e74138727c3dc2210694ef2daaae2d0bc22d3","2010-09-08 12:42:00+00:00","SCI: don't replace save/restore in hoyle1

fixes hoyle1 not starting anymore

svn-id: r52635
"
"54865f48371076dd280ad9f22b14e50da62d0eaf","2010-09-08 12:45:42+00:00","SCI: dont replace save/restore in hoyle2 too

svn-id: r52636
"
"10a460443badcf3a9e8d418b51a33cdf74335a2f","2010-09-08 16:15:42+00:00","SCI: adding save description, if none was entered

fixes bug #3061964

svn-id: r52637
"
"b92c329fa526dd710299963a3a156af7cb4af5b8","2010-09-08 17:01:21+00:00","I18N: Don't use fuzzy translations.

- Tweaked create_translations to ignore fuzzy translations.
- Fixed some formatting and removed extra whitespaces.

svn-id: r52638
"
"f1690a2b75237fe6b83c32eb6a1c7365d40fa0e6","2010-09-08 17:05:55+00:00","I18N: Fix building translations.dat outside the source tree

svn-id: r52639
"
"f3a9828d3683ed9ace360adb2b37459fbc28f98b","2010-09-08 17:41:31+00:00","WII: Fix typo, update translations.

svn-id: r52640
"
"0288f60f1972b5c5a7d719a8114fdeae32024cb2","2010-09-08 18:04:38+00:00","CONFIGURE and N64: add n64.mk with nintendo64 specific dist targets

svn-id: r52641
"
"47ad577a785aaeef7856aca883b367e9b681c4b7","2010-09-08 20:11:11+00:00","SCI: ability to change r_acc within DrawControl

preparation for returning rect array on |r| textcodes

svn-id: r52642
"
"0cba4f030691f83e487ddcc688214feef9a8b65e","2010-09-08 20:50:56+00:00","MOHAWK: Implement blocking sound in Riven

Sounds that set the third argument of the playSound opcode to 1 (wherever they may be) will now block. The volume parameter of playSound is also now honored. Merge the Myst sound blocking code with this too.

svn-id: r52643
"
"43a142bbff3ddd976637408e3345bdbb9c394f46","2010-09-08 21:18:22+00:00","N64: saner fake date in getDateAndTime
- Set the fake date in 2010 instead of year 3800

svn-id: r52644
"
"39899e51d0e8386b9d1d55d94603aedfaef89076","2010-09-08 21:43:46+00:00","GP2X: Clean up input code a little.

* Match the GP2XWiz input code.

svn-id: r52645
"
"873d794a6c7259b071a49d98f6b6ef031778b9f7","2010-09-08 22:58:41+00:00","I18N: Update the catalan translation.

svn-id: r52646
"
"9313e169fd7fc8efde6a8ae63cbb2599f83856b7","2010-09-09 07:42:25+00:00","SCI: Enabled the static selector remap code for SCI2+. The Torin demo works again

svn-id: r52647
"
"9307304d7eb6acbd2351355a30d24cb95a259db7","2010-09-09 09:48:32+00:00","GP2XWIZ: Rename GP2XWIZ backend to GPH.

* This better reflects the supported devices
from GPH (GamePark Holdings), namely the
GP2XWiz, Caanoo and merging in of the old
GP2X backend.

svn-id: r52648
"
"47711e4c59bf92ac4702000636a4d0d8d32a1e65","2010-09-09 09:55:07+00:00","CONFIGURE: Move GP2XWIZ and CAANOO to use the GPH backend.

svn-id: r52649
"
"792c5b2303f58d00ab3d51c855bd0a0764d07ee4","2010-09-09 10:46:43+00:00","SCI: Support a few optional parameters in SCI32 List calls
the actual support was already there due to extensive code sharing
w/SCI0, so only modifying signatures here

svn-id: r52650
"
"9c67db6b0d86b24e16d08c0dd53ec4e2d6b253f6","2010-09-09 10:52:17+00:00","SCI: adding text code reference support

fixes glossary in pepper, bug #3040039

svn-id: r52651
"
"c3c36cc59b46d9ef4e57bd58279a89dd8b8d5e4f","2010-09-09 11:40:46+00:00","SCI: SCI2/2.1 kernel table changes

- Mark several SCI2/2.1 kernel functions used for debugging as dummy
- Added an empty function for kSetWindowsOption, used for settings specific to
Windows versions (e.g. showing/hiding the title bar)
- Added a stub for kGetWindowsOption (currently returning 0 to a Windows related
option for Phantasmagoria)

svn-id: r52652
"
"16a7046519e1d0c355358e722e968a0c7de24b02","2010-09-09 12:01:04+00:00","SCI: Changed the error message when execute_method() references an invalid export

svn-id: r52653
"
"065e19092a48c85089bef3c7e1a07b92bf3453b2","2010-09-09 12:44:34+00:00","SCI: Support push and pop subfunctions in kMessage()
Glossary seems to work now.

svn-id: r52654
"
"8264bb704feca50ab6f9f6dcd000b924e0fcd11a","2010-09-09 12:46:46+00:00","SCI: Add getLastChannel() function to MidiPlayer class

svn-id: r52655
"
"68dd99643c63a20baec740923f69a470615eae38","2010-09-09 13:30:15+00:00","DINGUX and N64: changes to dists targets

Run instructions to copy engine data only if there is really some
datafiles to copy for the built engines.

svn-id: r52656
"
"e51b0f6b56fb4b3ee054e8de7b4f7489782ff74c","2010-09-09 13:38:00+00:00","SCI/Debugger: Show class names in addition to addresses in class_table output.

svn-id: r52657
"
"43f05c3361825ce01b3e3301b6b5354c6f5107d2","2010-09-09 14:01:33+00:00","BUILD: Fix compiler test result logging

svn-id: r52658
"
"2ba62328d24d2df8675182b5e9d7142111b4e83c","2010-09-09 14:01:48+00:00","BUILD: Create configure temp files in build dir

This fixes detection issues with a noexec /tmp (bug #3009167),
and matches what autoconf does. There should be no need to
randomize temp file names in the build dir.

svn-id: r52659
"
"746a1c56144e0d4e608244ac19e6774fd4de3933","2010-09-09 15:09:26+00:00","SCI: Kernel table changes

- Added the kernel names for all unimplemented kernel debug functions, and mapped
them all to kDummy, so that the kernel tables are correct and all kernel
functions are mapped (useful for debugging)
- Added a stub for kWinHelp (normally opens an external Windows help file), with
an appropriate dialog
- Added a stub for kWinDLL, which currently errors out on purpose (this needs to
be investigated, as it loads and uses external Windows DLLs)
- Readded kListIndexOf in kList (the signature was wrong when the previous commit
was made)

svn-id: r52660
"
"30080c7e070aa06fa1fb795db90392d85351a62c","2010-09-09 17:27:02+00:00","MOHAWK: Add initial work on the Riven marble puzzle

The marbles are currently drawn, and you can pick them up, but you can not place them on the grid yet.

svn-id: r52661
"
"5eb0314e4cc94291f4ffb62cd2c7784ff1e26748","2010-09-09 18:26:16+00:00","SCI: Fix last MIDI channel number for adlib driver

svn-id: r52662
"
"61adb401b2e7f515067b5a4561b222a82fc604b8","2010-09-09 18:34:27+00:00","SCI: Cleanup kWinHelp's dialog handling

Don't display the message twice and now we use the filename in the message.

svn-id: r52663
"
"a8afefd64b6707bb48684fcc1d62866a8772cf5e","2010-09-09 20:07:53+00:00","SCI: kIsOnMe is kOnMe, merge both into kIsOnMe

and map kOnMe for SCI2 to kIsOnMe, remove commented out hacks. fix signatures for those 2 functions, added TODO - someone should fix the SCI32 signatures

svn-id: r52664
"
"f446dbc8d5e8cfa90dc90ea3034d9eb7b2252a84","2010-09-09 20:09:32+00:00","SCI: Implemented the kPrintDebug SCI2.1 kernel function, used in Shivers (demo)

svn-id: r52665
"
"8bbbcfe5b8f4c7099d83610c83fe51014e43b6d0","2010-09-09 23:01:51+00:00","SCI: Fix digital track regression from r52662.

svn-id: r52666
"
"4e27844fef5c631bc92fbd9e0e61da7d1d2bfe86","2010-09-10 14:07:32+00:00","SCI: Some changes regarding resources

- Renamed the debug command 'resource_size' to 'resource_info', as it now provides
the location of where a specified resource is found (i.e. the resource.xxx file, or
the file name itself, if the resource is a patch)
- 'duskdump' shows the original location of dumped resources
- loadResource() now shows the location of files that couldn't be loaded

svn-id: r52667
"
"446aa6be8a44ed53372adc106c22ab16e0a5fff5","2010-09-10 20:14:37+00:00","SCI: adding patch for castle brain cipher puzzle

reinitializes puzzle each time its shown. Fixes save/restore bug in that room, bug #3063510

svn-id: r52668
"
"1b469c68d3d75e09ed9427fc3383a8b757602378","2010-09-10 20:25:10+00:00","NEWS: Mention Fascination support

svn-id: r52670
"
"21b96bd374b31df0e9c7ad813746917915cd42b3","2010-09-10 22:08:48+00:00","GRAPHICS: Improve PICT support

PICT images of <8bpp are now supported and paletted images now work when the PixelFormat passed is not 1Bpp.

svn-id: r52671
"
"a002c6f2fd8041876f646784b79255295edef0ef","2010-09-10 23:40:08+00:00","GOB: Fix 2nd Hebrew protection screen in Fascination

Add a workaround to avoid a crash when failing the protection check
This only applies for the 2nd protection screen in the Hebrew version
which is used when the intro is not skipped

svn-id: r52672
"
"77c43f4d0dad81d31a502320e0d423e0f50cb17a","2010-09-11 04:32:53+00:00","TINSEL: Fix for #3032778 - Mute not respected in DW2

svn-id: r52673
"
"70fed746df6ab0ff7fe2c80725fb0c94b8ea821a","2010-09-11 05:28:54+00:00","TINSEL: Fix for #3032780 - Mute not respected in DW1

svn-id: r52674
"
"a71f3aa99c3464665f45571822cf1eada2693cfe","2010-09-11 10:03:31+00:00","COMMON: Fix int-Rational operators

svn-id: r52675
"
"b2be00372217f79d935b687bc3a4bfaa0cb5c894","2010-09-11 13:30:42+00:00","SCI: In kFormat, handle arguments pointing to text resource 0 correctly.
Fixes Colonel's Bequest inventory formatting.

svn-id: r52676
"
"c81c7fd0bc95b1103c7cc0446898c86ac06f1db7","2010-09-11 16:18:55+00:00","i18n: Add lowres context in a few places

Also update the Italian and French  translations.

svn-id: r52677
"
"5cbe8270dd5f036351ed34ec508fe6f3f5ba9746","2010-09-11 16:47:30+00:00","i18n: Update Italian and Spanish translations

The change to the spanish translation fixes bug #3063423

svn-id: r52678
"
"8bc65ccdc7d5e7dc77600cdebc53b141473536dc","2010-09-11 21:23:22+00:00","SCI: Add 1.2M version of KQ5 EGA (0.000.055).

svn-id: r52679
"
"6bc9340df55d05ad7aa6b14348a567304ff41cc7","2010-09-12 07:24:57+00:00","COMMON: Add unit tests for recently fixed Common::Rational bugs

Specifically, the bugs in operators - and / for mixed Rational/int args,
fixed in rev #52675, are tested for.

svn-id: r52680
"
"74118a70878f0b6efcba73f8410a7f661949bcf6","2010-09-12 08:08:37+00:00","TESTBED: Merge gsoc2010-testbed branch

svn-id: r52681
"
"238a10fa522f49fce5064843ba31eeda0bd30681","2010-09-12 08:10:49+00:00","TESTBED: remove unnecessary executable flags

svn-id: r52682
"
"1f986e14af5dd6aab55c322e7edabeb98cb37f9e","2010-09-12 11:43:51+00:00","i18n: Add lowres context in a few places.

I also changed the english text for the GUI Renderer items in 1x mode
as the text was tool long and cut.

svn-id: r52683
"
"f7f5a561eb389d1e31c50fd36b50178f9393c1ef","2010-09-12 14:18:40+00:00","TINSEL: Remove unused variable

svn-id: r52684
"
"09ae34f4a4631b72a0b91ef28ec7658c0c00aed5","2010-09-12 14:20:52+00:00","TESTBED: Fix warnings

svn-id: r52685
"
"161b2e6c798b1499af0a042a73f13c86490b984d","2010-09-12 16:41:13+00:00","TESTBED: Title capitalization and consistency

svn-id: r52686
"
"de6555663d1c19b6658601df4b987d605183aeef","2010-09-12 18:13:14+00:00","Workaround for bug #038837: HOYLE3: EGA/VGA Crashes. Needs further
investigation and a proper fix post-release

svn-id: r52688
"
"bb1c8c3f51cd9856fc3e1629cf31c8f9539221c8","2010-09-12 18:31:10+00:00","VIDEO: Fix rounding the Smacker frame rate

_frameRate is now stored using Common::Rational instead of uint32.

svn-id: r52689
"
"5b6ca46adedf5af0fbfb60600b932f7a35890e32","2010-09-12 19:18:30+00:00","i18n: Update German translation

svn-id: r52690
"
"61a111d82aa5e929a4ae67425ff9f27fcf3f224e","2010-09-12 21:21:21+00:00","i18n: Translate the Save and Load buttons in cruise

This fix Fix bug #3064918 GUI: Save and Load button not translated in
cruise

svn-id: r52691
"
"fc11604e73e7d827699a072b6bc16411144c96ff","2010-09-12 21:35:49+00:00","i18n: Translate the Save and Load buttons in myst and riven

svn-id: r52692
"
"b6488818a549025313e23bfd9c111214cdd3d591","2010-09-12 21:50:52+00:00","SCI: Bugfix for rev #52688.

We can't just set the lockers of script 0 to 1, as at that point
the objects associated with the script are marked to be deleted,
thus we need to reload the script

svn-id: r52693
"
"c073369f0a563baf69f64b21175c481ba671c6b3","2010-09-12 21:56:37+00:00","i18n: Translate Save and Restore buttons in SCI engine

svn-id: r52694
"
"c447b99d4e8947197aa4600f74371017da9e88b4","2010-09-12 22:09:01+00:00","SCI: patching cleanup (+orgbyte/adjust command)

the new commands were meant for castle/brain hangman puzzle patch, but the patch didn't work well, so I removed it. Still the commands could/should come in handy

svn-id: r52695
"
"f656ed2974175a45a1557300d8db91c1fddbba18","2010-09-12 22:54:37+00:00","TOOLS: Add fonts in hugo.dat for DOS version

svn-id: r52696
"
"597eed026611eeaab6d992308677fa59b4f18908","2010-09-12 22:59:32+00:00","HUGO: Use fonts in HUGO.DAT for the DOS version

This is only a temporary solution, to be replaced by a proper .FON
handling. Hugo 2 and 3 (dos) now start.

svn-id: r52697
"
"4ac61cc29058dfa5d18dfc55dcec55afcdace78a","2010-09-12 23:10:31+00:00","HUGO: Fix GCC warning (Thanks MSVC for not showing those)

svn-id: r52698
"
"c6afdbdca393fff7eb18782270587fe323369ef4","2010-09-13 12:19:19+00:00","KYRA3: Add some sound debug output.

svn-id: r52699
"
"bfbb69f77e2ca2656a7beab2cdc58368d88c92a6","2010-09-13 12:50:26+00:00","I18N: Unified messages by removing whitespaces.

svn-id: r52700
"
"c2fb737950bd27d8f86a66a08d3c17b7b734fc1c","2010-09-13 12:53:27+00:00","I18N: Update the catalan translation.

svn-id: r52701
"
"e242814990862998c2af9289f88f0cbc8060fb13","2010-09-13 13:17:55+00:00","SCI: Proper fix for bug #3038837 - 'HOYLE3: EGA/VGA Crashes' and some cleanup

System scripts (i.e. 0 and 900-999) are now protected and never destroyed during a
game

svn-id: r52702
"
"ce657cc0dc3f4aec781aca590f4795477364c985","2010-09-13 13:47:56+00:00","SCI: Changed the script protection code to be a hack for Hoyle 3 only

This shouldn't be happening normally, but apparently it does, which would indicate
a potential issue with the object locking code

svn-id: r52703
"
"9086210a6594f4994631917fd15301488ead89b5","2010-09-13 14:08:18+00:00","NEWS: Added all the newly supported SCI games in 1.2.0

svn-id: r52704
"
"08ebd7123aa0bfa481369100821dbeae7cf5404c","2010-09-13 14:16:08+00:00","NEWS: Merge news for unreleased 1.1.2 with 1.2.0

svn-id: r52705
"
"d73b37972f975db868c40bc8a57e65249fb4fd69","2010-09-13 14:19:16+00:00","NEWS: Updates to the SCI games

svn-id: r52706
"
"0e91370a1d9f597edab4ae02b5e4208d8cd1e09a","2010-09-13 14:21:23+00:00","NEWS: Added missing dots

svn-id: r52707
"
"712a28ea6d12f6d782a6485f5327abe6a08b775c","2010-09-13 14:29:05+00:00","NEWS: Split the SCI games in a separate category, so that Fascination doesn't go
unnoticed

svn-id: r52708
"
"1edd47c9ff3077acd32f56f50d1cbcaa655201ba","2010-09-13 16:01:23+00:00","TOOLS: Add staticfont.h to create_hugo

This file was supposed to be committed in r52696...

svn-id: r52709
"
"c8b8bb3e9cb1afb79e7979d7078fc640b5eca162","2010-09-13 16:16:06+00:00","NEWS: Fix Hero's Quest title

svn-id: r52710
"
"6594f2894d1b5ecd2f7db3ae446471366eee1b3c","2010-09-13 21:14:05+00:00","I18N: Add language name for hungarian translation.

svn-id: r52712
"
"16589af383fa221a8b7be55667c9c4b7a284fb27","2010-09-13 21:17:10+00:00","I18N: Update header for French translation file

svn-id: r52713
"
"3ed22f9f302bcfee10879e7cc1c5cd575bd9be5b","2010-09-13 21:19:58+00:00","I18N: Update German translation

svn-id: r52714
"
"70245181f1fce247ba2f9ffbbd93c4032358d29f","2010-09-13 23:35:55+00:00","SCUMM: Fix for bug #3064655 'Restart with F8 key not working properly'.

svn-id: r52715
"
"dd76a20acd16df90457eb7eb11006902f8e3290b","2010-09-14 00:15:20+00:00","GUI: Fix caret undrawing. (Regression from r48551)

Starting with r48551 the caret undrawing caused the text selection color in
ListWidgets to be removed. It also added a slight offset to the character
next to the undrawn caret. All this is fixed now.

svn-id: r52716
"
"2a353089aa4863be3d0255fe1a8f65dbabb8c2c1","2010-09-14 00:34:12+00:00","GUI: Remove dead code.

This code was added when tooltip support was added. Since we changed the way
how tooltips are drawn later on, this code is not required anymore. Actually
it was never used, but it could've been used to save/restore the state of the
GUI for the tooltips.

svn-id: r52717
"
"efc13c42b29b79bc255ea22693aabe3920455566","2010-09-14 00:44:41+00:00","AGI: Improve support for MT-32 in the MIDI output.

Formerly the AGI MIDI code did not setup the channel mask properly, in case
'native_mt32' was set. This resulted in one missing channel (i.e. channel 0),
since the MT-32 only responds to data for channels 1-9.

svn-id: r52718
"
"f7fa335a1b7aac3ae1688ece525d621dad72d400","2010-09-14 00:47:26+00:00","AGI: Fix compilation.

svn-id: r52719
"
"2315907de565f709a4127810288f266c47ecf533","2010-09-14 05:32:20+00:00","HUGO: Rename some classes for better readibility

svn-id: r52720
"
"2cd25f87cd6869e61d88374d61c8b1176a8e7b24","2010-09-14 12:47:42+00:00","NEWS: Fixed a few SCI entries and space cleanup.

svn-id: r52721
"
"a1b16661de7d573c03aeb04d7be093020a3ff4b0","2010-09-14 14:00:15+00:00","PSP: remove virtual inheritance of BufferedWriteStream and BufferedSeekableReadStream

As Max pointed out to me, one can't really use virtual functions called from constructors/destructors.

svn-id: r52722
"
"9dfb24851c2a5cf5454dfbf63f085f73b8bd17c0","2010-09-14 14:18:25+00:00","COMMON: Remove dangerous virtual keywords.

See r52722.

svn-id: r52723
"
"94b41f5d2e75b43700902c12ba4fd0fd9426b0e8","2010-09-14 14:57:30+00:00","COMMON: remove virtual functions from BufferedStreams

As Max pointed out to me, they don't work as expected when called from constructors/destructors.

svn-id: r52724
"
"8ab435397fd0ee3b24f43cb135489fe70509c578","2010-09-14 19:02:33+00:00","I18N: Update Spanish and Italian translations

svn-id: r52725
"
"f742d2ecc5d2e467e73c5948da46b36c5af4d562","2010-09-14 21:53:22+00:00","SCI: Some constification.

svn-id: r52726
"
"c81f009e8feada22ffe62006fa0e1d6d21f510ee","2010-09-14 22:16:31+00:00","SAGA: Fix audio flags for VOC sounds

This is a regression from r43470 and fixes the speech in the intro.
Bug #3065113.

svn-id: r52727
"
"c74c206f053f4ad0d076bad9e94c559af262dda2","2010-09-15 12:14:34+00:00","SCI2: adding a stub for the kPurge memory function

kPurge is specific to the SSCI memory manager. We have our own memory manager and
garbage collector, thus we ignore these calls

svn-id: r52732
"
"6cf1a4d537c5329778b0ad2234ba985e82e32ce8","2010-09-15 15:21:59+00:00","SCI: Some very early work on kRemapColors (just comments/observations for now)

svn-id: r52733
"
"47c46cdfdeef954ab14761f886204c64d3f9ba83","2010-09-15 19:00:28+00:00","GOB: Add detection for Gob1 CD Polish

svn-id: r52734
"
"bb5db4aa3b67c7270b208fe43d829906f7409b63","2010-09-15 20:28:42+00:00","MOHAWK: Finish implementation of the Riven Marble Puzzle

You can now place the marbles and pressing the button will now only set the power to on if the marbles are in the correct positions.

svn-id: r52735
"
"6588398ce6fab85e287b10c2781d3797d7639cb9","2010-09-15 22:00:20+00:00","MIDI: Send a reset MIDI device signal on startup.

This is currently done in the engine code. I adapted AGI, AGOS, DRACI,
GROOVIE, LURE, MADE, QUEEN, SAGA, SKY, TINSEL and TOUCHE to send a reset
device on startup. The sound output still works fine (started up a game
from every engine), so this should hopefully not introduce any regressions.

As far as I can tell it seems that SCUMM does send a proper device reset, so
I did not touch it. KYRA only sends a proper reset for MT-32 currently. I am
not sure about SCI though.

This fixes bug #3066826 'SIMON: MIDI notes off when using RTL after SCI'.

svn-id: r52736
"
"b9a74a7915246c57a43c8999c4d29f534bfe4cf1","2010-09-15 22:00:43+00:00","KYRA: Send GM reset on startup.

svn-id: r52737
"
"b2c57117fd0749f0c39dbe6b9de65d2c0566ea1d","2010-09-15 22:30:00+00:00","DRACI: Initialize MIDI channel volume properly.

This fixes bug #3067148 'DRACI: Volume range not respected'. It seems Draci's
MIDI files do not setup the channel volume properly before using the channels,
but rely on having the maxed out. Since formerly the channel volume was
initialized to 255, it caused the channel volume to be zero in case the user
used 128 for his volume settings (128*255/255=128, and MIDI volume goes from
0-127).

svn-id: r52738
"
"b77434c415f22aad57251b61014a1d66971c950c","2010-09-15 23:12:29+00:00","I18N: Fix create_translation tool when string contain special characters

The english or translated strings in the PO file might have representations of special characters (e.g. '\n') or protected characters (e.g. '\'') visible as
in the source code. However at run time ScummVM expects them to be
the special characters and not their visible representations. Now the
create_translations tool does the substitution if it finds such characters.

svn-id: r52739
"
"057056b8d335ab3fee8644e066e9db0a06451a90","2010-09-15 23:25:46+00:00","I18N: Add translation for load/save success or failure messages

Also improve and update the french translation.

svn-id: r52740
"
"df91686a36e8571e381a6aa0b4910595899f9bba","2010-09-16 04:43:49+00:00","AGI: Initialise PCjr emulator channels on creation

Because chanGen() gets called very early, and sometimes it crashes
ScummVM as soon as the game starts. Actually, it's probably enough to
initialise a couple of fields in _tchannel[], but I figured it
couldn't hurt to clear all of _channel[] and _tchannel[].

svn-id: r52741
"
"7fea0c00b9a5d7ca66a6baedb2011969030a3963","2010-09-16 09:32:10+00:00","DINGUX: add exec wrapper for scummvm.elf

Add a wrapper to set HOME var when running scummvm on dingux.

svn-id: r52744
"
"59823374852d92cfe4400b5b5fcef5b06e3f5344","2010-09-16 09:37:15+00:00","DINGUX: Add placeholder for dingux specific readme

Add an almost empty readme for dingux, to be filled soon.

svn-id: r52745
"
"039b864688622230bca2acd3cdcd76a562fc8bec","2010-09-16 09:42:21+00:00","NEWS: Switched to Latin numbering for some SCI games

svn-id: r52746
"
"5c4f7ba267c3827edaa5117e3b3063fb7370766f","2010-09-16 12:45:09+00:00","TESTBED: fixed detection

svn-id: r52747
"
"454528f594e446ea8c90cc32ef1669e739f467ac","2010-09-16 12:56:38+00:00","DISTS/FEDORA: Remove mpeg2 and mention SCI

svn-id: r52748
"
"44610eb037a1d087b83311047ec62e515ca0ca1d","2010-09-16 19:50:15+00:00","I18N: fix a buffer size issue with translated save/load strings in AGOS

svn-id: r52751
"
"13421d70326c0afda31813bd679daf2313db4499","2010-09-16 19:54:41+00:00","README: Update and improve About section

I reported changes I made a year ago on the wiki User Manual/Introduction
page. It concerns mainly the supported games (many non SCUMM games
now) and (non-)beta status of ScummVM.

svn-id: r52752
"
"e0794fef7514d85d8d60fd18154b226b5d79b485","2010-09-16 20:02:24+00:00","I18N: Update Spanish translation

svn-id: r52753
"
"16557884b6d694b217877813126859687cc8b59b","2010-09-16 23:00:25+00:00","TOOLS: Add missing data for H1 Dos

svn-id: r52754
"
"c7b38c45101cfcaafc60aaec4a8817c45dffca7c","2010-09-16 23:03:03+00:00","HUGO: Fix H1 DOS initialization

Fix a bug in hugo.dat loading and initialize properly Hugo1 DOS

svn-id: r52755
"
"7835ce5cb8bef41e8c5c40914834a3c623ee6cfa","2010-09-17 03:55:41+00:00","COMMON: Extend getting a Mac resource fork resource with a name

Resource names can be the same across types (ie. 'PICT' 'Foo' and 'snd ' 'Foo'), so this ensures that the right type is chosen in those cases.

svn-id: r52756
"
"88e7bb49957c0ce27536f8f705776abd6dc7f140","2010-09-17 12:37:59+00:00","SCI: Removed some unnamed selector access in the workarounds. Fixes the regression
in the demo of EcoQuest, when opening a window

svn-id: r52757
"
"c6b85c2a876f898deb6c7c6fe1938e33d70cd844","2010-09-17 12:54:00+00:00","I18N: Use a String instead of a char buffer.

This should improve r52751, since String does automatic memory handling, thus
no more buffer overflows should by possible by having a too large translated
string.

svn-id: r52758
"
"091718d3c2a77156df56a710806e3a2efe74e535","2010-09-17 13:27:20+00:00","DOC: Update list of supported games in readme

svn-id: r52760
"
"a13d6ae102fa5971c24bac05537f82ad62733bb1","2010-09-17 13:44:32+00:00","DISTS/FEDORA: Update package description to match readme

svn-id: r52762
"
"8bf677716350c8a4c7b1009b9f97db56ca2e534f","2010-09-17 15:19:18+00:00","SCI2: some very early work on kSetShowStyle

svn-id: r52764
"
"a4383817d3c365e1e5bd63f86b37b87bccaf125d","2010-09-17 15:57:35+00:00","DISTS/FEDORA: package create_sjisfnt tool

svn-id: r52765
"
"04810a89f2dd2e3ef7354a8265ba69c054776642","2010-09-17 16:04:02+00:00","SCI: Use spaces for indentation for consistency.

I think the code uses this in this particular instance to have the comments on
top of the various tables aligned with the actualy entries, so I decided not
to make this conform to our guidelines, but rather to the rest of the style
used in this file.

svn-id: r52766
"
"be569dad405374d499d8c2eede116ba9273d8936","2010-09-17 17:52:17+00:00","GOB: Add detection for polish gob2 and gob3

MD5s provided in bug #3067489

svn-id: r52767
"
"b8e4f0b135bf650db5257fb1a477e32af12cc3eb","2010-09-17 18:03:12+00:00","SCI: Proper initialization in MidiPlayer's constructor.

svn-id: r52768
"
"9efa316a61575bb8c9df0b74880ecb0a786e314c","2010-09-17 19:13:47+00:00","RELEASE: This is 1.3.0svn

svn-id: r52773
"
"3251f71f650f106022e72578cf4b51efd1595688","2010-09-17 19:41:41+00:00","DISTS: Sync a few .in files

This fixes dists/iphone/Info.plist.in not being updated by r50752
and dists/meta.xml.in not being updated by r52074.

svn-id: r52775
"
"cc764cb8ec130060aa97b7bec738c2da8a5089cf","2010-09-17 20:02:03+00:00","SOUND: Move CMS emulator to sound/softsynth.

svn-id: r52778
"
"d477d66f49fb37609b6a989425603d470cb09245","2010-09-17 20:02:29+00:00","SOUND: Properly add CMS as plugin.

svn-id: r52779
"
"a6a49b284a43ba04a6b00dd0157daae050074c3e","2010-09-17 20:02:49+00:00","CMS: Change an incorrect error into debug output.

svn-id: r52780
"
"eb400c87876a306339d27b8ec8510cff2f3abee0","2010-09-17 20:03:20+00:00","SCI: Add CMS driver for SCI1-SCI1.1.

svn-id: r52781
"
"5abbe7204eee6af75348c171abafe2767b416002","2010-09-17 20:03:41+00:00","CMS: Some constification.

svn-id: r52782
"
"9f273b31aab8139e04391b22b27198cacdce4115","2010-09-17 21:28:24+00:00","SCI: Fix compilation on AmigaOS.

svn-id: r52784
"
"99cc8051816fca07a185d1b2612271ff04098d65","2010-09-17 21:40:53+00:00","DISTS/REDHAT: Package png and svg icons

svn-id: r52786
"
"1e9e8cd64a97ade7d8f9ff891e511d47b98da70d","2010-09-17 22:40:53+00:00","HUGO: Fix crash in the first screen of H1 Dos

- Fix crash in the first screen of H1 Dos
- Clean up

svn-id: r52787
"
"928bcdbe094767fefb7c415e098d7d9e47bc078d","2010-09-18 09:47:18+00:00","SCI: Some changes to the fallback detector (sync with branch 1.2.0)

Added more graceful handling of the case where SCI32 isn't built in and the
user tries to detect or start a SCI32 game

svn-id: r52789
"
"6fed6a75d53259f90b69ca951275e11d6c98042a","2010-09-18 09:52:05+00:00","TESTBED: Fix warnings

svn-id: r52790
"
"c91a07229a8bd841e6b6e77d977254c388a2e407","2010-09-18 10:55:16+00:00","JANITORIAL: Removed most punctuation at end of warning() and error()

Our warning() and error() functions always add an exclamation mark
to the end of the message anyway.

svn-id: r52791
"
"a48e19eaef1ce4cad6b877acc7b330a224280405","2010-09-18 11:26:10+00:00","SCUMM: minor cleanup

svn-id: r52792
"
"9cab0a5cfea09342667509a5e6c350bd3c4ab704","2010-09-18 12:02:52+00:00","M4: Added missing breaks to switch statement

svn-id: r52793
"
"53a5ba21ab3d3130e86bcfef48b2d82ccad628e7","2010-09-18 12:08:59+00:00","M4: NULL terminate after a strncpy

svn-id: r52794
"
"5b18bb1aa13e7da895b58a4e413797587365cf96","2010-09-18 12:42:23+00:00","SWORD2: Plug memory leaks.

svn-id: r52795
"
"ae3b6f0aa391a2352d0e2042a05366c5d80668b7","2010-09-18 14:18:48+00:00","SCUMM: Fix bug #3070077 - MMC64: No music when Syd plays the piano.

svn-id: r52796
"
"6537cb6463411c596ad2e8cce10a7f6138fa0841","2010-09-18 14:31:21+00:00","SCUMM: Remove unused code, which was replaced by ScummEngine_v0::runObject in revision 42737.

svn-id: r52798
"
"64f1fc23234256fc9aedccbde3d360efe2e99d78","2010-09-19 08:18:25+00:00","SAGA: Fixed bug #3068840 - 'ITE: ScummVM crashes when talking on the ferry'

svn-id: r52799
"
"1d9d55b1770e81a033a6ea9c4cabc8d0b7def1b5","2010-09-19 10:56:08+00:00","SCI2: Some work on RBT files

svn-id: r52801
"
"433448ff6212a45489d4474143f4cf5e791861a7","2010-09-19 11:44:07+00:00","SCI: Added documentation for the different music patches in SCI games

svn-id: r52802
"
"4edce6d86022bd76774773370203d4b67a95b653","2010-09-19 14:50:28+00:00","SCI2/2.1: Changes to the plane code

Moved some plane related functions inside updatePlane() instead of frameOut(). Cleanup.

svn-id: r52804
"
"965ec170cb019f48d31ee696568ca21d125f33af","2010-09-19 17:50:21+00:00","I18N: Add lowres context for one string.

Also update German and French translations.

svn-id: r52808
"
"971d5ca4b82707b76d3cb70d6e5904c3cb9bb318","2010-09-20 00:02:12+00:00","GOB: Don't crash if getCharData() returns NULL

This happened to me when playing the floppy version of Gobliins 2. I
don't know if it's a fix or a workaround, but the function can clearly
return NULL so let's guard against it.

svn-id: r52813
"
"b006082cf18120185a9ae18a2d926fddde76b941","2010-09-20 14:05:32+00:00","PSP: moved VramAllocator to display_manager.cpp.

It didn't really belong in memory.cpp and we're going to want to include memory.h everywhere.
* * *
PSP: more Vram Allocator cleanup

svn-id: r52815
"
"05f0ebf2620969277ff94ce486e13b19eb46c1c9","2010-09-20 14:09:39+00:00","PSP: Split up PspMemory class.

PspMemorySwap is more specific ie. it only needs to be known by PSP files. It could be put in another file, but not worth the effort.

svn-id: r52816
"
"f7f743ac31d0ec5af6d21aa217dae7387498af42","2010-09-20 14:10:44+00:00","PSP: switch from wrapping memcpy to defining our own memcpy

The advantage is that we get to do inlining and even use lwl and lwr instructions where appropriate. We have to do it ourselves because the PSP doesn't tolerate built-in instructions, but also we have a more efficient memcpy than the lib's.

svn-id: r52817
"
"bd9f9bb06e7e69e4735aacbb75c8d5b3cf66b024","2010-09-20 18:31:59+00:00","SCI: Handle bit 2 of scaleSignal by not updating nsRect values when
it's set. Currently game-specific for Hoyle4; fixes bug #3038424. But
other SCI1.1 games should be tested with a general version of this to
see whether it fixes relevant bugs.

svn-id: r52818
"
"0e86f6aa61730c699a7043e2d8a1cdcf4391650c","2010-09-20 18:45:52+00:00","Make r52818 general on trunk

svn-id: r52820
"
"e9058c57a513e9da1f0304a24a760548f2c6090b","2010-09-20 19:33:58+00:00","CONFIGURE: Rework GP2X/Wiz/Caanoo and OpenPandora builds.

Just some small cleanup to make the building of debug and
release builds follow the convention expected from the
configure flags.

svn-id: r52821
"
"f556a4d852e5c151d416d25708f712420ce4a28a","2010-09-20 20:12:32+00:00","I18N: Update Spanish German and French translations

svn-id: r52822
"
"723a94099e062408ec9b58d5133f74f37e0988d3","2010-09-20 20:18:35+00:00","SWORD25: Fix bug #3032763: 'SWORD2: Mute setting does not work'

svn-id: r52823
"
"610686818811f6e4e39589a9631301fa04054f23","2010-09-20 20:31:56+00:00","SWORD2: More safeguards for mute setting

svn-id: r52825
"
"ba04f31adec555fabf9b7675c4b3bf207cda8ba5","2010-09-20 20:37:34+00:00","SWORD1: Fix bug #3032772: SWORD1: Mute setting does not work

svn-id: r52827
"
"10031f81f6d973ea1828b1e27f81cca8ae15d457","2010-09-20 21:06:15+00:00","GUI: Fix Subtitles speed option cut in Audio tab of game options.

In normal (no scaling) mode and aspect ratio correction turned off, the
height of the Audio tab of the game options was too small and the subtitle
speed option was subsequently cut.

svn-id: r52829
"
"b65c17edc4ecaf8d749fcd54d2552b2be6e88e4c","2010-09-20 21:17:28+00:00","GUI: Give slightly more space to the options label in scummmodern theme

I think I have checked everywhere and it looks good both in English and in
French. This might help for future translations. I am not committing the
change to the 1.2.0 branch though as I am not completely sure it is
harmless.

svn-id: r52830
"
"763c089d06dbe3c14789eff13c98b87380c46a6a","2010-09-20 21:17:49+00:00","AGI: Fix bug #3061578: AGI: PCjr Mode Not Default for DOS Games

svn-id: r52831
"
"18d41096f6dcf6114d97572b20a484ad5a096e9f","2010-09-20 22:10:52+00:00","NEWS: Mention that Hoyle Classic Card Games is now supported

svn-id: r52833
"
"ec80b95580955fc3eba560c5b89f2aad6bd79a57","2010-09-20 22:36:19+00:00","KYRA: Fix RTL from LoL's main menu.

svn-id: r52835
"
"d43ff54a0894c30ea19b10541fd5a7f077892cc9","2010-09-21 05:36:51+00:00","AGI: Changed meaning of pcjr sound device. Now it is Sarien emu

Music drivers:
default: proper Tandy/PCJr
adlib: proper Tandy/PCJr
pcjr: old Sarien emu
amiga: old Sarien emu in Amiga mode
pcspk: Sarien emu in PCSpk mode (quite wrong)
midi: 4 channel MIDI

svn-id: r52836
"
"f994deb4eeda51eb3a73e555b69f44e8ee1a6c6a","2010-09-21 06:05:27+00:00","AGI: Deconfusify the AGI music driver

(After a brief discussion with sev.) AdLib is now the old Sarien sound,
PCjr is the new PCjr emulation. PCjr is still the default; we don't
need to ask getMusicType() how to get there.

svn-id: r52838
"
"c586517b94efa6509a378d38f5f7353d1f53e363","2010-09-21 06:50:29+00:00","ADded translations.dat to pkg files

svn-id: r52840
"
"ca767d5913416d3fcfcec74c15e2b3e30042c22b","2010-09-21 16:05:33+00:00","KYRA2/LOL PC-98: fix sfx rate

svn-id: r52842
"
"88e25e6f2510cf8cee4f48d3c4d4cf6643fc5e2d","2010-09-21 17:18:32+00:00","DRASCULA: Fix invalid memory access on inventory screen

When clicking outside of all inventory objects, the whichObject()
function would return 43, which is an invalid inventoryObjects[]
index. I think that's what caused it to crash for me. There are a
few other inventoryObjects[]-related changes as well.

svn-id: r52843
"
"76f2d3d78b2d88f36ac5d0f241b8a4b21a00024f","2010-09-21 17:57:02+00:00","DRASCULA: Fix bug #3069977 ('Grafic Glitches in text')

If response() loads an image into backSurface, we need to restore the
conversation charset to it once we're done. This may very well fix a
few other similar bugs, but I haven't verified that.

svn-id: r52845
"
"d110685e665300f01d4c3dfe09a99a9f5d4e71ce","2010-09-21 18:43:19+00:00","I18N: Update Italian translation

svn-id: r52847
"
"eb5ede13c3e3acce29d488107bbd59fbd210d067","2010-09-21 19:50:30+00:00","GUI: Quick fix for the mute checkbox label being cut in the in-game options

This happened with some translations as the width of the checkbox was
fixed to 80 pixels, even though more space was available. I have increased
it to 120 pixels.

svn-id: r52849
"
"c63553c234c84f27554bbf28ba3d878587cc8aef","2010-09-21 20:51:45+00:00","DRASCULA: Keep keyboard buffer flushed while waiting for conversation

Otherwise buffered-up key presses can cause dialog to be skipped once
the player finally picks a conversation option.

svn-id: r52850
"
"25c91513f85844eb86fef3b844b32b18785a955c","2010-09-21 21:17:49+00:00","I18N: Update the catalan translation.

svn-id: r52851
"
"3518a3d18fe7c946df055f2e6b8569a482b6176d","2010-09-22 09:56:03+00:00","Added include paths for Symbian^3 SDK support

svn-id: r52853
"
"f155d902c71aa79bccb81bc7dbfddfbe57107ff5","2010-09-22 10:27:09+00:00","Additional include paths for Symbian^3

svn-id: r52854
"
"b11263be90c72619bb360d64d7d06ffcd8addd20","2010-09-22 19:39:54+00:00","KYRA PC-98: fix endianess in music frequency

svn-id: r52855
"
"4b7a9b29fe36a47e7071b6980378a11f31ca9b96","2010-09-22 20:05:10+00:00","AGI: Fix for Bug #3067263 'SQ2: ScummVM hanging on the inventory screen'

This was due to a loop in AgiEngine::selectItems(int n), which lacked a check
that the engine was quitting or restarting.

svn-id: r52856
"
"0db9a4d6b4a5ed8bd7d706dca9835b38ac4b673b","2010-09-22 20:37:03+00:00","HUGO: Fix intro in H3 Win

This fixes the path on the world map, during intro

svn-id: r52858
"
"b9b1905378ee1cd7a67428849925ae0e7ba8fcbe","2010-09-22 21:22:11+00:00","HUGO: Constify char* parameters in Screen

svn-id: r52860
"
"01175256695aedb355c687f9a3205f8a2f6b994b","2010-09-22 21:22:15+00:00","I18N: Update Ukrainian translation

svn-id: r52861
"
"86a7d4382e65632c2b304d503a48ffaa4ab15415","2010-09-23 10:34:00+00:00","SYMBIAN : Updated define for S60v3 detection

svn-id: r52862
"
"9e4dff91641e32c83f4eb0da4858ea467e634a5b","2010-09-23 10:34:45+00:00","SYMBIAN : Remove application resource include not used.

svn-id: r52863
"
"3a3b2cf8623b0da297a0dca906ca032379b202ff","2010-09-23 10:37:10+00:00","SYMBIAN : Add addSysArchivesToSearchSet to support local data files properly. (Instead of using extrapath)

svn-id: r52864
"
"cc4a01433517b683ce9db7f912b269fcc9aa3eb3","2010-09-23 10:39:59+00:00","COMMON : Initialize translation after system has been initialized (to be able to access system specific search paths for translations.dat)

svn-id: r52865
"
"b7911ef0f4342f0d69f9aaf3c9e59f9f7b4ced7b","2010-09-23 20:01:08+00:00","DRASCULA: Play the English 'von Braun' track

The workaround is no longer needed since we provide the previously
missing track. It shouldn't break the game if you play from the CD
either, as the timing appears to be hardwired rather than keyed to
the music.

svn-id: r52866
"
"4807fdb4c70bd21c412914089b493cc190c50fb5","2010-09-23 21:03:20+00:00","PSP: fix issue in ME MP3 code. Release and init the ME when seeking.

Without this fix, the ME allocates more and more memory with every seek until it can't work.

svn-id: r52868
"
"fd3cc727c91da216ccb480fdbf8dc8d59cc39d9d","2010-09-24 00:38:18+00:00","SCI: Implement voice mapping for CMS driver.

svn-id: r52871
"
"a8df677c0494eef00de304734dadda1e1ef593c7","2010-09-24 09:56:50+00:00","SCI: save/restore intensity of sysPalette

fixes bug #3072868
should be save for backporting

svn-id: r52875
"
"be4d61986426da1817443c54d2f7c748408e0ed2","2010-09-25 12:45:12+00:00","HUGO: Add intro for H3 Dos

svn-id: r52877
"
"387753705ac55cce4dced8182e3816475a5a877d","2010-09-25 12:59:35+00:00","HUGO: Fix stricmp use and text color in splash screen

svn-id: r52878
"
"009e48154789696ca1a3920982c9ef836cae8735","2010-09-25 13:39:19+00:00","HUGO: Add H2 Dos splash screen

svn-id: r52880
"
"d4504a3f3af83de9184d39d644b8ef4fd8113079","2010-09-25 14:28:48+00:00","AGI: Fix C64 AGI pictures

The initial screen color needs to be 0 and not 0xf for these. Winnie C64/Apple II should be completable now, with some graphical glitches and palette problems.

svn-id: r52881
"
"744b301b22cf7145245c1ffc5ea8bab2ae3aa305","2010-09-25 14:59:24+00:00","SYMBIAN : Updated version nr to 1.13 in package file

svn-id: r52882
"
"9d50e47de321b193e0996dec84d585c3bb405ce8","2010-09-25 18:07:19+00:00","IPHONE,MACOSX: Sync Info.plist changes with 1.2.x branch

svn-id: r52886
"
"18cd3333c060bb5284f26275a14b7704e79aa440","2010-09-25 19:28:56+00:00","SCI: changes to kAddToPic

kAddToPic doesnt do loop/cel fixups, it also doesnt support global scaling and will only set nsRect on scaled Cels, not reusing fill() of kAnimate anymore, but doing those things separately

fixes kq6 - 2nd window shown instead of peppermint bush (bug #3070465)

should be save to backport

svn-id: r52887
"
"7105e294e2b48c498fd22d555bff0d6851148109","2010-09-25 19:43:36+00:00","SCI: little optimization in kAddToPic

definitely save to backport, belongs to r52887

svn-id: r52888
"
"73c5895ed26d49ae04600be8bf1247335e89fb4d","2010-09-25 20:38:40+00:00","PSP: ME MP3: cache stereo status

Bad timing can cause stereo status not to be picked up if at some point a MAD _header is not initialized.

svn-id: r52890
"
"f965616552a4a0d569a73be0649a11e4dd6dd96a","2010-09-25 20:50:13+00:00","SCUMM: Fix bug #3052804 by reverting NES-specific screen width hack

svn-id: r52891
"
"40e96d8dc582fabed2469dc6f4ec237308d03ad4","2010-09-25 21:09:54+00:00","I18N: Update Spanish and French translations

svn-id: r52893
"
"76992402d7d11ced3c0a676774bb768cc4454d10","2010-09-25 21:54:41+00:00","DINGUX: remove wrong comment and fill the readme with some infos

svn-id: r52894
"
"b1f63deba3afe176646dbf9aae5c22cfab453785","2010-09-25 22:47:00+00:00","GUI: Partial fix to bug #3075649 Fonts not found with buit-in theme

When the locale font are not found when loading the theme, it now
fallbacks to default language (i.e. English) and default font. For this to work
I had to move the TranslationManager initialization before the Theme is
loaded. Therefore it is now initialized when the GuiManager is constructed.

svn-id: r52896
"
"4543855eca837219e3cb69148438db628f264a67","2010-09-26 11:20:55+00:00","AGI: Fix bug in cmd_cancel_line()

We have to update cursor position, not just terminate the input
buffer. This makes Ctrl-C work as intended, which fixes one half of
bug #3054184 ('SQ1 AGI: keyboard special keys are not functioning
properly'). I'm not sure if the second half actually is a bug.

svn-id: r52899
"
"2ab77f2f52942dc57d38e342a4633f74630001aa","2010-09-26 11:27:08+00:00","TOOLS: Add H1 Dos intro ticks to hugo.dat

svn-id: r52901
"
"20a618045943af4df7ac21d298c4a3db4c414129","2010-09-26 11:32:52+00:00","HUGO: Add H1 Dos intro

svn-id: r52902
"
"64017f266ef581701b709c140322147f37df97fd","2010-09-26 11:43:07+00:00","HUGO: Remove extra ;

svn-id: r52903
"
"113e14224dce3fca92dc6a7592dd57e28dfcd24a","2010-09-26 12:07:50+00:00","AGOS: Fix Valgrind warnings on exit.

svn-id: r52904
"
"184833924b851b8da29101b868269b785d17cd17","2010-09-26 12:22:46+00:00","AGOS: Fix bug #3011638 - WAXWORKS: Crash retrieving spear from the crocodile carcass.

svn-id: r52906
"
"ad0200988832697ae2531a45a7ca53870afea6d0","2010-09-26 12:28:26+00:00","AGOS: Hopefully fix bug #3000876 ('FF: Crackling/static popping')

We want the WAV stream in playSounData() to contain the entire WAV
data, but the size we read does not include the eight first bytes.

svn-id: r52908
"
"5537ac91bf6fe1fed9c08a00f26aeab1e38db85a","2010-09-26 15:46:25+00:00","JANITORIAL: Removed unnecessary semi-colons.

svn-id: r52910
"
"432b7b25d9702544a119f9f6d432ea6950027f49","2010-09-26 15:47:13+00:00","SCI: kDrawPic setting _picNotValid on non-front

fixes lsl5 english graphic corruption during taj mahal wakeup, should also fix sq5 1.03 graphic corruption right after scrubbing (bug #3041069)

save for backporting

svn-id: r52911
"
"cd6aa62702461eb9a7907431f86fa3fd66435a18","2010-09-26 18:23:53+00:00","SCI: adding separate status drawing code

now also draws 'IV' in KQ4 correctly. This wasn't the case before because we reused the regular drawing code, which would see the 0xA ('IV') as linebreak

save for backport

svn-id: r52913
"
"8637b75c53225e2fb0dc649f4b060540cd6dd837","2010-09-26 20:21:12+00:00","NEWS: Update NEWS file with GP2X/Wiz/Caanoo stuff.

svn-id: r52916
"
"2e57bcad525cb00d1866b09c2ca2a34877c0fa1f","2010-09-26 20:23:58+00:00","CONFIGURE: Clean up overuse of _exeext for GP2X/Wiz and Caanoo.

svn-id: r52917
"
"3db60d9e441cbf48701d0a0565ac87f6c69b1d15","2010-09-27 20:24:36+00:00","HUGO: Add F3 behavior (recall), little cleanup

- Add F3 behavior
- Move drawStatusText() to Screen

svn-id: r52920
"
"d46f4a2fc0316e32a300752f5260e463118626e4","2010-09-27 21:50:11+00:00","HUGO: Move strlwr to Utils

svn-id: r52921
"
"5d1e26d804dd11ec35f6c96f1ab8fe1378d8ede9","2010-09-28 04:53:38+00:00","SAGA: Initialise _driverType

svn-id: r52922
"
"2d82cc385ddc87c9be0f3799e9d06e60640e6ac2","2010-09-28 18:15:25+00:00","SAGA: Fix an ITE intro regression

(Possibly related to bug #3076822 - ITE: Dialog repeats in intro.)

The p2_a.voc patch file wasn't played. This was because the engine
first loaded p2_a.voc as a replacement for voice resource 4. Then it
tried to load p2_a.iaf and, when it failed, removed the patch data
for the very same resource. Now it only tries to read a patch if it
hasn't already found a patch for the resource. (There may have been a
similar bug in the end credits as well.)

svn-id: r52928
"
"30db851ef005b13d42f41de3a720cc6450722476","2010-09-28 18:55:54+00:00","SAGA: Fix wrong logo animation in some versions of ITE

Not all releases put the Wyrmkeep credits patch in a 'graphics'
sub-directory, so assume it could be anywhere.

svn-id: r52930
"
"2db927c22385586b20a514c5a920bb64b079267a","2010-09-28 19:06:03+00:00","TINSEL: Remove redundant '_Windows' check

svn-id: r52932
"
"07427bed7476fa050fffcedd100b97e0c0aecda2","2010-09-28 19:49:53+00:00","HUGO: Suppress useless parameter in several functions

svn-id: r52933
"
"1d3ce126eac4a7fa479df79009fd0b15ca081109","2010-09-28 20:29:25+00:00","SDL: Fix for 32 bit mode support (untested; might be good for backporting, not sure, somebody should verify)

svn-id: r52934
"
"484bf9c269889f205d7db58e88518e55ea615675","2010-09-28 20:30:50+00:00","ALL: Fixup some #define names

svn-id: r52935
"
"a0c0b934c75bc93f467b9b30f765e31aaf1a1536","2010-09-28 20:31:17+00:00","GUI: Replace GUI_ENABLE_BUILTIN_THEME by DISABLE_GUI_BUILTIN_THEME

svn-id: r52936
"
"ab01f42a4bf33192c43bdae49ddfa9040d013c68","2010-09-29 00:19:13+00:00","IPHONE: The overlay will now always be in the native device resolution

svn-id: r52939
"
"e400554c2dae4890338b89b0f87444949909e732","2010-09-29 00:56:51+00:00","IPHONE/OSX: Updated xcode project, and added icon4.png for iPhone 4

svn-id: r52940
"
"05a08d61c738472c9a49d973b62e10be3d6b1118","2010-09-29 02:57:11+00:00","TOOLS : Fixes for skycpt use, particularly on case-sensitive OS

In order to allow for work on bug #1507756 'BASS: Officer Blunt wrong animation (?)',
the skycpt tool needs to be run, but this was only previously used on case-insensitive
OS i.e. Win32. To get this to work normally on case-sensitive OS i.e. Unix, a number of
corrections were made to the hardcoded filenames to ensure the same case as the
input files.

Minor corrections :
The README was also amended to deal with the pitfall of decompressing savefiles.
Added output of each RESET.* file as processed so offending file can be seen on assertion.
Corrected segfault on missing COMPACT.TXT, so exit is more graceful.

svn-id: r52941
"
"3cb3b1e692c818c0d81691823b6a61fc243ad597","2010-09-30 12:58:52+00:00","GOB: Rename kFeatures640 to kFeatures640x480

svn-id: r52942
"
"13d41dca41982be9a7d56e945d543344b1692c4a","2010-09-30 12:59:18+00:00","GOB: Add kFeaturesTrueColor

svn-id: r52943
"
"b6766f0d7f94b8553b29159f98c91be35e0ca878","2010-09-30 12:59:48+00:00","GOB: Stub setting up of 16bpp graphics

svn-id: r52944
"
"e68b6e9f15b9025cd587273da8eaa089670cc0b0","2010-09-30 13:00:30+00:00","GOB: Remove dither stuff, commenting out most v6 drawing

svn-id: r52945
"
"38e506004101edb6460c695fc62754fb9e951883","2010-09-30 13:01:07+00:00","GOB: Add a new class Surface

This will be the new class managing all drawing, providing
depth-agnostic methods for all drawing operations, including 2
iterator-like classes, Pixel and ConstPixel.

svn-id: r52946
"
"51fd528fe56e00466255d54e1e71b19f34729bfd","2010-09-30 13:02:16+00:00","GOB: Change all drawing to use class Surface

svn-id: r52947
"
"4f2b58b11740c8bdeb728a4798e572e8c9d1d990","2010-09-30 13:02:50+00:00","GOB: Remove the now useless VGAVideoDriver

svn-id: r52948
"
"3ab8bf16a27f34ed865edd7c028d0dff90448622","2010-09-30 13:03:22+00:00","GOB: Create 16bit surfaces for true color games

Enabling basic Urban drawing again

svn-id: r52949
"
"89f946ba3edde6cf1fa3b9d0eddd56aecfaee394","2010-09-30 13:03:51+00:00","GOB: Transparency support for 16bit surfaces

svn-id: r52950
"
"1d17a4157f068a988fd30e821c62cd2148e1a5f8","2010-09-30 13:04:14+00:00","GOB: Remove extra \n in debug warning()s

svn-id: r52951
"
"947540c0891afb42d9753fe2d05bdf4b5753d0ff","2010-09-30 13:04:43+00:00","GOB: Fix 16bit cursors

svn-id: r52952
"
"3c449e19ab6d8f42afba6476ff24bacd3cf32c3e","2010-09-30 13:05:12+00:00","VIDEO: Allow for scaled Indeo3 frames

svn-id: r52953
"
"ce074116969869f9d79de2b08b771c623e6377e8","2010-09-30 13:05:40+00:00","VIDEO: Allow for Indeo3'd VMDs

svn-id: r52954
"
"6bbfac77aff11292ec9fb538ebdc38283053e748","2010-09-30 15:03:51+00:00","VIDEO: Interpolate U and V values

svn-id: r52955
"
"02e759aad3da6e46b3deb6f6124908a4ee6e78b9","2010-09-30 15:22:52+00:00","GOB: Make GCC happier.

svn-id: r52956
"
"305d6fc7f561439fa814ceb095bf3ec75d9954e3","2010-09-30 15:31:31+00:00","GOB: Remove useless variable

svn-id: r52957
"
"7296a2d8d03b7358bdef0e9217f53eb4ee81ce9e","2010-09-30 18:09:01+00:00","I18N: Add translation for wince specific titles for key mapping dialog

Also backport fix from branch on translation of default title for key mapping
dialog.

svn-id: r52959
"
"cc69fa8297e157d96aaa53f79c48febd710fa2fe","2010-09-30 22:22:05+00:00","HUGO: Improve message boxes

- Use OK and YES/NO messages boxes when required
- Empty messages are no longer displayed

svn-id: r52960
"
"4293dbb7f3665e905f9340d7e101607201e097a1","2010-09-30 22:45:24+00:00","TOOLS: Added engine patch for use with skycpt and updated skycpt README

This patch removes the description for required code modification to sky engine for generation of RESET.* files from the README and places it into a patch file. This patch also adds two modifications which are required to get RESET.* with current codebase not mentioned in the README.

svn-id: r52961
"
"2efaedb29b3436c1eae03dad0fba59e2c72747d4","2010-10-01 06:16:24+00:00","HUGO: Fix crash using mouse

Fix crash when clicking on objects without a
default 'TAKE' action (like the hero, the eyes and
the bat in the first screen)

svn-id: r52962
"
"5727cab0f1f1a420a36afb7f524bd64015628861","2010-10-01 09:13:47+00:00","HUGO: Remove viewport variables from _config

svn-id: r52963
"
"8d858738d996421f6288ecce03766f65b565a464","2010-10-01 18:20:41+00:00","MAKEFILE: Add scummclassic.zip to DIST_FILES_THEMES

svn-id: r52964
"
"be1d196da5dbbabaef0bfa835b51e9c82c407645","2010-10-01 19:16:09+00:00","GUI: Error message for theme incompatible with current language

Add an error message when switching to a theme that does not support
the current language (i.e. it does not have fonts for the charset used by
that language).

svn-id: r52965
"
"0d8f4a22ae51d5943014a4c5f3ba610686039a24","2010-10-01 19:24:52+00:00","SCUMM/FM-TOWNS: fix palette and other graphics issues

This commit should fix at least the following bugs/feature requests: #1032859, #1252088, #1055391, #1315968, #1315938, #1742106, #812891.
The FM-Towns version of Scumm games use a mixed graphics mode with 2 layers (one with 32767 colors and one with 16 colors). Among other things I have added a screen output class which emulates this  dual layer approach which allows specific hardware effects like enabling and disabling layers (e.g. in the voodoo priestess scene in MI1).

Old savegames (saved before this update) will load, but youll encounter palette glitches in the verb/inventory screen, since the 16 color palette for layer 2 is not contained in your savegame. This will be true at least for version 5 games. Certain scene change actions (which require the verb/inventory part to be redrawn) might correct this (e.g. try looking at the treasure map in MI1 and closing it). Version 3 games should be okay, since they use a static text palette which is never changed and which will be reset after loading a savegame.

This update requires a USE_RGB_COLORS setting for proper operation. 8 bit users will get a warning that theyll have to expect palette glitches . Apart from that the engine in 8 bit mode should not only still work okay, but also benefit from some of the other (non palette related) improvements (e.g. bug #1032859 should be fixed even in 8 bit mode).

Japanese font drawing hasnt been improved much yet. This will be a separate task.

svn-id: r52966
"
"288d09389e358c1e317a7be72486b7ca46a843b7","2010-10-01 20:44:41+00:00","GRAPHICS: Cleanup.

svn-id: r52967
"
"5541af78b1b3ec506fcdd03c96104c4b10168742","2010-10-01 20:44:58+00:00","GRAPHICS: Add BPP check to Surface::move.

svn-id: r52968
"
"1177692701ccfef3eee94ab092a606c0da631566","2010-10-01 21:41:40+00:00","GUI: Fix bug #3075649 (Fonts not found with built-in theme)

When switching to a theme that do not have the fonts needed to properly
display the current language, it now revert to the previously used theme
and display an error message telling the user to change the language
first if he wants to use the theme he selected.

svn-id: r52969
"
"f94752f7528c406d68353dc75cad4047c4af86a2","2010-10-02 00:08:13+00:00","LURE: Partial fix for #3008511 Goewin getting stuck

This workaround prevents the Weregate from closing whilst Goewin is still within it

svn-id: r52971
"
"a16832760bfd1916ad60938e177a5ca6b920d781","2010-10-02 01:05:16+00:00","1. Added ConfigParams Singelton class to eliminate use of configuration specific static variables.
2. Modified code to handle the change
3. Updated the previously merged obsolete copy of branch gsoc2010-testbed.

svn-id: r52973
"
"b695f68eeee249340b7bcd559265c652c54b593a","2010-10-02 01:08:24+00:00","TESTBED: added data file for midi tests

svn-id: r52974
"
"8dca57e4e9fe6e3d5acf03f96c2b4b4469a888a0","2010-10-02 09:08:05+00:00","SAGA: Fix bug #3065113 with patched sound glitch

Bug #3065113: 'ITE demo: patched sound at intro is not played correctly'

svn-id: r52975
"
"74681b81b36cca67ad0964dda7241efe26ecbd82","2010-10-02 13:25:50+00:00","SCUMM/FM-Towns: limit SCUMM 5 games to 16 bit graphics mode

8 bit mode makes no sense for these games since colors will be too messed up.
SCUMM 3 games (Indy 3, Loom, Zak) are still supported in 8bit mode.

svn-id: r52977
"
"3c9dbdc697884aa7773153410694f935104c5254","2010-10-02 13:26:32+00:00","NEWS: Mentioned FM-TOWNS SCUMM games improvements in 1.3.0

svn-id: r52978
"
"54127a2123cb703ac582a66c42c7686052f927af","2010-10-02 13:27:06+00:00","i18n: Update Russian translation

svn-id: r52979
"
"5d1ab85874842ce268a5808ac1ef3e3ef421eb93","2010-10-02 15:01:51+00:00","SCUMM: update scumm-md5.txt

svn-id: r52981
"
"ad24be827c96b0a944ec6c1f5503a4e2e9b41218","2010-10-02 21:36:47+00:00","I18N: Update German translation in trunk

svn-id: r52982
"
"4a9f2204c4666841b50fdf2fc188c22240010752","2010-10-02 22:11:51+00:00","SCI: Fix typo in testcase

svn-id: r52984
"
"ab46bf0f61b5c18acbd3abbf0f8cd42ccd9f9956","2010-10-02 23:17:03+00:00","SCI: Allow multiple word groups in parse tree leafs

This is to prepare for multilingual SCI versions. In those a single typed word
may be parsed to multiple class,group pairs, any of which may match
the said specs. The actual parsing is not yet implemented.

svn-id: r52985
"
"a6839d5ffdb1a6446ec77f26d6136694592dae13","2010-10-02 23:17:19+00:00","SCI: Fix memleak

svn-id: r52986
"
"77fe52bbd787f1c379061fdfee67eeea248a5465","2010-10-02 23:18:15+00:00","INDY3/FM-TOWNS: fix intro graphics bug

svn-id: r52987
"
"694758fd2a0e98513c436e02cdf13d690fe9565d","2010-10-03 08:08:42+00:00","HUGO: Clean-up

svn-id: r52988
"
"f98536eef5b24bf98730c3b555aeb63ed9de0927","2010-10-03 10:49:42+00:00","SCI: Allow multiple word groups in parser

In SCI01 and up, each typed word may be interpreted as multiple
class,group pairs. This patch adds support to the vocabulary and
parser. It uses the matcher support added in r52985.

This fixes parser issues in German LSL3, but needs testing.

svn-id: r52989
"
"73310fe2376415d7e7807594f59a1d5e027a08f2","2010-10-03 10:49:58+00:00","SCI: Remove unused function

svn-id: r52990
"
"6ca15d0888922e95fe9fdd52c09586e35250d4fd","2010-10-03 14:32:09+00:00","SCUMM/FM-TOWNS: fix drawBox()

svn-id: r52991
"
"40e42f859fa615a7c78231b6926aaf1e071a26e9","2010-10-03 14:52:15+00:00","SCI: Fix textwidth computation for chars >= 128

svn-id: r52992
"
"7f2dfd0f82b0ef8e96ca22338922d601ad2516e1","2010-10-03 14:59:36+00:00","EVENTS: Apply backspace hack to keyrepeat too

svn-id: r52993
"
"718fe1d18f2550a6e5247782229843fdd5d2ef7f","2010-10-03 16:28:31+00:00","PC-98 AUDIO: some code size reduction for the NDS port

svn-id: r52994
"
"c9713bef7c0d6e5e7380491c3b201afa6c1e2677","2010-10-03 17:25:38+00:00","SCUMM/FM-TOWNS: improve merging of graphics layers

svn-id: r52995
"
"8d297f065ad67de8c0986ae33ff5e4520e90d4e4","2010-10-03 18:38:38+00:00","AGI: Properly detect the autosave slot in the save dialog

Forward-ported from branch. Let's do this the easy way for now, even
if I'm not sure why the save dialog shows the autosave slot anyway.

svn-id: r52997
"
"5d7ce32fbd4911f449e614bcf445cb2a26ed30d7","2010-10-03 20:29:22+00:00","SCUMM/FM-TOWNS: fix mouse cursor colors

svn-id: r52999
"
"0596971decae5d64857cf01eb11cf5694043440d","2010-10-03 20:44:58+00:00","SCUMM/FM-TOWNS: cleanup

svn-id: r53000
"
"11d9f1ec54351bcaf8eed8a55a96a474370808d9","2010-10-03 20:58:50+00:00","SCI: Support alternative inputs from vocab 913

This allows the input of accented characters and Japanese using plain ascii
in non-English games.

svn-id: r53001
"
"dffabdfed08f75ed040c087abc090f75c3ad5eb9","2010-10-03 21:38:33+00:00","DRASCULA: Improve French and German subtitles

It adds French and German subtitles to the Von Braun cutscene (see
bug #3069981) and also improve the French translation overall.
Thanks to SimSaw for the cutscene German subtitles.

svn-id: r53002
"
"ce8a2fbbbc658ee31d8621687119b3e1c295560f","2010-10-03 22:41:35+00:00","SCI: Added support for SCI1.1+ magnifier cursors (bug #3034973).

These are special cursors which zoom parts of a view dynamically. Examples
are Freddy Pharkas, when reading the prescription with the whiskey and LB2,
when using the magnifying glass on the Rosetta Stone

svn-id: r53003
"
"c9e3a93c04cb286c2e56c57aa719003e1d3772f4","2010-10-03 23:10:45+00:00","SCI: Added detection entry for KQ5/PC-98 (bug report #3073583)

svn-id: r53005
"
"27745c2143f5e79a0eb12d2b9aa19202d21637fb","2010-10-03 23:55:28+00:00","SCI: Added missing initialization of _zoomBitmap

svn-id: r53007
"
"d1fb1d5b2671f777e0e4ec7fceecfe6c4585858b","2010-10-03 23:56:17+00:00","SCI: Fix AltInput crash in non-parser games

svn-id: r53008
"
"165432ad190cd8b2131580989f2879b9154ec0d1","2010-10-04 06:05:34+00:00","SCI: Several corrections for magnifier cursors

svn-id: r53010
"
"fd4a78292fd81e405fbb66578bae36ac25b67a5e","2010-10-04 08:47:39+00:00","NEWS: Mention improved international SCI support

svn-id: r53013
"
"04a8ff06a21959f3048de5b0d09bbc45b5114f3c","2010-10-04 09:23:06+00:00","SCI: fixing crash in mag cursor code for pharkas

svn-id: r53014
"
"3185b9df424593fa8159734cc0267c825fa3ff8b","2010-10-04 17:03:38+00:00","SCUMM/FM-TOWNS: cleanup

svn-id: r53016
"
"1161714d72efea6f283c166ed9492df9a6bbf755","2010-10-04 17:30:23+00:00","FM-TOWNS AUDIO: minor fix

svn-id: r53017
"
"61afea6cbe527b0c4dedc587e1beb4568f7d379d","2010-10-05 09:14:18+00:00","LURE: Bugfix for #3060480 - Ratpouch alternating between rooms

svn-id: r53026
"
"c8fd37c9f0eca0164f44c07c9013ad6e7e733e2e","2010-10-05 10:30:26+00:00","SCI: Some fixes for zoom cursors

- Now the cursor buffer is initialized outside the mouse movement code, thus saving
a memcpy there
- Plugged some memory leaks
- Removed an obsolete check

svn-id: r53028
"
"c19c9482b2d2cdcacdd12c77d946ca31314931a8","2010-10-05 10:50:22+00:00","LURE: Bugfix for #3008511 - Goewin stuck at counter

svn-id: r53029
"
"0e0ab8b4024bf56bb8000bdf04bda19a0e8e3e00","2010-10-05 16:22:55+00:00","PC98 AUDIO: cleanup as suggested by sev (see devel)

svn-id: r53031
"
"b749b28c09cd2972e130b14260ee4925ef6bec72","2010-10-05 18:54:30+00:00","GOB: Fix text display in Gob3 Windows/ADI

svn-id: r53032
"
"5af782c5d279b0b3b54ee041bb50c8fec2d35fd3","2010-10-05 19:04:52+00:00","SCUMM/FM-TOWNS: disable new graphics code in DS port

svn-id: r53033
"
"77f57cd8f83f07196e25964121d7ad2e489b53fb","2010-10-05 20:11:19+00:00","DRASCULA: Add MD5 for improved French version of the game

svn-id: r53034
"
"2a99d3d4b14e34190cd730bb834c60131324ff0f","2010-10-05 20:59:47+00:00","GOB: Silence compiler warnings

svn-id: r53036
"
"7ffd94004ec7fdf04e83c90a35f7d7910b12a6ce","2010-10-05 21:22:30+00:00","GOB: Try to also open VMD files in Gob3 Win

Because the scripts reference it as IMD, while there are actually
only VMDs files in the data files of the Windows version

svn-id: r53037
"
"b15f51ad7b5e8e85afe970c1740aae566236afe6","2010-10-06 09:55:41+00:00","LURE: Fix for #3062794 - Diermot cannot leave room 7

svn-id: r53039
"
"e47e474cff9823c789626f4b0b26ff69257b5263","2010-10-06 21:26:45+00:00","PSP: rewrote input code and added an input mode

The old input code was getting too messy. A redesign made it easier to modify and add several modes and combos, including one for 1st person games which benefit from a different control scheme. A combo switches between the modes. I also added directional support while the virtual keyboard is visible, using the nub. This allows moving around in the text in some games, and moving the character while typing for others (e.g. AGI)

svn-id: r53042
"
"8e523d9d2fc471ef1ef25ac26b9f7053a382192e","2010-10-07 09:18:15+00:00","GOB: Fix object videos with more than 255 frames

A regression of the CoktelDecoder rewrite.

svn-id: r53043
"
"5ba3475f93013523f7ea3eec3ea30c89315029d4","2010-10-07 11:25:09+00:00","SCI: fixing kBaseSetter on scaled views

adding check, if view is scaleable
also just copying nsRect now instead of recalculating - fixes lb2 regression at the docks (calling taxi hangs the game, bug #3982289) - i noticed this difference before but copying nsRect didnt work back then (i guess because of other bugs), that's why i recalculated it

should get backported, but only after some more testing - maybe someone should play through lb2 again

svn-id: r53045
"
"2879e19b6a95917ea9c7b937ab31d9b7cac41693","2010-10-07 14:40:11+00:00","SCI: unknown valgrind cases->fake 0 when official

we will fake 0 instead of error()ing out in official releases, when an uninitialized temp is read

is supposed to get backported

svn-id: r53046
"
"95118b172e2b2d545f6cdfe32119ce28b062bfd4","2010-10-07 14:57:59+00:00","SCI: Still show warning for uninit. reads in release mode

svn-id: r53047
"
"8fcd25bccec61cdee86e2d28eed19a7395dc3b9f","2010-10-07 15:30:30+00:00","SCI: Added a define to disable room transitions

This is only useful for development, for speedy runs of games, and should NOT be
used in general, as it may introduce graphics glitches

svn-id: r53049
"
"9ec1985a098093ee33e4c06c8ca5df8d9fcca8f2","2010-10-07 15:45:38+00:00","CONFIGURE: add REDUCE_MEMORY_USAGE to N64 and Dingux ports

svn-id: r53050
"
"01c9b1706823b5a872f376a51a94ae3266dad69a","2010-10-07 19:23:49+00:00","SCUMM/FM-TOWNS: improved sfx support for indy4 and monkey2

svn-id: r53052
"
"cf9c948433e123904cd61f9ae67e09453ea1ab74","2010-10-07 19:27:11+00:00","SCUMM/FM-TOWNS: cleanup

svn-id: r53053
"
"cacfefa699363153ca27e8f226ca65539cc4cf10","2010-10-07 20:00:32+00:00","SCI: bugfix for magnifier cursors

When deleting the resources related to magnifier cursors, zero them out
as well. Fixes crash when exiting a game after using a magnifier cursor

svn-id: r53054
"
"7f6fa7e030882e8307dae153eae560d0cb8785ac","2010-10-07 20:18:33+00:00","SCUMM: Silenced signed/unsigned warnings, removed unused variable

svn-id: r53055
"
"9fae823f617cb73219824153f6f2517c08ffec96","2010-10-07 20:48:55+00:00","SCI: Add one more workaround for end of QfG3 Awari

svn-id: r53058
"
"e1a5b5cda15c772fc745538776d73b4609a3f26f","2010-10-07 21:50:47+00:00","SCI: Fix for bug #3083151 - 'QFG3: Long pause while loading specific savegame'

svn-id: r53060
"
"a214e08c0d96f4dbdca21382e3904b351e98ab83","2010-10-07 22:20:22+00:00","SCUMM/FM-TOWNS: minor change in sfx code

svn-id: r53061
"
"8639ca97e6f4bbdbf37b255cb7dc768ac7d51e0f","2010-10-08 08:07:31+00:00","TOOLS: Add RELEASE_BUILD to autogenerated MSVC project files.

This is only done for the release target and not the debug target.

svn-id: r53065
"
"6798b01569ae5ce692d93c470ae2f899c6bfd7ba","2010-10-08 10:35:25+00:00","SCI: add global scaling again to kAddToPic

fixes regression of r52887 - lb2 actors not scaled correctly bug #3083577

needs to get backported

svn-id: r53068
"
"6dcf366b7d5d6700c416d0f6b0c2d8d6bf40bb00","2010-10-08 12:41:03+00:00","SCI: fixing mag cursor as far as possible

added TODO for real proper implementation
at least the alignment and content shown is now correct

svn-id: r53071
"
"744a1829ac4927d2b30fc6ca8c2c064ec7bb6091","2010-10-08 13:33:54+00:00","SCI: Added a check for magnifier cursor multipliers

Sierra SCI only allowed multipliers 1, 2 and 4, and errored out on unexpected
values, thus we do the same

svn-id: r53072
"
"4ad65e5179c4ad5bf71d2bba3eaaeebf9fcef211","2010-10-08 13:50:11+00:00","SCUMM/FM-TOWNS: fixed possible invalid mem access in sfx code

svn-id: r53073
"
"b58bbd719cad79445f496828f1a49465481826ee","2010-10-08 16:31:08+00:00","SCUMM/FM-TOWNS: fixed threading issue in sfx code

svn-id: r53074
"
"47eb6ec1677b404882b2201ebaee1e6a19b485fc","2010-10-08 17:41:09+00:00","DISTS/REDHAT: Don't package dxa script in tools

The script is broken and no longer necessary with SMK support.

svn-id: r53076
"
"28ade1826a8294aeabc21f3e2d5be8e02471f8eb","2010-10-08 18:33:54+00:00","SCI: Support kGetTime modes 2 and 3 in SCI 0_LATE

This fixes bug #3083879 in Iceman.

svn-id: r53077
"
"8785bce1900e8b022773274c3258b468d4aa222d","2010-10-08 20:40:43+00:00","NEWS: set 1.2.0 release date

svn-id: r53082
"
"741e7c7f5ec800bf0209e93da3d6f9ec2869cdb3","2010-10-08 22:17:03+00:00","VIDEO: Factor out handleAudioTrack() to be used by Toons engine

svn-id: r53086
"
"cf82bef02ee2941ddad6664e34f3c94e35e015a3","2010-10-08 22:30:39+00:00","TOON: Merged Toon engine to ScummVM trunk

svn-id: r53087
"
"3aa0345ab3e609f84ba09461a5c89fca0fcc4107","2010-10-08 22:33:58+00:00","TOON: Fixed guard defines

svn-id: r53088
"
"e11637c7bc41d59dc6a666d3f0399b9a699b2443","2010-10-08 22:45:28+00:00","TOON: Normalized include paths

svn-id: r53089
"
"0fc6572b65908f7d3a7d13537afac67f1cc8a68b","2010-10-09 00:17:55+00:00","VIDEO: Remove useless references in handleAudioTrack function

svn-id: r53091
"
"2a984d1d3f2a3df03dea4a269b3b88b85b017e30","2010-10-09 00:26:58+00:00","TOON: Make some static data tables const.

svn-id: r53092
"
"3a0ad4c41c29b745ac3099a8a2df6a682041b4d7","2010-10-09 00:29:10+00:00","TOON: String fixes for motoezx build

svn-id: r53093
"
"0acdaf30b26cfe003bb774471d3d257a37aea378","2010-10-09 01:21:06+00:00","TOON: Merge toondemo game id into toon

ADGF_DEMO already marks it as a demo, so labeling the id as 'Demo' would be redundant.

svn-id: r53094
"
"88416b870d36116a32e33381733599d231f16e88","2010-10-09 01:36:38+00:00","SCUMM/FM-TOWNS: cleanup sfx code

svn-id: r53095
"
"2ab013941a2d338d938e41df0f490ea9ae6475f8","2010-10-09 10:29:11+00:00","TOON: Semicolon cleanup

svn-id: r53096
"
"20e6baca22dad668a71f6632b570dc73d5548521","2010-10-09 10:41:01+00:00","TOON: More semi-colon cleanup.

svn-id: r53097
"
"eef9f7b57b493cfb7712fd47cb961d16e8ce878d","2010-10-09 11:11:26+00:00","TOON: Ran astyle over the toon engine (+ some manual corrections).

svn-id: r53098
"
"571fe5d21eb7967974e5492ff8beab4545de7720","2010-10-09 11:18:19+00:00","TOON: Constify some more tables.

svn-id: r53099
"
"30556795fdcf5983db3dd2dc8a13f472125f934e","2010-10-09 11:27:25+00:00","TOON: Removed unnecessary 'break's (right after 'return's)

svn-id: r53100
"
"212d6cc1f01955a8c54d0aef782a925cd57f1ac5","2010-10-09 11:33:29+00:00","TOON: Fix black spots in title picture.

A 'full palette' is, presumably, 256 colours, not 255.

svn-id: r53101
"
"5ce63fb78f16dde136019f33c942fb19ffcf3c5b","2010-10-09 14:55:33+00:00","KYRA: fix regression in Screen_v2::generateOverlay()

(very noticeable in LOL PC-98)

svn-id: r53102
"
"89fd5b31c1eb9d79648841fc02c0f4cdad8bf433","2010-10-09 16:39:56+00:00","SCUMM/FM-TOWNS: minor fix for sfx code

svn-id: r53103
"
"043a293ae92126b38a65b62708e789fb96affeba","2010-10-10 07:41:13+00:00","HUGO - Fix error in data (H1 Dos)

svn-id: r53104
"
"582bd9a395e13881d96ea7c7cc54d3469d696565","2010-10-10 07:43:12+00:00","MIDIDRV: Prefer PCjr over PC Speaker

If I understand this correctly, if the player's desired music driver
isn't supported (e.g. if you have MIDI as default, and haven't said
anything specifically for Maniac Mansion), it tries to pick the
'best' supported music driver instead. In this case, check if PCjr is
supported before picking PC Speaker.

svn-id: r53105
"
"ced1aba1eac0e8e7891ad44f09ff0877a4fbb3da","2010-10-10 07:43:42+00:00","HUGO: New parser for H1 Dos and H2 Dos.

Add specific parser functions for H1 Dos and H2 Dos

svn-id: r53106
"
"25dac76b3500c23bf13cce359a59ea184f9cbeeb","2010-10-10 08:13:26+00:00","GUI: Ensure that the message dialog is wide enough

The Hugo engine currently uses the message dialog. Make sure that
the dialog is always at least wide enough to hold the 'Ok' button.

svn-id: r53107
"
"178c46c0388c76bd46515aa4d37f681105dafa1e","2010-10-10 08:30:18+00:00","PSP: factored PngLoader out of virtual keyboard for further use

svn-id: r53108
"
"a4c16f7447103c3264d1d4fd1ae3f980e242e604","2010-10-10 09:47:19+00:00","HUGO: Move Dos strings from Parser to hugo.dat

svn-id: r53109
"
"c50a149a35c7ad5d9e4c8aa8a7d2382506caa51c","2010-10-10 09:59:40+00:00","HUGO: Remove sound off when saving

svn-id: r53110
"
"550d340959d897a161d078111e7ec269d3c57797","2010-10-10 10:00:55+00:00","HUGO: Now force initial save

This should fix the corrupted initial savegame problem

svn-id: r53111
"
"bcf3b352853a268afba25a0bdfccefd27191f5c6","2010-10-10 10:11:33+00:00","GUI: Clean up my previous commit.

svn-id: r53112
"
"8e6ce812d1d4b27e048b1a2468ecbb6650e6fe32","2010-10-10 10:26:49+00:00","LOOM PC-Engine: fix regression

svn-id: r53113
"
"af6ffafe5fd6549b5dfce516a6c255cba515f54a","2010-10-10 10:32:58+00:00","GUI: Message dialog width

Ensure the message dialog is wide enough when it contains 2 buttons. This is used by Hugo's engine, e.g. when Exiting the DOS versions.

svn-id: r53114
"
"e5d17fedf79770c8ab6cb866fa4d2ee050576b8f","2010-10-10 11:40:16+00:00","BUILD: Add toons.dat to engine dist files.

svn-id: r53115
"
"440bcaa06034244dc00715bb20afc0b3205aedbc","2010-10-10 13:06:48+00:00","HUGO: Fix 'Exit' command behavior in the DOS versions

svn-id: r53116
"
"2c691e1168b6ebc667b32a4f2b18f3bba17b7146","2010-10-10 14:22:10+00:00","LOOM PC-Engine: fix mouse cursor

svn-id: r53117
"
"7a7eabb139687dd1de434f13b4b622693e6db06e","2010-10-10 14:27:19+00:00","TOON: Fix end of idle animations

svn-id: r53118
"
"0d6d895478dee36170c4c1d909c5f9b3354ec68b","2010-10-10 14:30:13+00:00","TOON: Disable too many levels of recursion with click events

svn-id: r53119
"
"eeb85b54ab4cb08f5fef9f967cd6720f3a74a19f","2010-10-10 14:40:24+00:00","IPHONE: Update XCode project some more

* Add missing M4 source files
* Add missing engine-data files
* Remove redundant library search paths

svn-id: r53120
"
"b1b41da650f5fd94f669becb284dd7c5b5bd8f87","2010-10-10 14:40:45+00:00","TEST: Use TS_ASSERT_EQUALS instead of TS_ASSERT + operator==

svn-id: r53121
"
"f8a6a3dcd22ae4628f989292b6492168ce9f988f","2010-10-10 14:41:08+00:00","IPHONE: Add Hugo + Toon sources; cleanup

In particular, remove references to obsolete files; and sort files in
the project alphabetically.

svn-id: r53122
"
"010fb9825ac9384402fb744713f0955922d727f1","2010-10-10 15:27:39+00:00","TOOLS: Fix typos in specialInfoLine arrays

svn-id: r53123
"
"c952f7aa58e74437b1d8257409a782174b337f83","2010-10-10 15:47:05+00:00","TOON: Added special conversation musics

svn-id: r53124
"
"1f6bc7e3095bcf8cac4daba79859fa1c23deea52","2010-10-10 16:13:55+00:00","TOON: Fix distortion in some looped music

This was very noticeable in the footman conversation music.

svn-id: r53125
"
"67c68afa6dd2fe1fdc300b72a7cf1d867ab38f27","2010-10-10 16:44:09+00:00","FM-TOWNS AUDIO: improve thread safety

svn-id: r53126
"
"927f560eb24b7cbed39e56660c7c7c7b6b7e2598","2010-10-10 16:52:15+00:00","TOON: Fixed bad Flux state when restoring a game

svn-id: r53127
"
"9c56271839dc6100be45bed9f75f5c67ec046907","2010-10-10 20:13:59+00:00","HUGO: Add debug channels to new parser functions

svn-id: r53128
"
"23aa94ec0273058e7fc1d826a654970d2dc71df7","2010-10-10 20:30:36+00:00","TOON: Fix fast animation 'Ready' on Sweetfighter game

svn-id: r53129
"
"aa89bbbcbd8764a5fd7a6d64e902b3b293384f4f","2010-10-10 21:12:10+00:00","TOON: Music attenuation when someone talks

svn-id: r53130
"
"0c6c03bfd6ed0d85564c5b074f38095c2b796245","2010-10-10 21:19:40+00:00","TOON: Fix potential undefined operation warning

svn-id: r53131
"
"85f770599fe6eb7df8efe105d70538e261b835b6","2010-10-10 21:26:18+00:00","TOON: Coding guideline corrections.

svn-id: r53132
"
"97f042e530ce5d198ef3d7cba555652c72222746","2010-10-10 21:26:37+00:00","TOON: Adapt include guard for consistency.

svn-id: r53133
"
"a4c657b8cf1b4ea779d803920f0c3e3c01667457","2010-10-10 21:40:25+00:00","TOON: Made all ToonEngine functions non-virtual

svn-id: r53134
"
"6ebd324be47a90560bb6937eada37f5dabae94b3","2010-10-10 22:13:38+00:00","HUGO: Add specific takeObject and dropObject for H1 DOS

svn-id: r53135
"
"8e36949212e194b9b6516bee214e2a2a91a9603e","2010-10-10 22:23:58+00:00","IPHONE: Sort DEFINES

svn-id: r53136
"
"5ae821ab65d004e164160f66a49327ec8a0f4e7b","2010-10-10 22:24:19+00:00","IPHONE: Remove what looks like redundant defines; cleanup

svn-id: r53137
"
"de8f6484a10daee8819ad98bebb661bcc153e3e8","2010-10-10 22:24:43+00:00","IPHONE: Enable cruise & teenagent; disable sci32

Actually, currently all engines are added to the project, but not all
are activated. Enabling and disabling engines is currently not easily
possible from within the project itself. So for now I manually enabled
exactly those engines which configure enables by default.

A proper solution would be to refactor the project, with (sub)targets
resp. (sub)projects for every engine. We might also want to switch the
iPhone port to use dynamic plugins.

svn-id: r53138
"
"ae89ed580163a3e2866ae432dc46efcd76ec14a8","2010-10-10 22:25:08+00:00","IPHONE: Tweak project file some more

* try to support MacPorts *and* Fink for the (currently not
working? Mac OS X target
* disable C++ exceptions for the release builds, too
* disable SCI32 specific source files for compilation

svn-id: r53139
"
"7642cd002ab8e1eb3f52d15e94d7ac03b24870c0","2010-10-10 22:25:30+00:00","SCI: Fix warning about uninitialized variable

svn-id: r53140
"
"3dda3c073a55a61ead9917a2cca557fdf020fdca","2010-10-10 22:25:52+00:00","GRAPHICS: Turn static AviDecoder methods into local funcs

svn-id: r53141
"
"96e19382b97846e9faeccba46bf1300a6fc06baa","2010-10-10 22:26:18+00:00","IPHONE: Add teenagent sources, plus some more minor changes

* Added teenagent engine souces
* Added some forgotten files for gob and scumm
* Some tweaks to help the simulator targets link

svn-id: r53142
"
"426d6749cf534dec673e958f98711ac64a04f9a6","2010-10-10 22:36:03+00:00","COMMON: work around different vsnprintf behaviour on IRIX


The return value of vsnprintf when the provided buffer is not large
enough to hold the formatted string is implementation-dependent:

C99:  The size the formatted string would take up.
MSVC: -1, with no indication of how large the buffer should be.
IRIX: The number of characters actually written, which is at most
the size of the buffer minus one, as the string is truncated
to fit.  This means the only way to be sure the entire string
is written is if the return value is less than the capacity - 1.

This change means that whenever we try to format a string where the size
is 1 below the built-in capacity, that the capacity will be needlessly increased.

If this turns out to be problematic we could make this behaviour __sgi conditional.

svn-id: r53143
"
"ce97c61079a67317998195415eba4384ad28b12d","2010-10-10 23:10:14+00:00","TOON: Fixed offsets in hard coded conversation musics

svn-id: r53144
"
"ed93a5895515efaff95b7a39e43b4525d254e47b","2010-10-10 23:24:57+00:00","HUGO: Use _targetName for naming save files

svn-id: r53145
"
"c3366755ef6f0614ccc97ad41caaf39c026a3c31","2010-10-11 17:07:34+00:00","PARALLACTION: Fix out of bounds access.

This is a partial commit of patch #3085298 'overflows in agi and parallaction'.

svn-id: r53146
"
"cc0afa92b32661c7c71049aa33a7764b0f9ffa4b","2010-10-11 17:07:53+00:00","AGI: Fix possible buffer overflow.

This is based on patch #3085298 'overflows in agi and parallaction'.

svn-id: r53147
"
"0fd6b7608e29ba56abb4f5084e752a7bfe26a3b2","2010-10-11 17:52:44+00:00","AGI: Fix one more strncpy/strncat issue

svn-id: r53148
"
"8b144960f86cf430ef344ab90226fbdddb37fefa","2010-10-11 19:50:17+00:00","CONFIGURE: Fix for bug #3085292 (--docdir not accepted)

- Handle the --docdir option which was documented but not accepted.
- Reorder the directory variables and their handling to have the same order
everywhere. This will hopefully make bugs like this harder to happen.

svn-id: r53149
"
"576d6429bcf2c7be379c1d3a6d9b916f93b90924","2010-10-11 21:27:28+00:00","TOON: Reduced CPU usage by about 40%

svn-id: r53151
"
"2978053a0094e5c1ba4ab871b3a27a3707197089","2010-10-11 21:41:31+00:00","HUGO: Split classes with multiple version in separate files

svn-id: r53152
"
"b7d8cd1eb57dc46a40a8ed0381b1485c7d8e3421","2010-10-11 22:29:05+00:00","DISTS/REDHAT: Add missing files to rpm

svn-id: r53154
"
"21cb3a62b678de56138de1b5527d202e10dd9916","2010-10-11 23:12:59+00:00","TOON: Reverted script throttle for now and fixed anim timing issue

svn-id: r53155
"
"95c0e6cc4270cc32e371094437c3a2beeb59eed6","2010-10-11 23:14:32+00:00","TOON: Fixed uninitialized var

svn-id: r53156
"
"eb52eb32a065375ef996af438261be3b70a27c33","2010-10-11 23:16:15+00:00","TOON: Fixed Flux disappearing in barn when talking to the cow

Several animations are not present for every Flux facing.
There is an hardcoded table to handle this.

svn-id: r53157
"
"a524209edcf6770d69625e5e49fd8446c21c8469","2010-10-11 23:26:26+00:00","CONFIGURE: Update backends and special host lists.

- Update the documentation of available backends and special hosts based on
the available ones.
- Sort backend/host/case lists alphabetically.

svn-id: r53158
"
"43161858ac14bae4ac6dea114d8b3e7a8c1b293b","2010-10-12 00:26:17+00:00","I18N: Forward-port r53063 (minor lowres fixes)

svn-id: r53159
"
"8388e0dfea4ae0d80e51368acd12685c740c5bb5","2010-10-12 02:18:11+00:00","JANITORAL: Clean trailing whitespaces.

svn-id: r53160
"
"54b2a8c98df204dfe64a27fc830936ec62e3f9ed","2010-10-12 04:19:58+00:00","JANITORIAL: Cleanup (mostly whitespace)

svn-id: r53161
"
"4f4ade6276d3b3263b5f62534da4d208bbd5ca1f","2010-10-12 07:50:33+00:00","OPENPANDORA: Add latest backend code from branch-1-2-0.

* Ooops, forgot to sync this with HEAD. Sorry about that.

svn-id: r53162
"
"a1e7761f6dcb0c38000bb40afdb97a0343cc5246","2010-10-12 14:39:27+00:00","TOOLS: Modified engine patch for use with skycpt and updated skycpt README

The Demo _does_ contain the Save/Load Panel resources, but not the required font #2.
Have updated the patch to allow use of font #0, so the process for the CD demo is now the
same as for the other versions of BASS.

svn-id: r53163
"
"f2d8d71a78520b164e76a47b1792190534625ffc","2010-10-12 19:33:36+00:00","CREDITS: Added qvist to credits per his request

svn-id: r53164
"
"77e70a71877a5d853393de24fc52a9e201b47b58","2010-10-12 19:44:40+00:00","AGI: Fix bug #3017908 with MIDI music

Bug #3017908: 'AGI: No music with the new MIDI patch'
Thanks to Raziel^ for pinpointing the bug.

svn-id: r53166
"
"7e5f66a4c8687c637ce1fa91e5370d4bcc1ea1d7","2010-10-12 20:00:23+00:00","HUGO: enable left diagonals

svn-id: r53167
"
"82e819d48a62970b6b15bfc5a72722203a6651f2","2010-07-29 19:32:17+00:00","SWORD25: Initial dummy engine

svn-id: r53168
"
"dbde2e46e3c44a795b8597ea3c2b6c7503dfbbef","2010-10-12 21:12:50+00:00","SWORD25: Added detection of libtheora, png an dplugged in the engine

svn-id: r53169
"
"7723d91c957d07205c51be32498d45cd0a78568f","2010-10-12 21:12:54+00:00","HUGO: Add lineHandler for v3 Dos, fix/add comments

svn-id: r53170
"
"a683a420a9e43705c972b5e74d55e319729e1a81","2010-07-29 19:53:02+00:00","SWORD25: Importing original sources

svn-id: r53171
"
