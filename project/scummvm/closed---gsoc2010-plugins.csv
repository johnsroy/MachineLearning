"commit id","commit date","commit message"
"07abe3d6038de672d82446b7a2d289977cd972fb","2010-10-13 03:28:59+00:00","SCI: Add detection for Hoyle4 Mac

svn-id: r53397
"
"6527c01cb501958bc04117da3d965b956e77704c","2010-10-13 03:49:54+00:00","GOB: Add Debug Console.

This allows interactive control of debug flags and variables and provides a base to allow
for commands to aid in tracking down script bugs which are tricky to replicate.

svn-id: r53398
"
"c0e2f1c6f8f7df66ae6c090f6c16aea14ebe8bf3","2010-10-13 07:14:38+00:00","TOON: Updated code to build properly for WINSCW and GCCE(symbian)

Added templates to MAX & MIN functions. Correct usage of OpcodeV2(instead of Opcode)
Match implementation with function definition. (int32 is not == int on all platforms)

svn-id: r53401
"
"655e4a961af0bd21b30ec3162b230ed387c1df21","2010-10-13 10:12:35+00:00","LURE: Bugfix for characters getting stuck in Abbey doorway

svn-id: r53402
"
"02322c562cfb27d7519a9ed86d1f2ff99cd379cc","2010-10-13 10:41:30+00:00","SWORD25: Get rid of Kernel::GetMicroTicks()

svn-id: r53403
"
"b3c352d1fee37831408c43155cca91f3d8e42764","2010-10-13 10:50:45+00:00","CONFIGURE: Don't execute a binary just to check libpng version

This fixes detection of libpng when cross-compiling.

svn-id: r53404
"
"85fa23afbe08d6296d716321d95214042d70f9ac","2010-10-13 10:51:20+00:00","SWORD25: Get rid of kernel/bs_stdint.h

svn-id: r53405
"
"59c6223d49c95a0e212c66bd197a6120f8996de6","2010-10-13 11:18:34+00:00","SWORD25: Fixed signed/unsigned bug

svn-id: r53407
"
"a876494fe7fb2653620c4674cfe11cd1bbd5b2bb","2010-10-13 11:20:49+00:00","SWORD25: Stop using class names as variable names

svn-id: r53408
"
"c86c0b6b96c06b89a3dbcc40f4082a39d7b185aa","2010-10-13 11:22:19+00:00","SWORD25: Cast the pointer to unsigned long long

...Instead of to uint, which fails on my 64 bit system where pointers
are 64 bit, but normal ints 32 bit wide.

svn-id: r53409
"
"ab57b38fdf72f6ca0e7459c366ba7daebc9217f3","2010-10-13 11:22:52+00:00","SWORD25: Resolve ambigous write() call on 64 bit systems

svn-id: r53410
"
"80c7fcede046bf3443535217e4d5b08b851cfbaf","2010-10-13 11:24:53+00:00","SWORD25: Remove the unused LUA compiler

svn-id: r53411
"
"c81da6dcb6edb610574fb90ff32fc976b5362ec5","2010-10-13 11:32:08+00:00","SWORD25: Silenced MSVC false positive about a potentially uninitialized variable

svn-id: r53412
"
"ff0160050a7f1a7bd9d338ec6d159fdf714c165c","2010-10-13 11:42:17+00:00","SWORD25: Force cast to uint instead of unsigned long long

As per Fingolfin's request, because apparently there's no long long
in the C++ standard; and ScummVM's hashmap needs uint.

svn-id: r53413
"
"fddc2ab3b99c921b3b4bffdfd6bf28457063fff6","2010-10-13 12:45:14+00:00","CONFIGURE: Use static libgcc on IRIX cross-compile builds (makes them work on vanilla IRIX systems).

svn-id: r53414
"
"30ed39e381648154ab18bd5d80f196a77a50eb7c","2010-10-13 12:57:01+00:00","README: Mention Italian NES Maniac Mansion

svn-id: r53415
"
"681ec592927b8d9a81eed7b1038743bf8e378de2","2010-10-13 13:07:16+00:00","SWORD25: Added a ENABLE_THEORA define inside fmv/theora_decoder.h

This define can be used to disable building of the Theora decoder, and thus makes
libtheora optional (therefore resolving an item in the Sword25 TODO). Disabling the
Theora decoder will effectively disable the game's videos

Note that running the game with the Theora decoder disabled is still untested

svn-id: r53416
"
"f2d9319d9eca6e1d6b30f9aac3230c158ec2a942","2010-10-13 13:27:55+00:00","SWORD25: Renamed ENABLE_THEORA to ENABLE_THEORADEC (like in configure)

svn-id: r53417
"
"d83a70af43a1650b83a4f9295195181074489f2d","2010-10-13 13:32:30+00:00","SWORD25: Renamed ENABLE_THEORADEC to USE_THEORADEC (like in configure)

svn-id: r53418
"
"69e3e55acaf5615281fbc1add0671ed765728fd9","2010-10-13 13:36:55+00:00","CONFIGURE: Fixed a bug with --disable-theoradec and made libtheoradec optional for
building sword25

If libtheoradec is missing then the engine still builds if requested, but the
videos will be disabled (note that running the game with videos disabled is
still untested)

svn-id: r53419
"
"3b49939eabcf87f37be45c68e2e8e2f1959f4066","2010-10-13 13:43:13+00:00","CONFIGURE: Fixed typo

svn-id: r53420
"
"db58a05a5796a6e9cc086434edc173237d1ef2b6","2010-10-13 13:45:50+00:00","create_msvc: Added support for USE_THEORADEC

svn-id: r53421
"
"01b4d4e913bdae5e0ccaec6029ff3312c86c0eb8","2010-10-13 14:00:29+00:00","create_msvc: enable language extensions for SWORD25

svn-id: r53422
"
"de3534fcd3a8c2041b9b8e1d78ed952409726053","2010-10-13 14:13:48+00:00","SWORD25: Include common/scummsys.h in places where USE_THEORADEC is used

svn-id: r53423
"
"62513679c0af9133f7187db6b9de4b59104fa466","2010-10-13 14:21:27+00:00","BUILD: Patch #3086472 'AMIGAOS4: Adding COPYING.BSD and new Icon'

Use the DIST_FILES_DOCS variable so no new document files are forgotten.

svn-id: r53424
"
"090540504db7633bb30fc257a4186b82beb36a0d","2010-10-13 14:33:47+00:00","SWORD25: Hopefully fixed compilation under Mac OSX, Solaris and mingw32

Taken from sound/softsynth/mt32/tables.cpp lines 28-41 (thanks LordHoto)

svn-id: r53425
"
"a3d3e94a8d37240353502e60a0cfa19c44c4fd38","2010-10-13 14:40:32+00:00","SWORD25: Extended Mac OSX compilation fix for sqrtf and atan2f

svn-id: r53426
"
"043f2db0c747c68a9188eba1c58ccc993c0bfa52","2010-10-13 15:00:28+00:00","BASE: Add SVN_REVISION placehold to internal_version.h.in

Our tools/update-version.pl script always keeps this empty.
But it will make integration of the create_project patch smoother.

svn-id: r53427
"
"fa8275f27b69b311c9c64dbb38b524e0c61006fe","2010-10-13 15:00:51+00:00","SWORD25: Don't even compile theora related code when that lib is not present

svn-id: r53428
"
"17f9913a2419c558276a191be07a45ba8f8fc87f","2010-10-13 15:06:14+00:00","SWORD25: Oops, atan2() takes two arguments

svn-id: r53429
"
"8f4f0d16fc4e5cd4803203f2aaeb0ddc99e57204","2010-10-13 15:41:00+00:00","SWORD25: Renamed getInstance() -> instance()

svn-id: r53430
"
"9b4d41d2d2a165a95b3b9223f53196fe51c0b14f","2010-10-13 15:41:34+00:00","SWORD25: Convert object registries to singletons

svn-id: r53431
"
"9755c63292cfa3ede160f30d45b28e6dfe8b53e7","2010-10-13 15:41:55+00:00","SWORD25: Invoke parent's class copy constructor

svn-id: r53432
"
"737c2dd0ba9c5fb609b443da5ec25d520e710129","2010-10-13 17:05:44+00:00","SWORD25: Partially revert commit #53389 and add the custom rule for C files
again, so that LUA can be compiled. It's a hack but at least it allows
compilation of C files for now

svn-id: r53437
"
"a52f986125305ff8dd57e65c2c6d2c53e15064a2","2010-10-13 17:33:13+00:00","SWORD25: Use $(CXX) -x c to build C files (hopefully this fixes compilation)

svn-id: r53438
"
"96e05a1ff9a4ef70c862a3294b989b53cac35691","2010-10-13 17:42:56+00:00","SWORD25: Hopefully fix compilation when libtheora is not present

svn-id: r53439
"
"2880ebdeb4501d7a055cd3bcdb4094310abef236","2010-10-13 17:45:20+00:00","Fixed ifdef. I'm too tired today :/

svn-id: r53440
"
"f9910fd0ee51a07a455ae0153f4b9827b40b2965","2010-10-13 18:13:24+00:00","SWORD25: Don't compile lua.c

lua.c has its own main function which we don't want. Compiling this in for me gives me a Lua console on startup (which probably isn't a good thing).

svn-id: r53442
"
"2dea84947eb9b78053946e61ff273dd562589388","2010-10-13 19:02:24+00:00","SYMBIAN: Add makefiles for TOON Struck

svn-id: r53443
"
"2a49aa1fea9ff87e3d532c5a61153c6ff7aaa908","2010-10-13 19:22:04+00:00","BASE: Added 'Theora' to the features string, when enabled.

svn-id: r53444
"
"bbbfdad4581ce1aab757f1af6e663f9851543baa","2010-10-13 19:33:12+00:00","SWORD25: Check if _LogFile has been created before flushing.

svn-id: r53445
"
"bc2781fdb39b5c7db7154c8dd90538974907508d","2010-10-13 20:04:50+00:00","SWORD25: Semi-colon cleanup.

svn-id: r53446
"
"e52b77dc7b87b8511c8760cf76e8fe057e83302f","2010-10-13 20:05:21+00:00","SWORD25: Worked around crash in options dialog.

I don't really know if this is correct, but aesthetically it goes well
with how the scale factor is treated.

svn-id: r53447
"
"072c5b447c14b895ff90cddf699aedd741c5ff92","2010-10-13 22:15:22+00:00","CREDITS: Add Sword2.5 team. The wording was agreed with them

svn-id: r53448
"
"810f0875997686157e88445448544da6a47428ca","2010-10-13 22:18:32+00:00","SWORD25: Fix empty loop body & conversion warnings

svn-id: r53450
"
"9ca0a6147b0ce336c125ae1c5f9a79c906c6876d","2010-10-13 22:18:57+00:00","SWORD25: Get rid of (deprecated) access to libpng io_ptr

Unfortunately I cannot test this, so watch our for regressions.

svn-id: r53451
"
"e0b69a3061a0e0112a611151e004ea6e6f5b82c2","2010-10-13 22:23:09+00:00","SWORD25: Remove lua.c since it is not needed

svn-id: r53452
"
"320dd0b07147341d72328dd4e51d7cfda468a2b6","2010-10-14 00:03:53+00:00","TOON: Fixed Bug #3084725 with cursor disappearing at screen borders

Bug #3084725: 'TOON: Glitch in cursor anim'

svn-id: r53453
"
"90e12a43fd8e0f6e94f59a52b6794e01200adcc7","2010-10-14 13:05:40+00:00","PSP: clarify and fix up display code

Also added support for stretching images, and fixed up displaying of large images as well as PNG files

svn-id: r53454
"
"7c2254589937d9f35d4779c270c9ef6f426e4b73","2010-10-14 13:19:32+00:00","PSP: added image viewer for viewing images during games

svn-id: r53455
"
"ea5bf685fc5c942be2292223c4af17998b18d8b6","2010-10-14 18:19:51+00:00","SCUMM: Fix bug #2952298 with 16-bit HE cursors on Amiga

Bug #2952298: 'HE (16Bit): Inventory items (Cursors) have wrong color'
This appeared to be generic BE bug. Thanks to jvprat for nailing it down
and providing the patch.

svn-id: r53456
"
"00a477fa79c3b9d5317203a9f839fac04ffe8b1d","2010-10-14 18:51:11+00:00","TOON: Fix some labels of the Spanish version.

The solution was suggested by Strangerke after realising it looked like a
copy-paste typo from the Russian version.

svn-id: r53458
"
"f67bbc4eccd483e329845c05c8aa2dc5ab6f8215","2010-10-14 20:44:44+00:00","SWORD25: Attempt to optimize movie rendering

Current code makes about 5 blits of each frame which is a huge
overhead. This code is an attempt to make that 1. Doesn't work yet
as the rendering pipe keeps blitting invisible pictures.

svn-id: r53459
"
"a4537b84bd19ede43c4882012be4d52f6347c189","2010-10-14 22:11:17+00:00","PSP: made image viewer reset to the first image between engine loads

svn-id: r53460
"
"06c2b6bace8af0ddcbaff9a032c0f6eabddd22e8","2010-10-14 22:27:48+00:00","TOON: Fixed the Spanish special characters.

- Wrap the text to font mapping in a function to give more flexibility.
- Add mapping of the opening exclamation and question marks to the common
mapping array.
- Added a special case for a character already mapped incorrectly in the
original interpreter, which seems to conflict with what's required by
the other languages.

svn-id: r53461
"
"6fc10aeeac5551d9402456e4f1e4df7c9bb2ab2c","2010-10-14 22:33:32+00:00","PSP: made image in viewer movable by pushing nub continuously

svn-id: r53462
"
"dad3f32278436be0831ac19393d4dc77d0b634ea","2010-10-15 03:33:54+00:00","MACOSX: Fix make bundle when compiling with libpng

svn-id: r53463
"
"089988c11c379e1b48c198a867215365373f6b11","2010-10-15 04:37:44+00:00","GOB: Fix Code analysis warnings

See bug report #3087831

svn-id: r53464
"
"bacbf0890071c51f064bb13d7c341e7d8cdf1da2","2010-10-15 05:50:19+00:00","Bug #3087858: fixed null pointer dereferencing

svn-id: r53465
"
"6049a370b364b84a2d71aa9a5a9db83b704fbe78","2010-10-15 06:08:42+00:00","HUGO: Fix NULL pointer dereferencing

svn-id: r53466
"
"e5ec399c55a616379c9c9c400d1eb96b24e9f15c","2010-10-15 06:12:23+00:00","SWORD2: Fix some code analysis warnings (bug #3087857)

svn-id: r53467
"
"bd18e20f7d429c908a1adea943b5c8b1c9800a90","2010-10-15 06:16:27+00:00","HUGO: Merge engine and hugo files

- Move initNewScreenDisplay to display.cpp
- Merge engine.cpp and hugo.cpp

svn-id: r53468
"
"63cb05135142a55a542d1bc0d65093017c6d73d2","2010-10-15 08:29:23+00:00","LURE: Fix for #3087842 - Code analysis warnings

Only the warning for res_struct.cpp is valid to be fixed

svn-id: r53469
"
"764eaa554ce2633e9a927f7264ff3ca57ee5650d","2010-10-15 08:49:20+00:00","AGI: Fix some code analysis warnings (bug #3087825)

svn-id: r53470
"
"168670acb2924b64df59452a34c15888c62b4a4f","2010-10-15 08:52:22+00:00","TINSEL: Fix for #3087863 - Code analysis warnings

svn-id: r53471
"
"b0923dfd763efc88bf9ecc6870cbe4b97605ab13","2010-10-15 08:57:18+00:00","CRUISE: Fix some code analysis warnings (bug #3087829)

svn-id: r53472
"
"9b9e8f7d8dd8858d49c9dabbf07eab0cde6ec919","2010-10-15 09:08:54+00:00","DRASCULA: Fix some code analysis warnings (bug #3087830)

svn-id: r53473
"
"96585f24d97f548d63652585fcfaf6d1599a1aac","2010-10-15 10:52:23+00:00","SWORD25: Fix unloading of movies so the menu animation properly loops

svn-id: r53474
"
"f8c15c90ffc6c89ed3696d7dcb76f783244acf5d","2010-10-15 12:16:57+00:00","SWORD25: Fix a few global constructor warnings

svn-id: r53475
"
"2b5de8c8921d8ec012c689597870e5ae781e3b81","2010-10-15 12:17:20+00:00","SWORD25: Adapted a few things to our code formatting conventions; translated rest of graphicengine.h to german

svn-id: r53476
"
"550073ee049ba30d84cb76c82fb18c045b07569f","2010-10-15 12:18:19+00:00","SWORD25: Do not use Kernel::GetService directly anymore

svn-id: r53477
"
"f52b31a05f9b234a367dd83b89cceaa3d9848204","2010-10-15 12:18:41+00:00","SWORD25: Typo, cleanup

svn-id: r53478
"
"36cd5caf956c087995a62983ad09c15250f29475","2010-10-15 12:19:13+00:00","COMMON: Add XMLParser::parseIntegerKey variant accepting a Common::String

Almost all places where we used XMLParser::parseIntegerKey were using
it like this:
XMLParser::parseIntegerKey(str.c_str(), ...)
Since this makes the code harder to read, I overloaded the method to
also accept Commmon::String directly.
Also removed all .c_str() invocations where necessary.

svn-id: r53479
"
"2fed5ff83244d6d66199239c3753e5934ed18b7b","2010-10-15 12:19:34+00:00","COMMON: Move XMLParser method impls to .cpp file; make skipComments non-virtual

svn-id: r53480
"
"34cc54eaa92d0aa02c8c61b6c3522776971988b2","2010-10-15 12:28:56+00:00","Add doxygen comment for namespaces of several engines.

This is an empty template which ideally engine maintainers
would update and complete with concrete information...

svn-id: r53481
"
"7cdddd5ffb1501e5612a77c91aa282fc19cf2bed","2010-10-15 12:40:24+00:00","SCI: Fixed code bugs from bug #3087872 - 'SCI: Code analysis warnings'

svn-id: r53482
"
"42f2a131553cf0e8e1fd30beba7402c6530513ea","2010-10-15 12:41:11+00:00","Reverted revision 53456, as requested.

svn-id: r53483
"
"4ccce198761e9e7da5ec495345515f7ddf922743","2010-10-15 12:48:19+00:00","ENGINES: Enhance namespace comments a bit

svn-id: r53484
"
"c1e47e0e60249eec5f4445de245a53f0a800e136","2010-10-15 12:56:17+00:00","SAGA: Added sanity checks for realloc() calls - bug report #3087852

svn-id: r53486
"
"9717686337d7acd83ed3e46daa57e929d3e632df","2010-10-15 13:00:19+00:00","MADE: Fixed bug #3087849 - 'MADE: Code analysis warnings'

svn-id: r53487
"
"e74e4814e43724eb9dc5b1cdece8958a03257135","2010-10-15 13:07:31+00:00","SWORD1: Fixed bug #3087855 - 'SWORD1: Code analysis warnings'

svn-id: r53488
"
"04973e85be84db4ac5a71a7012eb68c8e52af3c4","2010-10-15 13:11:34+00:00","VIDEO : Corrections to QDM2 codec for bug #3087917 'Code Analysis Warnings'

The first correction was to use a temporary variable to remove the possibility of a memory leak when using realloc.
The second correction was to remove the gain variable from QDM2Stream::qdm2_calculate_fft() which has always evaluated to 1.0f and so has no effect.

svn-id: r53489
"
"5c48c3fd2b5a229e125455b3f5c23f4773b0191e","2010-10-15 13:54:23+00:00","GOB: Remove strncpy0()

Replacing it (and some strncpy + manual terminating) with
Common::strlcpy()

svn-id: r53490
"
"835455798f2e9876f28a9cb25d354545e6b28715","2010-10-15 13:55:18+00:00","GOB: Remove the now useless helper.h

svn-id: r53491
"
"81de95671c4a7bfc546db81c90a0a8b4a31349b1","2010-10-15 13:55:46+00:00","GOB: Properly fixing the captureCounter code analysis warning

svn-id: r53492
"
"ccb35067199abdc0291d3ebbb55c85a9cea3fa8c","2010-10-15 13:56:14+00:00","GRAPHICS: Fix code analysis warnings

See bug report #3087917

svn-id: r53493
"
"36d7ec96b926d25942d8e1d768d6b63237e38e86","2010-10-15 14:14:10+00:00","KYRA: Fix valid warnings of bug #3087837 'KYRA: Code analysis warnings'.

svn-id: r53494
"
"d221176c47d33618be8ab8f3a81da6384037d751","2010-10-15 14:14:33+00:00","CRUISE: Replace some strncpy with strlcpy.

svn-id: r53495
"
"8fc3c21bd0d2b3030284c3be4656240bff37d667","2010-10-15 14:14:51+00:00","COMMON: Attempt to silence MSVC warning in Common::gcd.

svn-id: r53496
"
"5c102d4f082e6e05048cb06e87ff40a17c43207d","2010-10-15 14:18:58+00:00","COMMON: Silence gcc warning introduced with r53496.

svn-id: r53497
"
"f3270f1957c89f92480c90824714b6574affd774","2010-10-15 14:33:57+00:00","SCI: Fixed access to dest in kTextSize() (thanks LordHoto)

svn-id: r53498
"
"abcceb8a4eb96fd864cb38bec401974a44e33661","2010-10-15 14:37:50+00:00","QUEEN: Fixed code analysis warning - bug #3087851

svn-id: r53499
"
"c2e08538ee87e156720e6adc5da0bdb090df6a39","2010-10-15 15:05:23+00:00","M4: Fixed code analysis warnings - bug #3087845

svn-id: r53500
"
"59618570492a5ebb90c5cf9f6316cd7aed1328b0","2010-10-15 15:17:49+00:00","TOON: Fixed code analysis warning - bug #3087867

svn-id: r53502
"
"db369838e20dc29a6bb1ebc2455ca17f0add069b","2010-10-15 15:23:53+00:00","AGOS: Fixed code analysis warnings - bug #3087828

svn-id: r53503
"
"7f43ed3f9dd3a899a5891e17c3eaa58dc3fd29ad","2010-10-15 15:40:36+00:00","SCI: Changed the check for vertex_min into an assert (thanks wjp)

svn-id: r53504
"
"e7ff1574efc0d69ba39c6e5acf27a1215a764048","2010-10-15 15:51:59+00:00","M4: Fixed OP_NOT and OP_COMP behavior again (thanks wjp)

svn-id: r53505
"
"4306a6557769d7d7f42d45b81bd62d4b6a17283c","2010-10-15 18:20:01+00:00","COMMON: Revert attempt to silence MSVC warning in Common::gcd.

svn-id: r53506
"
"08afc68df0dd237ed27895135af51d66d76ef994","2010-10-15 18:20:21+00:00","COMMON: Extend workaround in HashMap code for sgi IRIX MIPSpro to also apply for Intel's C++ compiler.

svn-id: r53507
"
"cf8b58998417b6735b8e69b9cd4673a3c3204f34","2010-10-15 18:30:29+00:00","COMMON: Made some constructors explicit, where we wouldn't really like implicit conversion.

svn-id: r53508
"
"10bd159d0dfe4238c4df379b1740d098ce8dfa31","2010-10-15 19:08:56+00:00","SWORD2: Add assert()s prompted by code analysis warnings.

See bug #3087857.

svn-id: r53509
"
"b184d7bbdb109d1d123ebb5cf87fe3d2febe1865","2010-10-15 19:10:18+00:00","SCUMM/FM-TOWNS: improve japanese font drawing in SCUMM 3 games

svn-id: r53510
"
"9744167adc35ea945eaef333e76696b1d6feaeb7","2010-10-15 20:01:13+00:00","SWORD25: Fix infinite recursion

If I understand this, we don't need to call Kernel::GetInstance()
when we are already in the Kernel class. In this particular case,
_RegisterScriptBindings() is called from the Kernel constructor, so
it gets called again and again because _Instance hasn't yet been set.

svn-id: r53512
"
"effe45e5814ba6ec764df1a31263d377aec75e6e","2010-10-15 20:32:46+00:00","TOON: fix Ä umlaut and ' char in german version of toonstruck

svn-id: r53513
"
"5ba92baa9fbf798a30da9c7cfe09fa31fd304854","2010-10-15 20:52:29+00:00","TOON: readding spanish special chars removed in r53513

svn-id: r53514
"
"41e9691e86168ab9814aa9f2b15a0e35320c7a14","2010-10-15 21:12:42+00:00","SCI: fixing view-undithering for laura bow 1

(cupboards in room 43, just in the room to the left from the start)

svn-id: r53515
"
"e868dcd804ce053ca6813e8976570bdc042fead9","2010-10-15 21:13:35+00:00","LURE: Fix for #3087842 - Code analysis warnings

This is a somewhat cleaner version than my previous commit

svn-id: r53516
"
"9cc51096c08feb7102d09fb08f4b3a3e1cd41dcb","2010-10-15 21:16:36+00:00","SCI: updating comment for r53515

svn-id: r53517
"
"87b5598720a2d2ddad8f785c740e0aa435c631f6","2010-10-15 21:26:05+00:00","SCUMM/FM-TOWNS: fix up/down inventory arrows in Indy 4 Japanese

svn-id: r53518
"
"af52d3a7f631cc4ff64f41ae7bfe20141de263c2","2010-10-15 21:48:46+00:00","SCUMM/FM-TOWNS: fix display of dialogue options in Indy 4 Japanese

svn-id: r53519
"
"906704b213aac71aacd3ff029b359dcc99461247","2010-10-15 21:58:34+00:00","TOON: Fixed bug #3084738 with loading bottomless bag state

Bug #3084738: 'TOON: Vanishing bottomless bag'

svn-id: r53520
"
"19272595e746ad7fb867eaa2bea5d1c46543c965","2010-10-15 22:05:54+00:00","TOON: Fixed Bug #3085978 with 'Exit Not Defined' appearing

Bug #3085978: 'TOON: 'Exit not defined' when leaving cellar'

svn-id: r53521
"
"ffbca0786d8c37b22e8822f7297c3e0ee6f65207","2010-10-15 22:19:27+00:00","SCI: fixing iceman undithering door close-up

room 9 (go up right at the start)

svn-id: r53522
"
"63c30e959fb9dc6ff40fd8cb4d3d4a4969f5e019","2010-10-15 23:28:09+00:00","SCUMM/FM-TOWNS: fix regression in non Japanese SCUMM 3 games

svn-id: r53523
"
"2c2ca3e353e3f9dec82c7ad10f8eaf2d984a2e5b","2010-10-16 00:17:19+00:00","TOON: Fixed bug #3086000 there was no magnifier effect

Bug #3086000: 'TOON: Magnifying glass cursor drawn incorrectly'
Zoom magnifier postprocess fx has been implemented

svn-id: r53529
"
"59e9db845055dd326d1beaf94b67aa472c677e24","2010-10-16 01:03:21+00:00","CREDITS: Added Toon engine

svn-id: r53530
"
"3b69f1cae63a5ddb47d159f57c5dfa93ce78d71f","2010-10-16 01:15:09+00:00","CREDITS: Sync credits with r53530.

svn-id: r53531
"
"ea9679cf72b15464999e4cf6e9ba4dbedee3f658","2010-10-16 12:02:59+00:00","SWORD25: Update svn keywords

svn-id: r53537
"
"e6ae9c4d984a48539604237f4d76dc1cb6002ae6","2010-10-16 12:04:22+00:00","SWORD25: Use C-style comments in C files

svn-id: r53538
"
"7b50c2e3c3affcb242d096f30e59f3856b267b03","2010-10-16 15:14:09+00:00","TOON: Fixed Bug #3086564 with freezing conversation

Bug #3086564: 'TOON: Conversation freeze'
There was an error in hardcoded conversation flag function
Fixed also all endianess problems in conversations

svn-id: r53539
"
"fff20668728536cf5077714b214ad69d79be5cc3","2010-10-16 15:44:50+00:00","TOON: Fixed bug #3085999 with bad mouse button behavior

Bug #3085999: TOON: 'Exiting inventory screen loop'
Now the events are fired on mouse down instead of on mouse up.

svn-id: r53540
"
"291f39044f0b6745f44b3a4fc2ce9cfcf76145e5","2010-10-16 15:49:48+00:00","TOON: Removed useless debug printf

svn-id: r53541
"
"de1b17fb99a8351244721f6c595a2ed539f6afc2","2010-10-16 15:55:11+00:00","TOON: Fix inventory autoclose when the click is too long

svn-id: r53542
"
"49fc73e3be33163b63d7a3114bdc27032f5ffdde","2010-10-16 17:06:10+00:00","TOON: Fix bugs #3085967 and #3085969 about guards dance

Bug #3085969: 'TOON: Missing dialogue for Palace guards dance'
Bug #3085969: 'TOON: Missing dialogue for Palace Guards sequence'

svn-id: r53543
"
"c9f9c75a838719921003287af6c44625ee71352c","2010-10-16 17:25:08+00:00","GOB: Extend debug console variable command a bit

...So that it's actually useful

svn-id: r53544
"
"748e00f1cf30e9690532bd98087de2e65ca2bac2","2010-10-16 19:27:11+00:00","TOON: Implemented the 4 different mute modes for sound/text

As specified in the hotkeys screen (music,dialog,sound,text on/off)
Sounds are still played but with a volume = 0 (for timing issues)

svn-id: r53545
"
"bc5f10a55c0c19d3d90d2c9f4ed9909787718126","2010-10-16 20:48:51+00:00","SCI: Add The Black Cauldron (fan game)

svn-id: r53547
"
"40d38fcc0d8c63036132a7aab643a7405ef5f43f","2010-10-16 21:58:33+00:00","TOON: Added most of the remaining Advanced Engine Features

Loading/Saving during runtime, Advanced Pausing,
Load savestate via launcher, RTL

svn-id: r53549
"
"4d28de5623480788afbd4b21668db08556f1e3aa","2010-10-16 22:07:09+00:00","TOON: Prevent quick load/save when it's not currently possible

svn-id: r53550
"
"728a231d7b8b392b933e507f17f20afe91fd0eed","2010-10-17 12:44:56+00:00","SCUMM: Fix bug #2952298 - HE (16Bit): Inventory items (Cursors) have wrong color.

svn-id: r53552
"
"c841c3fb7c9b93d48512c4480753ca409770990f","2010-10-17 13:08:00+00:00","SCUMM/FM-TOWNS: more improvements to japanese font drawing

- made use of LordHotos graphics/sjis code to reduce code duplication
- japanese mode for version 3 and 5 works fine now with few exceptions (some line spacing glitches in MI1 intro etc.)

svn-id: r53554
"
"365cb758fb9d1751981884585aa84bf9cd14a53b","2010-10-17 14:11:06+00:00","GRAPHICS: enable sjis code for scumm engine

svn-id: r53555
"
"7706f90c71b86ed13fb3cf941411382c2f57b4a9","2010-10-17 22:56:11+00:00","SCI: Added comments for the unmapped SCI2/SCI2.1 kernel functions

svn-id: r53556
"
"3dc498c5ece33f790972ead8656b8bafb10c8730","2010-10-17 23:45:57+00:00","SCUMM: Fix Macintosh demo of Putt-Putt Joins the Parade.

svn-id: r53557
"
"1d60fc45f293f62877e39194a797edc38e6593c0","2010-10-17 23:52:33+00:00","SCUMM/FM-TOWNS: more improvements to japanese font drawing

(MI1 intro is still not right)

svn-id: r53558
"
"f40e427ab08aaaf83efbb220d6be082fd0a362a1","2010-10-18 00:43:49+00:00","SCUMM: Correct incorrect demo entry for Backyard Football 2002.

svn-id: r53560
"
"34ff8269185dded206173796383eb3bd4732c769","2010-10-18 04:23:30+00:00","SCUMM: Check the sound channel is valid, before checking the sound channel.

svn-id: r53561
"
"ada933c2ad25bce6200d0edfb0df73ecca17b764","2010-10-18 04:25:53+00:00","SCUMM: Check the sound channel is valid, before checking the sound channel.

svn-id: r53562
"
"ae63e206618821e3e2550927851353ac6aafaae6","2010-10-18 10:26:27+00:00","SWORD25: Fix for Valgrind identified errors

svn-id: r53563
"
"a5cbff237284d85774ad17eca1ef0e6a5218c62b","2010-10-18 10:40:46+00:00","CREATE_MSVC: Added support for libpng as well

svn-id: r53564
"
"81f71f48c24e6d0e7c4550b6b6e6372a3d9b14ac","2010-10-18 10:58:22+00:00","SWORD25: Fix Valgrind reported uninitialised errors

svn-id: r53565
"
"35af08619df28db3a3487523a6cb5cc202b4c87e","2010-10-18 11:09:36+00:00","CREATE_MSVC: Added a missing check for sword25 and reordered some engine checks alphabetically

svn-id: r53566
"
"3b21db16188899eac9914fe1c3b32b311a3aa344","2010-10-18 16:00:07+00:00","SCUMM: Fix parts of bug #3087898 (SCUMM: Code analysis warnings)

svn-id: r53567
"
"3feac393b0c951c53d96181b320dd42f5c725f35","2010-10-18 17:12:00+00:00","SWORD25: Renamed Lua .c files to .cpp and make it compilable

svn-id: r53568
"
"c360aa9d142f038785a9805972cc6950398a4443","2010-10-18 17:13:03+00:00","SWORD25: Fix warning

svn-id: r53569
"
"5d08ad157d903c61d788edfee97854aa9a162503","2010-10-18 17:42:24+00:00","CONFIGURE: formatting fix (and kick the buildbot full rebuild)

svn-id: r53570
"
"d69a63c14506a2d7182f4193a922cf6bd06c857b","2010-10-18 18:43:13+00:00","SCUMM: Move common code from ScummEngine::fetchScript* to new method.

The new method is called refreshScriptPointer(). Also renamed
getScriptEntryPoint() to resetScriptPointer() in an attempt to highlight
both the similarity and difference between the two.

svn-id: r53571
"
"6175c2bb190c1ef8280852a5ac01752666ee0de9","2010-10-18 18:55:24+00:00","SCUMM: Fix potential bug in ScummEngine::resStrLen.

In particular, it might happen that ScummEngine::resStrLen is called
while the _scriptPointer is stale. In that case, it would be working
with the stale pointer. If the code calling it then uses fetchScript*()
methods to read the string whose length was just computed, then it would
read potentially *different* data (e.g. copyScriptString or
loadPtrToResource could have been affected).

I am not sure if this actually could have caused bugs somewhere; it might
even be provable that a script relocation cannot happen in all places
that invoke resStrLen. But for now it's much easier to make the code
safe than to verify that theory ;).

Also simplified some related code.

svn-id: r53572
"
"32f1a9ad8bd31ebdd786c78c0234bf6a4e46d138","2010-10-18 18:56:20+00:00","SCUMM: Add paranoia check

svn-id: r53573
"
"cda2c950d64c660a30d0e9d8ec9b5923a26545d3","2010-10-18 18:56:40+00:00","SCUMM: Simplify SO_LOAD_STRING code

svn-id: r53574
"
"277113f600fd0decf2908f36ba99e3254b2befc8","2010-10-18 19:03:24+00:00","SCUMM: Fix out of bound access (discovered by Code Analysis in MS VS2010; thanks to aquadran for helping verify the fix)

svn-id: r53575
"
"4b5640883c851bc9f771da98190b8d416095ba0d","2010-10-18 19:04:41+00:00","COMMON: Implement Common::vprintf(). Patch by littleboy

svn-id: r53576
"
"05b3f2a0711df91230bf39587c9eed4da36e1afa","2010-10-18 19:07:24+00:00","GUI: Use vprintf in Console class. Patch by littleboy

svn-id: r53577
"
"c92d2bc234f2f73a9629b3622cd5e66c57439cda","2010-10-18 19:10:57+00:00","SOUND: Add support for LastExpress version of IMA ADPCM sound.

Patch by littleboy.

svn-id: r53578
"
"86d650926f9b991b6398e4ad4b0613ac264dfbaa","2010-10-18 19:17:38+00:00","LASTEXPRESS: Merge in the engine.

svn-id: r53579
"
"937cf6cd7aa3fdafc661bcfcf28e4f3dd05306ba","2010-10-18 19:18:06+00:00","CONFIGURE: Plug in Last Express engine

svn-id: r53580
"
"dd7a2f75c022cbf4d974bce980ceeb459ab0b005","2010-10-18 19:19:28+00:00","SCUMM: INSANE: fix a long standing bug discovered by static code analysis

svn-id: r53581
"
"ceae152531a9c2269b8df05f0608915040a121ac","2010-10-18 19:29:56+00:00","SCUMM: Silence MSVC 2010 code analysis warning

svn-id: r53582
"
"a33d473535cf480124e76cd19b67816c684a4dd2","2010-10-18 20:02:27+00:00","CONFIGURE: Added va_copy detection for Last Express engine

svn-id: r53583
"
"56b1f8ddeef842edae08e48be2562b0f0a49b3db","2010-10-18 20:19:44+00:00","Revert 'CONFIGURE: Added va_copy detection for Last Express engine'

svn-id: r53584
"
"7f7a6cdafd758287f6bbb767adb98a42edb2f4a2","2010-10-18 20:19:58+00:00","Revert 'GUI: Use vprintf in Console class. Patch by littleboy'

svn-id: r53585
"
"f7645fea4504450370a81da4ea4d9248660860c9","2010-10-18 20:20:14+00:00","Revert 'COMMON: Implement Common::vprintf(). Patch by littleboy'

svn-id: r53586
"
"6a67bfd85d33e0cf87267ab56e286bafc96ece27","2010-10-18 20:39:54+00:00","LASTEXPRESS: Implement 3 more AI logic functions

svn-id: r53587
"
"0c72b1800dc122019643ce05ffd3d2d3163ca6d4","2010-10-18 21:03:28+00:00","LASTEXPRESS: Fix GCC warnings

svn-id: r53588
"
"5ff68b49d739d990b781102441b4473b9ff3ae2b","2010-10-18 21:16:58+00:00","FM-TOWNS AUDIO: improve thread safety

svn-id: r53589
"
"5c2bcadd214b0af8f10e2915b986735739c42b36","2010-10-18 21:35:15+00:00","CREDITS: Add lastexpress engine

svn-id: r53590
"
"521751e8d7810ee603669fd2e4c2b35dd1da4bf0","2010-10-18 22:17:18+00:00","SWORD25: Use const_cast to cast away constness.

This fixes a few warnings/errors in the LUA code. I added some FIXMEs at the
places where the casts happen, since usually this casting indicates bad
design.

svn-id: r53592
"
"a821d65efe255d9e86c5d7dc5f711152bb68fbed","2010-10-18 22:17:41+00:00","SWORD25: Fix compilation on 64bit arches by casting a pointer to ssize_t instead of int.

This should be no permanent solution. I added a small fixme comment near the
cast so it won't be forgotten.

svn-id: r53593
"
"70566beb78cc637b0d94ff587c4735d6edaa73ac","2010-10-18 22:30:44+00:00","SWORD25: Since ssize_t might not be available on all platforms use size_t for the pointer cast now.

svn-id: r53594
"
"9cbae5252ff249946a6b2ab2c65961dd36b7b098","2010-10-18 23:06:52+00:00","LASTEXPRESS: Check for a valid sequence in SequenceFrame::getName

This allows the demo to fail gracefully to the debugger instead of crashing

svn-id: r53595
"
"f82ee445d33de5d40fa34222080d3d7ffd165768","2010-10-18 23:40:36+00:00","LASTEXPRESS: Add md5sums of German TLE.

svn-id: r53596
"
"f05110f3f675a0ceae9c704391610b5896b584a7","2010-10-18 23:54:35+00:00","SCUMM/FM-TOWNS JAPANESE: fix font spacing issues

(improves MI1 intro)

svn-id: r53597
"
"01669d8de0ac2d1ec50c102abe79d3112075c5d8","2010-10-19 00:45:53+00:00","LASTEXPRESS: Rewrite resetCurrentParameters to use a temporary var

Per LordHoto suggestion, to see if it fixes compilation on motoezx & PS2

svn-id: r53598
"
"fdaa1b9c613fd5a1eae81652879f7bdb45c51be6","2010-10-19 01:42:00+00:00","LASTEXPRESS: Merge parameter creation into resetCurrentParameters()

svn-id: r53599
"
"c1a3689a5d561f3a6779282c23b9bbed75bbeccd","2010-10-19 04:59:45+00:00","SWORD25: Fix cppcheck warning

svn-id: r53600
"
"00bf6ab791f89db92052c62186465daf33f15e05","2010-10-19 07:37:50+00:00","PSP: add missing return statements to image viewer

svn-id: r53601
"
"355032d4f9600eea3684cab3166375053fbd9d8b","2010-10-19 08:12:04+00:00","SWORD25: Fix cppcheck warnings in BS_Log::LogPrefix

The LogPrefix method isn't currently used, but I'm fixing it just in case it's ever used again

svn-id: r53602
"
"3b29bda9a1d98eb5bca748451f763a2ea6523b9e","2010-10-19 09:23:20+00:00","SWORD25: Added operator= to Polygon class

This fixes a corruption where vertice arrays were being copied directly and destroyed prematurely

svn-id: r53603
"
"ebf9911649f6596128493c5965f5b5638a029812","2010-10-19 09:42:48+00:00","SWORD25: Work around for bug in Mac OS X 10.2 SDK

svn-id: r53604
"
"f020ec90779dd4db968df7dfd1e2961434ea3fc6","2010-10-19 09:43:08+00:00","LASTEXPRESS: Fix warning about empty loop body

svn-id: r53605
"
"88bca8e13d0d385161bd8aee95998345a6aa516e","2010-10-19 09:43:31+00:00","SWORD25: Optimize ReverseArray, move it to only place it is used

svn-id: r53606
"
"ddf0a3d80c726dfb274473c1931b184a46493e1d","2010-10-19 09:43:53+00:00","SWORD25: Move BS_ServiceInfo to service_ids.h and turn it into a POD struct

svn-id: r53607
"
"d6b7ebab16e4aa2e1e50b15ed11e4ede32520d1a","2010-10-19 09:44:13+00:00","SWORD25: Some code cleanup

svn-id: r53608
"
"8f5eee67dbbc69979ca4b4527307277410f99956","2010-10-19 09:44:29+00:00","SWORD25: Destroy singletons upon engine exit (untested, may lead to crash upon exit)

svn-id: r53609
"
"4caa1d40a8cdfc7efad298f607eddd9cd7e6019e","2010-10-19 09:44:48+00:00","SWORD25: Simplify log listener code (and get rid of another global constructor)

svn-id: r53610
"
"6a1e874447e86d243a6cdd5bd95f0d95a1333059","2010-10-19 10:03:38+00:00","SWORD25: Fix for Valgrind identified memory leak

svn-id: r53611
"
"f8c72439383c6ea6324d03fa4c9e067a33af2235","2010-10-19 14:53:39+00:00","SCI: fixing possible deadlock inside clearPlaylist

thx to ajax16384

svn-id: r53613
"
"0e7abce271c218faa6ae19059207fed5d61b0ef8","2010-10-19 15:31:07+00:00","SAGA: fix submit 53486 'Added sanity checks for realloc() calls - bug report #3087852'. zero count realloc may return NULL as valid value

svn-id: r53614
"
"193a0c6ca1b00255fccd9668349ad05bae2348d7","2010-10-19 16:17:45+00:00","PSP: disabling the ability to build Broken Sword 2.5. Revert once fixed.

Lua is very problematic for the PSP build because it wants a) libpng built with the plugins which is not great, but not that bad. b) It calls several PSP functions directly, and it turns out PSP functions can only be called from the main executable -- they're in flash and must be fixed up using custom PSP utils. Until this mechanism is changed so that for example lua calls functions in the main executable, the PSP cannot be built.

The following functions need to be removed/moved to the main executable:
All socket functions (should be disabled anyway)
Clock()
Rename()
Additionally, png functions should ideally also be called only from the main executable.

svn-id: r53615
"
"1d87f434a2238b288eec8b489e1825a65fa84cea","2010-10-19 16:58:27+00:00","SCUMM/FM-TOWNS JAPANESE: implement flipped text

(used in the MI1 circus scene after Guybrush gets shot out of the cannon)

svn-id: r53616
"
"f6a43d980a129c6f8da4cc45ee404bdb77f0d522","2010-10-19 17:03:36+00:00","SCUMM/FM-TOWNS JAPANESE: minor fix in last commit

svn-id: r53617
"
"490d4aef0ef1c0649f1ff8e81ce315c830562c11","2010-10-19 19:54:15+00:00","LASTEXPRESS: Changed some spaces to tabs

svn-id: r53618
"
"0d1d4818947c085cb3714b73024738cb99f5fca9","2010-10-19 20:50:29+00:00","SWORD25: Properly implement GraphicEngine::fill()

Now all transitions and dimming out screen at exit dialog is supported.

svn-id: r53620
"
"d94435eebd8ab8e21a4a28a0274cae02910cb41d","2010-10-19 20:51:21+00:00","SWORD25: Enforce code naming conventions in gfx/graphicengine*

svn-id: r53621
"
"bbd95da899c496c10a4050b7b3cfd3f8dc8aa6b3","2010-10-19 20:52:06+00:00","SWORD25: Fix engine exit when running without theoradec

svn-id: r53622
"
"f3becaddf1d865e44f13aadbb8c71952a73f2268","2010-10-19 20:52:47+00:00","SWORD25: Enforce code naming conventions in gfx/image/imageloader*

svn-id: r53623
"
"3feab382bc5c97656580254c235a5573e24e0d6f","2010-10-19 20:53:43+00:00","LASTEXPRESS: Fix corpse disappearing when hiding the body in the bed

The setItemLocation action had a typo that prevented it from setting the item location.
The 'corpse moved' event was not set and it broke the scene progression.

Also clean up the pickCorpse code and add better comments.

svn-id: r53624
"
"ae78107e2a8732977313e208f1d08e65d50ec8e8","2010-10-19 20:54:30+00:00","SWORD25: Enforce code naming conventions in gfx/*

svn-id: r53625
"
"6629efc676ca48e958dcfa0ee4e66e6aba1c6597","2010-10-19 21:03:33+00:00","SWORD25: Enforced code formatting rules in rest of the engine

svn-id: r53626
"
"bfb0986cd4f73e564384f513daeba9e7938dcb4d","2010-10-19 21:40:24+00:00","SAGA: replace Actors '::realloc' with Common::Array

svn-id: r53627
"
"e4029f6f0e5aa9dc679ce875fb7625c564c69144","2010-10-19 22:29:53+00:00","SAGA: SAGA: replace SpriteList '::realloc' with Common::Array

svn-id: r53628
"
"59c054938a7fd2036badbecfbb3b72ad55b0e820","2010-10-19 22:34:26+00:00","LASTEXPRESS: Fix some space formatting.

svn-id: r53629
"
"21a29d3b45183d0bd79f756d7e2fe90b9c372f65","2010-10-20 03:01:03+00:00","SCUMM: Have o6_getRandomNumber() use the absolute value of the argument

The Backyard Baseball series calls the function with negative numbers, but expects a positive result. The games are now actually playable.

Thanks to Kirben for assistance in tracking this bug down.

svn-id: r53630
"
"28a98c7416c27ddb028c1fe22d7eaf0369f95303","2010-10-20 03:54:33+00:00","SAGA: Silence warning

svn-id: r53632
"
"480a26833fa38cfbefb80a2076d274782d9f7253","2010-10-20 04:01:28+00:00","DOC: Update Backyard Baseball series.

svn-id: r53633
"
"d305587495c3d0329fab989e5d2fd2cf3379a636","2010-10-20 05:59:11+00:00","PSP: added dummy function to allow BS2.5 to build

svn-id: r53635
"
"9d12ee212561b0f9b94c8fc76f48c73d35b5ced9","2010-10-20 09:50:39+00:00","PSP: building BS2.5 again. Reverting 53615.

svn-id: r53636
"
"66ecd08868b83d166e6e01c2e4c2b66eecdbe99a","2010-10-20 10:53:50+00:00","SWORD25: Fix to correctly write game state to savegame files

svn-id: r53637
"
"14e82dbe7f25c1a31cc8afbc712ee0246c7706dc","2010-10-20 11:11:09+00:00","SWORD25: Added description field to savegames

This stores the date and time of when the game was saved, since ScummVM doesn't support getting a file's age like the original engine did.

svn-id: r53638
"
"4e936522eeb0de8092ad74e8522b885550d934cb","2010-10-20 13:00:58+00:00","GPH: Cleanup Readme and support scripts.

GP2X: Cleanup Readme.

SDL: Change a few backend defines to GPH_DEVICE from the device name (blocking main and loadGFXMode so they can be written elsewhere).

svn-id: r53639
"
"f835d49e2ad6fdb310f0ca2a4a7e987f01baa136","2010-10-20 13:03:19+00:00","CONFIGURE: Add -DGPH_DEVICE to all the GPH device targets.

Also add wrapper around the plugin dir. for the OpenPandora from 1.2.0 branch.

svn-id: r53640
"
"33038a2d58c7c919c66f714277d2e239e6a015d9","2010-10-20 13:07:52+00:00","OPENPANDORA: Clean up support scripts and README.

svn-id: r53641
"
"aae3f96f356401c72687a28b4f147da6ba51d579","2010-10-20 13:09:40+00:00","TOOLS: Add OpenPandora to credits and replace GP2X/Wiz with GPH Devices.

* I hope this is the right place to to this ;).

svn-id: r53642
"
"6dfab4fce8f8b1634f2771a043c4a5fcf1737482","2010-10-20 13:50:16+00:00","CREDITS: Commit the result of 'make credits'.

svn-id: r53643
"
"64c0d2a1d1f2b2688e86092834f2e559c437cd29","2010-10-20 15:39:08+00:00","SCUMM/FM-TOWNS: minor graphics fix

This fixes a graphics glitch that occured when leaving the Scumm Bar in MI1 for the first time (before the cut scene with LeChuck).

svn-id: r53645
"
"3d85d6804bb13a8cd2822b771aa2e6d4c8276a1d","2010-10-20 17:31:29+00:00","SCI: Added a new debug command, 'find_callk'

This command can be used to find the object methods (including their
corresponding objects and owner scripts) that call a specific kernel
call. This shall aid us track all the spots where a particular kernel
function is called from, therefore it'll be a bit easier to find
examples where unimplemented kernel functions are called

svn-id: r53646
"
"ab362cfa53770d485d9424b3c55f300465fd7c52","2010-10-20 18:10:36+00:00","SCI: Marked several unused SCI2/SCI2.1 kernel functions and updated comments about some others

svn-id: r53647
"
"2d1205f7a022a82e3513137b57cfb63b75b5964e","2010-10-20 18:29:21+00:00","SCI: Changed some tabs to spaces

svn-id: r53648
"
"2a19d755de0caa76032a680cebb511820e559ce0","2010-10-20 20:39:08+00:00","SCI: Silence GCC warning

svn-id: r53649
"
"308ec17a0564b8328a5163d493211b21b5df2ec5","2010-10-20 20:46:52+00:00","SCI tools: Removing the now obsolete sciunpack tool, after discussing with lskovlun. We got a more advanced functionality in ScummVM now

svn-id: r53650
"
"6be5d2554dc930ff50d3b31fabd3294e1fd13fa9","2010-10-20 20:53:32+00:00","SAGA: replace StringTable '::realloc' with Common::Array; reduce amount of memory for every string table

svn-id: r53651
"
"aee1e1574429fceaecd8258ff4ce0b0db0f427c5","2010-10-20 20:57:08+00:00","SCI tools: Removing the now obsolete old_objects tool, after discussing with lskovlun. It was supposed to be the underpinning for a VM that never materialized

svn-id: r53652
"
"ae2d2e78e13b75f556cc532b34cf6db13d53ffca","2010-10-20 20:58:14+00:00","SCI tools: Removing the now obsolete classes, scriptdump and vocabdump tools, after discussing with lskovlun. We got better functionality than these in ScummVM now

svn-id: r53653
"
"ac2b5df1282923f5cfde0cd5c1d7dee2b714c698","2010-10-20 21:00:59+00:00","SCI tools: also removing obsolete file graphics_png.h

svn-id: r53654
"
"e797fdc0d9508a200e28c297ab350ca3dda33751","2010-10-20 21:06:45+00:00","SCI tools: Removing the now obsolete listwords tool, after discussing with lskovlun. We got better functionality in ScummVM now (the parser_words debug command)

svn-id: r53655
"
"1bd1a253f0bdc063b4795a68fab52e2d98d2f181","2010-10-20 21:23:02+00:00","SAGA: replace Font '::*alloc' & '::free' with Common::Array

svn-id: r53656
"
"db55d81b085c891d30b9b2b646d0da1bea7e1ef1","2010-10-20 21:47:26+00:00","SCI: removing 'german' laura bow 1

the version released in Germany was/is 100% english-only

svn-id: r53657
"
"d97d21e0292d536727d926e8bbd3219ecd664caf","2010-10-20 22:02:33+00:00","SAGA: replace Sprite '::*alloc' & '::free' with Common::Array

svn-id: r53658
"
"c105e05a022fd09062f82372860c40818a4f8b4d","2010-10-20 22:36:50+00:00","LASTEXPRESS: Fix typo in Mertens::function42()

This caused Mertens to invite you to Kronos's car, even before you've been
to Whitney's compartment, changed jacket and assumed his identity
(reported by eriktorbjorn)

svn-id: r53659
"
"d8c1251f88852541a5ef909ab046cd2b5f37196d","2010-10-20 23:58:34+00:00","SAGA: Fix warning: comparison of unsigned expression < 0 is always false

svn-id: r53660
"
"8ae4926da21c17943fb9621a02a3913a82a2a8f3","2010-10-21 03:41:44+00:00","GPH: Rename README (package build step uses the README-GPH name)

svn-id: r53661
"
"01ea6f86bdc66412836e411dfa0c9f2f4b330907","2010-10-21 05:13:32+00:00","SCUMM: Revert revision 45302, which caused regressions when random team is selected in Backyard Football.

svn-id: r53662
"
"e5c3b67ddb1388282fed1fb8f6f7bfb7ae820f01","2010-10-21 05:17:16+00:00","SCUMM: Correct a copy and paste error in compareByteArray/compareByteArrayReverse code.

Thanks to clone2727 for noticng this error.

svn-id: r53663
"
"787bafc442fb82640441982c8069b3816381c7f1","2010-10-21 08:44:03+00:00","CREDITS: Fix HTML entity

svn-id: r53668
"
"cca5504b6c7e201c024f0823f0ad151eb8a9b061","2010-10-21 08:51:10+00:00","SCUMM: Fix bug #2984000 - SPYFOX3 (French): Crash when using fingernail machine.

svn-id: r53669
"
"66fabfa0492a2f95dd6a0d7f3981ea88007529c1","2010-10-21 09:31:42+00:00","SCUMM: Document ScummEngine_v90he::sortArray

svn-id: r53671
"
"89fc06d87880ff541292488bac94c03642188d8b","2010-10-21 09:32:00+00:00","SCUMM: Remove redundant call to checkArrayLimits

svn-id: r53672
"
"d251521f63b0d3d0e8dbaf16a867b043e6ddfedb","2010-10-21 13:13:56+00:00","SCI: Added the ability to filter out results of the 'class_table' command

svn-id: r53673
"
"0101a0e0bb7076c19b243c7f5ae2004653e5fc45","2010-10-21 17:09:57+00:00","HUGO: Moved _objects to a separate file

also suppressed some dereferencing

svn-id: r53674
"
"f4a0633d8a0f07e456261083a06e3aea4428eb5d","2010-10-21 19:24:22+00:00","LASTEXPRESS: Fix debug message.

svn-id: r53676
"
"c1505d6e51d008e2a482f600a960d8fe8e378f75","2010-10-21 20:13:25+00:00","SAGA: unroll IsoMap::drawTile buffer copy loop; refactor Sprite::drawClip

svn-id: r53677
"
"8b72f49460efa2fde822467ce049e5e15444084a","2010-10-21 22:32:50+00:00","SAGA: replace Script and Thread '::*alloc' & '::free' with Common::Array

svn-id: r53678
"
"521eb95aea5160c08965f568518f51513b1a74ac","2010-10-21 22:35:57+00:00","SAGA: fix gcc warn

svn-id: r53679
"
"a621302a719d384560fd8f2765639a948ef0cee9","2010-10-21 23:38:35+00:00","LASTEXPRESS: Implement 10 more AI logic functions

svn-id: r53680
"
"c35d23aa95d12e5b622d9c25558f91ddf5eb066f","2010-10-21 23:39:48+00:00","LASTEXPRESS: Implement 7 AI logic functions

svn-id: r53681
"
"b347156e787b5f5b8afd7f8d4a223bf34aed7597","2010-10-21 23:40:14+00:00","LASTEXPRESS: Implement remaining AI logic functions for Francois, Gendarmes and Milos

svn-id: r53682
"
"08f905fe564e808e660224250f4a770a41b0b5d8","2010-10-21 23:40:47+00:00","LASTEXPRESS: Implement remaining AI logic functions for August

svn-id: r53683
"
"def40a625a0767ddf30c42f03aba44ec58ea5a07","2010-10-21 23:41:22+00:00","LASTEXPRESS: Implement remaining AI logic functions for Kahina and Kronos

svn-id: r53684
"
"21a25a99f5ea2cc679301cd8a11d17c64d927607","2010-10-21 23:41:56+00:00","LASTEXPRESS: Implement remaining AI logic functions for Tatiana

svn-id: r53685
"
"f22c915a9168e20d6f9b22836fec5f43b5cffc3d","2010-10-21 23:42:31+00:00","LASTEXPRESS: Implement remaining AI logic functions for Anna

svn-id: r53686
"
"a3d4181e00398ccf304aefb1360a7ab843b17236","2010-10-21 23:43:04+00:00","LASTEXPRESS: Implement remaining AI logic functions for Coudert

svn-id: r53687
"
"3abbcfd7802fc7a309a23940254d9a6e55dd2f82","2010-10-21 23:43:36+00:00","LASTEXPRESS: Implement remaining AI logic functions for MmeBoutarel

svn-id: r53688
"
"af36047c715e7bffaa36de2c0018dbf1cb88d284","2010-10-21 23:43:57+00:00","LASTEXPRESS: Rename LOBYTE macro

svn-id: r53689
"
"4466e2a20db1ef0ec92b12dc631d1593c315e471","2010-10-21 23:44:27+00:00","LASTEXPRESS: Simplify some entity callback code

svn-id: r53690
"
"002557fbd2575e2cdb82e19c9909a4c654593139","2010-10-21 23:44:59+00:00","LASTEXPRESS: Rename CURRENT_PARAMS to CURRENT_PARAM

svn-id: r53691
"
"a54783c41479d9bdb3fc9a7739bf97af29dc9bdb","2010-10-21 23:46:00+00:00","LASTEXPRESS: Merge several TIME_CHECK* macros together

svn-id: r53692
"
"06d9de0a9bb20c4dd3dea2639ec452888f480a58","2010-10-22 00:35:37+00:00","LASTEXPRESS: Fix GCC errors & warnings (missing stricmp & parentheses)

svn-id: r53693
"
"fed894aeee8bc9cdf174e50eab9b24de8bf30a70","2010-10-22 01:30:18+00:00","LASTEXPRESS: Add missing casts, fix warnings and correct typos

svn-id: r53694
"
"38463e61619fe1e4d2b6c59313d99c40482d7411","2010-10-22 02:08:26+00:00","KYRA: A little refactoring (name change).

svn-id: r53695
"
"3653613443d8def9ae7f552eb799d1f039fd8097","2010-10-22 02:09:16+00:00","KYRA: Add a datatype for the item ids and convert Kyra1 to use it.

svn-id: r53696
"
"03e2d54ca7f3d5533cbae376921cf617736caee5","2010-10-22 02:10:22+00:00","KYRA: Adapt Kyra2+3 to use the newly added item type too.

svn-id: r53697
"
"5ff20cb12d26b80e0e23a5dab734412d24fa0289","2010-10-22 02:11:00+00:00","KYRA: Cleanup.

svn-id: r53698
"
"b816a81c028730c586e29045ac24e11d49e2ca0f","2010-10-22 02:11:50+00:00","KYRA: More cleanup.

svn-id: r53699
"
"d6e4c07dac32cb184e69fa41772f13b6769933c6","2010-10-22 13:10:41+00:00","LOL: fix possible regressions

svn-id: r53700
"
"c67bcddf858b956efd7626170f4525dd763c768b","2010-10-22 14:19:37+00:00","Initialize variable in NS gui code (was crashing a demo). Patch #3089932 by fuzzie.

svn-id: r53701
"
"5ba15c5ae566f31e72fad772aeebeeade9bf9c75","2010-10-22 14:21:26+00:00","Update BRA demo startup code to use the part/location handling code from r50042. Patch #3089932 by fuzzie.

svn-id: r53702
"
"04cd1c1c116bac051f5cd3746922a371aac4f19d","2010-10-22 18:09:49+00:00","LASTEXPRESS: Add some documentation for the kTime constants

svn-id: r53703
"
"031e0167e4979fcb9f5bef3fde273605d3dc8eb9","2010-10-22 19:28:12+00:00","SCUMM/FM-TOWNS JAPANESE: fix another font spacing issue

(fixes MI1 character talk text)

svn-id: r53704
"
"4a0ba817e58c5a1c7d17af5a79f91570dd98ca16","2010-10-22 20:45:00+00:00","HUGO: Move findObjectSpace() to ObjectHandler class

svn-id: r53705
"
"66e3815963564b1070bad56e25e2f9fb5e2a039e","2010-10-22 20:53:25+00:00","TOON: Fixed Bug #3089974 and #3086015

Bug #3089974: 'TOON: Two Drews when exiting King's bedroom'
Bug #3086015: 'TOON: Woof doesn't idle correctly'

Most talking animation bugs are fixed with this.
The mouse is now hidden when entering a room.

svn-id: r53706
"
"9e9739c074420b2d3c080b91e25d52f121e14140","2010-10-22 21:07:28+00:00","TINSEL: Added detection entry for DW2 Demo

svn-id: r53707
"
"96723838c6559a2885cdbeaf1a207ee608ed9ce6","2010-10-22 21:08:27+00:00","TINSEL: Added new opcode set for the DW2 Demo

svn-id: r53708
"
"ffa8b9d61a62bb873c93232020cafc94a56f83bb","2010-10-22 21:17:54+00:00","TINSEL: Compilation fix

svn-id: r53709
"
"63862026bc5dd0fe4d171ee75cd3784211beda44","2010-10-22 21:21:57+00:00","TOON: Fix for a small typo in talking state

svn-id: r53710
"
"a88d7b29050ce8b149e29a4d3b7f57fa21c3e2d1","2010-10-22 21:23:44+00:00","TINSEL: Remove unused function

svn-id: r53711
"
"d771d98a92eb7019614bba14bdf822b2022a6558","2010-10-22 21:33:31+00:00","TINSEL: Fix incorrectly mapped opcode in DW2 Demo

svn-id: r53712
"
"9cbb0d557948d8b4c3a8c766a1fc32bb75a2c6c3","2010-10-22 21:42:48+00:00","TOON: More talk animation fixes

There was a conflict between the idle animation and the talk animation
in some cases (showing the chain anim & idle anim in the arcade)

svn-id: r53713
"
"610c5eb336f9e6561f44772845fbd525a0bb5eab","2010-10-22 21:49:21+00:00","TINSEL: Load samples file for DW2 Demo

svn-id: r53714
"
"90974937a3a56cd2446101d7ee663e1bdbe82db2","2010-10-22 22:00:27+00:00","LASTEXPRESS: Reorganize and enhance some debug commands

Add 'time' command to convert between in-game and human-readable forms
Rename 'dump' command to 'show' and use named parameters instead of index
Add progress and flags options to show command

svn-id: r53715
"
"3a90af96f58ea8291f3d964f8c3e2c44496e274e","2010-10-22 22:06:59+00:00","LASTEXPRESS: Update namespace comment with latest engine status

svn-id: r53716
"
"b8ff3eb4913dd22bc75ae360baadadd95151077f","2010-10-22 22:09:59+00:00","TINSEL: Ignore SV_SPEECHDELAY in DW2 Demo

This stops the long delays at the start of playing each sample

svn-id: r53717
"
"f24394b85f5d34815659c50cd956c262f4b79d68","2010-10-22 23:13:17+00:00","SAGA: replace Actor::_pathCell, Anim::*, Converse::text, IsoMap::*, Music::_songTable, ObjectMap::*, PalAnim::*, Scene::sceneLut, SndRes::_fxTable*  malloc based arrays with Common::Array implementation
add ByteArray type
fix debug Tile Hittest frame drawing
debug 0x%x => 0x%X

svn-id: r53719
"
"4b98404d7b1f76188a0465c6e83085510567d2c6","2010-10-22 23:29:52+00:00","TOON: Close correctly sound packs

svn-id: r53720
"
"9f2e7d5ff5c2e416cb1638d67ead9c52ba27fc21","2010-10-22 23:33:56+00:00","SAGA: fix gcc size_t warns

svn-id: r53722
"
"3fb739f90a67c96abf3a3025487bb509b829fa22","2010-10-22 23:35:56+00:00","TOON: Fix conversation freeze in the beginning of chapter 2

A missing talk animation was started

svn-id: r53723
"
"fe06b7d151f4752b51191cd3475ba85953df2d6a","2010-10-22 23:39:29+00:00","TINSEL: Fix for #3091314 - Added extra detection entries for Multi-lingual DW1

This adds in German, Italian, and Spanish as detection entries, so a user can immediately select what language to run the game in.

svn-id: r53724
"
"a82b0435a2f6777fd91c85dc0058c9dbd2568306","2010-10-23 00:30:21+00:00","SCUMM/FM-TOWNS JAPANESE: fix font drawing in MI1 intro

svn-id: r53725
"
"afd677c2c7a7e6dd088f64ff77bcb4fa154b4cc4","2010-10-23 02:18:08+00:00","SCUMM: Fix buffer overflow, that was causing crashes when saving in Backyard Baseball 2001/2003.

svn-id: r53726
"
"d602e4a785df248140d088fa691fb525d603d76e","2010-10-23 03:09:39+00:00","PSP: make vkbd's function keys match their visual representation

svn-id: r53728
"
"402fac9ed41cea27d37574aa2db37ce016372106","2010-10-23 06:27:16+00:00","SCUMM: Add workaround to allow saved games to be shared between Macintosh and Windows versions of Backyard Baseball 2001.

svn-id: r53729
"
"3f4655c03f717a2db549ae2418dac2a22b8709e0","2010-10-23 13:39:04+00:00","SCUMM: Disable multiplayer option in Backyard Baseball 2001.

svn-id: r53731
"
"3e657c1bf961390bf645a27c6616b527e457d372","2010-10-23 14:37:26+00:00","LASTEXPRESS: Add md5sums of UK Broderbund TLE.

svn-id: r53733
"
"c483a22f2a8c02c2b1ecaf5f9626999fd3ed3c7e","2010-10-23 15:44:04+00:00","SWORD25: Get rid of global SharedPtr instances

svn-id: r53734
"
"360f67636bdb67eeac80e60b8e27fb88b80fa0fd","2010-10-23 15:44:33+00:00","SWORD25: Register LUA callbacks insider registerScriptBindings() methods

Previously, the constructor of an anonymous global object was used to do
this, for no apparent reason.
However, maybe there was a hidden reason which I missed, so this change
might cause regressions. I.e., please test.

svn-id: r53735
"
"da31121507db2d92cfbd707d2a08afa9bddf34c2","2010-10-23 15:44:55+00:00","SAGA: Improve comment for ByteArray::getBuffer()

svn-id: r53736
"
"efcfb40da92eedc2a22e595b26369f960efd434e","2010-10-23 15:45:22+00:00","SAGA: Add some const qualifiers to SagaEngine methods

svn-id: r53737
"
"3534cff8ef88b5e6a87e4f561146e52288456fa1","2010-10-23 15:46:50+00:00","ALL: Fix indention (whitespaces -> tabs)

svn-id: r53738
"
"0d54400806f5e25ea60e56d2fa84de3643c50f8c","2010-10-23 15:47:23+00:00","SCUMM: Skip endian conversion on little endian systems (instead of assigning values back to themselves)

svn-id: r53739
"
"09f77eb4642eae4e945f8c10554ce204aff450e0","2010-10-23 16:01:40+00:00","LOL: - fix invalid mem access

- also extend LordHoto's recent item code changes to LOL

svn-id: r53740
"
"4af9057eaa3e69b6575415359537d91d6bc0cfb9","2010-10-23 19:01:34+00:00","PSP: Fix up imageViewer to pause game

The only real way to pause the game is to take over the event loop, which is a little sad... Also fixed a possible crash when loading an image that was to big, by only rendering when we have _init set.

svn-id: r53741
"
"ebf4e736baeafcd6f790fdcd72533b69d9caeafe","2010-10-23 19:17:26+00:00","SCI: Added the Spanish version of SQ5 from bug report #3090664

svn-id: r53742
"
"bd14661fdfc3efcc649edf5db683c96ef4cc09d9","2010-10-23 19:19:06+00:00","SCI: Silence runtime warnings when editing kernel_tables.h with VS2010

svn-id: r53743
"
"6c47ca8253d970045f817dc75008cfb21c499d62","2010-10-23 19:23:07+00:00","SCI2/SCI2.1: Some changes to the screen drawing code.

- Implemented kernelUpdateScreenITem
- Changed the list of screen items to be a list of FrameoutEntry entries,
so that it doesn't get recreated on every frame

svn-id: r53744
"
"4e9cae8ca8f26d8d8ce41260015111337b990500","2010-10-23 20:07:06+00:00","LASTEXPRESS: Output human readable time in the show game state debug command

svn-id: r53745
"
"ae6aa8a6b354b5050406ba87626535ffef0be541","2010-10-23 20:22:24+00:00","SCI: always allocate +1 byte in kMemory now

fixes multilingual lsl5 room 280 - names of airport ladies not shown correctly (bug #3093818)

svn-id: r53746
"
"deb461d2003e8183402530cd27ae56c289f50050","2010-10-23 21:30:39+00:00","GUI: added close() call to Dialog::runModal()

This should prevent a small leak in the GuiManager when adding the dialog to the stack. Check for any regressions.

svn-id: r53747
"
"405c523bbb199919ef172e4cb549625b319e6b2d","2010-10-23 21:56:16+00:00","SAGA: replace decodeBGImage malloc with ByteArray

svn-id: r53748
"
"f812f88c103fd968a886a746494a23e3128f0590","2010-10-23 22:02:52+00:00","LASTEXPRESS: Add new dump command to dump the list of files in the archives (with size & md5)

svn-id: r53749
"
"5b7c5e429871ce09465150ef9cca8e6cbeb3f259","2010-10-23 22:04:51+00:00","SAGA: fix typo

svn-id: r53750
"
"b10cd22d510e063d647ac03930800e3df7c514e8","2010-10-23 23:07:10+00:00","SAGA: replace Events malloc base linked list with Common::List

svn-id: r53751
"
"2da4469686ed5336174f990605f8626dd4b46f53","2010-10-24 01:29:59+00:00","SWORD25: Remove outdated comments

svn-id: r53752
"
"85e3ddc30987ce0331d68157362322e4a7b00f83","2010-10-24 01:30:53+00:00","SWORD25: Add ImageLoaderManager, get rid of last globally constructed object

This also gets rid of an evil use of atexit.

svn-id: r53753
"
"1e16d576ca4798bd1fac640330c5e2faf176658a","2010-10-24 01:31:30+00:00","SWORD25: Merge B25SLoader into PNGLoader

svn-id: r53754
"
"7cc8811a5c9b63703c2131841745cd5b7e5f009a","2010-10-24 01:32:15+00:00","SWORD25: Merge classes PNGLoader, ImageLoader and ImageLoaderManager

This looses some flexibility when it comes to supporting other image
formats. But since the game does not use other image formats, this seems
rather irrelevant, compared to how much simpler the code now is.

svn-id: r53755
"
"4d6fb4e76819f7e5621685a32f4ff075e7b5674c","2010-10-24 01:32:52+00:00","SWORD25: Get rid of colorFormat parameter in PNGLoader API

Only CF_ARGB32 was supported anyway.

svn-id: r53756
"
"2a987c4a318ba7529b373a607eb58cee237b67d5","2010-10-24 01:33:24+00:00","SWORD25: Simplify & optimize PNG reading code

The interlaced part is untested since I do not know any place
in the game where interlaced data is used.

svn-id: r53757
"
"48d15398e575bb9fa3e015126fa6087511ef9843","2010-10-24 01:52:27+00:00","SWORD25: Get rid of kernel/string.h

svn-id: r53758
"
"fa0151683c0cca507f3c16ab8b2ca91a4c4ae83a","2010-10-24 01:53:01+00:00","SWORD25: Replace ResourceManager's hash table by a Common::HashMap

svn-id: r53759
"
"518526ba2f6e2e84a73c84791be12df6d733dadd","2010-10-24 01:53:32+00:00","SWORD25: Remove some dead code; cleanup

svn-id: r53760
"
"bf5ae45490a0683692715fcc8a103f0e096e9c21","2010-10-24 13:00:47+00:00","KYRA/PC98: workaround for missing delay opcodes

The sequence data for the forest sequence in the Kyra PC-98 intro has no delay opcodes making it play way too fast on modern systems. This workaround adds the same delay opcodes to the sequence data that the other Kyra versions have.

svn-id: r53761
"
"c975ed11a14a78bfbf6aa0442058a8f19d470c6c","2010-10-24 13:04:33+00:00","ALL: Fix various typos (patch #3093266)

svn-id: r53762
"
"5fbca853aa6c6a181b090bff124e054dfa3a01f4","2010-10-24 13:05:03+00:00","SCUMM: Turn global g_cmsEmu into a member var of Player_V2CMS

svn-id: r53763
"
"b446a7dcc2cd49e5591d36cfc2380a110cf979c0","2010-10-24 13:09:56+00:00","ALL: code formatting fixes

svn-id: r53764
"
"225fd20bee837d0a9d9959621c0aa8bfa8a4337b","2010-10-24 13:26:58+00:00","Revert r53747: 'GUI: added close() call to Dialog::runModal()'

It broke the launcher after adding new games.

svn-id: r53765
"
"fa7e8a8eb382c37d35d9166dcd87646811e4a377","2010-10-24 17:42:45+00:00","SAGA: replace Actor::_actors and _objs malloc base arrays with Common::Array

svn-id: r53766
"
"c9c9eafbbb791d1b754c053aac221979a39216e1","2010-10-24 18:34:08+00:00","SDL/w32: add ability to hide console

feature is currently commented out - waiting till discussion has ended

svn-id: r53767
"
"27ee12e6a596dc585622e0cee5a27f906503df70","2010-10-24 19:04:35+00:00","SDL/win32: fix lf, thx msvc

svn-id: r53768
"
"2e0b1c621388d7b37746cf41f7d1104ac900b133","2010-10-24 19:07:46+00:00","SDL/WIN32: Disable currently unused config entries, added with r53767.

This code should be enabled, when we decide to enable m_kiewitz' code to
disable the console window. Also we should add the command to the --help
output etc.

svn-id: r53769
"
"f37252e6cfacf1a1546265ffc7895e499a2b7e54","2010-10-24 19:10:13+00:00","LASTEXPRESS: Change detection entries platform to kPlatformUnknown

All full versions of the game are multiplatform Dos/Win/Mac
and the demo is Dos/Win

svn-id: r53770
"
"0db700a3dced67c607c9e9719ea22347612ead40","2010-10-24 19:15:17+00:00","GUI/LAUNCHER: improved MIDI device selection (also #3088438)

This fixes an issue with the <default> setting in the GM and MT-32 device tabs that has caused some complaints and discussions on -devel. It might also be what bug #3088438 is about.

With a <default> setting ScummVM would just use the first available MIDI device (even if this is the not really well working MT-32 emulator). This <default> setting was also indeed set by default - making it even more annoying.

Now there is a new setting for both the GM and MT-32 device tabs ('Don't use GM/MT-32 music').
This will cause MIDI device detection to be skipped and the best of the other devices (Adlib etc.) to be used. This new setting is used as default. So users who haven't specified anything will get Adlib, PC Speaker etc. (if supported by the engine) even if the engine prefers Midi.

There is a new 'Use first available device' setting which will have the same effect as the '<default>' setting we had before.

svn-id: r53771
"
"25e1af837a94f6b1a9dcdcdb69abb21167a7f6ce","2010-10-24 20:20:48+00:00","GOB: un-ban and fix a somehow corrupted version of Fascination

(This version has been found on original floppies)

svn-id: r53772
"
"e3ea3b5b7e6f1fbb20d9f958476e5a2263af7052","2010-10-24 20:22:21+00:00","SAGA: replace Scene::_resourceList, Interface::_inventory malloc arrays with Common::Array

svn-id: r53773
"
"cb6efae5afef01034544f7f9ac9da98cd44e3475","2010-10-24 20:36:47+00:00","GOB: Replace strncmp by scumm_stricmp when possible

svn-id: r53774
"
"b581a866a9131d8b669e897b62540f227013f82d","2010-10-24 21:49:22+00:00","SCI: fixing obvious kAddToPic regression

caused by r53068, triggered bug #3092840 (SQ5 genetix lab scaled incorrectly when laying course) - thx to digitall for bisect

svn-id: r53775
"
"77d20f6962f0978de365ff6c19f129fdd4b1e203","2010-10-24 21:53:27+00:00","SCI: Fixed bug #3094235 - 'SQ4CD: Crashes at Roger jr. in beam'

svn-id: r53776
"
"e4dc5336db4f2e864aa5b7d1496c00169ef69b50","2010-10-24 22:15:25+00:00","LASTEXPRESS: Fix crash in subtitle handling

svn-id: r53777
"
"859c1c2c08c39262de6b6ba6e1169bb03d14353a","2010-10-24 22:15:36+00:00","LASTEXPRESS: Fix issues when copying debugger commands

- Properly free allocated memory in resetCommand()
- Make sure _commandParams strings are null-terminated

svn-id: r53778
"
"67cc1b8a84e8cbc344e87fe0f4715cae96199b69","2010-10-24 22:17:44+00:00","SAGA: replace Resource:loadResource malloc with ByteArray class

svn-id: r53779
"
"0f1ae79ac476c7871e91e4e5c01e2bc752c93777","2010-10-24 22:25:16+00:00","SAGA: fix const cast warns

svn-id: r53780
"
"599094d3a086db31a4988b27b480399beb51dafd","2010-10-24 22:40:37+00:00","SAGA: fix SAGA_DEBUG; fix IHNM cutaway typo

svn-id: r53781
"
"0970cdf5e55a7dc52f8f2a3fd76421bdd33d6164","2010-10-24 22:52:57+00:00","SAGA: reduce memory usage

svn-id: r53782
"
"4f37c92602bcbad8e21bf4db5496cdabf197e7f7","2010-10-25 00:16:38+00:00","LASTEXPRESS: Don't use NULL in arithmetic

svn-id: r53783
"
"816ef5708f35c026e97143ee6159f24f5a96cd08","2010-10-25 00:50:51+00:00","LASTEXPRESS: Adding Date-Time Comments To UK Broderbund Detection Entry

As per Littleboy's request.

svn-id: r53784
"
"b2e8daa2d7c071918b3d220b7448fa82120a46f9","2010-10-25 03:21:49+00:00","SCUMM: Add patch #3093057 - MMC64: sentence/inventory color.

svn-id: r53785
"
"3b66f3d9200e7f80e42d5bd9c1b103b78ab7a48f","2010-10-25 03:37:00+00:00","GOB: Make moveAdvance() and movePathFind() a bit more readable

svn-id: r53787
"
"d751212eb34808ff77c6ceebea9b61f2e1ff0812","2010-10-25 03:37:24+00:00","GOB: Add sanity checks to getPass()/setPass()

svn-id: r53788
"
"029aee61a6741e10159042895b5e62f2cbf5b925","2010-10-25 03:37:48+00:00","GOB: Format getDirection() to be more readable

svn-id: r53789
"
"27cfa212300c6c122e4740fbf8f62bfc8c05f6f0","2010-10-25 03:38:12+00:00","GOB: Fix a typo in checkDirectPath()

svn-id: r53790
"
"bcb85799540b946ac4c48abe7f3842e6b9a6fde1","2010-10-25 03:38:34+00:00","GOB: Minor map cleanup

Make the direction a named enum and create a function moveDirection()
for increasing coordinates according to a direction.

svn-id: r53791
"
"f1d41b83264576beaa82e98a5dfef3663020f1ef","2010-10-25 03:39:04+00:00","GOB: Format optimizePoints() to be a bit more readable

svn-id: r53792
"
"9605cda50ba32dfb96020ffe4dc92c2353cad222","2010-10-25 03:39:28+00:00","GOB: Fix the Gob3 stairs walking bug

Fix the bug where blount keeps moving between two steps
of wide stairs.

svn-id: r53793
"
"66de867fe4ebc1015b9c9d61d2e987f0bef2fdaa","2010-10-25 03:39:58+00:00","GOB: Fix the Gob3 ladder walking bug

Fix the bug where Blount stops in the middle of big ladders.

svn-id: r53794
"
"8e10c5bc3b98030df8232091f38295b001cfe2f7","2010-10-25 05:26:16+00:00","SCUMM: Add patch #3093048 - MMC64: German actor names.

svn-id: r53796
"
"5942382ad4643b9cab526b161b4d04dc71babdc5","2010-10-25 07:07:23+00:00","SCUMM: Add patch #3093051 - MMC64: Ladder facing patch.

svn-id: r53799
"
"2bf64b10506a97a7e9342e5d97ad89bd33628a53","2010-10-25 07:27:05+00:00","ANDROID: Force extra screen update when updating overlay.

This appears to work around a blank screen bug Nexus1.  I never
tracked it down, but as far as I can tell it is triggered by multiple
overlapping updates before flushing the texture to screen.  This
condition only happens in the overlay atm so an extra redraw isn't the
end of the world.

(Also remove an unused _full_screen_dirty property)

svn-id: r53801
"
"7d0598d81025793dd078722a68b429a7e807c8a8","2010-10-25 07:35:40+00:00","ANDROID: Provide an alternate partial texture update for stride != width

The new one copies into a temp buffer and only does one
glTexSubImage2D.  I'm led to believe that this is faster on some
devices (but slower on others).  Disabled for now, but someone might
want to try both versions on their slow device.

Also manually set glColor before calling DrawTexiOES, following
mention of a bug in a discussion I stumbled across.  DrawTexiOES-use
is disabled for now, so this is a noop.

svn-id: r53803
"
"f228c76b35ba5362ffac6fa7cc86fe1acd5fa8f7","2010-10-25 07:53:02+00:00","SCUMM: Add patch #3093061 - MMC64: sentence highlighting.

svn-id: r53805
"
"4f0cc6a435d725e62d38a4c7bdbd597f7f142972","2010-10-25 08:03:55+00:00","SCUMM: Add patch #3093541 - MMC64: Actor Walk / Object Fix.

svn-id: r53806
"
"f158688c33a07bbb9eb6351a6b03d27bcebe6eb7","2010-10-25 08:26:21+00:00","SCUMM: Add patch #3089936 - MMC64: Parcel/Tombstone/Verb Fix.

svn-id: r53807
"
"3bd60b09c1b58a2a75591d89a806d6f0d1b1221c","2010-10-25 08:50:16+00:00","ANDROID: Don't trust eglChooseConfig and refilter/sort results manually

It seems some Android versions and devices (eg Droid) don't implement
eglChooseConfig according to spec and the first result isn't the best
choice.  Implement our own filtering / scoring to workaround this.

svn-id: r53808
"
"a0a9de42e1a86278706c94af5f93522d4077d8fa","2010-10-25 08:51:10+00:00","ANDROID: Add --disable-timidity to the recommended flags

svn-id: r53809
"
"eb6dd6d8c8077f417332ab28dee08aacfd1a75e8","2010-10-25 09:13:57+00:00","HUGO: Add specific v1d object class

svn-id: r53810
"
"6889fe42a3f1ddb64a8ae2eec7c2d22bdd115770","2010-10-25 09:19:06+00:00","HUGO: Fix GCC warnings

svn-id: r53811
"
"0053b7011e6ce00a0947a349b70112185b5430e2","2010-10-25 09:22:46+00:00","HUGO: Add missing files (sorry!)

svn-id: r53812
"
"57b571ecd0b51ce09922c8fcf0f0fbdea0580fb2","2010-10-25 10:35:52+00:00","SCUMM: Add patch #3094711 - MMC64: Correct position of plant actor.

svn-id: r53814
"
"8e923d9c5488080ebbe083fe4b1fc046dcdc6d54","2010-10-25 12:07:07+00:00","HUGO: Add specific function variantes for H2 Dos and H3 Dos

Also add pathfinding to H1 Dos

svn-id: r53822
"
"4e9a2798ef9aef3b28e595adeaa0873fd1ce6171","2010-10-25 13:20:15+00:00","HUGO: Fix display priority order in H1 Dos

svn-id: r53823
"
"35f220ace2ae1839f8a0706fc0e3de1ad39a6045","2010-10-25 13:31:01+00:00","HUGO: cleanup: Suppress trailing spaces and tabs

svn-id: r53825
"
"f4ae774751a82c934203e371b93a144ef1991e7d","2010-10-25 14:03:01+00:00","HUGO: Add a debug channel for Object functions

svn-id: r53826
"
"65c7299b38bf1f2e0b3039895f41d1afed647bca","2010-10-25 14:31:06+00:00","GUI/LAUNCHER: follow-up to r53771

The GM and MT-32 popup widgets would be set to the first available MIDI device by default (before any selection has taken place yet). Instead, default will now be the first list entry.

svn-id: r53827
"
"adcab043a2f765c0d573677f742cf6252959fa1a","2010-10-25 16:33:04+00:00","SCI: fix comment in kAddToPic

svn-id: r53828
"
"d2a7a840c786d0ea0e08267b95da25f655a1f322","2010-10-25 16:41:39+00:00","SCUMM: Move class Player_V2CMS to its own header file

svn-id: r53829
"
"075919756fdc2f5edfec0734b1fe822d2a303ad4","2010-10-25 16:42:24+00:00","SCUMM: Move shared code of Player_V2 & Player_V2CMS to new common base class

svn-id: r53830
"
"b42faf72e8840d235346a636a0f5be721f775a03","2010-10-25 19:59:32+00:00","HUGO: Add specific versions of doAction() for Dos versions

svn-id: r53831
"
"90dcc8c91ad9419e521d2f7917fe4854bf7dcb89","2010-10-25 21:51:11+00:00","SWORD25: Get rid of classes ScummVMWindow and Window

svn-id: r53832
"
"f370ba174aa8085f80779bd92e22189451ccaf01","2010-10-25 22:14:53+00:00","LASTEXPRESS: Add Date-time comments for US & FR Broderbund releases

svn-id: r53833
"
"7ab1e368e880e17d3ea904fe74153219e9531d1d","2010-10-25 22:15:47+00:00","TOON: Implemented Ambient SFX

For example used in arcade playing sounds, lullaby music,
toilet game win sound effects...

svn-id: r53834
"
"e761f76653b1c12493d1cb047ace29264e537e4b","2010-10-25 22:41:25+00:00","SWORD25: Get rid of most of the 'kernel service/superclass' code

svn-id: r53835
"
"c509752da116a66cca8ac9c364edb888b1bbd3d9","2010-10-25 22:41:34+00:00","TOON: Fixed some Z-order issues for animations

Happened when the flag 0x20 was set in Init_Scene_Anim
It says to use the background layer system

svn-id: r53836
"
"e0d5db0bb822f4772d90cd404fb23e89524f7b3a","2010-10-25 22:41:48+00:00","SWORD25: 'Implement' RTL support & add TODOs about missing feature support

svn-id: r53837
"
"a7832856252828450a63fdd1d10c337cc8fb671e","2010-10-25 23:19:39+00:00","SWORD25: Simplify FS 'wrapper' code a bit, add FIXME comments

The save system of this engine currently partially bypasses the
SaveFileManager API, by (abusing) the fact that the Lua engine allows
creating files in arbitrary places (it exposes fopen, fread, fwrite
etc.). This is used to create a 'config.lua' configuration file. This makes it non-portable.

In addition, the filenames used for the savestates ('0.b25s') do not
comply with our naming conventions for engine savestates.

It should be possible to overcome all this, but it might require hacking
the Lua engine; or we could try to replace some of the BS2.5 script
functions with our own, dynamically.

svn-id: r53838
"
"ed0de8462df02e717c9673dfd4e77288377815ba","2010-10-25 23:34:12+00:00","SWORD25: Add FIXME about savegame names; cleanup

svn-id: r53839
"
"8217efc74a9b5066bd158e7fef5edd257aec9f16","2010-10-25 23:34:36+00:00","SWORD25: Disable script triggered screenshots

svn-id: r53840
"
"ae2c4b7cd209b310ae9e01edafa9613c06ff421f","2010-10-26 00:41:42+00:00","LASTEXPRESS: Savegame support update

- Implement Menu::startGame() properly
- Add stubs functions for game restart
- Made savegame headers serializable and moved validity checks inside struct definition
- Implement create/init savegame functions
- Add SavegameStream to be able to read/write to the same memory stream
- Add stubs for setup, writeEntry & loadEntry functions

svn-id: r53841
"
"2f254a35317e9f5588832d88490cf3fca12b94f2","2010-10-26 04:20:20+00:00","SCUMM: Add alternative version of patch #3094717 - MMC64: save actor state.

svn-id: r53842
"
"f663a736dd1d7b8bed0b25e94269f1c4e329ae73","2010-10-26 05:19:24+00:00","LASTEXPRESS: Silence GCC warning

svn-id: r53843
"
"fd8af7ba6ed6753f4b8a656b26d6092c824fc844","2010-10-26 06:55:17+00:00","LASTEXPRESS: Make GameState::time of type TimeValue

svn-id: r53844
"
"dc4a22ed7d1a43703b0a6f2d87480ce948bc20a8","2010-10-26 06:55:34+00:00","LASTEXPRESS: More savegame work

- Implement SaveLoad::writeEntry
- Implement missing saveLoadWithSerializer functions for all serialized classes & structs
- Add stub for SaveLoad::computePadding

svn-id: r53845
"
"bdbd0c1417e54080bafe0bd601715152366f3440","2010-10-26 12:09:38+00:00","LASTEXPRESS: Do not delete Clock & TrainLine frames in clear() functions

svn-id: r53846
"
"6bc59c0bb06e591167124633b06fb6ca9f1d32df","2010-10-26 12:10:38+00:00","LASTEXPRESS: Implement loading of savegame entry headers

svn-id: r53847
"
"0b5cc5b9ff6abd20e5bdada69b1066b3657663e7","2010-10-26 12:10:49+00:00","LASTEXPRESS: Fix forward/backward in the menu

svn-id: r53848
"
"8622ee1ef1fcfc71515440dd9737d7c6a11d77be","2010-10-26 12:11:06+00:00","LASTEXPRESS: Turn dummy action error into a warning

svn-id: r53849
"
"5323be5f8465fb1a8d461aed1e03718bb93e5c49","2010-10-26 12:49:32+00:00","LASTEXPRESS: Fix GCC warnings

svn-id: r53850
"
"f9cb635b5825c89e0084c9e75d420cb9d582ca34","2010-10-26 14:42:24+00:00","SCI: fixing bug #3091767 by reverting r52820

interpreters should get checked for that hoyle 4 code, comment added

svn-id: r53851
"
"a877ba002681f08785c6e01ab341193158c9c648","2010-10-26 15:29:04+00:00","SCI: little cleanup kAnimate

svn-id: r53852
"
"9af803f575aa63cd30e82c596e9e6cbac82613bb","2010-10-26 16:21:00+00:00","SCI: kAnimate bit 2 is hoyle 4 exclusive

adjusted comments about that and also renamed the bit, also added additional TODO, because hoyle 4 has special code that gets into action, when bit 0 is not set, but bit 2 is

svn-id: r53853
"
"d3523a604071eae4f78f879f9d42a81f29b9121f","2010-10-26 20:14:17+00:00","LASTEXPRESS: Read savegame in blocks instead of bytes

svn-id: r53854
"
"d078a4d235117696d889a6f52a0b2c6a0569d6ea","2010-10-26 20:19:17+00:00","SCI: fix gfx issues when giving out cards hoyle4

bit 2 actually triggers special drawing of cels in sierra sci

svn-id: r53855
"
"bd7d9965e9f2048a53e7fe9668d0c2a05cf2fc81","2010-10-26 20:56:55+00:00","SCI: removing unneeded call

was a left-over from debugging

svn-id: r53857
"
"c4d4277807f5990102817ade9d558b700013ebc3","2010-10-26 21:16:16+00:00","HUGO: Add specific schedulers for each DOS version.

This fixes intro (and game) in H3 DOS, general game
behavior in H2 Dos. H1 Dos is still broken.

svn-id: r53858
"
"786b5f64737d29d4e06639025074911916c21c78","2010-10-26 21:49:51+00:00","TOOL: Add credits for Hugo

svn-id: r53859
"
"86d6f3c2000435bd14b2726a8bd94183b333619a","2010-10-26 21:54:57+00:00","GMM: Add a basic help dialogs for engines not providing  one (i.e. all but SCUMM)

svn-id: r53860
"
"dfdf8f2e805022d8b018bd8ee2961bdea167716a","2010-10-26 21:55:29+00:00","Update credits

svn-id: r53862
"
"83eb3b36541aa9ca2872db6fd173e628d16b094a","2010-10-26 22:00:44+00:00","TOOLS: Add short description for CREATE_TOON, standardize tabulation

svn-id: r53864
"
"66da19552ea855d825c6a68b00e3e5ea8b84d932","2010-10-26 22:18:14+00:00","TOON: Implement cmd_Set_Anim_Scale_Size

Used to rescale the knight animation when the knight
is moved around the room in Chapter 2

svn-id: r53865
"
"fc1e70eb01007e89a66ca9d9313f7e1b1ffc1e0b","2010-10-26 22:26:13+00:00","TOON: Fix SetMousePos wrong position

When the game was in a close up, cmd_Set_Mouse_Pos was setting
a out-of-window mouse position.

svn-id: r53866
"
"4e2d1b507a395c6dc618af38711e30bd89a91b00","2010-10-26 22:30:39+00:00","BASE: Remove oudated comment, and redundant warning

svn-id: r53867
"
"7c2323bdc3163dae4f03dfc033ad7e47fb20ccda","2010-10-26 22:33:49+00:00","AGI: Replace report() macro by debug() / warning()

This makes AGI quite a bit less noisy by default.

svn-id: r53868
"
"2c99caa795e1215b2dff286f68887f45460a7edf","2010-10-26 22:35:37+00:00","AGI: Fix memory leak in AgiEngine::parseFeatures()

svn-id: r53869
"
"415f9a1b0b510dead1c0c8afa17d42c7065541c0","2010-10-27 09:47:18+00:00","AGI: Add note about AgiEngine::parseFeatures

svn-id: r53872
"
"13b6e0d69a041a4598b12cd92fbf2c00a347b932","2010-10-27 11:09:03+00:00","PSP: Fixed ImageViewer code to deallocate TimedMessageDialog

Not deallocating it before loading the next image causes fragmentation in memory which eventually prevents big things from being loaded into memory.

svn-id: r53873
"
"9ab69ab6f459b92e3283fac51b26326a3490f220","2010-10-27 14:31:20+00:00","GROOVIE: Fix bug #3095031 (regression in Russian T7G).

Additionally fixed some NEWS file punctuation.

svn-id: r53874
"
"b5e41b3a82a6f39302b34dd0b582265d3028d8ed","2010-10-27 15:15:59+00:00","SWORD25: Fix out of bounds writes when pressing keys like ctrl or F-keys

This fixes a crash one got by quitting via the GMM.

svn-id: r53876
"
"95353b0e60a8acaec28bd0e348b8f1c76d92cabf","2010-10-27 15:53:36+00:00","SWORD25: Use ScummVM keycodes

This should enable use of F-keys in BS25. Most of the KEY_*
constants are not used by the scripts anyway.

svn-id: r53877
"
"aaf7ffdd5c160447cfa56468bf0a8c768d14ad5d","2010-10-27 15:53:53+00:00","SWORD25: Fix keyboard state handling

Previously, you could get the game into a state where it would think a
key was constantly being pressed. E.g. by pressing 'p' several times
quickly in a row, the game would end in a state where it endlessly
toggled between pause mode and regular mode.

svn-id: r53878
"
"dba75791d9fcda63c546975fa98da4bc64afce7d","2010-10-27 19:19:22+00:00","LASTEXPRESS: Add some missing casts and const qualifiers

svn-id: r53880
"
"d5e4ab6b209b1e2a847993ce40a4c015e795b168","2010-10-27 19:19:38+00:00","LASTEXPRESS: Cleanup game saving

- Move loading of game stream to separate function
- Add checks for NULL in functions using _savegame
- Add expected saved size for sound & savepoints

svn-id: r53881
"
"5688a393b420a8f3ba83444c44bebcff47c7339a","2010-10-27 19:19:57+00:00","LASTEXPRESS: Do not try to show intro when loading a game

svn-id: r53882
"
"cdfcaa4d48fe31afd795da787fa798054b2824e6","2010-10-27 19:20:20+00:00","LASTEXPRESS: Implement game loading (last save entry only)

svn-id: r53883
"
"44ba44297d13c4b197819678963fa8f99fbd4e37","2010-10-27 19:21:52+00:00","LASTEXPRESS: Hide menu elements after a game has been loaded

svn-id: r53884
"
"5a336830a00c1371d8307794c7e43fe98e7baa1d","2010-10-27 19:22:05+00:00","LASTEXPRESS: Use Common::Rational when adjusting menu clock

Also fix the wrong check that set the time directly to the target time

svn-id: r53885
"
"e85f43877aa4e2e2750c6f2d5cfd3f562d893fe5","2010-10-27 19:22:37+00:00","SCI: Proper pausing/resuming of MIDI music in SciEngine::pauseEngineIntern(), Console::preEnter() and Console::postEnter() and added a sanity check in SciEngine::getDebugger()

svn-id: r53886
"
"8dbe052ca2f55d003491be52d6f322cdbb1e8ef1","2010-10-27 19:43:35+00:00","LASTEXPRESS: Rename variable to silence GCC warning

svn-id: r53888
"
"4089b9fe2cd506a8b708d376e88441a36fc72260","2010-10-27 19:48:54+00:00","JANITORIAL: Remove unnecessary semicolons

svn-id: r53889
"
"8a08ca1f39a0dc5ad6003d8213fe8aec4acb7327","2010-10-27 21:43:08+00:00","SCI: Cleanup, invoking pauseEngine() on Console::preEnter() and Console::postEnter()

svn-id: r53890
"
"2ad28b8cd53c363f12d920c746795e0d371dc9f9","2010-10-27 22:37:51+00:00","ENGINE: Generalize SCUMM play time counting and move it into Engine.

This implements Max's idea on -devel
('Re: [Scummvm-devel] ATTN Engine authors: Advanced engine features') from
27.10.2010 on 11:12PM CEST.

Unlike the SCUMM implementation it stores the play time as ms instead of s.

The SCUMM engine was adapted to use this instead to reduce code duplication.

svn-id: r53892
"
"ab1c54a9eef79090c7cf81f09e561480b4964671","2010-10-27 22:41:08+00:00","TOON: fix some evaluation order bugs in smacker decoder

These bugs would cause crashs in MSVC 2008/2010 release builds.

svn-id: r53893
"
"dac9493069509518c0f508f93630584765bac5df","2010-10-27 22:52:02+00:00","ENGINE: Rename resetTotalPlayTime to setTotalPlayTime.

I also extended the comment for it to show two possible use cases.

svn-id: r53895
"
"7e1d78cab1f25bf15c67d523dab1891067bd07f7","2010-10-28 00:24:53+00:00","SWORD25: Simplify InputEngine::(un)persist

svn-id: r53897
"
"cf3551525f4583ec8a5feb231cb25d81a9722853","2010-10-28 00:25:33+00:00","SWORD25: Get rid of CallbackRegistry

svn-id: r53898
"
"b2fa7e58a395b883e7c59ecb1f29f8fc6607885b","2010-10-28 00:26:25+00:00","SWORD25: Start to rename read/write methods of *PersistenceBlock classes

All should be renamed to reduce risk of accidental incorrect use.

svn-id: r53899
"
"f772de04f9d6c0ab6a386af580b69fd162568974","2010-10-28 08:16:03+00:00","CREDITS: Added sword25 engine

svn-id: r53900
"
"b53d12da23e6154e0f027fef68cc21518f53018d","2010-10-28 09:51:56+00:00","SWORD25: Standardised savegame filenames, start on advanced engine features

svn-id: r53901
"
"3a4647dc50aebfa89dd495d12573198b46b78893","2010-10-28 12:48:51+00:00","SCI: Several changes related to MT-32 -> GM mapping

- Changed C - style comments in map-mt32-to-gm.h to C++ - style comments
- Added a new dynamic MT-32 -> GM mapping, complementary to the normal one, which can be done on the fly using the new console command 'map_instrument'
- The 'show_instruments' command has been moved to the music section and now displays the instruments of the game which aren't in the MT32-> GM mapping

svn-id: r53902
"
"a7b5133903ef4a50a52b5d6ecd5264ec6e69b62c","2010-10-28 13:00:21+00:00","SCI: Improved the description of the 'map_instrument' console command a bit. Also, the dynamic mappings are now checked before the static ones

svn-id: r53903
"
"0e7444a4638e32292ae00bcba8d8394bd4e22481","2010-10-28 15:27:44+00:00","SCI: Fixed compilation and added include safeguards to map-mt32-to-gm.h

svn-id: r53904
"
"408d0e6c5fe6e01a5503aa0985b88bdac2798e6d","2010-10-28 15:33:28+00:00","SCI: Fixed typo

svn-id: r53905
"
"27c52434badedc7c94f01eba8d3eb24495baabc5","2010-10-28 16:26:04+00:00","SCI: Split the GM related names out of map-mt32-to-gm.h and into a separate header file

svn-id: r53906
"
"b3e42b94c916b3c0bb51bc78cb34cd25fbcbd65c","2010-10-28 18:45:11+00:00","SCI: Added some missing GM mappings for MT-32 instruments:

- MT-32 Castanets -> GM Claves
- MT-32 OneNoteJam -> GM Celesta
- MT-32 JungleTune -> GM Pan Flute
For PQ3 (from rev #53902, not in the commit description):
- MT-32 Warm Pad -> GM Pad 2 (warm)

Thanks to digitall and waltervn for their help with these

svn-id: r53907
"
"ec08328f0c08cddb312e640de25dcc3532615837","2010-10-28 21:39:46+00:00","TOON: Fixed some animation glitches for small sprites

Fixed problems when the uncompressed is smaller than compressed size
Bug fix sent by Thomas
It also fixes Bug fix #3086004 : 'TOON: Lights above WACME doors incorrect'

svn-id: r53908
"
"2c042c263b9d3fac7d3087770b4788af8d6c3a0f","2010-10-28 22:45:15+00:00","SWORD25: Comment out unused static variable.

svn-id: r53909
"
"d7f8fc108e788057e174e454481fcdd739193176","2010-10-28 22:58:39+00:00","SCI: Updated help page on the new console command 'map_instrument'

svn-id: r53910
"
"607920c869b16646be595a1e5938576f7476f950","2010-10-28 23:56:36+00:00","KYRA: Fix some code errors reported by ICC (i.e. subclasses not overwriting methods by missing a const.)

svn-id: r53911
"
"32338876f8565197edca64bc01492961639e9d95","2010-10-28 23:57:24+00:00","KYRA: Rename KyraEngine::saveGameState to KyraEngine::saveGameStateIntern.

This is to avoid name similarity between KyraEngine::saveGameState(Intern)
and Engine::saveGameState.

svn-id: r53912
"
"88ad2d39914a2e87773757940d7596304d749c99","2010-10-28 23:59:37+00:00","SCI: Fixed a detection entry of Hoyle 1 (bug report #3090841)

svn-id: r53913
"
"07e9c6a03558a12a2445a467f034f5f211397763","2010-10-29 00:40:35+00:00","KYRA: Minor formatting cleanup.

svn-id: r53915
"
"62c5f4f8e5bc7595d2eea735f38b8eb427b4dd7d","2010-10-29 00:40:57+00:00","MT32: Remove useless cast.

svn-id: r53916
"
"082d9a446571ae034d4deaeb81c0affde450224d","2010-10-29 07:08:24+00:00","PSP: corrected png loader to use bit depth rather than palette size

Sometimes we can have an 8bit file for example that has a palette of 16 colors or less, so we need to go by the bit depth rather than inferring the bit depth from the palette size.

svn-id: r53917
"
"547e028b93cdc279d4ee871b94aac5701534cb28","2010-10-29 07:55:18+00:00","PSP: Improved image viewer movement

Before the limit was arbitrary. Now we check the proper location on screen and move in increments relative to the size on screen.

svn-id: r53918
"
"509f79990daa032c40af759552064c28b703ea97","2010-10-29 10:28:20+00:00","SCI: Updated kSetShowStyle signature for SCI2.1. SQ6 starts again

svn-id: r53919
"
"5cfb461b5b340e5f95134fcc10a8ae21af59f2a6","2010-10-29 10:58:54+00:00","SCI: Added detection of some fan made script patches.

When such a script patch is found, a dialog pops up at the beginning
of the game, asking the user to remove it. The issues that these
script patches fix have already been fixed in ScummVM, thus these
patches aren't necessary, plus they can lead to crashes, freezes, buggy
behavior and/or unexpected errors, thus it is better if they aren't
used at all, if possible

svn-id: r53920
"
"6aec3882a453c0667c4596d9212a8150fc6093ee","2010-10-29 16:28:22+00:00","SCI: Remove unused variable + some formatting fixes.

svn-id: r53921
"
"1b2952e3ff6b21c90f5981795de7ca66e56fabec","2010-10-29 16:41:30+00:00","ENGINE: Add a setPlayTime to SaveStateDescriptor taking an ms value.

svn-id: r53922
"
"447ca7ea696fb7edb26610ccb57605b28dcf7625","2010-10-29 16:41:49+00:00","SCUMM: Switch to the new SaveStateDescriptor::setPlayTime.

svn-id: r53923
"
"a5c28de26b8e98b424f03aa957c947cec969cfe5","2010-10-29 16:53:46+00:00","SWORD1: Switch to the new play time counting of the Engine class.

svn-id: r53924
"
"1ed0051fcee19bca86cb352b077967a819dc5b46","2010-10-29 16:54:10+00:00","DRACI: Switch to the new play time counting of the Engine class.

svn-id: r53925
"
"67566890bd07256e56ed113e5b0df1f1a9f76112","2010-10-29 18:57:19+00:00","KYRA: match music settings with latest launcher code changes.

(Users will get AdLib music at default unless they have specified a MIDI device in the launcher (MT-32 for KYRA, GM for HOF and LOL.)

svn-id: r53926
"
"c9442e26ad70fa18dbcee3814ca586e2bc45bdf8","2010-10-29 19:00:37+00:00","KYRA: match music settings with latest launcher code changes.

(Last commit got trunkated somehow)

svn-id: r53927
"
"ecd3e29fe0854c632e5a7688b171e24561c70fc2","2010-10-29 22:00:31+00:00","TOON: Stops all Sfx/voice when exiting a room

Caused crashs when exiting when a sfx or voice was still playing
Bug found by Thomas

svn-id: r53928
"
"c0063a6d502daa189b1790ea3e186dfcecd06d8c","2010-10-30 00:32:45+00:00","COMMON: Add SCUMMVM_CURRENT_FUNCTION macro (useful for debugging)

svn-id: r53931
"
"55a8bd9e359074709975e6b99629fbb3cae4a913","2010-10-30 00:33:11+00:00","TINSEL: Add COROUTINE_DEBUG macro to ease debugging coroutine code

svn-id: r53932
"
"afb5986c9eaf172d2a00530012702f7054e95521","2010-10-30 00:33:31+00:00","TINSEL: Dispose state of active coroutines in Scheduler destructor

This fixes some leaks that occurred when exiting the game resp.
returning to launcher. Note that we still leak some coroutines when
exiting after loading a savegame.

svn-id: r53933
"
"ac94cf274290911fc3ee5395202b30f161601a62","2010-10-30 00:33:54+00:00","TINSEL: Fix subtle leak in coroutine code, some minor tweaks

* Fix a bug which caused coroutines invoked with nullContext to
leak their state.
Sadly, nullContext is underdocumented, yet very delicate and
full of subtleties... ./
* Move nullContext decl from sched.cpp to coroutine.cpp
* Enhance a few doxygen comments

svn-id: r53934
"
"36d17c74d127a7718bb3e713bd89fccd91017e97","2010-10-30 00:34:21+00:00","TINSEL: Remove unnecessary CORO_PARAM from ObjectTextOut

As a nice side effect, this gets rid of 25 out of 64 occurrences
of nullContext in the TINSEL code.

svn-id: r53935
"
"a487da3c19e69400a5f89ecb2935a5a6b572817c","2010-10-30 00:34:41+00:00","TINSEL: Remove redundant if()

svn-id: r53936
"
"919d79f091bece96d33a7f1fba4cdab6d6b65821","2010-10-30 04:30:42+00:00","SWORD25: Added a hack to allow the new English voice pack to be detected

svn-id: r53937
"
"09c678e3631567330123b5035f3798fbbd6e8e82","2010-10-30 08:21:10+00:00","SWORD25: Fix hanging cutscene video

Even though our video player does not (yet) support audio, we need to
adjust the values of _audiobufFill and _audiobufReady as if it did, or
it will never realize it has reached the end of the cutscene.

Also fixes what looks like a typo in audio data clipping.

svn-id: r53938
"
"71e08336c03a6f2f472dd0144e4744bf8797e9bd","2010-10-30 09:17:21+00:00","SWORD25: Play the cutscene audio

Once the audio buffer has been queued in the audio stream, the Theora
decoder is no longer responsible for it. It has to allocate a new
audio buffer for the next set of audio data.

Of course, at the moment the audio is pretty useless because the
playback speed is all wrong.

svn-id: r53939
"
"ef7cc2d5062346f8499b2c31291560ffaa5f9deb","2010-10-30 11:07:44+00:00","SCI: Fixed detection of fan made script patches for LSL1

svn-id: r53940
"
"bf44b0e5455358cac7ae6492d3f0b479d37e830f","2010-10-30 11:21:28+00:00","SCI: Fixed script bug #3098353 - 'ECOQUEST1 German: Crash at the blackboard in the dolphin room'

svn-id: r53941
"
"724a702fdfb5cd635706403829f8770bb3a3de8d","2010-10-30 16:04:43+00:00","HUGO: Free memory on exit

svn-id: r53945
"
"31dd8026dce37df32785443b6ee1b535873b4b29","2010-10-30 17:24:52+00:00","GOB: Minor map cleanup

- Move enum Direction out of class Map
- Convert kLeft et al into a proper enum RelativeDirection

svn-id: r53946
"
"1612a96285d4da48208fad2f704a6335925deac5","2010-10-30 17:25:29+00:00","GOB: Unify Map_v1::/Map_v2::getPass()/setPass()

svn-id: r53947
"
"4c23f3e1631ed904fa67b77b964e73aae4873850","2010-10-30 17:26:06+00:00","GOB: Make Map::_passMap protected and group some vars

svn-id: r53948
"
"bfa88a05a153ec7c91d0b2e79c9f5705c9ba55ed","2010-10-30 17:26:49+00:00","GOB: Make Map::_wayPoints protected

Only allow const access through Map::getWayPoint()

svn-id: r53949
"
"0f536e28f9c3b6ee7bb3a92de49c8efc03e70ea8","2010-10-30 17:27:23+00:00","GOB: Rename Map::_widthByte to _mapVersion

svn-id: r53950
"
"8a7d0cc249ead074d7fb5bc8ff45acb279b87f80","2010-10-30 17:27:53+00:00","GOB: Remove the 'ugly' reading of Map::_itemPoses

Removing the need to pack that struct

svn-id: r53951
"
"0f3ed50cfc6d1542d95a9d07c557572043c3060b","2010-10-30 17:28:27+00:00","GOB: Make some more map properties protected

svn-id: r53952
"
"14d8d589e24c64370ed2ba8fb5254066b7ab1d47","2010-10-30 17:28:54+00:00","GOB: Make Map::getItem()/setItem() nonvirtual

svn-id: r53953
"
"a04b4e6517adf73d2738e9efdc70e8c5af355e1b","2010-10-30 18:37:15+00:00","LOL: workaround for bug #3098935

(Vaelan's Cube can be duplicated at Scotia's Barrier)
This is a bug in the game data of early unpatched floppy versions.
This can also be fixed by applying the official patch (ftp://ftp.westwood.com/pub/lands1/updates/lolus123.exe).

svn-id: r53954
"
"f1ed9c9a6f5d28749ed330f73000b15d1810b290","2010-10-30 19:51:17+00:00","SCI: add Russian SQ4 & SQ5

svn-id: r53955
"
"6c702094a8a2907b6e177124f424306b7a5a40ef","2010-10-30 20:48:54+00:00","HUGO: Free some more memory before exiting

- suppress two useless variables
- initialize some variables

svn-id: r53956
"
"9995c7bd980352be55807db03bf0bf2ed55e1d78","2010-10-30 21:25:30+00:00","HUGO: Comment out all occurrences of FILE *fpb

These are not portable, and (at least in the current code)
do nothing useful either: a file is opened, and closed again,
in write mode. At most this may create / delete the file.
But since the method containing this code is never called...

svn-id: r53957
"
"c07e58ba069a6594305396cdec0e451ebce9f197","2010-10-30 21:25:52+00:00","M4: Disable code using FILE, fopen, etc. and add explantory FIXME

svn-id: r53958
"
"334173d3331213e2ae8de6faca5de27688fc5964","2010-10-30 21:26:13+00:00","M4: Remove unused getter method MadsM4Engine::system()

svn-id: r53959
"
"ff34a778318355ffba2ee5700524fccba9fe5cf3","2010-10-30 21:26:32+00:00","GUI: Don't #include Mac OS X sys header here

svn-id: r53960
"
"44393b2dc8ba78342dcbb7df39eca2e9e1f6e429","2010-10-30 21:27:42+00:00","ALL: Add code to help stop people from accidentally using 'bad' APIs

A new header file common/forbidden.h is included by scummsys.h and it
re-#defines numerous symbols like fopen(), fread(), system(), etc. with
garbage, in order to provoke compile errors in any code using them.

If a .cpp file really *must* use any of these (e.g. because it is a
backend file), then these redefinitions can be disabled by #defining
FORBIDDEN_SYMBOL_ALLOW_ALL as the first thing in the .cpp file. Whenever
this is done, an explanatory comment should be added.

Note that this system cannot catch all 'bad' usages (notably the Lua
code in the sword25 engine), as it can only work if scummsys.h is
included.

svn-id: r53961
"
"768038be1147d66b31e508b61099726018f96e10","2010-10-30 21:49:20+00:00","GP2x: Enable use of forbidden symbols

svn-id: r53962
"
"19c3196c1ce73fd0b05d17df03fe56cbb9d711db","2010-10-30 21:49:46+00:00","LINUXMOTO: Enable use of forbidden symbols

svn-id: r53963
"
"1425013c4bd67add0037806060b178b17c4c6e4f","2010-10-30 22:43:25+00:00","GPH: Enable use of forbidden symbols

svn-id: r53964
"
"6801af969144ef3ea4fc8035f9aebf669f8c84ff","2010-10-30 22:44:15+00:00","TOOLS: Enable use of forbidden symbols

svn-id: r53965
"
"4369f24ae817fa79e14c3ff36a0b5ecf40b99050","2010-10-30 22:44:37+00:00","CREATE_HUGO: Avoid use of global constructors

svn-id: r53966
"
"064bdebd55392096a98837a24413d6244fa2c60c","2010-10-30 22:44:57+00:00","LASTEXPRESS: Use const_iterator to iterate over a const array

svn-id: r53967
"
"6ea76cd9133a76645ef74c9fc75aed80ed2b5d14","2010-10-30 23:53:30+00:00","SDL: Fix SDL plugin provider code (used e.g. by Dingux port)

svn-id: r53968
"
"184c732bf6d1a2fd77eecf6f95314eb5181057ce","2010-10-30 23:53:59+00:00","PS2: Enable use of forbidden symbols

svn-id: r53969
"
"ac748c2ebd6fc437df2d7232edcc53cdbd532760","2010-10-31 00:01:00+00:00","PSP: Enable use of forbidden symbols

svn-id: r53970
"
"2e4cedd98a472a9e5109b546d42cc14fcd6bd42b","2010-10-31 00:04:24+00:00","IPHONE: Enable use of forbidden symbols

svn-id: r53971
"
"917c4b00cb95f390ab75f77620c202866edb5254","2010-10-31 00:14:59+00:00","WINDOWS: Enable use of forbidden symbols

svn-id: r53972
"
"ec680ef8aad8e82a14eb5a2af59fb72284919722","2010-10-31 00:20:30+00:00","LOL: fixed bug #3099321

(Crash in Yvel tavern basement)

svn-id: r53973
"
"dca3c8d8bfc6c4db38cf8e8291818dd472041d4e","2010-10-31 01:45:24+00:00","SCI: Play time related changes

- Added support for savegame play time
- Removed obsolete variables for calculating the play time (EngineState::gameStartTime and Console::_enterTime)
- Renamed some variables to camelCase

svn-id: r53974
"
"94c8d0a14df429a1b25bd9f5c5d75497fd0ddbd1","2010-10-31 11:08:43+00:00","Updated with latest from trunk

svn-id: r53976
"
"27182f266f48a6d55dd5d830ed19e2c4285ac1ba","2010-11-01 06:31:09+00:00","PSP: removed CXA_AT_EXIT. It didn't work well because __dso_object already exists in the main executable, causing it not to be built in the plugins.

svn-id: r53996
"
