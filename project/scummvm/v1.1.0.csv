"commit id","commit date","commit message"
"94b823fcc772d80561d5476446ed7945819ed6e8","2009-09-25 06:22:54+00:00","MERGE branch gsoc2009-draci 41388:44325 into trunk

svn-id: r44326
"
"edd338b229f4c6d6fc0b2aeb7e3bcf412c80071d","2009-09-25 06:43:33+00:00","Make engines/draci/ compilable after merging from a branch

svn-id: r44327
"
"7106caca810bb8012f3c04edc4ef01d73215bd66","2009-09-25 07:05:26+00:00","Replaced the C99 lround() with floor(), to get draci to compile under non-C99 compilers (e.g. VS)

svn-id: r44328
"
"a74a9c6c0120b9b84df2a8ff9b430e840d472431","2009-09-25 07:06:55+00:00","Silenced some warnings

svn-id: r44329
"
"d6502a0c2416fc388a4e4e2c93315202fecaac5e","2009-09-25 07:11:19+00:00","Added MSVC project files for the newly-added draci engine

svn-id: r44330
"
"f51c81f34402c665751774b23f3734b7b7a0b2b4","2009-09-25 08:13:39+00:00","Add const's to many interfaces of engines/draci/

svn-id: r44331
"
"6ea572b183dd3d7764d7bc866c3da04e23f1e936","2009-09-25 09:08:17+00:00","typo

svn-id: r44333
"
"e2017d4681f2de667f24afd61ead524ff19b8a9a","2009-09-25 09:09:22+00:00","Mention 16bit graphics and SCUMM Amiga fixes in NEWS

svn-id: r44334
"
"07092bfccbfdbb5e01cb99068f36229055e56df6","2009-09-25 09:10:59+00:00","Removed dead code

svn-id: r44335
"
"adaf3ec8b4818f89e9f4d39fb2a14710b0f0bd5b","2009-09-25 09:13:33+00:00","SCUMM: Rename _bitDepth to _bytesPerPixel

svn-id: r44336
"
"e296cef9becef7e890cd1ce33d1b0ae23007a784","2009-09-25 09:48:43+00:00","Created a macro for lround(), for non-C99 compilers, and used that in places where lround() is used

svn-id: r44337
"
"3c8500c14966d8e1b49918056ff1fc9128ae4ea9","2009-09-25 09:57:38+00:00","Patch #2856708: AMIGAOS4: FS updated to new SDK

svn-id: r44338
"
"d72ad75c52c70ce1232dbc9bdb7fe7219201f289","2009-09-25 10:11:31+00:00","Reverted commit #44316, as colors show up correctly now without dithering. Dithering is now off again for SCI0 by default, an can optionally be turned on

svn-id: r44339
"
"761d0e53f9ca089c730e9e308256caab3a6384ce","2009-09-25 11:03:04+00:00","Cleanup configure script: (1) don't add -DUSE_ARM_*_ASM redundantly to DEFINES, we already add these automatically in ports.mk; and (2) #define macros that determine the host OS consistently via -D and not via config.h

svn-id: r44340
"
"399c511f908b5e6cc6bf13f926c12e0ca3470060","2009-09-25 11:21:56+00:00","Part of patch #2850021: disable hq-scaler&mt32emu for motoezx&motomagx-platform

svn-id: r44341
"
"1a4257f46ffd9179ebb06c4b2cb7617f4acceb6e","2009-09-25 11:22:14+00:00","Move linuxmoto specific stuff from ports.mk to a new file backends/platform/linuxmoto/linuxmoto.mk

svn-id: r44342
"
"67564cb5323f5444a54530eda3b948320160c3bd","2009-09-25 11:22:29+00:00","Move wii specific stuff from ports.mk to backends/platform/wii/wii.mk

svn-id: r44343
"
"957f9c0b551282d94693ac4762033e6b1630af0d","2009-09-25 11:27:12+00:00","More of patch #2850021: disable hq-scaler&mt32emu for motoezx&motomagx-platform

svn-id: r44344
"
"20ad5714387906acac142d4040525630dbeac319","2009-09-25 11:27:41+00:00","Last part of patch #2850021: disable hq-scaler&mt32emu for motoezx&motomagx-platform

svn-id: r44345
"
"f91f4d4186f06281f3e1cd3c2b267f6dd9018220","2009-09-25 11:39:22+00:00","Patch #2858137 and fix for bug #2855359: fmt_fnt.rom font loading failure is ignored

svn-id: r44346
"
"26f2597fd1d8f7b5264ffa12d2d80a690d0f4503","2009-09-25 12:11:27+00:00","Modified version of patch #2838507: Add support for non-gcc compilers to configure, Makefile etc

svn-id: r44348
"
"f66485eb514d369d1f1b87ac6b7a354204660ca3","2009-09-25 12:17:08+00:00","LINUXMOTO: main.cpp is now linuxmoto-main.cpp

svn-id: r44350
"
"55211a1c1deec4d30870bdc7740fa771e8c3b521","2009-09-25 12:20:22+00:00","cleanup

svn-id: r44352
"
"6eb639d5ca45d761b0c513ee45cad5e109880d06","2009-09-25 12:24:14+00:00","NDS: Added some more DS specific defines to configure

svn-id: r44353
"
"d374d7d5f42f83b2509fd6288ee7f768101714e9","2009-09-25 12:25:27+00:00","Only include Makedepend when really using SGI MipsPRO

svn-id: r44354
"
"4221773f6a5f470cdd1df5b9224c442a458f5047","2009-09-25 13:01:35+00:00","SCI: Pedantic cleanup

svn-id: r44356
"
"78d2ea9fcf863db4ba5f7bf92a7a4fecc4da6fc2","2009-09-25 13:01:50+00:00","SCI: Fix a memory leak

svn-id: r44357
"
"2fe6b329686cea10765ec87584455637ce656b47","2009-09-25 13:02:11+00:00","SCI: Remove EngineState::game_version, it was only used for saving anyway. Also remove syncCStr()

svn-id: r44358
"
"180b3f1247e44c7167ca9578261b570357c11b7a","2009-09-25 16:15:57+00:00","Create a define for the special 'signal' offset used throughout the engine, and fixed the arbitrary 0 values from commit #44294, set when some math functions do invalid calculations

svn-id: r44359
"
"431780297e6db1f97733689a6c1485a624a61dc9","2009-09-25 17:33:00+00:00","Added some more const's to the interface of Dragon History

svn-id: r44362
"
"229aee065c9d808bd67b24b9a8d2b041fb4ca37e","2009-09-25 18:56:53+00:00","LOL/PC-98: start fixing text displayer

svn-id: r44363
"
"5ffc41a09ebc2618d2231f31ad7daf3183e14f67","2009-09-25 19:15:01+00:00","Remove redundant -Wno-multichar and -fno-exceptions from configure (they are already specified in Makefile)

svn-id: r44364
"
"77a27acf83d2375c1dc2e091cd30dfb0514d0634","2009-09-25 21:33:00+00:00","LOL/PC-98: fixed dialoge box sizes

svn-id: r44369
"
"73a4b7857fd7daea46c148096cf7ba945a3d6b2e","2009-09-25 22:07:34+00:00","LOL/PC-98: fixed gui colors (money stash, live and magic bars, scroll)

svn-id: r44370
"
"7f1b50f300997a90fa5a66d8e741cd9d0a535231","2009-09-26 04:13:44+00:00","Dirty rects fix for pixels remaining on screen changes

svn-id: r44371
"
"a5df07f56ae159b306e81d5920ae228be817e284","2009-09-26 04:37:19+00:00","Bugfix for the dirty rects for drawn sprites when the sprite is partially off-screen

svn-id: r44372
"
"e46029e8c614c2f18419691baf1ff3b9fd40e95d","2009-09-26 09:31:05+00:00","added option to allow control digital imuse tempo callback. it's related to volume fading, lip sync quality and platform resource costs.

svn-id: r44374
"
"84accad507657e636789d23fe457dca6f3447c23","2009-09-26 13:17:11+00:00","LOL/PC-98: start fixing sequences (like broken arms inn and king richard getting poisoned)

svn-id: r44375
"
"27a638fa824b624f425c3f548255b0736ddd9f6d","2009-09-26 13:47:32+00:00","draci: Fixed bug in Surface::centerOn{X,Y}() which made it return a negative coordinate for strings that are too long. Resolves the crash caused by the English data files containing strings which are improperly line-breaked. Ideally, the engine should do the line-breaking itself when the string does not fit.

svn-id: r44376
"
"605b6fd885f0adbec016bcecac6d557b45873647","2009-09-26 15:04:09+00:00","removed packed structs/direct read/writes, so the game should work on big-endian archs.

svn-id: r44377
"
"7242428a048ae7e71bff8fadd1ceebffdd356fc3","2009-09-26 15:05:47+00:00","commented out walkbox debug code.

svn-id: r44378
"
"eb24b8e4552bd1459d5340514593fab78ddcb58e","2009-09-26 16:03:16+00:00","FLAC support had a typo in detection, fixed

svn-id: r44379
"
"5d17bae1208012d3f8213ac43d10481a6776c2f7","2009-09-26 18:25:36+00:00","LOL/PC-98: more fixes for text displayer and character inventory

svn-id: r44380
"
"00504a893b3039ede85668243ef9cf54901494c3","2009-09-26 21:17:47+00:00","LOL/PC-98: fix menu colors

svn-id: r44381
"
"a49da8381b25d3d536e28a906a16093ad23d2993","2009-09-26 22:50:35+00:00","SCI: Fix copy/paste error

svn-id: r44382
"
"be0b1e060bd5c8bd9ade520e827c9135658de04f","2009-09-26 22:55:24+00:00","SCI: Fix regression in r44081 breaking walking in QfG2

svn-id: r44383
"
"c12a78eaa8792ce5a499eda46e13809275603c03","2009-09-26 22:56:15+00:00","SCI: Fix compile error with DEBUG_AVOIDPATH

svn-id: r44384
"
"f7d7140876a3f516025f3e54f63696f49f44e5ee","2009-09-26 23:43:45+00:00","SCI: Ignore size argument to FILEIO_WRITE_STRING.
This matches LSL5's expectations when saving the password.

svn-id: r44385
"
"933bdcf8296d008483131c5ba00919eba7b63ae9","2009-09-27 01:49:35+00:00","SCI: Add warning when dereferencing non-aligned stack pointer

svn-id: r44386
"
"5d2d8c580a902c97b201f2e012a7888f94e44581","2009-09-27 01:49:56+00:00","SCI: Add utility functions for copying data between raw/non-raw segments

svn-id: r44387
"
"d3c19163847de0dbfc28972b91f43a7b4c0ded7f","2009-09-27 01:50:26+00:00","SCI: Major string handling update.

All string access to segments should now work with both raw and non-raw
(reg_t) segments, using the new utility functions in segMan.

There will likely be regressions.

svn-id: r44388
"
"2f40ea11e654e888108f64be4650dc68a2c3c72f","2009-09-27 05:17:00+00:00","added save()'s where needed

svn-id: r44389
"
"6ecf67b96f8e65c265c01d5b6fdc2dcb48835781","2009-09-27 05:24:45+00:00","replace spaces with tabs

svn-id: r44390
"
"1b1471e8da6ec1c9349c5e6ddebb43392abc7218","2009-09-27 10:36:30+00:00","TUCKER: add missing compressed file close when version doesn't match

svn-id: r44392
"
"0f564aad8138366d7606875b623e573cbb6141d4","2009-09-27 10:36:45+00:00","TUCKER: add clipping for text drawing

svn-id: r44393
"
"56e2e32268859e98263097e669abe2ab104774e9","2009-09-27 11:14:01+00:00","SCI: clean up kStrAt

svn-id: r44394
"
"77751a04556547fc65f5b7cb7e007644e2f470fc","2009-09-27 12:23:14+00:00","SCI: change segment offsets in reg segments to be in half reg_t.
This makes offsets in raw and reg segments consistent, which
fixes string addressing in savegame dialogs.

svn-id: r44396
"
"08e4d96a7d044cca5075b00ee82faa3babaa477a","2009-09-27 13:05:50+00:00","SCI: clear strcpy's dest string if src is invalid.
This fixes moving the plank at the start of KQ6 in Text mode.

svn-id: r44397
"
"4d31d0d7251aafe6608ab134dbcf1541c10a6895","2009-09-27 13:08:56+00:00","SCI: Fix crash when opening menu's

svn-id: r44398
"
"1f8a06a0b83a9e7da910da04a4f10eefeb600655","2009-09-27 13:48:51+00:00","added missing sound

svn-id: r44399
"
"33e9b0baf941d2541e616d2f46f98471e5e3b788","2009-09-27 14:18:21+00:00","SCI: turn assert into warning, as it used in QfG2 char import

svn-id: r44400
"
"ac4c2701e9b59b551620dbea5f9bdc72fc46e2ab","2009-09-27 14:59:40+00:00","New configure var '_port_mk', set to 'ports.mk' per default. Ports can overwrite this, and this change finally allows make targets in that file to access all the common mk variables (e.g. EXECUTABLE).

svn-id: r44401
"
"0d2056f8c9e8b77d1a19a0a350b8b9cfa9e8fa76","2009-09-27 15:06:35+00:00","Use _port_mk for the Wii and Gamecube port.

svn-id: r44402
"
"c501e650462c29de41ce0a3f36ae1aa0b2104515","2009-09-27 15:09:25+00:00","Use _port_mk for the motoezx and motomagx ports.

svn-id: r44403
"
"fe5e0ee9ca39cc5f5a70ec3c7ccc85288f0d976e","2009-09-27 15:11:36+00:00","Use _port_mk for the WinCE port.

svn-id: r44404
"
"f687ed42210af35fe359c3b2edb93e7ef57b2aed","2009-09-27 15:16:54+00:00","Use _port_mk for the PSP port; some psp.mk cleanup.

svn-id: r44405
"
"d7130081c91f58d914c25ee0105876368b0d05f7","2009-09-27 15:39:15+00:00","makefile -> Nakefile

svn-id: r44406
"
"3330ca56c84462df9a2b0eab0bafe42d112b2b82","2009-09-27 15:40:52+00:00","make -> $(MAKE)

svn-id: r44407
"
"4193367d30e2233eac3d7239387e11b583da2bba","2009-09-27 15:42:18+00:00","makefile -> Nakefile

svn-id: r44408
"
"f34f2ee6cc336c6c6edcf74a1d8fa8e82bd7ee93","2009-09-27 15:44:02+00:00","make -> $(MAKE)

svn-id: r44409
"
"f4597ee83ecc3ecda72f99714e24e5e03d14179a","2009-09-27 16:06:06+00:00","Fixed compilation of the NDS port.

svn-id: r44410
"
"8c8b996f56fc52f468fd14307d6ebf6dcdc7969c","2009-09-27 16:33:59+00:00","SCI: Add workaround for file mask used by QfG3

svn-id: r44411
"
"8b6b3358c8cab75cd693fb3a3abc16990c5850b5","2009-09-27 17:18:30+00:00","Properly return values on functions with non-void return types.

svn-id: r44412
"
"fc2bb50600e393cdb3d1e868b9274a43d05bca21","2009-09-27 18:11:06+00:00","Remove memory leak in animation manager. Get rid of 1 non-const reference parameter.

svn-id: r44413
"
"cf1031fc63a19bfebc82744ab4b1ed55a3868408","2009-09-27 18:51:07+00:00","Fix renumbering of animation indexes

svn-id: r44414
"
"4edecad9db05c169bdccf2d45f212eb4e643bdb9","2009-09-27 19:23:44+00:00","TINSEL: cleanup

svn-id: r44416
"
"460d7b269bdd22cd4c9df941ab3e2d5bb640297a","2009-09-27 19:24:18+00:00","Simplify kFormat slightly

svn-id: r44417
"
"0a36b67a1f12490f84c1a6c1f03aa09f2e598c1f","2009-09-27 20:46:38+00:00","reduce display list size - we only use a fraction of it.

svn-id: r44418
"
"caa3b6707e4cd6a20f2d20d57f9748b8ece89852","2009-09-27 20:49:59+00:00","Improved the interface of Sprite and Animation concerning relative coordinates and scaling.

It is no longer needed to modify the underlying animations when drawing them
on the screen or testing pixels in them.  Read access is enough, because
the displacement of the object is passed as a parameter.

Added some more const's where they logically belong.

svn-id: r44419
"
"7971d77dd6bfbe788a01ec2985d1b73847c0dd44","2009-09-27 21:00:45+00:00","SCI: Adjust isValidOffset to match changes from r44396,
and make maxSize report the valid space starting at offset.

svn-id: r44421
"
"a04881072a0ab0f537aa01aa5df5aeee750f8b03","2009-09-27 21:25:34+00:00","Reduce code duplication when cleaning animations

svn-id: r44422
"
"bec07b42a0ce4462c5649818de68683b52ae7f67","2009-09-27 21:52:14+00:00","SCI: Remove directory prefix added by QfG3's char import

svn-id: r44423
"
"8f609497ee7417d9c9e7766a3125f355bf7e1662","2009-09-27 22:42:21+00:00","Backported NDS changes from 1.0.0 branch to trunk

svn-id: r44426
"
"6ec05c48f937cad59f881484bd0b04f8fcc3fc99","2009-09-27 22:42:51+00:00","Fix CoreAudio MIDI backend on Mac OS X 10.6

svn-id: r44427
"
"76132409d69302b41d0bc7499fa0a97fdb2bf169","2009-09-27 22:43:32+00:00","Removed Mac OS X QuickTime MIDI backend. It breaks on OS X 10.6, and it's not as good as the CoreAudio backend anyway

svn-id: r44428
"
"725377f090b538acd209c353c965fe93af450b56","2009-09-27 23:06:39+00:00","SCI: Fix scrolling in SCI1 list controls.

svn-id: r44429
"
"d0db5963110929d0d2353278a4d64caca358f48a","2009-09-27 23:57:39+00:00","Fix rounding coordinates at the edge of the screen.

svn-id: r44430
"
"42e3c63b117fe1bff5b059d95564f52f8ed58563","2009-09-28 02:54:38+00:00","get rid of static Common::String's

svn-id: r44431
"
"7ef17ba73e26436e30689d14fda8153aadb3c347","2009-09-28 03:06:43+00:00","get rid of static Common::String's

svn-id: r44432
"
"8a78e968387ff001085bb6cec4ae6c8edba222db","2009-09-28 03:51:23+00:00","Make getFile() return a const pointer and clean-up all uses of it.

svn-id: r44433
"
"359d374dc6122a97172827e82246126704bbc799","2009-09-28 04:09:03+00:00","Added const's to getPalette() and several uses of getObject()

svn-id: r44434
"
"994b74a19351143dfcf41e9d7d64174861842e75","2009-09-28 07:04:29+00:00","1) fix scaler selection for vga games on vga (or higher) devices. 2) fix a crash during startup

svn-id: r44435
"
"a13ba4cee7c57fa55e5704d1bf3039c1e90e3954","2009-09-28 07:21:56+00:00","overload newer incarnation of setmousecursor

svn-id: r44437
"
"6ffa6ecccff0002086bc0e7f0a032fa276bfe140","2009-09-28 07:25:28+00:00","revert previous fix

svn-id: r44438
"
"0335a37b053647866fe283cd630c18d65f99cdc0","2009-09-28 07:28:20+00:00","Fixed clipping-related bug (bug #2826036)

svn-id: r44439
"
"0dcc75671e5fb0c60b00b9905451dcfddced89aa","2009-09-28 08:57:44+00:00","Fix WinCE build error

svn-id: r44441
"
"9c4f4e677534a75652b85454997f9d9ec05aee14","2009-09-28 09:05:29+00:00","Fixed whitespace fail

svn-id: r44442
"
"033b587bd2f9ed523920e10c6dfb79e7dd81201f","2009-09-28 09:09:15+00:00","Added topString to the list of static selectors, for commit #44429

svn-id: r44443
"
"fa3e257aa229020fc792e63df974bcc371345eb9","2009-09-28 09:16:53+00:00","Removed the svn:executable property on non-executables

svn-id: r44444
"
"770cca79d0077d01dfb14365a0491f5c4aa50ce2","2009-09-28 09:56:05+00:00","Script workaround for partially off-screen text in DW1 GRA

svn-id: r44445
"
"ccc737a7149a0a87e8a5ad0467aa2eb58e29c8bc","2009-09-28 11:28:09+00:00","Fix a memory leak

svn-id: r44447
"
"f413356bed8399e93aa9cdfc48f574e157d9fcb1","2009-09-28 19:39:17+00:00","SCI: When merging palettes, map all unused colours to index 0.
This fixes the boots/belt of the hero sprite in QfG3 character generation.

svn-id: r44448
"
"88a9099949ebd2409878cdb9ee7d3d329ead1ad8","2009-09-28 20:21:09+00:00","SCI: Remove unsafe unmarkDeleted function.
It did not undo all effects of a script being deleted (specifically its
superclasses remain unlocked), causing an inconsistent
state. Also removed EcoQuest CD hack that worked around a specific
instance of this problem.

svn-id: r44449
"
"95cd669efbe9e907a8f48f2066de9a8bfbafaf93","2009-09-28 21:58:48+00:00","Fix for bug #2868581 'KYRA1: Invisible Brandon'.

svn-id: r44450
"
"a8d6e8774c79cbeb52e7ec772534059040a2d662","2009-09-28 23:02:39+00:00","Made AnimationManager::sortAnimations() do multiple passes, if necessary, and added some animation debug info.

svn-id: r44452
"
"0c0135e0ed5047281519ffafdd22afc9b65b0f1c","2009-09-28 23:10:08+00:00","draci: Added methods Game::positionAnimAsHero(), Game::getHeroX() and Game::getHeroY() and implemented correct positioning of all dragon animations. Fixed exiting the inventory by right-clicking outside it.

svn-id: r44453
"
"137c44013c1fb6803784f377245a70c2cdd30800","2009-09-28 23:32:16+00:00","draci: Inverted a logical check to make it more obvious.

svn-id: r44454
"
"635769bd5d38847349700f13ffaf56f689582fae","2009-09-29 00:03:09+00:00","draci:
* Added const to some methods of Game.
* Removed some code cruft from Game::walkHero() (duplicate calculations and variables).
* Fixed small bug which prevented talking text from being centered above the dragon.

svn-id: r44455
"
"00a733f7cf33942a0618d99a4f9d0c0aefad1fef","2009-09-29 05:54:59+00:00","Clean up and unify positioning dragon's animations

svn-id: r44456
"
"4be9e6cda06fd7cacf9e9fdfe9db5e9bcc3dfb41","2009-09-29 06:36:39+00:00","Rewrite from scratch drawReScaled() and cropping now works well.

I left draw() as is for now, although it could also be similarly simplified.
Also, one could easily completely get rid of columnIndices[], but I was too
tired for the time being.

svn-id: r44457
"
"f78428384ee067abb072669e0927b84047b4ee73","2009-09-29 07:40:04+00:00","QFG3 clears clones with underbits set, so disable the warning for this behavior

svn-id: r44458
"
"af4c6c5f5b642e6a53596b7a00d57e2060ba0693","2009-09-29 08:18:40+00:00","Fixed bug #2868938

svn-id: r44459
"
"f9296a64459a09961bdf61fa4dbb3d3f524a4c25","2009-09-29 14:24:07+00:00","- Changed the unimplemented debug SCI kernel functions (InspectObj, ShowSends, ShowObjs, ShowFree, StackUsage and Profiler) to be dummy functions - we have our own debugger, and don't use these functions for debugging
- Removed the function number parameter from all kernel functions, as it's no longer needed, and removed the FAKE_FUNCT_NR hack
- Removed kUnknown() and kStub()
- Dummy/unknown kernel functions are no longer invoked, and a warning is shown instead, with the paremeters passed to them

Note: there is an evil hack used for debugging scripts in invoke_selector(), which probably no longer works now

svn-id: r44461
"
"2c2cf614c810cf68e8f6c9bddd17aa44944e50ef","2009-09-29 14:28:37+00:00","Oops - don't attempt to print the sought kernel function name when its empty

svn-id: r44462
"
"70f7c46f4228c252db35ba9a3267a30fca906212","2009-09-29 14:36:46+00:00","Add newline after 'Available debug channels' in Cmd_Debug, now all debug channels will be listed in separate lines.

svn-id: r44463
"
"270104fc70dab11f3864bedbeaab0f410b2ec5fe","2009-09-29 14:37:09+00:00","Remove unused variable.

svn-id: r44464
"
"6f6b6993909326cbd5fe293cf2d3b35a93e56c91","2009-09-29 15:51:45+00:00","Added a FIXME comment for the removed functionality in the script debugger

svn-id: r44466
"
"f6aaafae7c602311a65838f4b798e7a536057ea7","2009-09-29 16:56:30+00:00","Gob - Silence a Valgrind warning by initializing a variable

svn-id: r44467
"
"c85736913140a8c65aed7060a4ae2cc4a64bee70","2009-09-29 19:51:37+00:00","Fixed Valgrind warnings about invalid memory access. Hopefully without breaking
anything, but modifying a data structure while traversing it can be a bit
tricky...

svn-id: r44469
"
"ff70b554eace73fafb0165fb0dc16da91f377ce4","2009-09-29 22:43:30+00:00","Playtoons - implement some functions related to hotspot texts
Fascination - initial version of several 'Fascination Window' functions, proper naming of most of fascination OPCODEDRAW and OPCODEGOB functions

svn-id: r44472
"
"77bd8d0bfbfaea6c05ca606ead77334d88cd22d1","2009-09-30 00:13:59+00:00","SCI: Add callk stackframe directly in run_vm

svn-id: r44473
"
"76a0bcb6c4a523c5a5b312ece3cb2bab359ab4a9","2009-09-30 04:33:52+00:00","Implemented the map room, entered when 'm' is pressed.

svn-id: r44474
"
"e660f31ed896e487dba5783619840cc065cc1bc5","2009-09-30 07:09:07+00:00","Provide only the data that is strictly needed when creating a new Inventory.

svn-id: r44475
"
"eb5beef6a1f5a76735b35fb17796420ba2e6d080","2009-09-30 07:47:58+00:00","* Added secondary inventories for BRA.
* Added comments where code must be added/updated to support multiple inventories.

svn-id: r44476
"
"4477f419034b7c606aef7eb7038337b7229cec33","2009-09-30 08:23:12+00:00","Converted _color_equals() into respective equality operators within the gfx_color_t structure

svn-id: r44477
"
"c9ca057ae2d8d3994aba86bb1ded05e0db008188","2009-09-30 10:45:14+00:00","- Adapt parts of the Draci code to match our code formatting guidelines
- Remove use of tabs for formatting, now in nearly all cases tabs are only used for indentation
- Use 'uint' instead of 'unsigned int' in the whole engine for consistency's sake
- Strip some trailing tabs and leading whitespaces

svn-id: r44478
"
"e29b1758de7773636edebbbf2867d6cbb3b12f9c","2009-09-30 11:11:06+00:00","fix bug #2869491: 'PSP make problem after 44348'

svn-id: r44479
"
"ab403f484501f1c3f9695a7e4be7a5b8fea246b5","2009-09-30 11:21:09+00:00","Check readline+termcap if linking with readline failed

svn-id: r44480
"
"fd21bb2611b4260a1243ab14c9a0797fb9ba3617","2009-09-30 12:17:38+00:00","- Moved the list of synonyms and parser nodes inside the vocabulary class
- Added a convenience member inside the EngineState struct to access the instance of the Vocabulary class

svn-id: r44481
"
"1b94303b788bdad949a954e2ec603ab7003da509","2009-09-30 13:07:12+00:00","Update SJIS code to read SJIS.FNT version 2 data (no support for drawing ASCII and half-width katakana glyphs yet).

svn-id: r44483
"
"fa077237c1a48aa5b3b56f3697e775f5e05cb08c","2009-09-30 13:09:18+00:00","Fixed a crash when starting KQ1SCI

svn-id: r44484
"
"9be8a6e4f6c35c1bbad3b8f6af7f223e584b8954","2009-09-30 13:41:19+00:00","Simplified inventory handling (too much information hiding will kill you).

svn-id: r44485
"
"03a26923c91ee608382bce6d11af4a9049fa86dc","2009-09-30 14:53:07+00:00","Implemented support for drawing 8x16 chars from our custom SJIS font.

svn-id: r44486
"
"b8c7237d12ac766dc5db9a5731e3e50f0715cd09","2009-09-30 14:53:34+00:00","Cleanup: got rid of Screen::ShadeType.

svn-id: r44487
"
"438244a0168c1d3fcecee379ecae78c1808d49a6","2009-09-30 14:53:57+00:00","Adapt KYRA engine to use the ASCII and half-width katakana support of the SJIS font. (required for LoL PC98)

svn-id: r44488
"
"2240886315c4031fc7e68ae644916e35c607615e","2009-09-30 14:54:18+00:00","Got rid of old workaround, which was only needed because our SJIS font did not feature any ASCII chars.

svn-id: r44489
"
"1497f9845a860e2d1ab6a6a5b418233239af427b","2009-09-30 15:21:44+00:00","Fixed regression in r44417, found by waltervn. The score in KQ1SCI should be diplayed correctly again

svn-id: r44490
"
"c76041d46d82215ff59f885d3bd089d602e493cf","2009-09-30 15:43:28+00:00","Fixed a crash in KQ1SCI, when the user types something wrong - the game tries to open a file with an empty file name, and an odd file mode

svn-id: r44491
"
"27026f65652a2afc02947303c1bde68e21724d15","2009-09-30 16:00:44+00:00","SCI: Replace magic '-42' by an enum

svn-id: r44492
"
"cc54ad650d3f7ffd2546e9d15905a0bda8327415","2009-09-30 16:04:21+00:00","Remove trailing whitespaces

svn-id: r44493
"
"25dde91c7c6c7da52636e3daa34bd9eee5d9dcb9","2009-09-30 16:06:04+00:00","SCI: Some palette code cleanup

svn-id: r44494
"
"8ba75fc522f16844524dd4d6f88c3851e2402969","2009-09-30 16:16:53+00:00","Fix code formatting (esp. 'if(' -> 'if (' etc., but also indention and other things)

svn-id: r44495
"
"f1c76e2dcb405444c4ddf1959cdad402b613f8b3","2009-09-30 19:14:46+00:00","Fascination - Fix a regression in intro (fix of R42171)

svn-id: r44496
"
"a5d1094daba6dd0f9df42d7b0307a05d78fdaa36","2009-09-30 19:44:03+00:00","SCI: Make kFile error messages slightly more verbose

svn-id: r44497
"
"94572773d0567151627e87fcd5f3cba8420321cb","2009-09-30 20:42:58+00:00","LOL/PC-98: - fix spell effect colors
- fix some font color glitches

svn-id: r44498
"
"5ad13a3dff41398c4b33cd340637fd3924cfded1","2009-09-30 21:07:04+00:00","Fix 2 ValGrind warnings.

svn-id: r44499
"
"aa368806d9a69a9a21c44322ed2fbc8ceef20af1","2009-09-30 21:12:38+00:00","oops

svn-id: r44500
"
"598056ead0bfff5bf6b08de50cc19e159f91d35a","2009-09-30 21:46:00+00:00","LOL/PC-98: - fixed TIM dialogue button text colors
- fixed menu text alignment

svn-id: r44501
"
"bbb2274a7d7d57edfbf0c11271a7203c036cba7d","2009-09-30 22:43:29+00:00","- Removed some leftover 16/32bpp color code, as we're always using palette mode now
- Simplified the mouse cursor manipulation code

svn-id: r44502
"
"86016e4dc5ab081b5d5f3e3ab7cc5c9dd0cd7109","2009-09-30 22:54:00+00:00","Changed the list sanity checks to return warnings instead of errors in case of failure - apparently, this can occur in some games, e.g. Longbow and QFG1

svn-id: r44503
"
"96a40e771207f4c3664f0271685fa8adfd9f299c","2009-09-30 22:54:30+00:00","Fascination - Suppress some warnings

svn-id: r44504
"
"30084d72a5eaedbd22cc14aa6bb1f72a573944f0","2009-09-30 23:00:03+00:00","Added a new special reg_t, SIGNAL_REG, for signaling when an error occurs (usually), or to signal success in some special occasions

svn-id: r44505
"
"9efc90c8afe7775404676e1b95b5aa9e0d298118","2009-09-30 23:13:46+00:00","Fixed the warning message shown when dummy functions are invoked

svn-id: r44506
"
"2d29625f0e8afba7a447be49615742f6612d38a0","2009-09-30 23:27:00+00:00","Removed an old (and now obsolete) workaround for KQ5

svn-id: r44507
"
"24d649b972235d85d0e4d96de4607fa87d4f26c1","2009-10-01 08:32:35+00:00","Clean up room changing code and support returning from the map.

Completely changed the interface, removing unused methods and attributes,
renaming other ones to reflect what they do, and moving some methods into the
private section.  Code changing the location, originally scattered over many
pieces of code, has been unified into one place.  Remember the previous room
when entering the map so that one can return there.

Also, the event handler processes one event at a time, preventing lost clicks
on touchpads.

svn-id: r44508
"
"168257df24ea78bbeab562096fe780778ad83382","2009-10-01 08:53:10+00:00","SCI: Remove outdated debugging hack.
In the past, a negative selector value was used to identify a callk
stack frame. Currently a type of EXEC_STACK_TYPE_KERNEL already does that.

svn-id: r44510
"
"7d40dde96f09e7f3f1722b184bfbef30adc5ad4d","2009-10-01 10:57:59+00:00","- Removed the toggle for 'weak' validations, as there are cases where they fail (e.g. in Longbow), so there is no point in having strict validations
- Removed the invalid toggle from kernel signatures - we now never error out on invalid object references, but throw a warning instead
- Simplified determine_reg_type()

svn-id: r44511
"
"5a8b81119b5292036a6d63c94a37ced70ff9c083","2009-10-01 11:02:23+00:00","Fix free/delete/delete[] mismatches. Patch by salty-horse

svn-id: r44512
"
"7d6848dfa3ceebe2d618c8ba59a03cae631bacf1","2009-10-01 11:06:38+00:00","SCI: Add some fixmes noted by salty-horse.

svn-id: r44513
"
"e67b0ef08cbd84abeae1f81b452a038322028889","2009-10-01 12:03:12+00:00","Replaced delete operator with delete[]

svn-id: r44514
"
"04493d139e53d7f86441ff79997340b6583f0117","2009-10-01 12:09:02+00:00","Fixed some potential memory leaks, reported by salty-horse

svn-id: r44516
"
"aba45bfd5fe0d77345166275f63d2bedb87a220f","2009-10-01 12:12:07+00:00","Reworked of code line in changeExtension that was giving a cppcheck warning

svn-id: r44517
"
"d90c60e879d3e3f9b8a8c76a4b3d82de18698d3c","2009-10-01 12:19:01+00:00","Fix a regression in the first part of the intro (gitches when the paper and the rat are moving).

svn-id: r44518
"
"6e462c900287a8abd9132a4716153346a3681ba9","2009-10-01 12:41:21+00:00","Removed the STRICT_SEND, STRICT_READ and ASSERT_ARITHMETIC defines

svn-id: r44519
"
"ddea9a5bda91189988e8f1f6025f8e90aec433c7","2009-10-01 14:47:52+00:00","Fix Common::String::printf in MSVC

svn-id: r44520
"
"934e92c28378970e70c6d725db7606c0d7106228","2009-10-01 15:07:45+00:00","Fixed bug #2847539, by resetting the optimization options for the release version to the default ones

svn-id: r44521
"
"6697f469224a00bda5d6f6e383d71ad4a6faedbb","2009-10-01 15:33:38+00:00","Rewrote weird-looking code, which might lead to undefined behavior, according to GNU

svn-id: r44523
"
"2fa7fbc1a53b7f158dfe9c70395d1b8a2cd442d1","2009-10-01 15:58:15+00:00","T7G: Proper fix for #2847539 - remove ambiguity in multi-byte script reads.

svn-id: r44524
"
"4a7cea681360d21a9be983bf75942a1c693cdbb9","2009-10-01 16:47:34+00:00","Fixed event handling.  ValGrind fixups.

My yesterday's fix on handling 1 event per call caused the game to be
unbearably slow on Linux.  The old way was much faster.  I have solved too
fast a succession of mouse button down and up by not clearing the mouse flag
when the button goes up instead.

Fixed a memory leak and uninitialized variable after my refactoring of game
location changes; found by ValGrind.

svn-id: r44525
"
"a6b2e9255fff6bf079115ba8aa7fa6dd9069cfed","2009-10-01 16:52:05+00:00","Fixed mismatching malloc/free, and plugged a memleak.

svn-id: r44526
"
"876a28d26170e8fee5256767b1bf984c77900f18","2009-10-01 17:30:10+00:00","SCI: cleanup

svn-id: r44528
"
"523f0b34fba6f11d3e0412c88dbdf7d415a63f36","2009-10-02 07:44:55+00:00","SCI: Remove dead code

svn-id: r44530
"
"292640b14e42b91fca0cf4ea07920ad38095a77d","2009-10-02 11:04:36+00:00","SCI: Make NULL_REG & SIGNAL_REG const; change validate_property so that its callers cannot modify NULL_REG accidentally anymore

svn-id: r44531
"
"0fe40b505395ee7f54344be67741d6efb44e02f4","2009-10-02 12:44:12+00:00","SCI: Use String::printf instead of temporary buffer

svn-id: r44532
"
"908e13fa73e946340c6ae9867a370af0562d9c8e","2009-10-02 12:53:04+00:00","SCI: Remove PRINT_STK macro; cleanup

svn-id: r44533
"
"14c58b73e95d0beec58ae44a652453da766b1bbd","2009-10-02 12:53:45+00:00","Remove dead code

svn-id: r44534
"
"78578a042fd40f836c7e25acdf8a86cfc6b71f6b","2009-10-02 13:13:47+00:00","Bugfix for dirty rects getting lost during room fade-ins

svn-id: r44536
"
"41f6365f9b93a8d22324c77372d08671f67f7051","2009-10-02 14:11:45+00:00","Mention removal of quicktime MIDI backend in NEWS

svn-id: r44537
"
"01176782ead27701b4700f458fbad3f8a84514af","2009-10-02 14:32:54+00:00","Fix some cppcheck warnings reported by salty-horse

svn-id: r44538
"
"f54e82e4880767f6e71c83840bff1ae8e0feda3d","2009-10-02 14:42:24+00:00","Fix more cppcheck warnings/errors; some code formatting; and fixes to our tools

svn-id: r44539
"
"0041502ee7751ef843392cc527fa091e852fc76d","2009-10-02 14:44:52+00:00","Release resources properly; fix code formatting

svn-id: r44540
"
"cbcd53f1f34a65cea46f80761f15c9fad8cc35c4","2009-10-02 15:02:57+00:00","Fix cppcheck issue reported by salty-horse

svn-id: r44541
"
"f915a46e1f56d54b9b80039d83aa8b2ceb1045ee","2009-10-02 17:50:56+00:00","Fix for bug ref#2867294 (hopefully)

svn-id: r44542
"
"41adc39d2d5ae1691717a778c5874306317cf6f4","2009-10-02 18:38:52+00:00","Fixed cppcheck warnings about mismatching allocation/deallocation.

svn-id: r44543
"
"bfec2debe67dd52bf2434fe37b45a6e7332d4b5a","2009-10-02 20:20:45+00:00","SCI: Fix parse_reg_t, it no longer modified the const string passed to it

svn-id: r44545
"
"5884ac58c630612c1b1a6b6834aff0b7cfb9879f","2009-10-02 20:21:07+00:00","Whitespace changes

svn-id: r44546
"
"e5aae67e393fdde1d306c124e595d7135614ee5b","2009-10-02 21:27:10+00:00","LOL/PC-98: - some more fixes for level graphics (shapes are still not quite right)
- fixed heal spell

svn-id: r44547
"
"14d6b33e4f989ddf1788821b9dfe05d22aa9736a","2009-10-02 22:13:39+00:00","LOL/PC-98: fixed death menu, live/magic bar colors and money box

svn-id: r44548
"
"548d139b48d76d391051520d828d977893c0cf28","2009-10-02 23:13:47+00:00","LOL: cleanup

svn-id: r44549
"
"43f84746bf276106b147bc9593b2a3e3ad424e4b","2009-10-03 05:16:19+00:00","Fixed positioning and update of the title under the mouse pointer.

Clamping on the border of the screen works precisely.  When switched to the
inventory, titles of game items are displayed instead of a (sticky) title of
the last object before entering the inventory.  Put some const's where
appropriate.

svn-id: r44550
"
"5d7caf3ca99d281ae9d37d25c1ee206b45575f64","2009-10-03 08:59:11+00:00","Added a +1 for dirty rectangle calculation so final column of changed area is included

svn-id: r44551
"
"66233031d706f93dba6dd8be7c2f57320cd726fc","2009-10-03 13:40:55+00:00","revert r44542: the fix reopens another previous bug

svn-id: r44553
"
"e515b57b67fc65ac8df9574d6818aecc35bc7aed","2009-10-03 13:42:24+00:00","LOL/PC-98: fixed automap

svn-id: r44554
"
"29bb8a59eeb9ad7f6cd2fa77c58e8cfc10f40ee7","2009-10-03 19:27:10+00:00","If an error occured on constructing a VorbisInputStream, return 0 from makeVorbisStream, just like makeFlacStream does.

svn-id: r44556
"
"bbb3cc808601af2535b888528d9500c224c01ad6","2009-10-03 19:29:14+00:00","If make*Stream failed, the file needs to be closed to prevent an assert on a consecutive open().

svn-id: r44557
"
"1336b5464bb597dca7f81e68c7204be1f1dc6a06","2009-10-03 20:12:44+00:00","Fixed bug in archive.cpp that caused at least one engine (SAGA) not to work

svn-id: r44560
"
"95959a88ef3b1f993ac3013df6233301fc542436","2009-10-03 20:25:27+00:00","SCI: Fix typo

svn-id: r44561
"
"90eebcd245ae06221a41477e2268f5a281c628d6","2009-10-03 20:26:30+00:00","Use buffer in Common::String::printf slightly more efficiently

svn-id: r44562
"
"a3fc7230eb6aecce6ad48c22540fa1dbe11606b1","2009-10-03 20:35:13+00:00","fixed addMenu isspace() issue on umlauts

svn-id: r44563
"
"f6de0b4ec9fcc240cdc0c46aedb2e2089e07bd5c","2009-10-03 20:42:26+00:00","LOL/PC-98: add keyboard support

svn-id: r44564
"
"b9cdb1abb76c94723c24ca66eb8d47d96c8c5ebd","2009-10-03 20:49:18+00:00","SCI: Merge new GUI code written by m_kiewitz.

This is a major rewrite of the graphics code. A slightly adapted
version of the old code is still available and currently the default.
The new code is selectable in sci.cpp, but is not yet finished.

svn-id: r44565
"
"79b12939a8c03fd25cee8b8b8dcbaf175f5a9e72","2009-10-03 21:06:45+00:00","SCI/newgui: set title on newWindow

svn-id: r44567
"
"742d70204e6e4eb02ac673c3d80ab37a637d046b","2009-10-03 21:14:52+00:00","SCI/newgui: virtual warnings fixed

svn-id: r44568
"
"4cb0359670758b3cddcdc9d65f7832752ca05f98","2009-10-03 21:16:11+00:00","SCI/newgui: cellCount changed to uint16

svn-id: r44569
"
"204b975e7fdc4a68318b47b5561dd1328528dfdd","2009-10-03 21:23:21+00:00","SCI/newgui: initializer fixup

svn-id: r44570
"
"cfb7632a770d077adeed2494e7f6d23c65e9186d","2009-10-03 21:27:00+00:00","SCI/newgui: Removed SciGUIpicture::drawPalette11

svn-id: r44571
"
"75de46e9ab69d189e2831bdd3a6af2a1d27de15a","2009-10-03 21:27:01+00:00","SCI: Fix sign issue in stringfrags

svn-id: r44572
"
"93c3d07e2b459d8b9d20e857e430986b24420fe4","2009-10-03 21:30:36+00:00","SCI/newgui: constant 0xFFFF -> -1

svn-id: r44573
"
"c0773975f54dd862fa7d68df900236ea63a6b509","2009-10-03 21:49:09+00:00","SCI/newgui: removed duplicate unused code

svn-id: r44574
"
"3035ca2fd3e5457aedb30dfc002c6bb1303fbbf4","2009-10-03 22:07:18+00:00","Let Ctrl-Left click behave like Right lick in Dragon History.

Also, started implementing Advanced Engine Features:
- pause support
- RTL support

svn-id: r44575
"
"bce248cab6759d6213b28a89d96e741e10a5a656","2009-10-03 22:10:45+00:00","SCI: Redraw edit controls when they change.

svn-id: r44576
"
"0e5836bb3412a4d2defde20b6bf4a6bb65465c77","2009-10-03 22:39:46+00:00","LOL/PC-98: add keyboard support for menus

svn-id: r44577
"
"f61bf4f97a208735dc42320e7ca072ca7fc5dd58","2009-10-03 22:44:16+00:00","SCI: Fix parse error in parse_reg_t

svn-id: r44578
"
"a8c4d70d3e70addfd3fffe92178a4b41cb72889a","2009-10-03 23:01:22+00:00","SCI: attempt to fix wii/dc build error

svn-id: r44579
"
"ea66b759168b5f3fb9a49ef92771190b6ea99745","2009-10-03 23:16:32+00:00","Slight change in the SCI MSVC project files (put the files from the gui32 directory in the proper filter)

svn-id: r44580
"
"0ed87062ed776e8d182eac16157b2c7b48796843","2009-10-03 23:56:49+00:00","SCI: Add hack to gui to fix loading

svn-id: r44581
"
"b8e02a03c1d0f1a8224a091b910c8210e6486c53","2009-10-04 01:05:27+00:00","LOL: fixed minor bugs in text displayer

svn-id: r44582
"
"b6d7da6927d7fa3bfb0fd8a48330c6d876e61d53","2009-10-04 03:50:10+00:00","Implement all boilerplate concerning Global Main Menu.

All currently defined featues will be supported.  I have implemented
everything boilerplatish, except for the actual game saving/loading (which
will come in the next commit), getting volumes from the configuration
(because we don't play sounds yet), and changing subtitles.

svn-id: r44583
"
"10d70ec742f8b109257db2be7b0efaafeee9cb3a","2009-10-04 05:20:56+00:00","SCI/newgui: cleanup

svn-id: r44584
"
"bf408b0dbe1b9bcc57c590ec8b2a3ab08644752f","2009-10-04 05:22:49+00:00","SCI/newgui: unfinished TextColors/TextFonts support/setting default palette mapping for kq5

svn-id: r44585
"
"df14027c411af320ab6a696f37cbc47e35675393","2009-10-04 05:44:23+00:00","Implemented rudimentary game loading/saving.

Fixed many bugs in the boilerplate.  Saving (only) things that really need to
be saved.  Loading seems to work modulo dialogs and (possibly) inventory.

svn-id: r44586
"
"06f5393ed41a4c003d7c46f6a37637c8f9a4dc1e","2009-10-04 06:39:07+00:00","SCI: fixed crash in sq5/german (umlauts)

svn-id: r44587
"
"1ed6a2668be5462694c81369cc5abb89e199e2dc","2009-10-04 09:13:15+00:00","Load inventory items properly after loading the game.

This solution is quite hacky, but so is the rest of the code, before a
future refactoring done one day.

svn-id: r44588
"
"decdc5771a6c4733ab4a1276fc60c2454c8340a6","2009-10-04 09:31:37+00:00","Applied patch #2872409 'MADE engine fixes' by agent-q, with one small modification (initialized _soundStarted in the ScriptFunctions constructor)

svn-id: r44589
"
"42ee5350c3b44763aa78ca3d105670bbf6bba376","2009-10-04 09:33:07+00:00","Hack Game::_shouldExitLoop.

Immediate exit needed when loading a savegame hurts waiting in an inner
(strange) loop inside a GPL program, because animations don't progress at
all.  Reverted to the previous behavior and kept the immediate exit as a
hack for loading the game.

svn-id: r44590
"
"bb7a728a999f3fb13dd13e53795d3aeb6ff8baac","2009-10-04 09:38:57+00:00","SCI/newgui: TextColors and TextFonts implemented (for sq5)

svn-id: r44592
"
"772cb3365189a99f08c1a7be461455be9771c141","2009-10-04 10:42:18+00:00","SCI/oldgui: onControl code moved

svn-id: r44593
"
"a015e5f967a5cf96d2e514ac49cf0a2b907544d8","2009-10-04 10:46:25+00:00","SCI/newgui: onControl implemented

svn-id: r44594
"
"3dbf54267b64c3b937470ce3808ae57b03741c33","2009-10-04 10:47:10+00:00","SCI: onControl now uses gui classes

svn-id: r44595
"
"e2cc953a9fd5c93b03644da925cb7f48f605c351","2009-10-04 10:48:49+00:00","SCI: removing unused variables from onControl

svn-id: r44596
"
"a139ddd8404655d53bb18a456732bbd5276212f1","2009-10-04 11:05:38+00:00","SCI: kReadNumber crash fix for lsl1

svn-id: r44597
"
"837cde96f37fb61c16386442aad9feb552b96573","2009-10-04 11:14:38+00:00","Removed unused references to OSystem

svn-id: r44598
"
"306c9d1db63b29f503db355170a73c3e642fa200","2009-10-04 11:23:28+00:00","SCI/newgui: SciGUIfont workaround for lsl1sci

svn-id: r44599
"
"594527fe4b1f60e9eb62238174bc506c5d538dac","2009-10-04 11:26:09+00:00","SCI/newgui: restoration of constructor

svn-id: r44600
"
"14c322ceb76038d85063c07e812e0f8a27b6254d","2009-10-04 11:32:29+00:00","SCI/newgui: font constructor change (again... what happened here?)

svn-id: r44601
"
"f8e8e764ceeca1ae61a6058cca7fdf94718c4518","2009-10-04 11:42:26+00:00","LOL/PC-98: some more work on sjis font support for the text displayer

svn-id: r44602
"
"696fd7af203e28c1f3821ceea56b48d83d28fdd5","2009-10-04 11:58:52+00:00","Reduce usage of Common::String::emptyString

svn-id: r44603
"
"a1e2ba1ba5c0c80b826522bdd4555508ad442b51","2009-10-04 11:59:29+00:00","SCI: Fixing a bunch of warnings; change 'intencity' -> 'intensity';
properly init a sciPalette via memset

svn-id: r44604
"
"3aadeaa01887d3044fd0a9ac50406e101cb73bb2","2009-10-04 13:29:35+00:00","Removed unused enum

svn-id: r44605
"
"4957ec3505d9b763bfe90bbaf840bbafdaa72143","2009-10-04 14:59:51+00:00","SCI: kAddToPic, kAnimate and kSetNowSeen transferred to SciGUI32, not yet implemented in newgui

svn-id: r44606
"
"49a78bfb3ec92b184d22f3206eb6957417b671b4","2009-10-04 15:06:50+00:00","SCI/newgui: accidentally changed Draw_Horiz and Draw_Vert, reverted

svn-id: r44607
"
"ae737ca2c2e71c50d7dd35fe118e78ae57ce0ded","2009-10-04 15:12:05+00:00","LOL/PC-98: fixed save menu

svn-id: r44608
"
"b05493af048956fb6c7b2cd21f5e98a6dba84c96","2009-10-04 15:14:28+00:00","SCI/newgui: windowMgr cleanup, UpdateWindow() ported over

svn-id: r44609
"
"1572e622a350792df2e07969749a68a5c6344200","2009-10-04 15:20:43+00:00","SCI/newgui: UpdateWindow() -> rect1 instead of rect0 typo

svn-id: r44610
"
"3deae94473d868b4ba60f43bb502e64c79d9ace6","2009-10-04 15:34:43+00:00","SCI/newgui: getCellRect() getLoopInfo() implemented, cleanup

svn-id: r44611
"
"76854f0b861c7d5cc2e21b260bc0dac79509472a","2009-10-04 15:44:10+00:00","SCI/newgui: more descriptive names.

svn-id: r44612
"
"62c951c03101fea8d6358831574e6abe1664cb61","2009-10-04 15:44:32+00:00","SCI/newgui: turn sciWnd into subclass of sciPort

svn-id: r44613
"
"d134eb73cee5d67c299cb9b52dcafd452594b887","2009-10-04 15:49:40+00:00","Add missing PACKED_STRUCT attribute to FrameHeader.

svn-id: r44614
"
"b8e740c1670874ab34963f080061863e96536d9a","2009-10-04 16:22:49+00:00","Attempt to fix wince compilation.

svn-id: r44616
"
"da7006094373217edd00f051ef907a4e815742b6","2009-10-04 16:26:43+00:00","Make '_picRect' local to gui_windowmgr.cpp and mark it as const.

svn-id: r44617
"
"ec526ca4617e436c40dffd1258eac16c8b98e691","2009-10-04 16:35:02+00:00","SCI/gui: renaming...

svn-id: r44618
"
"4a9804a044997d67c4505a5842d38c62c4f4b45c","2009-10-04 16:37:02+00:00","SCI/gui: renaming...

svn-id: r44619
"
"01fca745fd3bd64f31b3b65142b58fe4add3b2c1","2009-10-04 16:39:46+00:00","SCI/gui: more renaming...

svn-id: r44620
"
"975f1b75eaf0e1ce51a85d87285c140b06ab1b39","2009-10-04 16:41:53+00:00","SCI/gui: final rename commit

svn-id: r44621
"
"fc4d7b7d1dc22170b8223ce723cce9a219d84c59","2009-10-04 17:37:46+00:00","LoL PC98: Fix thumbnail generation via ingame menu.

svn-id: r44622
"
"41e4a1ddb6b515f932f445dabbbba28351472315","2009-10-04 17:38:15+00:00","LoL PC98: Fix thumbnail creation for quick saves and autosave.

svn-id: r44623
"
"eaca55ee50172ce98e0a53629251602884dcb918","2009-10-04 17:54:08+00:00","Some fixes to comply with our coding guidelines.

svn-id: r44624
"
"d0bc425da6db52258ef25bf9c73640892182ec91","2009-10-04 18:00:11+00:00","Remove obsolete comment.

svn-id: r44625
"
"9d80759a71b128c45cfd5217ed14575bff003ed2","2009-10-04 18:01:38+00:00","Use spaces instead of tabs for formatting. (Tabs should be used for indentation only!)

svn-id: r44626
"
"07353be65a030261f673d1816d01f08bd35c7b90","2009-10-04 18:34:53+00:00","SCI/newgui: invokeselector implemented into kAnimate

svn-id: r44627
"
"0da9ad5ff59e910c91becf1ba62ee5e864d25c32","2009-10-04 18:36:58+00:00","SCI: Add SegManager::findObjectByName() method, make parse_reg_t() local to console.cpp, and switch other code using it to use findObjectByName() instead.

svn-id: r44628
"
"6ad5840181557a42be4812984fb38d3f47c3e66a","2009-10-04 18:38:18+00:00","SCI: Rename EngineState::segMan to _segMan

svn-id: r44629
"
"7c7e0445eed953e4af155932625e6dddc2cf4c9b","2009-10-04 18:51:01+00:00","Replaced DblList with Common::List

svn-id: r44630
"
"69af4ce9f4dff2631c794da140f24466460288a8","2009-10-04 19:49:47+00:00","SCI/newgui: implemented kPalette / set intensity

svn-id: r44631
"
"43a9f9c2efd73ad92f135e6d526ace94109b59db","2009-10-04 20:01:21+00:00","SCI: Add include guards for gui headers; don't include gui/gui.h from engine/state.h

svn-id: r44632
"
"c8f002ae437677c08ab6154983c70f146607bfaa","2009-10-04 20:08:11+00:00","Removed Ctrl-Left Click treating as a Right Click

svn-id: r44633
"
"f242266f6dc1f18e1b47aa4942c263cf81b75300","2009-10-04 21:26:33+00:00","Change a couple places from 'end of namespace' to 'End of namespace', for consistency

svn-id: r44634
"
"db2e5a4fb5018aefd72c4ffe2597968f63145774","2009-10-04 21:27:24+00:00","SCI: Rework the way SciGUIwindowMgr keeps track of windows/ports; remove the GUI heapmanager

svn-id: r44635
"
"08c7ec123def1bfb298bfe30f918ba4f78a2ecea","2009-10-04 21:30:13+00:00","SCI/newgui: SciGUIview class now uses resmanager to detect view format

svn-id: r44636
"
"6063d5fbe9c183a106ddeca27992b26b8a6a38d5","2009-10-04 21:57:31+00:00","SCI/newgui: ega view loading implemented, unpacking still missing

svn-id: r44637
"
"eb56dfa965718163535df46ecbcfa7a94dbcff4b","2009-10-04 22:11:46+00:00","Fixed two bugs concerning loading:

1. a room need to be reloaded by force when the loaded game is in the same
room as the game before the load
2. objects from the last room and their animations must be deallocated
before I change the room number

svn-id: r44638
"
"92d0a9e17f293159af57918fa7dffae7dbd1528b","2009-10-04 22:15:19+00:00","SCI/newgui: EGA view loading / mapping table

svn-id: r44639
"
"632359c0b4d5b833233e27685516e92a5b91ed2c","2009-10-04 22:26:57+00:00","SCI: Fix cast, constness

svn-id: r44640
"
"71ebd67331c3eaf5100cbf71a917ee69fb2b186b","2009-10-04 22:32:36+00:00","- Minimize the parameters passed to SciGUIfont()
- Some WIP on the pattern_Textures array

svn-id: r44641
"
"8e73622d134e73b24157d2a58cbbe10099d40f94","2009-10-04 22:33:15+00:00","Add some doxygen comments to WinCE scalers. Somebody should verify those. Also note how SmartphoneLandscape's ARM asm version seems to do something different compared to the C version

svn-id: r44642
"
"670d8582ff3fe37a72854e1968665d76c2d5ec33","2009-10-04 22:35:04+00:00","Attempt to fix linuxmoto compilation on our buildbot

svn-id: r44643
"
"db8c6e3f6cc6f9ca889adfd58f78be8571e407e7","2009-10-04 22:43:30+00:00","SCI: Really remove sci/gui/gui.h include from engine/state.h

svn-id: r44644
"
"cc39c5022a1cfcca0f2f0caff6b38e44c40a65c9","2009-10-04 22:55:54+00:00","Work-around a bug in the original game files.

svn-id: r44645
"
"fd5cf8f2dbe7e0a64b1f1e387a6c7aa393207698","2009-10-04 22:59:39+00:00","Cleaned up version of patch #2872626: 'PSP: flicker part 2'

svn-id: r44646
"
"126450f3bc272570d19d0dc8a7473287d1b72ff0","2009-10-04 23:21:01+00:00","Revert nonsense I did in backends/platform/linuxmoto/module.mk and modify ASM build rules instead, enforcing the creation of output dirs for compiled files

svn-id: r44647
"
"136dbba9c4542dc83814ca24f5ae1604cb380dd7","2009-10-05 07:00:59+00:00","Fixed warning (GameObject is a struct)

svn-id: r44648
"
"8568892bf56269c9e19c98e1b834bb407df58aa2","2009-10-05 07:10:01+00:00","- Renamed GUI -> Gui and capitalized as appropriate (e.g. SciGUIwindowMgr -> SciGuiWindowMgr)
- Renamed 'cell' -> 'cel'

svn-id: r44649
"
"6f97a7ca817a36ff1e0ac3dcf9bb9113e4765bc0","2009-10-05 07:25:18+00:00","Cleanup

svn-id: r44650
"
"3f77685f13165120d64eabf863f017ee65684711","2009-10-05 07:38:05+00:00","More method renaming

svn-id: r44651
"
"d61e73367fc0ef5dd59c0664d511e539e7195d6c","2009-10-05 07:48:43+00:00","Silenced some warnings in drawVectorData()

svn-id: r44652
"
"7f053e3a62e8558d98faed1bc477c1a469e7210f","2009-10-05 07:51:31+00:00","Removed the unused _bytesPerDisplayPixel parameter. All SCI games use 8bpp color (apart from the videos in Phantasmagoria 2, which are not part of the engine itself)

svn-id: r44653
"
"93833ee86a48e53ae2d38fc66a3539b9cf727f2e","2009-10-05 08:19:43+00:00","Window shadows are also taken into account when storing their bits. This fixes the issue where window shadows were left on screen when windows were closed

svn-id: r44654
"
"d37f4ea07d110994bb8e3b2897263213fd33c142","2009-10-05 09:20:55+00:00","Proper check for window shadows

svn-id: r44655
"
"4478ab647277d7eaa6eb52042f1be82e8f1cc5f1","2009-10-05 09:23:59+00:00","SCI: Name argument

svn-id: r44656
"
"55e7c29d95b6d77c4e59f1deeae5760f4cf0b29e","2009-10-05 10:27:00+00:00","Removed dead code

svn-id: r44657
"
"6e38de3905ec7f5cbbfb991b4a4f960027550b3a","2009-10-05 11:42:04+00:00","SCI/newgui: kDrawControl on icon implemented

svn-id: r44658
"
"4d699301c75b18a9a2526f19ef85b1c05c2a0070","2009-10-05 12:04:39+00:00","Minimize unnecessary calls to updateScreen() in the new GUI. This improves drawing speed dramatically

svn-id: r44659
"
"7da723ab4e867a5b23c979df1a6b77eec05a85ad","2009-10-05 12:12:18+00:00","SCI/newgui: drawControlIcon - updates screen now

svn-id: r44660
"
"f3d3596d544a099812295711221c61683f488e22","2009-10-05 12:37:01+00:00","Renamed
setCLUT() -> setPalette()
getCLUT() -> getPalette()

svn-id: r44661
"
"3e66ae85f60469e8a79c2b7a2ac2b11589bac9c5","2009-10-05 12:49:31+00:00","Better naming for the palette setting functions, to disambiguate them from the existing ones

svn-id: r44662
"
"4c35022f6b3b5cc77fa90eb306e96a14fbb91a99","2009-10-05 13:33:26+00:00","Lines are no longer treated as fake rectangles and are shown correctly again

svn-id: r44663
"
"91a16e0c7dd97b24461901d03b1b485eea833dcc","2009-10-05 16:43:24+00:00","Moved the cursor movement code in the GUI

svn-id: r44664
"
"d7f584166dcde5e183c89b0e9fcfa2c99ba43061","2009-10-05 16:51:01+00:00","SVN/newgui: ega cel uncompression implemented

svn-id: r44665
"
"ac5d71b57e4fd835fab6bcdcf3198d7463e47546","2009-10-05 17:40:21+00:00","SCI/newgui: duplicate the color in cels into upper 4 bits on ega so they wont get dithered with black

svn-id: r44666
"
"ac9faddd1749514d188857cd2df332deb029da8e","2009-10-05 17:57:06+00:00","SVN/newgui: views on sci1.1 - mirroring now possible

svn-id: r44667
"
"2a06f341811da796f28ae07dc03cb54e5c2850fe","2009-10-05 18:00:12+00:00","SCI: Move restoreRect adjustment from DrawWindow to NewWindow

svn-id: r44668
"
"ec43c3050376c9ba9325db3a503ebcd3ec54d0ac","2009-10-05 18:20:50+00:00","SVN/newgui: renamed getScreenPalette to getSysPalette (code doesnt get the screen palette at all, but actually the current sysPalette which does not need to be active at all times

svn-id: r44669
"
"3654cefe332dbae35978cddd7cf268d6d14379b1","2009-10-05 19:20:52+00:00","SVN/newgui: kDrawStatus implemented

svn-id: r44670
"
"7596f535ac2812c3765486bc9e8f4b4d7cf04d61","2009-10-05 19:28:43+00:00","Fixed crash when starting games with the stable GUI

svn-id: r44671
"
"442a87012303b8d4073fa08a843fef19da5c5ff5","2009-10-05 19:30:17+00:00","Stop spamming of the console

svn-id: r44672
"
"e6b1a0cb4b3f26cdf332d9981a858de86b02d96d","2009-10-05 19:39:47+00:00","SCI: kDrawStatus now calls s->gui->drawStatus with NULL if no text given

svn-id: r44673
"
"16580e53bf71ad99bb7f41186c85981d1c728147","2009-10-05 19:46:38+00:00","SCI: kDrawStatus changed, dont call gui if no text received

svn-id: r44674
"
"e77f997e33bc4d7fb4b28c399c4762d9f7b2d5e3","2009-10-05 20:02:29+00:00","SCI/newgui: EGA picture drawing is now using EGA palette

svn-id: r44675
"
"9b416ca9474c48532b3f86d4289a631eb19a80c6","2009-10-05 20:19:07+00:00","SCI/newgui: switch to SCI1 commands when being IsVGA(), fixes qfg2

svn-id: r44676
"
"db4938fd86bdbc17f1a0e02169a6fc160de8c0a2","2009-10-05 20:21:59+00:00","SCI/newgui: SciGuiPicture - enum rename from SCI0/SCI1 to EGA/VGA

svn-id: r44677
"
"c30cdf65e7597ceef80c6e25a382ac7531d33289","2009-10-05 20:46:19+00:00","SCI/newgui: color duplicated to upper 4 bits on EGA to remove dithering with black

svn-id: r44678
"
"64d73415cac1e81e144a6604eecb8b5c9f134032","2009-10-05 21:38:51+00:00","SCI/newgui: changed the way dithering works on ega games, also default value change for kDrawStatus

svn-id: r44679
"
"20125b51c49004c827fde6011a3e4c873b47c1f3","2009-10-05 21:47:28+00:00","SCI: Fix error message

svn-id: r44680
"
"30596adec20f5b19636c7053bc69d5bc66236f95","2009-10-05 22:42:41+00:00","SCI/newgui: Implemented trick to get dithering going after drawing picture w/o destroying statusbar

svn-id: r44681
"
"437a7cc07cc6deca0c8f6f2565fa3cd253e2fa7c","2009-10-05 23:00:48+00:00","SCI: Make getBitsDataSize use the same logic as saveBits

svn-id: r44682
"
"36c2625f07ebfc9b69165762bf33c071a93b20a1","2009-10-05 23:46:39+00:00","Here we have:

- dropped gBitFormat

- added extra param 'const Graphics::PixelFormat *' to

OSystem_PS2::initSize

OSystem_PS2::setMouseCursor

Note! To compile on SVN you will have (for now ;-) to create
few few empty folders by hand, note very elegant but will
keep you going until when we (ehm...) refine the PS2 Makefile.

Here comes the brute force script I use inside backends/platform/ps2

mkdir -p backends/platform/ps2
mkdir -p base
mkdir -p engines/scumm
mkdir -p engines/scumm/he
mkdir -p engines/scumm/imuse
mkdir -p engines/scumm/imuse_digi
mkdir -p engines/scumm/insane
mkdir -p engines/scumm/smush
mkdir -p engines/agi
mkdir -p engines/agos
mkdir -p engines/cine
mkdir -p engines/cruise
mkdir -p engines/drascula
mkdir -p engines/gob
mkdir -p engines/gob/demos
mkdir -p engines/gob/save
mkdir -p engines/gob/sound
mkdir -p engines/igor
mkdir -p engines/igor/parts
mkdir -p engines/kyra
mkdir -p engines/lure
mkdir -p engines/made
mkdir -p engines/parallaction
mkdir -p engines/queen
mkdir -p engines/saga
mkdir -p engines/sky
mkdir -p engines/sky/music
mkdir -p engines/sword1
mkdir -p engines/sword2
mkdir -p engines/touche
mkdir -p gui
mkdir -p graphics
mkdir -p graphics/fonts
mkdir -p graphics/scaler
mkdir -p graphics/video
mkdir -p graphics/video/coktelvideo
mkdir -p sound
mkdir -p sound/mods
mkdir -p sound/softsynth
mkdir -p sound/softsynth/opl
mkdir -p backends/events/default
mkdir -p backends/fs
mkdir -p backends/fs/amigaos4
mkdir -p backends/fs/ds
mkdir -p backends/fs/palmos
mkdir -p backends/fs/posix
mkdir -p backends/fs/ps2
mkdir -p backends/fs/psp
mkdir -p backends/fs/symbian
mkdir -p backends/fs/windows
mkdir -p backends/fs/wii
mkdir -p backends/keymapper
mkdir -p backends/midi
mkdir -p backends/plugins/dc
mkdir -p backends/plugins/posix
mkdir -p backends/plugins/sdl
mkdir -p backends/plugins/win32
mkdir -p backends/saves
mkdir -p backends/saves/default
mkdir -p backends/saves/posix
mkdir -p backends/saves/psp
mkdir -p backends/timer/default
mkdir -p backends/vkeybd
mkdir -p common

I know, you don't need all those '-p' but it looks more consistent ;-)

svn-id: r44683
"
"8d762cf0f0c1db8acf2e2abc665ff12c024f5e4c","2009-10-06 06:50:31+00:00","SCI/newgui: support for amiga palette, amiga picture support, cleanup

svn-id: r44685
"
"358bfb31419666325f0fd69907a3ffb1e9febdc6","2009-10-06 07:12:09+00:00","SCI/newgui: one typo in view sci1.1 fixed

svn-id: r44686
"
"c901f18e031e4ecae0b168a031c8b6ad71981680","2009-10-06 07:25:07+00:00","SCI/newgui: view 1.1 loading now completely fixed, included sanity check and one fixme

svn-id: r44687
"
"6cd612d3594012bac14b1aad791f1117faf57bf0","2009-10-06 07:35:21+00:00","Fix regression introduced by r44459; LGoP2 crashed after Infocom logo

svn-id: r44688
"
"467c883ae10dbdafbf134027984834dbd0881c52","2009-10-06 07:37:08+00:00","SCI/newgui: view type amiga now supported

svn-id: r44689
"
"8e108cc0a0c76814ac533c51b361737ba5e8c867","2009-10-06 08:11:06+00:00","Removed unused reference to OSystem

svn-id: r44691
"
"df29b0067e100e97f29d286178685257816f0972","2009-10-06 12:26:13+00:00","- Unified the screen buffers that are used by the current and the new GUI
- Replaced the FreeSCI line drawing code (which is actually Bresenham) with Graphics::drawLine(), after discussing with waltervn. This shouldn't bring any regressions, as we're no longer offering the option to scale the background at a vector level. After playing through some of the games, I haven't noticed any regressions
- Some cleanup

svn-id: r44692
"
"daa6f0d9a2ce86f3e7088f689878996ba0b10684","2009-10-06 12:33:36+00:00","SciGuiView is only using the ResourceManager, so there's no need to pass the whole EngineState to it

svn-id: r44693
"
"334a48a33d069d00f31c972a7e9aeb0c82b7d148","2009-10-06 13:30:20+00:00","SCI/newgui: removed warnings from vector drawing

svn-id: r44694
"
"3eb350ff1f93a2390faf1fdf36314c2c4f8c9857","2009-10-06 14:00:35+00:00","Removed duplicate private variables

svn-id: r44695
"
"5d382150dfcef7ad596f5c164d9313c8469ddf62","2009-10-06 14:37:25+00:00","- Removed the SciGuiGfx parameter from SciGuiView
- Moved _sysPalette inside SciGuiScreen
- Made CreatePaletteFromData() a static helper function

svn-id: r44696
"
"855af31757d20ace18f8b96c09d44571aacc049b","2009-10-06 15:20:33+00:00","Removed the Bresenham line drawing code in the SCI new GUI, and replaced it with Graphics::drawLine()

svn-id: r44697
"
"14dfa5d7b01fba21c3da100830febbcdd1532d8c","2009-10-06 16:14:40+00:00","SCI/newgui: palette functions from SciGuiGfx now in SciGuiPalette

svn-id: r44698
"
"f258a29d6be4909f7d62811cf2c3a4ddc6d566d7","2009-10-06 16:19:20+00:00","Updated the SCI engine module.mk and MSVC project files for commit #44698

svn-id: r44699
"
"d2fdc8fc79839ebb7cc2b2e61644651d534e34a5","2009-10-06 16:25:34+00:00","SCI/newgui: Draw_Line() now doesnt modify prio/control anymore

svn-id: r44700
"
"ca9f08c6244a51098669993ccd829afefe33ff72","2009-10-06 16:36:28+00:00","SCI/newgui: kHiLite support

svn-id: r44701
"
"ed0a9611707c7b9145cb4e0401db4b53de754707","2009-10-06 16:45:06+00:00","SCI/newgui: drawpattern now adjusts to curPort

svn-id: r44702
"
"f664dcdee8946946544205764b8c9a7610c89715","2009-10-06 17:04:56+00:00","Simplified the LSL1VGA font resource workaround

svn-id: r44703
"
"0b47085da0d287ff14b9d0299bfe18cdf6dd469e","2009-10-06 17:09:34+00:00","Removed an unused reference to OSystem

svn-id: r44704
"
"1342d0482110ca26bffdf10bbc66eb377e22fd03","2009-10-06 17:13:57+00:00","Moved the LSL1VGA workaround inside the font class

svn-id: r44705
"
"d1bca7ced6ff4d20906720ef72a490cddfba4a64","2009-10-06 17:16:27+00:00","SCI: Minor cleanup

svn-id: r44706
"
"5e9820cc6f9ac9925de125929d873d8ecbc8ce04","2009-10-06 17:17:12+00:00","SCI: clean up oldx/y vs x/y

svn-id: r44707
"
"1481c78d1a61937d9339563a521b3b87c14520e9","2009-10-06 17:18:44+00:00","Removed yet another unused reference to OSystem

svn-id: r44708
"
"45fda46cf31884ca446c23e6c6df50794145cf9e","2009-10-06 17:22:40+00:00","KYRA/LOL: - get rid of ascii/sjis detection which could cause problems when typing savegame names
- fixed some minor bugs

svn-id: r44709
"
"4991a87b53b503616858160c0b0dea86e2be4a83","2009-10-06 17:28:32+00:00","Kyra: fix kyra 3 font

svn-id: r44710
"
"b8f18e8ddd60c9e7cf063f449857f855ba9bd323","2009-10-06 17:44:17+00:00","SCI/newgui: pattern drawing texture now bit0-bit7, sierra did it bit7-bit0

svn-id: r44711
"
"c17495d8952e03de03288829c487a60014d2656e","2009-10-06 17:45:57+00:00","- Fixed kGetTime() again
- Removed the odd way of calculating elapsed time in SciGui(). We got _system->getMillis() for that purpose
- Replaced the code in SciGui::wait() with the one in SciGui32::wait (which works fine, and is correct). The code in SciGui() was not polling for events while waiting, either

svn-id: r44712
"
"ab4013d1e5fde0a45a509143f772d5d7e09dc24a","2009-10-06 18:53:20+00:00","SCI/newgui: pattern drawing circles now fixed

svn-id: r44713
"
"d8e10f3e40d292a5b3c904e5432e96d34a08e5df","2009-10-06 19:22:59+00:00","SCI/newgui: dont allow negative coordinates in draw pattern (fixes bad pixels in kq1)

svn-id: r44714
"
"cbb4f05bf9694818f24f7169e4d54a46b277c02b","2009-10-06 19:47:12+00:00","SCI/newgui: changed menuPort to one pixel less

svn-id: r44715
"
"7601f1b14fadb108f99557ca5c90a481a7efe0e0","2009-10-06 19:57:17+00:00","gob - fix valgrind warning: invalid read when animKeysCount equals 0

svn-id: r44716
"
"6d135e904f33c5f473294dfa389a496abcd8dd8a","2009-10-06 19:57:55+00:00","WIP code for replacing the FreeSCI view decoding code with the new one (no changes to the logic, yet)

svn-id: r44717
"
"f81716993458226001549e18453f7f229de5ad75","2009-10-06 20:49:14+00:00","More work on the view wrapper code

svn-id: r44718
"
"c676b90475e34c71e2e055469104549c1e8b1f99","2009-10-06 21:20:32+00:00","SCI/newgui: pattern drawing table fix

svn-id: r44719
"
"f533e0ad9e1704a67397ffdf0117f9a693ee79c9","2009-10-06 21:23:24+00:00","Reverted #44697 (line drawing in the new GUI), with some function renaming. Apparently, Sierra's implementation of the Bresenham line drawing algorithm was a bit different than ours, which resulted in problems with flood fill

svn-id: r44720
"
"e4c3cbbd791962118ee6aedd47864f1aa2ff49c8","2009-10-06 21:41:20+00:00","Reverted the priority line drawing code in the current GUI (with some cleanup) to use the FreeSCI line drawing code, which was removed in #44692. Apparently, Sierra's implementation of the Bresenham line drawing algorithm was a bit different than ours, which resulted in problems with flood fill

svn-id: r44721
"
"ffc769ca537faa9bea3d640af436c0eab89e6feb","2009-10-06 22:13:46+00:00","Updated the parameter names of FillRect()

svn-id: r44722
"
"f72c4d21c7d158345546dd9db95c2ae9a1924f79","2009-10-06 22:45:08+00:00","More work on the view wrapper code

svn-id: r44723
"
"a17d01bd21b8377b132b59ec48589495d3852fb0","2009-10-07 11:31:30+00:00","More work on the view code wrapper. Now all SCI0-SCI11 views should be displayed correctly, apart from the late SCI0 ones (e.g. in Codename Iceman), where the palette is incorrect

svn-id: r44724
"
"5cc21cedf688015e12fa4f9b014bedfed01f00a4","2009-10-07 11:35:12+00:00","SCI: removed r44595, sierra sci really does behave like Common::Rect, no need for +1

svn-id: r44725
"
"23b39f5c459c9387012e63cde931c9b929b387cb","2009-10-07 12:09:20+00:00","SCI: SciGuiPalette - init() is now private

svn-id: r44726
"
"77b549a0ad9e3a66f9a571e049c26a74231c2ce4","2009-10-07 12:47:53+00:00","SCI: SciGuiCursor class added, cleanup, OSystem removed from SciGui constructor

svn-id: r44730
"
"337dbf2289e73b5fbbc6b8e0466f1cdbdc61687a","2009-10-07 12:52:21+00:00","SCI: removed OSystem from SciGuiScreen

svn-id: r44731
"
"ece4f55db970c27a82d99aac76bc621790478b61","2009-10-07 12:53:58+00:00","Updated the MSVC project files and module.mk for commit #r44730

svn-id: r44732
"
"1dfe7578cba4894630bd6fa093cfa1607fbdad6e","2009-10-07 14:53:15+00:00","SCI/newgui: kSetCursor (show, hide, pos, shape) implemented

svn-id: r44734
"
"cb31d302b9600123e0748ddb655090899095a23b","2009-10-07 15:53:34+00:00","SCI/newgui: implemented debug command show_map

svn-id: r44735
"
"de3d1cfdaf040d3f9959d9738205f0e3fc3b6b08","2009-10-07 16:16:34+00:00","SCI/newgui: fix that caused floodfill to fail

svn-id: r44736
"
"ec421984a9a6aa8d1f51913a6382b8eb1eb2c59a","2009-10-07 16:26:16+00:00","Replaced the view loading code with the new view loading functions. EGA view color translation has been disabled, as it caused palette problems in Codename:Iceman

svn-id: r44737
"
"9f5c52b41057134b0c2c333e67cee37af023d1c9","2009-10-07 16:47:06+00:00","Fixed a potential buffer overflow in kFormat, which occurs in the 'About' screen in KQ4

svn-id: r44738
"
"94a9616d909850703b7c9c9f736bdc82d5494b7f","2009-10-07 17:01:19+00:00","Hopefully fixed a mismatching free() call in gfx_free_pixmap(), originating from getView()

svn-id: r44739
"
"6e17b025a5aace9de4d189e6c7545eb0edef4f63","2009-10-07 17:29:37+00:00","Implemented the SciGuiView destructor and plugged a memory leak in the current GUI

svn-id: r44740
"
"0e3b634ecbd7210af60f0ca112bd7e5e9e4711a8","2009-10-07 17:46:17+00:00","Fix mismatching new[]/delete use, by replacing delete with delete[].

svn-id: r44741
"
"7f78a7c6beedf1750f859dba89de03d01bf5dd96","2009-10-07 18:00:49+00:00","SCI/newgui: undithering of picture now possible (just follow instructions in gui_screen.cpp)

svn-id: r44742
"
"0c413530ac6d2c6731cdd15b44cf065a90757835","2009-10-07 18:09:06+00:00","SCI: set default EGA palette to 0, if no parameter is actually given us. Fixes lsl2, kq4, sq3, etc.

svn-id: r44743
"
"51784e95808f751027a5ca011d10d421e86d992e","2009-10-07 19:02:11+00:00","SCI/newgui: it seems that this fixes floodfill finally

svn-id: r44744
"
"971f495103355c79f726d5c1c3a33b809f46320e","2009-10-07 19:36:47+00:00","SCI/newgui: hopefully the final fix for drawpicture - set priority and control to 'not draw' state, also added remark for fillroutine

svn-id: r44745
"
"be84af2603979b9464487116f8615b5494f63086","2009-10-07 19:44:10+00:00","Fix an assert in activeWin().

svn-id: r44746
"
"c20530b4eb26f610470379d8cce2684f6020a3b2","2009-10-07 19:46:14+00:00","adding myself to authors :D

svn-id: r44747
"
"0dd211592e8cb86d94b8933baa405be7656e68f8","2009-10-07 19:49:41+00:00","adding myself correctly to credits.pl ;)

svn-id: r44748
"
"58470866d85ef49de8baffd364f20be92499f703","2009-10-07 19:56:00+00:00","another try to add myself...(this is more complicated than writing for sci itself)

svn-id: r44749
"
"a4029a4d4eaf6ad60f792dda2cc520496182631a","2009-10-07 19:57:32+00:00","dont ask...

svn-id: r44750
"
"5a865445813c924a0ca333d881f51c056bf9d165","2009-10-07 20:04:48+00:00","SCI/newgui: SciGuiView - paletteoffset in EGA games documented and finally not used

svn-id: r44751
"
"423f54a2d0585fa281649988e33d6f0bd6279925","2009-10-07 20:14:24+00:00","Add Hkz and myself

svn-id: r44752
"
"35f8e6ec0505c9f7ea2ae1e03b39372784bd768f","2009-10-07 20:25:49+00:00","LOL/PC-98: fixed freeze spell

svn-id: r44753
"
"20a51e79e889fa10fd0f0b9ba3c66e11855c8b5b","2009-10-07 20:38:23+00:00","Update AUTHORS properly using 'make credits'

svn-id: r44754
"
"0b83993a6476dc63475f985feb20d3044d20d7f8","2009-10-07 20:58:33+00:00","SCI/newgui: kDrawPic cleanup, addToFlag inverse detection currently not working needs fixing

svn-id: r44756
"
"54e69d635914a62dba6c2af570c1224937e704b5","2009-10-07 21:10:42+00:00","SCI: changed kDrawPic to use oldGfxFuncs()

svn-id: r44757
"
"c0c2d4f484cbf4dfaed91be525b365102a916a17","2009-10-07 21:15:50+00:00","SCI/newgui: SciGuiPicture now errors out on mirrored VGA pictures (added fixme)

svn-id: r44758
"
"80d136a362e667d4e8ff0754fe634eba30e0590a","2009-10-07 21:25:31+00:00","SCI: kDrawPic / had an error in previous revision

svn-id: r44759
"
"1562add63191c482acf99da61d6d8d1e2bf8903d","2009-10-07 21:29:47+00:00","- Cleaned up the cursor code
- Renamed gui -> _gui in EngineState, for consistency
- Added a reference to SciGuiCursor in EngineState, to be used by current code
- Renamed setCursorHide -> hideCursor, setCursorShow -> showCursor
- Moved the cursor zone limiting code inside SciGuiCursor. This code is currently not functioning, as we need to call refreshPosition() before each updateScreen() call to limit the cursor position.

svn-id: r44760
"
"a61076a645e8c185b54d290f223b70fea2fccb3b","2009-10-07 21:47:34+00:00","SCI: debug command undither implemented

svn-id: r44761
"
"e6fc06344d78bece094e01112db044c2cf185c7e","2009-10-07 22:03:17+00:00","SCI/newgui: changed dithering logic, otherwise colors combined with black wouldnt get undithered correctly

svn-id: r44762
"
"db86e00c9393a1688a18bb9298cabfc5278d04db","2009-10-07 22:44:44+00:00","SCI: Make local tables 'static', rename them according to our CFG

svn-id: r44763
"
"623098c393eaad1f85240c4b393b88da7f46b43f","2009-10-07 22:45:50+00:00","SCI: Fix warning, cleanup

svn-id: r44764
"
"e8a13197e3958b7d8472c8519cb060407266eb14","2009-10-07 22:50:11+00:00","SCI: Replace SciGuiGfx::mallocPort by 'new GuiPort'; also add FIXMES about ports which are not freed, have no valid ID and are not known to the window mgr

svn-id: r44765
"
"5d07a657f0619d197c8ababec32f1022a5d4f2e4","2009-10-07 22:53:32+00:00","SCI: Get rid of SciGuiScreen::initScreen, also known as 'calloc' elsewhere ;)

svn-id: r44766
"
"8498d769be544a7a4d0edbca894fa594f4723c8e","2009-10-07 23:04:13+00:00","SCI: Reduce header interdepencies once again. Rule of thumb: Never include a header file from another header file unless you absolutely *must* do it; if possible, try to use class forwards instead, and include the headers from source files only

svn-id: r44767
"
"a4fa78743d23deed3414f1915694184bac3f2798","2009-10-07 23:21:18+00:00","SCI: Change more stuff to be CFG compliant

svn-id: r44768
"
"0988e273eca17749037e501c20715b99b2dfb89a","2009-10-07 23:34:24+00:00","SCI: Turn lookup_node & lookup_list into SegManager::lookupNode & SegManager::lookupList

svn-id: r44769
"
"ce75c9270a836f991e54578767f2e4e4678f6c09","2009-10-08 07:25:18+00:00","Removed the unused game_time variable, and fixed the incorrect calculation of start_game_time when restoring a game

svn-id: r44770
"
"2d98b72858794e5ecf246180bb3cd51334513eae","2009-10-08 07:57:26+00:00","Restore the engine state stored within SciGui during loading once more, since it gets replaced during loading. Fixes loading (a regression from #44730)

svn-id: r44771
"
"0120111416a8bb8c9447123a43746d1d61e42a55","2009-10-08 07:58:31+00:00","SCI/newgui: removed EGAmapping

svn-id: r44772
"
"498d80a5107c8513a1c7dfa30b458af6408211d6","2009-10-08 08:00:30+00:00","Don't store the engine state in the SciGuiPalette class. The palette timestamps are now calculated from Epoch time, instead of game start time (the functionality is exactly the same, though)

svn-id: r44773
"
"f1cb78673acffcbd58b63ae62b79d1b0b11a1a45","2009-10-08 08:10:57+00:00","gob - Fix a Valgrind warning occuring in CD games

svn-id: r44774
"
"633463b1ddd9c5fce57dff2c03a32edd4701e693","2009-10-08 08:22:19+00:00","Updated comment to indicate that QFG1VGA is one of the newer SCI1.1 games that has word-aligned resources

svn-id: r44775
"
"bac0c769475bde85a240c557b7dab28c345dae4a","2009-10-08 09:29:14+00:00","SCI/newgui: kAnimate - resolved previously unknown code functionality

svn-id: r44777
"
"982950941c8fa0f240dcc3b4393beb0a61d23a31","2009-10-08 09:33:20+00:00","The layout of global object data is different in the PCE version of Loom.

svn-id: r44779
"
"d1dcd82ac01f245c96a4b82c53e6a0d535bada7d","2009-10-08 10:02:26+00:00","SCI/newgui: kAnimate SciGuiGfx::AnimateFill implemented

svn-id: r44780
"
"cce8d2e279cad25e9bc0bffbe94b5da230b9495f","2009-10-08 10:35:12+00:00","SCI/newgui: kAnimate - more implemented, cels are now drawn but isnt working correctly currently

svn-id: r44781
"
"120b6b939267afaecf23e13fca3d94f8b98aee30","2009-10-08 11:23:53+00:00","SCI/newgui: kAnimate - _delete invoking implemented

svn-id: r44782
"
"8f8b84f774600bb4ac6b53b9f69d934ca17b2818","2009-10-08 11:49:11+00:00","SCI/newgui: kAnimate - coordinates fixed

svn-id: r44783
"
"43a60d965a4a543eaaf1dd63336024c85373e1be","2009-10-08 11:57:17+00:00","SCI/newgui: change to nsRect, scripts expect that. Fixes mouse clicking on several games

svn-id: r44784
"
"caaba2ae95674931c38f1419e58b2d01ddeb941d","2009-10-08 12:04:34+00:00","Add a hack that fixes bug #2858887 and #2859606

svn-id: r44785
"
"bcade54247bef8fd2103b992a63760d2633cd072","2009-10-08 14:37:55+00:00","Started rewriting the check for the graphics functions type  (still not finished)

svn-id: r44787
"
"61952c3ac193403bf7ff7aa9dfad4a52c4089dd5","2009-10-08 16:23:46+00:00","SCI/newgui: implemented more of kAnimate, currently crashes on windowMgr update.

svn-id: r44788
"
"aab278974af34f218d7e3b4977ec259399feaf51","2009-10-08 18:07:49+00:00","SCI/newgui: kAnimate changes

svn-id: r44789
"
"03ee8c00beaab731a8e5e4347aa9711eed2523b1","2009-10-08 18:34:49+00:00","SCI/newgui: remarks about _menuPort, uninitialized usage in SciGuiPalette removed, _menuPort and _mainPort get deleted in destructor

svn-id: r44790
"
"d46aac8404f5212e6387a21530ce579298bc65f9","2009-10-08 18:59:45+00:00","SCI: Fix warning

svn-id: r44791
"
"f5ccaf7e29183d6e51456d5994eccfd35ff9a117","2009-10-08 19:14:58+00:00","SCI/newgui: floodfill cleanup, pattern drawing: helper went private, clipping implemented

svn-id: r44792
"
"42120ed626c0d18bc1e1738678dbd1fa96481f04","2009-10-08 19:41:38+00:00","Introduce a new struct TimeDate, replacing struct tm in client code. May lead to compilation issues in ports, which should be trivial to fix, though

svn-id: r44793
"
"a121c822ebbb502d39bf761f7c794fe446f3da87","2009-10-08 19:42:39+00:00","LOLLOL/PC-98: fixed ghorka swamp freeze mode

svn-id: r44794
"
"d56d072fb21fe201d533b4d92a698284549a0cbe","2009-10-08 20:07:00+00:00","SCI: Removed SegManager::getDescription

svn-id: r44795
"
"b0eeb3636ca801e2f40ef05b014d3ec40488704f","2009-10-08 20:13:52+00:00","SCI/newgui: cleanup, fixing uninitialized variable in SciGuiPalette

svn-id: r44796
"
"f8cdacdeeacd722031a1ce8d9426b7e1059e24c9","2009-10-08 20:22:12+00:00","LOLLOL/PC-98: fixed add-spell-to-scroll animation

svn-id: r44797
"
"64c4a8f901a1ac8a08c38225915577835a06f8bd","2009-10-08 20:37:10+00:00","LOL/PC-98: fixed lightning spell

svn-id: r44798
"
"b6967bc70d8a7fa248fadd591ea08bcf56ba4ec1","2009-10-08 20:51:49+00:00","SCI/newgui: more cleanup

svn-id: r44799
"
"cc236d97990486bfe36a4f19fd01b139ea90d969","2009-10-08 20:59:53+00:00","PS2: Add some stubs for the ps2 port to our primary build system (incomplete WIP)

svn-id: r44800
"
"2ab906bafd7e154bb9e333d7e76fe2a714478efd","2009-10-08 21:00:21+00:00","SCI/newgui: RestoreBits() now ignores empty handles

svn-id: r44801
"
"3399c3aeb638ae874557c72b4ab4db016ff152c8","2009-10-08 21:28:57+00:00","Change doxygen inline comments from '//!' to '///' as proposed on -devel

svn-id: r44802
"
"76996301d1988f2c6b2659e11223c3016c1232bc","2009-10-08 21:29:45+00:00","SCI: Removed obsolete stringfrags code

svn-id: r44803
"
"2f1c7f779a1facc88188d399574d4aeb8cf6dea5","2009-10-08 21:32:04+00:00","SCI: Don't iterate past end of list

svn-id: r44804
"
"860f7ce39befef97035c4eedd862799bd084545f","2009-10-08 21:39:33+00:00","SCI: Remove outdated comment

svn-id: r44805
"
"0c457be0fbc7935f264d8df55b034e33bda6f09f","2009-10-08 22:03:55+00:00","SCI: Turn reconstruct_scripts into SegManager::reconstructScripts

svn-id: r44806
"
"3072d54589f223572ce3d147920190bb13e57252","2009-10-09 07:50:37+00:00","SCI/newgui: Implemented kAddToPic (almost complete, but z-sorting and some extra code missing)

svn-id: r44807
"
"8694b48ae33fb010312be056e6b830b317e48526","2009-10-09 08:15:30+00:00","Set up a basic tracing system for all memory allocations to help track down memory leaks

svn-id: r44808
"
"0d9e1ded6f3a07f903c8d8e21407c4415067cb91","2009-10-09 09:41:35+00:00","Fix warning

svn-id: r44809
"
"b846fd6aca31916383b9656c40ba0be6ea6f3ed0","2009-10-09 09:41:53+00:00","cleanup

svn-id: r44810
"
"e6dd7e24f29ba6aa76a1b9361a480e6d099a3667","2009-10-09 10:03:45+00:00","PS2: Fix warning, use fully qualified path for backend specific header ps2temp.h

svn-id: r44811
"
"8549e48707fda26046a104eee851a4172689fcc1","2009-10-09 10:05:45+00:00","PS2: Fix warnings

svn-id: r44813
"
"857a35f7485b5594c280c0c597b3a876900e8aba","2009-10-09 10:32:33+00:00","Fixed all memory leaks as far as the initial title screen

svn-id: r44814
"
"3135892df03fb453ac295dfcc57a4c4a6e7389a9","2009-10-09 10:49:03+00:00","SCI/newgui: windowmgr cleanup

svn-id: r44815
"
"513cdb44a6bf866a893275538a19bfee8c7f465d","2009-10-09 11:38:13+00:00","BUILD: Introduced new env var 'LD' analog to CXX (and defaulting to CXX), currently only used for PS2; modified cross compiler testing code to only compile but not link the test C++ file (working around another PS2 issue); some tweaks to the PS2 related build code

svn-id: r44816
"
"23ded6d95574e430eac527eadcd40cf6691d39a0","2009-10-09 12:01:22+00:00","Fix warning

svn-id: r44819
"
"9f3c2c90838ff35f3b505973b4247be6da8edef8","2009-10-09 12:04:07+00:00","SCI/newgui: SciGuiFont now locks the resourcedata, fixes broken fonts in games

svn-id: r44820
"
"ce8addf5e04d07c6f27a3a35d241d6dc56eed936","2009-10-09 12:09:52+00:00","SCI: resmanager / include order change

svn-id: r44821
"
"7bf181bf98b5cdb38251efac681277015ceaf2d5","2009-10-09 12:10:08+00:00","Slightly modified version of patch #2875544: PSP plugins patch

svn-id: r44822
"
"0d5ba6ac6c865e42bb889ea607c1d0e9586dae17","2009-10-09 12:10:17+00:00","SCI/newgui: SciGuiView now also locks resource

svn-id: r44823
"
"22477093b4c4f74b2263ea8b0f23724527dff4da","2009-10-09 12:28:11+00:00","PS2: Hack to enable zlib/mad support for now (until detection & linker issue have been fixed)

svn-id: r44824
"
"ed5a4625d5c0f6cfdde588ff470d8db90e4d914b","2009-10-09 13:15:37+00:00","SCI/newgui: support for priority bands, kCoordPri kPriCoord implemented, priority band picture support also added

svn-id: r44825
"
"79bbcdac7dc3866b435e44a83727b9f0a5088ba3","2009-10-09 13:25:32+00:00","SCI/newgui: some more priority band usage in kAnimate

svn-id: r44826
"
"c26e283d1bdec6cec36050cd37a147fc5a2e4e6e","2009-10-09 13:43:20+00:00","SCI/newgui: priority bands support for ega pictures

svn-id: r44827
"
"4011e948e71b8bf03493caeede8c2018e6d756a0","2009-10-09 16:15:56+00:00","Finished the automatic detection of the graphics functions used in SCI0 games. Also, introduced a new helper function to detect the offset of a ret call inside a script, with possible uses in other script detection routines

svn-id: r44828
"
"6e6336ece7b0f578126149570529480850b6b136","2009-10-09 16:20:15+00:00","Fixed an issue when examining callk calls in the new graphics functions detection routine

svn-id: r44829
"
"53b1ff79a3a8bdd28c3ba5e44baa35f655800129","2009-10-09 16:21:37+00:00","Oops...

svn-id: r44830
"
"15e427c2c2a8482edd4352d3051d6b00e685dce3","2009-10-09 16:35:37+00:00","whitespace changes aka. buildbot rebuilding :)

svn-id: r44831
"
"ab1184770b4b53f4f16af51813a5e03c53139e1b","2009-10-09 16:51:10+00:00","SCI/newgui: kCanBeHere partially implemented, little corrections

svn-id: r44832
"
"efb1c33715606d94f12e169669104f72a4423ce4","2009-10-09 17:16:34+00:00","SCI/newgui: priority band init fix

svn-id: r44833
"
"7825128639355fa66ec897dbc0779c6403f559e0","2009-10-09 17:31:01+00:00","LOL/PC-98: fixed minor bugs in text displayer

svn-id: r44834
"
"a38d6451ba2c9ee192747bb4e9d28269798f74b1","2009-10-09 17:34:52+00:00","SCI: kgraphics.cpp cleanup (no code changes)

svn-id: r44835
"
"14f8d50a62f400bd79459c202d14938c37285ac6","2009-10-09 17:41:59+00:00","Moved actor movement detection in state.cpp, together with the other detections and rewrote it to work in a similar fashion to the other detections

svn-id: r44836
"
"01dc7545d2b8dcd70bab1ecdcb26d2d0c9b71f17","2009-10-09 17:47:33+00:00","SCI: drawMenuBar/clearMenuBar now using gui class, currently unimplemented in newgui, but so wont get affected by oldgui switching to visualScreen anymore (e.g. qfg2)

svn-id: r44837
"
"164611668b070abfdfa276980431176ad0b5becd","2009-10-09 18:06:24+00:00","SCI/newgui: pattern and floodfill moved into SciGuiPicture

svn-id: r44838
"
"dd0f5c318cf98919b2ce9a0f8942914ce0758218","2009-10-09 18:08:13+00:00","SCI/newgui: pattern #defines moved into SciGuiPicture

svn-id: r44839
"
"18df7c69ee9e5e6cade2bcd55dac1bba0ba949a2","2009-10-09 18:24:55+00:00","SCI/newgui: kAnimate priority fixed

svn-id: r44840
"
"918827ce99583b5bd62fa5bdb10a55c5427e256c","2009-10-09 18:57:16+00:00","SCI/newgui: correction for kAddToPic, fixes guards in 1st screen of kq1

svn-id: r44841
"
"e387d274dda33f6eac59780097a1a2d312b9d25f","2009-10-09 19:19:34+00:00","SCI/newgui: adding inactivate code for debug purposes to forward single methods to SciGui32 (testing only)

svn-id: r44842
"
"9f88122baaaf23de91e5f0cea5e1ced1e8e0f7f0","2009-10-09 19:41:39+00:00","SCI/newgui: calling process_sound_events now directly within kAnimate(), fixes hanging scripts (e.g. sq3 exiting pod, kq1 getting killed)

svn-id: r44843
"
"5801dd206412542f4f93391c7cb9e0c38cca7697","2009-10-09 19:50:20+00:00","SCI/newgui: moved priority band initialization to init() call of SciGui to avoid having to call usesOldGfxFunctions() within constructor, where it would crash on some games (sq3)

svn-id: r44844
"
"23887e97355363e076b2eeb4e3321f7a27a7c63d","2009-10-09 20:21:21+00:00","SCI/newgui: changing undithering logic again, palette now uses decoded color-combinations, fixup happens during dithering run on undithered mode

svn-id: r44845
"
"e0b1ef6e463f4d817a87a9eeb85f4760c4980218","2009-10-09 20:54:02+00:00","SCI/newgui: changing SciGuiScreen::dither() for cel-undithering logic

svn-id: r44846
"
"0d7d2b8371e5d903fe0390de8656e33bf0fabdb2","2009-10-09 21:35:48+00:00","LOL/PC-98: fixed monster drawing bug (some wrong pixels)

svn-id: r44847
"
"a8cd7694ccea215b6f003899333b1d727384b5b5","2009-10-09 21:36:09+00:00","Fix warnings about non-static const member in class without a constructor

svn-id: r44848
"
"6f1c43a7311d5e942f055087e307d6a537e159c6","2009-10-09 21:42:37+00:00","LOL/PC-98: fixed last commit

svn-id: r44849
"
"2e964baeef9a74d45090583b52419afa3c9c47bf","2009-10-09 21:47:33+00:00","Some const correctness changes; cleanup

svn-id: r44850
"
"99111f0ffd9038e23b16114daed582d8b64a30a7","2009-10-09 21:49:04+00:00","SCI: Fix some weird casting in the vectorPatternCircle and vectorPatternTexturedCircle

svn-id: r44851
"
"d0876b06ed71979ee8f1370e738b5d4d7ba89d75","2009-10-09 22:21:45+00:00","Remove some unused variables

svn-id: r44853
"
"8b3ff337beadb78a8baca971043266f9a019d104","2009-10-09 23:09:28+00:00","don't discard const qualifier needlessly

svn-id: r44854
"
"d95ed757895e0afd70f21819a28124ce954dd899","2009-10-09 23:15:54+00:00","Removed the wrong code for kGetTime case 1 in some SCI0 games - that case has always remained the same in all SCI versions. Added a warning in case we got some other case than 0 or 1 in SCI0 games

svn-id: r44855
"
"b91ae69ad2285e14091064ae1cc3b5b7ed299642","2009-10-09 23:19:53+00:00","Removed the now unused GF_SCI0_OLDGETTIME flag and simplified all of the game entries in the detector

svn-id: r44856
"
"9bb73a845727a958d4351b7dd36e1ee208b68833","2009-10-09 23:53:37+00:00","Removed the unused _flags variable from EngineState

svn-id: r44857
"
"8ae420637338c32b377c6518b4373302d6d8ee77","2009-10-10 00:07:19+00:00","Introduced a new debug level, kDebugLevelResMan, and reduced some of the messages printed to the console

svn-id: r44858
"
"4b3c1645bcbe19ba55a3e6f16c4b32b2332caab3","2009-10-10 01:38:45+00:00","SCI: Adlib: Add support for loading patch data from adl.drv

svn-id: r44859
"
"6c1cac39567bf6867274c1bb0c93feef72d535c6","2009-10-10 02:16:23+00:00","SCI: kMessage() rewrite

svn-id: r44860
"
"df3fbd432de3d0bfc8ec689a5616b34103c63791","2009-10-10 04:15:38+00:00","Further memory leak fixes

svn-id: r44861
"
"6bbe30f44b6aab44c269fd7c7775146c8a9085ea","2009-10-10 04:47:18+00:00","Game now completely starts up without memory leaks

svn-id: r44862
"
"a4fbc73ee65db07b8bbc3a7e37bdb6cf19d63e07","2009-10-10 05:08:56+00:00","Fixed memory leaks in savegame restoring

svn-id: r44863
"
"ba297ab7b14afff874d4b6731969ddab45eec6d1","2009-10-10 10:46:11+00:00","Replaced make_reg(0, -1) with SIGNAL_REG and fixed a warning (MessageRecord is a struct)

svn-id: r44865
"
"053cbdecc7b08c1ffd7711d99b0d2f24f1639deb","2009-10-10 10:48:46+00:00","Merged _k_base_setter() inside kBaseSetter()

svn-id: r44866
"
"16042120301a5b562415f1a35cba0a2ef782a131","2009-10-10 11:42:41+00:00","Makefile.common now requires us to set $(LD) as well...

svn-id: r44867
"
"bfabde4512f24c9c508fbbce6447b46c63355a98","2009-10-10 12:00:34+00:00","Fixed loading again - a regression from commit #44803

svn-id: r44868
"
"3aa8699874dfd5d053bb66b9e59c9036ba6b5c0a","2009-10-10 12:13:34+00:00","SCI: Fix warnings

svn-id: r44869
"
"3e259dea30f02e90b891801b27bdedb44f66a06f","2009-10-10 12:29:36+00:00","LOL/PC-98: fixed two minor bugs

svn-id: r44870
"
"b94c17488b48364953142c8c81fc7c07684175b2","2009-10-10 12:35:20+00:00","Added a rule for assembler with cpp preprocessing.

svn-id: r44871
"
"a07c50aba437b283a23d50c4695695189a1f1c5a","2009-10-10 12:58:40+00:00","SCI/newgui: removed SCI_SCREEN_MASK_DITHERED

svn-id: r44872
"
"bb381d3a52172bd84c5781111c1a4b7bd8a18a31","2009-10-10 13:47:26+00:00","SCI: Fixed bug in new Message() code

svn-id: r44873
"
"f517f32902b8c454ea355141444807198f9b678e","2009-10-10 14:26:53+00:00","RGB support.

svn-id: r44874
"
"6f9a4749d145375bb466a889b98fc74f5ff58305","2009-10-10 14:30:19+00:00","Enable RGB colour for Dreamcast.

svn-id: r44875
"
"fb4538dd2db6f8910e5303675e8339be269fd613","2009-10-10 14:31:16+00:00","Added flag for updating dependencies.

svn-id: r44876
"
"8fd29ecf9f5b7f66824b7df45e3f04dfc2b5cfeb","2009-10-10 14:55:56+00:00","Fixed some warnings.

svn-id: r44877
"
"d6f5d93dbf554bf7e133b0de7e675b6453736356","2009-10-10 15:58:51+00:00","Started rewriting the Object struct into a class

svn-id: r44878
"
"a15cf067a78f065e1b7f0893efa8c3fe80f518dd","2009-10-10 17:15:10+00:00","LOL/PC-98: fixed minor glitch in wsa code

svn-id: r44879
"
"17ee52170789b6d2485cf096309189f7c0bdcb2e","2009-10-10 17:40:29+00:00","SCI/newgui: intelligent cel undithering implemented

svn-id: r44880
"
"0a3e03a1669a5c51edbfcb078d58122d13277ecc","2009-10-10 18:18:12+00:00","SCI/newgui: removed hardcoded screen height/width

svn-id: r44881
"
"7f2259d2801285eac9d56e01231c250d889069f7","2009-10-10 18:39:52+00:00","SCI/newgui: changed GuiAnimateList struct

svn-id: r44882
"
"7c065c84cb3fce9c86f93956cd0bfdda24bd6388","2009-10-10 18:45:33+00:00","LOL/PC-98: implemented drawing code for teleporters

svn-id: r44883
"
"dbaac9de57a97f597b6f817cd7f377ba8216d1a1","2009-10-10 20:25:04+00:00","SCI/newgui: kAnimate is now using a dynamic buffer that stores animation data, fixes sq5 crash

svn-id: r44885
"
"cb15cdfb0733e14e6b5d065bbefb96eeb560ffda","2009-10-10 20:30:31+00:00","SCI/newgui: kAnimate list - showBitsFlag implemented

svn-id: r44886
"
"5d0afc45c6f4632574eaa7e0844f1711fe16c7ce","2009-10-10 21:25:21+00:00","SCI/newgui: kAnimate now using Common::List

svn-id: r44887
"
"2d3979ff6e9db470e587eb59517c09b01e078e66","2009-10-10 21:38:24+00:00","SCI/newgui: kAnimate - list is finally sorted according to y and z

svn-id: r44888
"
"b2a148e12c49043855775f414249d49f5ee78b59","2009-10-11 02:47:07+00:00","SCI: Fix hang in KQ6 book worm scene

svn-id: r44889
"
"f2db73e55d2e3eda8b7f746ae8483f4f474d121a","2009-10-11 03:40:11+00:00","SCI: Fix bug in Message() recursion

svn-id: r44890
"
"22baa6464733fa075f9896f71bad0bea432c1fa4","2009-10-11 07:21:59+00:00","SCI/newgui: kAddToPic fully implemented

svn-id: r44892
"
"e9bedf9b979e3dcd339d7019a574ab448a68383d","2009-10-11 07:54:20+00:00","SCI/newgui: Implemented kCanBeHere list processing

svn-id: r44893
"
"4ca178e203cfe4e7dbda902093ebed801b72e3eb","2009-10-11 08:03:09+00:00","SCI/newgui: correction for GuiAnimateEntry struct

svn-id: r44894
"
"76ea099d234820a5e26efb8aad15305c670a9eac","2009-10-11 08:07:59+00:00","SCI: Remove superfluous casts; fix warning.

svn-id: r44895
"
"67c7d49729da0aecc8d308d731e8323110afd1c5","2009-10-11 08:15:25+00:00","SCI/newgui: offTop changed, fixes window corruption (qfg3 and more)

svn-id: r44896
"
"0b1a8dea2deaa996b7229f637c0c9795443d4301","2009-10-11 08:52:23+00:00","SCI/newgui: kShakeScreen partially implemented

svn-id: r44897
"
"d971b0737a76ed58678fc41b9efcb8cab8a8999f","2009-10-11 09:25:31+00:00","TUCKER: ignore selected verb when displaying options (tracker item #2872383 - Look at options)

svn-id: r44898
"
"fc775204298965851279ca69a7628ee73107b442","2009-10-11 09:26:36+00:00","TUCKER: fix original game glitch (tracker item #2872385 - Fish swims out of aquarium)

svn-id: r44899
"
"e780a973d243b6c2d6b9142cd60a5c741a9bf513","2009-10-11 09:31:48+00:00","SCI/newgui: kDisplay restoreUnder/saveUnder implemented, fixes previously sticky text in sq1, kq5, etc.

svn-id: r44900
"
"91eee2e99ae17c8e4cfceb4b09f98f164d6eb5c7","2009-10-11 09:34:35+00:00","SCI: change remove script FIXME warning into comment

svn-id: r44901
"
"236e8013661d829d701491edc971b2ea7eef496e","2009-10-11 09:39:53+00:00","SCI/newgui: comment change on SciGui::moveCursor()

svn-id: r44902
"
"353fe8ae563d52eaa0ae07a71f6a839d8854b68a","2009-10-11 09:47:12+00:00","SCI/newgui: SciGuiGfx::BitsFree() implemented, currently used in kAnimate, Bits-methods renamed

svn-id: r44903
"
"6492c00a3ad24c16ef77e837c478bbc1b4c1e1bb","2009-10-11 11:28:43+00:00","Revert changes to graphics/sjis.h in r44709.

svn-id: r44904
"
"8f6e9f0bf2cbd3c6cc59488aa7f8a4b5c92ffc15","2009-10-11 11:29:34+00:00","Fix FM-Towns/PC98 menu code.

svn-id: r44905
"
"6e93add43f5b098df8b51e1d23ba4d9a3136b8ea","2009-10-11 11:30:24+00:00","Cleanup.

svn-id: r44906
"
"ea28351862c8db5c8e1bd72a4d4c4cb63a50b2a6","2009-10-11 11:34:30+00:00","Cleanup.

svn-id: r44907
"
"0353b9923d4f6c159ba4a78e6e495f2aa326357e","2009-10-11 11:42:50+00:00","SCI/newgui: SciGuiPicture now also supports mirroring of cel-data

svn-id: r44908
"
"65865de4731b733b85e19b4e4d79f883e11400db","2009-10-11 11:59:30+00:00","Removed unused variable.

svn-id: r44909
"
"67c6e92efba2ffcde33a3e9b8e9ebaf7389e05ae","2009-10-11 12:00:56+00:00","Add support for 8x16 chars in the FM-Towns font ROM code.

svn-id: r44910
"
"e90f337bd20bcf04920c1eeae634892750aed363","2009-10-11 12:01:20+00:00","Fix regression introduced with r44907.

svn-id: r44911
"
"47988039ea009940f20e56b79749d6800cfc806c","2009-10-11 12:05:55+00:00","Fix text input font for LoL PC98.

svn-id: r44912
"
"0d98fa3fe4ff5100fa66f23d18c45aeea732d265","2009-10-11 12:15:17+00:00","SCI: made kEditControl use SciGui class, not currently implemented in newgui

svn-id: r44913
"
"7755404f52b022d52d9c6bb0120973acb50d2bd6","2009-10-11 12:45:40+00:00","Fixed compilation with the current GUI

svn-id: r44914
"
"f4288516e80ec64aa262ccd8fcf61b1f8ce3fa09","2009-10-11 12:51:13+00:00","Revert commits r44912 and r44905, seems like the original FM-Towns/PC98 games did only allow ASCII input, thus they didn't use the SJIS font in the save/load menus.

svn-id: r44916
"
"bd6de4f642ed81f6fa32565b1324003857f4bf45","2009-10-11 13:44:19+00:00","Hopefully avoiding an assert in the MSVC debug CRT library when entering an umlaut in the launcher.

It's a bad idea to cast a parameter to the 'is*' functions from ctype.h to 'char',
since 'char' might be signed and the 'is*' functions are defined to only accept
input which fits 'unsigned char' or equals EOF. In this concrete example the value
of 'state.ascii' is > 0x7F, thus becomes negative after the cast to 'char', which
violates the parameter rules of 'isprint'.

Sadly it seems this is not the only place in our code, which does pass a possibly
signed parameter to an 'is*' function. We might either want to change all code to
only pass an unsigned char value, change the code to do parameter validation or
fix it in another way.

svn-id: r44920
"
"6d030126d7d75f498692d8e2772d58728c6197bd","2009-10-11 13:46:58+00:00","More work on the Object class

svn-id: r44921
"
"097d6d298d0f3f5a0ee73463d9c4dc8094668b67","2009-10-11 13:54:35+00:00","Print warning, when the number of colors in a palette file exceed the number of colors in the target palette on load.

svn-id: r44922
"
"7b493e9a60d4e8e08f19772d793f8f1a36c19a42","2009-10-11 14:15:37+00:00","fix new[]/delete mismatch

svn-id: r44924
"
"efcfae742b63ca01abca64cbbfa5aa71b2dae527","2009-10-11 14:28:20+00:00","SCI: kDrawControl for list and textedit controls also using gui class

svn-id: r44925
"
"117dfd08ecc41a6c7dc339ba21205e72fcb764fa","2009-10-11 14:30:55+00:00","rename shadow var

svn-id: r44926
"
"4a157d43b352997e05164d231a634bc65d302308","2009-10-11 14:58:58+00:00","SCI: Implement CoordPri() with two args.

svn-id: r44927
"
"6f553a630a6776893813335c39a477905f5b45a2","2009-10-11 15:32:22+00:00","SCI: Relax GetAngle() signature for KQ6.

svn-id: r44928
"
"ba9a9422b42fe447854f7c6e56ff5794135b6b60","2009-10-11 15:41:52+00:00","SCI/newgui: list control implemented

svn-id: r44929
"
"1d3118cf4282dd15d188d07f99cb438348c6d803","2009-10-11 15:51:43+00:00","Implemented some advanced savegame functionality - loading and deleting savegames from the GMM is now possible, and new saved games will also have thumbnails. Saving from the GMM creates corrupted saved games, so it has been disabled for now

svn-id: r44930
"
"57ae40e52c7ac95a32e80ffa4cc3c4a0ed356ae9","2009-10-11 16:00:16+00:00","Fixed a warning, ironically inside a warning().

svn-id: r44931
"
"0da0d5b6a418b6205a1b228c32efbd6433e5b125","2009-10-11 16:12:24+00:00","Stop passing all of the engine state to SciGuiPicture

svn-id: r44932
"
"1d2031defd094f0b067634c42c864c2143a6b341","2009-10-11 16:15:42+00:00","Stop passing the engine state to SciGuiWindowMgr

svn-id: r44933
"
"9b97f21486e7c84611140c05a1e8aa20df238777","2009-10-11 16:47:01+00:00","Reset the EngineState pointer in the SciGuiGfx class when loading. Fixes loading with the new GUI

svn-id: r44934
"
"6fda9a5067ca642ccf569a0845e170a6a74ce442","2009-10-11 17:59:23+00:00","Optimized some screen updates in the new GUI to only update the changed rectangle, instead of the whole screen

svn-id: r44935
"
"16e852159a57d59f4b57a2752a50eb7611c5ab78","2009-10-11 18:40:21+00:00","LOL/PC-98: fix king richard healing sequence

svn-id: r44936
"
"222b0d38876e39b71910600edfc80c673643a3b8","2009-10-11 18:41:13+00:00","Fill box routines do not translate the fill box coordinates

svn-id: r44937
"
"07736ede1908b9705aed9180f072e9f77fd9d9b0","2009-10-11 18:42:52+00:00","Added kSetPort case with 4 parameters (used in the ending of LSL6)

svn-id: r44938
"
"1f00be5c15615f2bc784692396b4eaa26eef5cf9","2009-10-11 19:23:00+00:00","The _variables array is sized from syncArray, so there's no need to store its size in the savegame

svn-id: r44940
"
"22ffa71c0a9ab23126604de7538b5331a5414a06","2009-10-11 19:33:38+00:00","LOL/PC-98: fix outro music

svn-id: r44941
"
"7449091202506956bf678bf6b1641106028cb01b","2009-10-11 20:09:35+00:00","KYRA: fix sjis dialgue text display

svn-id: r44943
"
"cfc7b741f9f662a18048065d1db89cbc20b6b57b","2009-10-11 20:20:28+00:00","Use BitsShow() for partial screen updates

svn-id: r44944
"
"29a6fdf367b09a944a255e58d11207ce494d6a54","2009-10-11 20:23:15+00:00","fix compilation

svn-id: r44945
"
"2109a0ff9dc7e8dac3a17e79bec2565e219bea6f","2009-10-11 20:29:38+00:00","LOL/PC-98: cleanup

svn-id: r44946
"
"c693401dce27b6767ebc9160aaf086d72c0c6aa4","2009-10-11 20:41:02+00:00","LOL/PC-98: fix decoration shape drawing

svn-id: r44947
"
"8fe74a1a7ea395fd744792db71d9a78ea7045a45","2009-10-11 20:46:04+00:00","SCI/newgui: support for textedit control (mouse support not yet implemented)

svn-id: r44948
"
"409a1bd0a6e43181c4d651620d2ea88e03db2bfe","2009-10-11 21:18:43+00:00","Removed unused variable.

svn-id: r44949
"
"bb7cac5b8734d4be3d08d54daed66cdd3613172d","2009-10-11 21:28:52+00:00","Show a warning when a selector vocabulary can't be found and a static vocabulary is used

svn-id: r44950
"
"e1dc8452bd3d3d5e3de49d3de92c3c86cef79fa2","2009-10-11 22:20:58+00:00","sword1: fix psx demo startup

svn-id: r44951
"
"b6baadff535fd48fbf94a2519ac4a2404088d273","2009-10-11 22:26:03+00:00","Updated the modern theme logo with a darker shadow

svn-id: r44952
"
"c4563616ae06194087b467746fe2b820b6311ac0","2009-10-11 22:30:40+00:00","Added support for sound archives.

We initialize them in the DraciEngine constructor, but don't play any sounds
yet.  Checked that it works for all existing sound files (required several
work-arounds against unspoken specification).

When copying the interface from barchive.h, I decided to remove some const's
from there, because getFile() wasn't really behaving like const.

Removed some static Common::String instances.

svn-id: r44953
"
"e2db155b1a82150a4c651a643b6a4343e810b8e9","2009-10-11 22:34:01+00:00","sword1: fix one gcc warning about comparison between signed and unsigned

svn-id: r44955
"
"f71b32dd96cc524fbb433752ea2ead51e1cf02a4","2009-10-11 23:01:59+00:00","Loading and caching sound samples in memory.

The sounds are not played yet, but the infrastructure is getting ready.

svn-id: r44957
"
"62cebbb51ee74ca5341d2dd35af79b723d738222","2009-10-11 23:28:40+00:00","Implemented a few more harmless GPL2 commands

svn-id: r44958
"
"6768065f142b4fe87ac4786d23023806022f3b7c","2009-10-11 23:54:44+00:00","Reduced code duplication and fixed one deletion bug.

svn-id: r44959
"
"6aaf99ec6756c2ff4d661b88f0aad489784212ac","2009-10-12 00:01:39+00:00","Disambiguated _anims.

It's both a pointer to an AnimationManager and list of animation ID's fo
each object.  The latter renamed to _anim so that I can easily search for
them.

Also, fixed the bug promised in the previous commit.

svn-id: r44960
"
"3ef5145b41852ce39494e353ee7c95600d49093e","2009-10-12 00:15:34+00:00","Reduced huge code duplication by introducing Game::stopObjectAnimations()

svn-id: r44961
"
"b99e69f4d9a4ec864d5b6f26787d1841e4bdc56d","2009-10-12 00:32:51+00:00","Fix indexing of the dragon's animations.

After inspection, I assert that it isn't true that the _anim array needs to
be sorted.  In fact, sorting ruins the ordering of the dragon's animations,
which corresponds to enum Movement.

After fixing this, let the dragon have a rest instead of constantly walking
down.

svn-id: r44962
"
"ca35af26976c0499b83ff3b434ae3d7b9eaef33f","2009-10-12 00:39:49+00:00","Fixed funcActPhase()

svn-id: r44963
"
"1a4dcd3c82d6db389a25ad92235843b1841fbf23","2009-10-12 01:16:13+00:00","Implemented GPL commands JustTalk and JustStay.

The basic commands are done.  It remains to implement handling music (after
we play it at all), fading palette, and controlling the quick-hero and
speed-text flags (after I find out what they do).

Now the dragon switches between talking and staying during dialogs.  However,
the left/right direction doesn't work yet, because we don't respect _lookDir
and _useDir yet.

svn-id: r44964
"
"43437eecb88fbf0c34db6660406652b4ca4ddcde","2009-10-12 03:08:28+00:00","Dragon looks into the requested direction.

Parsing _lookDir and _useDir, and passing it all the way around to walkHero().

Also, added playHeroAnimation() to reduce code duplication.

svn-id: r44965
"
"07222b8e89819f63ebd6cac535c7dda41a001146","2009-10-12 07:11:22+00:00","SCI/newgui: kGraph updateBox implemented, cleaned up usage of BitsShow() still not perfect (e.g. kq5 cutscene information box)

svn-id: r44966
"
"e85553b024cb6e7d8f4e079eb9176d000e6329c9","2009-10-12 07:18:38+00:00","SCI/newgui: change in windowMgr, so that removed windows will get restored in any case (ReAnimate currently not implemented yet)

svn-id: r44967
"
"713f573735b483fffd5da9f7469be3f72faf97e7","2009-10-12 07:30:55+00:00","SCI/newgui: implemented kPicNotValid

svn-id: r44968
"
"ebb188c415bac4dfc2bfbcd2b7f7236365e0247d","2009-10-12 08:25:38+00:00","Move the line drawing code to SciGuiScreen()

svn-id: r44969
"
"b6be6ae7a946773fd32a5ed8d372294cb72824b4","2009-10-12 08:55:33+00:00","SCI/newgui: typo fixed in SciGuiPicture

svn-id: r44970
"
"e8deac29a5bacdb82f96a82f5cdcf1881055a0a5","2009-10-12 10:09:25+00:00","Fixed a warning message under MSVC... seems like Common::String::printf does not work correctly when used on an empty string

svn-id: r44972
"
"2bb8d69380c7a86b99c1fb4812fafaad3b84529c","2009-10-12 10:32:44+00:00","Got rid of _baseTable and _baseDisplayTable

svn-id: r44973
"
"50faafc6227ab0a53b05ecb3a6b2223e903386cb","2009-10-12 10:33:36+00:00","SCI/newgui: priority band initialization fix

svn-id: r44974
"
"9ae7935a1d3311821e8fc3086471d64719e050aa","2009-10-12 10:34:31+00:00","SCI/newgui: kDrawControl (icon) now also calls BitsShow()

svn-id: r44975
"
"250402f21bf95d36e543013112455c6e00eb1e23","2009-10-12 11:36:42+00:00","SCI/newgui: kGraph RedrawBox (ReAnimate) is now using class calling (functionality not yet implemented)

svn-id: r44976
"
"ab1f2dac77448b848f1e736e6b8cc4162f6a5ec1","2009-10-12 11:49:32+00:00","SCI: Fix warnings, cleanup

svn-id: r44978
"
"833e6f41d5fac26a4b0a687a70f7ecfe57fcee76","2009-10-12 11:51:28+00:00","Fix broken size in Common::String::printf output in MSVC

svn-id: r44979
"
"5ab01ded3d2e7905413f846ec40511c362697ebf","2009-10-12 11:54:32+00:00","Add unit test for bug fixed by r44979

svn-id: r44980
"
"81a2316bd5f67ebcc8c7703b369586b6a20318e1","2009-10-12 12:03:06+00:00","Reverted the Common::String::printf() related commits, as the function works fine now under MSVC

svn-id: r44982
"
"0ab28463d6495bef1c792ec9cd605bd0ec7c65c6","2009-10-12 12:15:27+00:00","SCI: re-enable accidentally commented update call

svn-id: r44983
"
"f4f17ae51639fc28501e282cc8bd5c421e180a31","2009-10-12 12:38:58+00:00","SCI: kGraph now fixes up coordinates before constructing a rect (invalid rects are given to us by castle of dr. brain right at the 2nd screen when entering left door)

svn-id: r44984
"
"03a24ccae0ca7c348fc2040871623a765b62b105","2009-10-12 12:42:50+00:00","SCI: kGraph cleanup

svn-id: r44985
"
"3599ac0b9b60bf05039aab4d6df2c84152ea66cb","2009-10-12 13:10:25+00:00","SCI: now allowing calling celWide and celHigh with only 2 parameters (done by eco quest 1 when entering menu)

svn-id: r44986
"
"61ac28abea2a2325fe9253e7439d86897d02cbc1","2009-10-12 15:13:15+00:00","SCI: kCelHigh / kCelWide got broken with last revision, now fixed

svn-id: r44987
"
"cfc3af3466484dbd5cccefa1276716836d09e754","2009-10-12 15:41:19+00:00","Minimize dependencies in the new gui

svn-id: r44988
"
"291e479daf44611be9238943ba0ee33150baaedc","2009-10-12 15:52:50+00:00","SCI/newgui: background of noupdate cels is now correctly saved (was typo) solves sticky cel problem

svn-id: r44989
"
"093554749f18f209d9f45b5db52ed3db0fb49e01","2009-10-12 16:00:30+00:00","SCI: commenting out music warnings

svn-id: r44990
"
"c713abc6c752cfe4d98be3fc0de92eb6d091e0e5","2009-10-12 17:21:23+00:00","Cleanup

svn-id: r44991
"
"0cc28b5cd75dd9b3b6bbe578c20e8eed0689f1f5","2009-10-12 19:30:33+00:00","use new ScummVM logo (with capital S)

svn-id: r44992
"
"1821ea1bd35f423bf3ae5627d2345fe44bdc732e","2009-10-12 20:27:47+00:00","SCI/newgui: addToPic (list) replaced priority with z, to fix drawing coordinates of static cels within a picture

svn-id: r44995
"
"30cb28e7efe0e3a5c69c658d50634e6161e92680","2009-10-12 20:46:32+00:00","Silenced GCC warning.

svn-id: r44997
"
"71686a2e7bc0273e857d8328066c1e7294ae0b69","2009-10-12 22:08:35+00:00","SCI/newgui: priority band initialization now working exactly the same way as sierra sci did (fixes at least lsl3)

svn-id: r44998
"
"d306e1219e606f5af6b3dd37556f1ba1ecb5ed51","2009-10-12 22:23:27+00:00","SCI/newgui: priority band initialization - forgot to use priorityBandCount variable

svn-id: r44999
"
"e77928440307f0d8a765e32100e031989ad25ff5","2009-10-12 22:27:23+00:00","Sound effects are now correctly played.

Dubbing is not yet played.

svn-id: r45000
"
"7c311057c10f876cbe5053fac1943917766ae0f0","2009-10-13 04:44:22+00:00","Dubbing is played.

I haven't implemented switching dubbing and subtitles on/off according to
the config manager nor the speed of the subtitles, yet.

svn-id: r45001
"
"baec8c2421c30ebee00c0e0e97de8beba3a9fc2a","2009-10-13 05:38:45+00:00","Set all sound/subtitle-related parameters from ConfMan.

Made it intelligent so that when, for example, the dubbing file doesn't exist,
we don't fail, but instead always show subtitles even if the GUI settings
says dubbing only, etc.

svn-id: r45002
"
"aea23b47149a2d92b52f1e1ea55c660719805518","2009-10-13 06:52:31+00:00","SCI/newgui: fix floodfill for qfg1ega pictures

svn-id: r45003
"
"19cacbdb3c0918cedc244db97a47598b42198fa2","2009-10-13 07:17:30+00:00","SCI/newgui: SciGuiScreen putPixel etc. needs to use _width and _height instead of _displayWidth and _displayHeight

svn-id: r45004
"
"3f914e67a0f1e4a0a32c694abd7e86d05c2a6f53","2009-10-13 08:03:09+00:00","SCI/newgui: finally changed floodfill to behave the same way as sierra sci. Fixes sq3 priority map

svn-id: r45005
"
"1731acc320a2fbaf79162597272e787a0ffe8c10","2009-10-13 08:09:17+00:00","SCI/newgui: floodfill / remove screenMasks that are already filled with the right value (otherwise we could get into an endless loop)

svn-id: r45006
"
"a048e81f81a0fb9a0a2d6b833e6cf891f8cb37f4","2009-10-13 08:48:43+00:00","Updated some icons to the new version (.icns provided by Max Horn)

svn-id: r45007
"
"db5ee083272856225528e626bf9327811c81387a","2009-10-13 09:29:58+00:00","Update the Wii icon

svn-id: r45009
"
"0f995c02f32a8ccd1b3ebfcb16d2b7c21225df86","2009-10-13 09:33:57+00:00","Fixed a bug in the graphics function detection code, and corrected the location of the static 'overlay' selector in SCI0 games. Fixes the demo of lsl3

svn-id: r45010
"
"ff1d2592ccc392de75d89752190ee8d311bb9f3b","2009-10-13 11:12:41+00:00","Update some more icons (motomagx, gp2x, gp2xwiz and wince)

svn-id: r45011
"
"dcf44e1bd805135e6bce8102cd3f05582d0bac3f","2009-10-13 14:26:42+00:00","gob detection
- Add preliminary Gobliiins 1 CD-i detection.cpp
- DOS CD is 2.01, not 1.02

svn-id: r45014
"
"099c073605952c7c530d009a6c7cb4f988616f73","2009-10-13 14:50:14+00:00","Update the WinCE bar and the XPM images

svn-id: r45017
"
"050f3626544f3c8217a0cec701fd6fb68940ada3","2009-10-13 15:28:27+00:00","SCI/newgui: SciGuiAnimate class created

svn-id: r45019
"
"4ccfb76e3c080e524f070cac54886fd029a0d130","2009-10-13 15:29:24+00:00","SCI/newgui: added new file to module.mk

svn-id: r45020
"
"f31974bc7740615d1eb36ee61f836aadc9dbaea5","2009-10-13 15:30:37+00:00","SCI/newgui: added new file to msvc8

svn-id: r45021
"
"0305a306ae21c8bedfa0b4ab0e4d036e64b1e954","2009-10-13 15:43:58+00:00","SCI: added new files to msvc9

svn-id: r45022
"
"5ca933bb765b397acc84d0700bd393717d3a43fb","2009-10-13 15:47:05+00:00","SCI/newgui: implemented resetEngineState() in SciGuiAnimate

svn-id: r45023
"
"da4a8bbca28c622f60f43ff6cae7279bf1058aaf","2009-10-13 15:48:43+00:00","SCI/newgui: removed left over stuff from SciGuiGfx header

svn-id: r45024
"
"cc66387cc4160beb011002b6b15a5f79bafc3e98","2009-10-13 15:50:27+00:00","SCI/newgui: uncommented enum in SciGuiAnimate header

svn-id: r45025
"
"65ed9eac4e325d26a684d1ff984e124c9fded03a","2009-10-13 15:57:40+00:00","SCI/newgui: SciGuiAnimate header included into gui_gfx

svn-id: r45026
"
"7cefc4cc989ba7606e6473db9a56c14e30326c24","2009-10-13 16:18:17+00:00","SCI/newgui: kSetPort() now also supporting 7 parameters

svn-id: r45027
"
"5aa141539786c4f905addfd0c05f6e00dfd3afd7","2009-10-13 16:22:07+00:00","Merged the cursor manipulation code - cursor views are still not done

svn-id: r45028
"
"4e0046dd1f1cd342bd0c2c8b1f7367299e117d15","2009-10-13 17:09:32+00:00","Merged the rest of the cursor code

svn-id: r45029
"
"535873ba4698ae1cf883eaa2b95d5ac4788f4f26","2009-10-13 17:17:40+00:00","SCI/newgui: canBeHere fixed, walk-anywhere in sq3 is not possible anymore

svn-id: r45030
"
"f9c6e77abe560879de1fb44dd3e10c7f4241fe11","2009-10-13 17:22:52+00:00","Removed some leftover code, fixes KQ5CD

svn-id: r45031
"
"b4a537137b4ea46feede518d2842840277cbfdcd","2009-10-13 17:50:27+00:00","SCI: stub for kDrawControl K_CONTROL_PERCENTAGE

svn-id: r45032
"
"b50d197f721219baaf55c400fcbfc010ef6ccbe4","2009-10-13 17:51:10+00:00","Removed some leftover cursor code

svn-id: r45033
"
"0b396ed37c80deb7475c53d194253c435203e78a","2009-10-13 17:57:03+00:00","Removed the now unused code in gfx/res_cursor.cpp

svn-id: r45034
"
"f5b73061e45cafe17e409f42046660524e6d278d","2009-10-13 18:49:10+00:00","SCI/newgui: K_CONTROL_* renamed to SCI_CONTROLS_TYPE_*

svn-id: r45035
"
"0df369767d4c560b75e4578cb7d3ab703cb5bf2b","2009-10-13 18:50:46+00:00","Revamp the way --enable-release / --enable-debug work. They are now no longer mutually exclusive. Also, ports can override whether we default to (non-)release resp. (non-)debug builds

svn-id: r45036
"
"581b819c25e9cf0700f36dd3cf22818db30f9420","2009-10-13 18:51:14+00:00","BUILD: Don't set endianes & data types explicitly, rely on auto-detection

The auto-detection code *does* work for cross compilers, too. So it
should never be necessary to explicitly set _endian or type_1_byte etc..
But if for some reason this does not work correctly on your port, and
you have to re-add the explicit settings, please make sure to clearly
document this with a comment.

Note: Several ports set type_4_byte='long'. I added FIXME comments to
each code, asking porters to document the reason why 'long' must be used
instead 'int' resp. instead of the auto-detected type.

svn-id: r45037
"
"8191c04056ea65169e04957d00da11550b3495e3","2009-10-13 18:51:59+00:00","SCI: Merge some sfx related global funcs into SfxState.

This allows us to get rid of 'static SfxPlayer *s_player'.

svn-id: r45038
"
"8126f81b6f11982ae696d861a26387a7169923d0","2009-10-13 18:52:36+00:00","SCI: Doxygenify comments in class SfxPlayer

svn-id: r45039
"
"c77be11ccd81afb92e5f2e2620295fa65dc3124d","2009-10-13 18:53:11+00:00","SCI: cleanup

svn-id: r45040
"
"296dd543443e15c97366bab40a732c7eff9cfd34","2009-10-13 18:53:50+00:00","SCI: Merge SegManager::alloc_Hunk into SegManager::allocateHunkEntry

svn-id: r45041
"
"297542345f938e3c55f48cef967ec6dbc432f8ec","2009-10-13 18:54:20+00:00","SCI: Skip loading HunkTable segments. This fixes a silly bug that can lead to arbitrary numbers of HunkTable segments to be created by repeatedly saving and loading.

svn-id: r45042
"
"c59c10ac087cd835996d71c0e52f416d46e083ac","2009-10-13 19:00:09+00:00","PS2: Replace license header on irx_imports.h by a GPL one. These files
contains trivial content and are not really 'copyrightable' anyway.

svn-id: r45043
"
"8ccafc09a96a4fafceec67794b1f86691d3efc67","2009-10-13 19:08:40+00:00","SCI/newgui: DrawControl type 10 is actually just a dummy in qfg1ega, we dont need to do anything. I believe some other control is responsible for the percentage box

svn-id: r45044
"
"94cd10297406f4b57d6d0d38a3ac3be18311f22b","2009-10-13 19:12:25+00:00","PS2: Clarify licensing terms for some files

svn-id: r45045
"
"73fa80d94088cfac87f4302112bff5c3b2fb9754","2009-10-13 19:48:41+00:00","LOL/PC-98: fixed outro

svn-id: r45046
"
"b49d6d950b1bca350baea7a9437071cf5823af5f","2009-10-13 20:25:51+00:00","Moved some old GUI specific code from kgraphics.cpp into gui32.cpp

svn-id: r45047
"
"2ae08e8478af697fc7b8a49eeaf2879d87a67c2e","2009-10-13 20:50:59+00:00","SCI: Don't save HunkTable segments

svn-id: r45048
"
"429c9eb8140ef6c28cac27c3a145c971f02c540b","2009-10-13 20:52:05+00:00","SCI: Don't end warning() format strings with a newline or a period (a newline and an exclamation mark are automatically added)

svn-id: r45049
"
"4201515d23d1ac96355778285f5ac8f1c9d663e2","2009-10-13 21:01:27+00:00","Patch #2878216 (AMIGAOS4: Icon updated)

svn-id: r45050
"
"724e7a873ae3342fab34f247b7a4647736491563","2009-10-13 21:18:47+00:00","SCI/newgui: class SciGuiTransitions created

svn-id: r45051
"
"8c17b257eab6c7b84e0a779ae1a1cb068cc44cce","2009-10-14 06:12:16+00:00","Fixed regression bug #2874229. Regression had happened in r39878, when the dialogue code was refactored.

svn-id: r45053
"
"8570068f584ad48b50d5fd0fa77cafb447e9a302","2009-10-14 09:28:58+00:00","- Moved cel width and height calculation in the GUI
- Merged the engine states of the old and new GUI

svn-id: r45057
"
"d358f072548953e3767ffd427564d1fa178816b4","2009-10-14 09:32:49+00:00","Proper variable naming

svn-id: r45058
"
"28034ef29834a8406b69bbf2a665eed061581da1","2009-10-14 09:36:39+00:00","SCI: Fix warning, cleanup

svn-id: r45059
"
"5ea978f63a7835de5ed1c8a6b4af269b27511ba8","2009-10-14 09:37:22+00:00","SCI: Rename some vars (cleaning up what seems to have been caused by a blind global search & replace)

svn-id: r45060
"
"4c91ace5307e2451ad7217f352c57ed51ffa84af","2009-10-14 09:46:02+00:00","SCI/newgui: support for embedded cel data < 320 pixels width. fixes jones/vga

svn-id: r45061
"
"947d3ab5d47f974832955d75a466a9199f928d92","2009-10-14 09:56:11+00:00","SCI/newgui: coordinates fixup for embeeded cels

svn-id: r45062
"
"ec25df8e2356fad682d84fa1eb4b1e5e6815ae25","2009-10-14 10:02:23+00:00","SCI/newgui: another change to floodfill, fixes jones/vga

svn-id: r45063
"
"caaac0130aa79b7145d5608f8dff5b3fe422704a","2009-10-14 10:11:03+00:00","SCI: kDrawControl now also fixes bad rects (fixes jones/vga)

svn-id: r45064
"
"7c2eae0ca34d59ee2093f6289f03b2a7eb186cd6","2009-10-14 10:25:06+00:00","SCI/newgui: fixes textcode processing to get out if string ends and no ending delimiter found

svn-id: r45065
"
"1aa2cb8e61252b4bc333674d20ffa4054697bdd9","2009-10-14 11:18:13+00:00","Update the SVG and Moto EZX icons

svn-id: r45067
"
"d6d2b0b6bb5677a950e47959ff5c475f99905b81","2009-10-14 11:23:46+00:00","SCI/newgui: SciGuiTransitions now gets picRect

svn-id: r45068
"
"5da32b16c2fb3f05cd63bcf8dc984533234c9f24","2009-10-14 11:28:50+00:00","SCI: kDrawPic - flags is actually uint16

svn-id: r45069
"
"cf51ef499ea92dcce10e9d844c06b86a2a847c10","2009-10-14 11:29:09+00:00","Plugged loads of memory leaks in the new GUI

svn-id: r45070
"
"060980c50272829151157477425fe0f1dc393a9a","2009-10-14 11:34:02+00:00","SCI/newgui: SciGuiTransitions receives SciGui now

svn-id: r45071
"
"9dff5c53b4841113a4d1edddda8b39c418f11053","2009-10-14 12:39:39+00:00","SCI/newgui: SciGuiTransitions now at least supports fadeIn/out

svn-id: r45072
"
"7ba018898eb0ca349bb500a6280ad707673deee8","2009-10-14 12:47:51+00:00","SCI/newgui: implemented code to differentiate between EGA and VGA transitions

svn-id: r45073
"
"d9de73e725b1bf5a3734260757ad6d0283079723","2009-10-14 12:48:28+00:00","fix compilation

svn-id: r45074
"
"2284932e359a48277821e95eeedf2da61eebe7f1","2009-10-14 12:53:57+00:00","SCI/newgui: changed step-count to half to minimize cpu load

svn-id: r45075
"
"a2c7ec6d85c23a1cbf7da75f146a926677e5321a","2009-10-14 12:56:14+00:00","Tweak configure for PS2 to disable debug mode by default and enable relase mode by default

svn-id: r45076
"
"8df9514b79a0cde3b883c9d2599b3c879c06c614","2009-10-14 13:23:37+00:00","SCI/newgui: SciGuiTransitions now supports pixelation effect (lsl5 intro)

svn-id: r45077
"
"b220471efdefd9533a1e52b96c3e91b6de6a0940","2009-10-14 13:28:36+00:00","Fixed kMoveCursor(). Now the cursor will be moved to the correct spot when pressing tab in dialogs

svn-id: r45078
"
"f286a6d5b9d37cc57367a01d13c397769d88957e","2009-10-14 13:58:37+00:00","SCI/newgui: SciGuiTransitions now supports block-pixelation as well (EGA and VGA), e.g. qfg1/ega

svn-id: r45079
"
"c93c9cb68dded6d4a47de73c2de74d433b027439","2009-10-14 14:06:53+00:00","gob: fix a regression in Bargon Attack intro caused by a fix of Ween problems. Still requires a more proper fix, but at least it doesn't hang anymore (closing bug #2878717)

svn-id: r45080
"
"51975b50cb8f95d15b3d9e63b8de4b590eb90016","2009-10-14 14:17:15+00:00","Add LoL PC98 credits entries to kyra.dat.

svn-id: r45082
"
"1b3a5eaff610a55f7f4295e2585616619c3517f6","2009-10-14 15:21:53+00:00","Started rewriting the SEQ decoder to use the new GUI functions

svn-id: r45083
"
"e07479261606df3ee02c905bd5707061a5d49811","2009-10-14 15:43:58+00:00","SCI/newgui: SciGuiTransitions now also supports scrolling up (lsl6 intro)

svn-id: r45084
"
"07b73f6ea8a94f72db244d2c4af1845363a504a0","2009-10-14 15:46:59+00:00","SCI/newgui: woops, forgot to set new palette when scrolling up

svn-id: r45085
"
"c10052865dde9905aff35a9bbf09d66487631e07","2009-10-14 16:57:16+00:00","SCI/newgui: SciGuiTransitions scroll left/right now supported (kq1)

svn-id: r45086
"
"ccaec44fc0dabcd923a9216dc4a303d25f7ec69f","2009-10-14 17:08:02+00:00","SCI/newgui: fix header of transitions

svn-id: r45087
"
"20036d3cb4705404710519653cb0f5da56d90da7","2009-10-14 18:03:47+00:00","Fixed the palette in the SEQ decoder again

svn-id: r45088
"
"8e58d5ef80bf8a0e33a7ef698881ab20362f332a","2009-10-14 18:09:54+00:00","SCI: kDrawPic now reads out blackout flag for transitions

svn-id: r45089
"
"3c5c9541545af978f035d2db544bcba48a48ece0","2009-10-14 18:35:15+00:00","SCI/newgui: changed kPalette (setIntensity) to behave differently (seems we had it wrong) also changed nonsense clipping

svn-id: r45090
"
"bc49c6e63ed0ba4eb7f8b372872505665aec2383","2009-10-14 19:39:07+00:00","SCI/newgui: kPalette / setIntensity / reimplemented setPalette optional parameter, fixed memory corruption in setIntensity

svn-id: r45091
"
"a7e51b8276df7123c6471c1bf212729e181b4642","2009-10-14 21:45:16+00:00","SCI: kAnimate now delays a bit if needed (fixes typing in intro of lsl5, kq6 sierra logo and much more)

svn-id: r45093
"
"a7e6f50ede79a0f7f1ca89ae6900d838cf4fe334","2009-10-14 21:48:52+00:00","SCI: removed speed throttler (cause of kAnimate change)

svn-id: r45094
"
"6a2985ba08fc030d93d625615d7b1b5604fbc98c","2009-10-14 22:37:05+00:00","Patch #2834677: Wave/ADPCM Endianness Fixes

svn-id: r45095
"
"984527a479b29b31cc4065eb70723d194d656530","2009-10-14 22:40:43+00:00","SCI: Fix build with VM_DEBUG_SEND enabled

svn-id: r45096
"
"e6d3bb80b4123df4b6c1d472a426ee333df3bb9f","2009-10-14 22:41:03+00:00","SCI: Improve cmdSend slightly. It's still broken, though

svn-id: r45097
"
"7f0f6655e87461d191c4fa9177779b13406dbb46","2009-10-14 23:22:32+00:00","cleanup

svn-id: r45098
"
"3dc7c0a732ea5fa5ec3aa74406f242c211fd04b4","2009-10-14 23:28:23+00:00","SWORD2: Switch from loadWAVFromStream to makeWAVStream.

This also fixes a memory leak (the MemoryReadStream wasn't being freed).

svn-id: r45099
"
"edf682791365e15fdbec1587ecde012c53fce6f6","2009-10-14 23:29:14+00:00","SWORD1: Remove obsolete TODO

svn-id: r45100
"
"d4d1346ceba02d0d24b364a8295c85dd967116b6","2009-10-14 23:30:06+00:00","TUCKER: Convert one more loadWAVFromStream instance to makeWAVStream

svn-id: r45101
"
"942dc2ce845fa2fc274b825f71bfefbad8a2b992","2009-10-15 06:37:05+00:00","SCI: included stub for kPalVary to make Pharkas work a little bit more (currently crashes in kMessage)

svn-id: r45102
"
"1fe5233c311167804884f93799e68074ab4ae5f3","2009-10-15 06:50:42+00:00","SCI/newgui: SciGuiTransitions now doesnt fade in/out color 255 anymore

svn-id: r45103
"
"3e7eb5089c242865a3e579024c30566253d0ed41","2009-10-15 07:46:52+00:00","SCI/newgui: within transitions mouse cursor is now hidden

svn-id: r45104
"
"0868fd24d27b8398247527e334e0f8849726092a","2009-10-15 07:50:10+00:00","SCI: kAnimate now uses gfxop_sleep for sleeping, mouse cursor is more fluid that way

svn-id: r45105
"
"1259c3ded7cb2e96d17af9b6d2e6e0b0083ce34c","2009-10-15 08:03:01+00:00","SCI/newgui: SciGuiTransitions fadeIn now uses setIntensity() like sierra sci does, fixes blackout in longbow and others

svn-id: r45106
"
"483bed9540733b546c58482f7a101adcc45dcec7","2009-10-15 08:22:37+00:00","Updated custom PSP makefile with engines, cleaned up, fixed small issue

svn-id: r45107
"
"03d2c959319bb2a17b8526a690d59dda8a39a856","2009-10-15 08:38:42+00:00","Fix Makefile again; use PSP targeted sdl-config, not the system-wide one.
If you need to adjust this to build then your toolchain setup is broken!

svn-id: r45108
"
"c3e1f7be6b2810f95a5fa14df716292db71a30c2","2009-10-15 09:54:45+00:00","SCI: Don't cache squares

svn-id: r45109
"
"022491c1cd7a8b3da5ed14d6dd04846ac7d44beb","2009-10-15 10:12:14+00:00","SCI/newgui: longbow palette 999 doesnt have mapping, so palette was detected as SCI1.1, changed detection. fixes black windows

svn-id: r45110
"
"5d6b2564953fd1452d4af7130c7c39fb6d301b1d","2009-10-15 11:47:05+00:00","SCI/newgui: SciGuiPicture now supports embedded ega cel data

svn-id: r45112
"
"0d6ab8c73a1059885a6ecb93f530f690de84e22f","2009-10-15 11:57:36+00:00","SCI: Add support for reg_t based segments to Message()

svn-id: r45113
"
"6e18ee5b8831cf7908b52f91767f239631cbd9e3","2009-10-15 12:04:07+00:00","Changed palette initialization depending on the findings of the resource manager. Fixes the palette in several SCI1 EGA games

svn-id: r45114
"
"f351295ebe115a0517eb9d43c8c050f59d5cd76f","2009-10-15 12:48:47+00:00","SCI/newgui: SciGuiTransitions now translates old IDs to new IDs, also changed that new IDs will get used from SCI1_LATE upwards

svn-id: r45115
"
"f1a981cb4931e69b99b94677f272ac1a3053ccd8","2009-10-15 12:55:12+00:00","SCI/newgui: SciGuiTransitions now also supports scrolling down (e.g. lsl1 intro), cleanup

svn-id: r45116
"
"4587b9bed8cee8e5c71f51665372ef176d57f220","2009-10-15 13:00:18+00:00","SCI/newgui: SciGuiTransitions: now warns correctly about unsupported old IDs

svn-id: r45117
"
"e195b8870771091147b95aea1d744e1a9f2b46a2","2009-10-15 13:30:18+00:00","SCI: kAnimate speed throttler fix

svn-id: r45118
"
"e5c88ffc7a4a6b7d86d69a27900ae52b33f2e181","2009-10-15 13:37:25+00:00","Save/load dialog now uses GUI::SaveLoadChooser.

svn-id: r45119
"
"017b0e0acb5b844bf002c093e11f03cfc343c34f","2009-10-15 13:40:39+00:00","Fixed bug 2879785. Dialogue commands were partly executed too early: see comment at line 480 in dialogue.cpp.

svn-id: r45120
"
"766820d72c252328a91f64782fdc3aabf11166a7","2009-10-15 14:57:40+00:00","SCI: added fix for iceman (dance with girl walking)

svn-id: r45122
"
"6d95f8ca618b2f881fb1dd83705d5cc33a6da886","2009-10-15 15:07:47+00:00","SCI: pointer_add -> error changed to warning b/c iceman does it. Just ignoring it doesnt seem to have any effect on the game

svn-id: r45123
"
"da7652deb3425427de3693cb21ef1bf8af3e8d96","2009-10-15 15:17:54+00:00","Changed the KQ6 floppy SEQ decoder to use the common VideoPlayer interface. Some cleanup

svn-id: r45124
"
"fe7b70a4d5d7b6a173227fe22be51a491209c1eb","2009-10-15 15:27:08+00:00","SCI/newgui: undithering now enabled by default

svn-id: r45125
"
"21d397fdd2bebdc447657924a55f289608ff047c","2009-10-15 18:00:28+00:00","SCI/newgui: Do textcodeprocessing only for SCI1.1+

svn-id: r45126
"
"e3aa37dde006210bde31e70d71ef7383d50a579a","2009-10-15 19:24:50+00:00","SCI: Fix send debugger command

svn-id: r45128
"
"59649759b83b61f1f34e8be3303aa417135c56d3","2009-10-15 19:57:46+00:00","Removed unused variable.

svn-id: r45129
"
"78c905ebbe6244c9cd3f4e76c02bd6808e04d1ef","2009-10-15 20:01:24+00:00","PSP plugin: fixed small warning that could cause problems

svn-id: r45130
"
"4ce77c77faed71efbedd177d73ad02342b439daa","2009-10-15 20:13:19+00:00","SCI: Make send varselector reads more verbose. Add notes.

svn-id: r45131
"
"93587aad89f11a7aeee7cbaf80c57ec196973776","2009-10-15 21:10:34+00:00","New iPhone icons from jvprat

svn-id: r45132
"
"6ade594794534b179bf482c4a93d052c412b097c","2009-10-15 22:01:57+00:00","SCI/newgui: transitions now also support horizontalRoll (e.g. qfg1ega), cleanup, oldIdTable now also supports blackoutFlag

svn-id: r45134
"
"6edf387418d49089bc2bc12e67261cc547774e87","2009-10-15 22:05:52+00:00","Give Gob1 CD-i its own platform.

svn-id: r45135
"
"71d4d12a82bb52cacb2728fb2f9d8837c1549436","2009-10-15 22:09:15+00:00","SCI/newgui: transition 100 (no transition at all) now also supported

svn-id: r45136
"
"dddce5d97b0c9b0cf723d16ead08d5a00ad7eca0","2009-10-15 23:57:13+00:00","Don't crash without sound support.

svn-id: r45137
"
"d560de52344b07fbbe088579566ba98f8847238b","2009-10-15 23:58:13+00:00","Fixed bug 2879795. Ensure cursor is visible after save/load dialog and debugger are closed.

svn-id: r45138
"
"1dfc808aadd82347020882d472b2c27a6dddff60","2009-10-16 00:08:18+00:00","Fixed bug 2879805. Typo in inventory code made the inventory impossible to cleanup on loadgame.

svn-id: r45140
"
"b2bf21f0da168d1a88f3b52b03825699074dc91c","2009-10-16 00:09:20+00:00","Fix memory leaks when reading thumbnails

svn-id: r45142
"
"01057a75f4b48bfc789a2d53a4afdeaaad6d3d93","2009-10-16 02:02:09+00:00","Fix bug #2879796 - Reversed Ventriloquists.

svn-id: r45143
"
"7e154726ff2bf8aa5361682ae2b4d24192e50b67","2009-10-16 03:49:27+00:00","Fixed bug 2879799. Freshly loaded data was erased when changing to the new location and the character stayed the same.

svn-id: r45145
"
"c0a4881f5a3efd14a202447d17227a7fcc62c336","2009-10-16 04:19:16+00:00","Start the correct music inside the Hot Sushi. This fixes the part of ticket 2879793 that is actually a bug.

svn-id: r45147
"
"1535ae7f6ee54dc3457794fd7e73c7410b4506a1","2009-10-16 04:25:28+00:00","Rollback additional file committed in r45147.

svn-id: r45148
"
"9934b70733f3322e1136d805f927fb0f628d1dfc","2009-10-16 07:37:12+00:00","removed MemoryReadStreamEndian, used regular memory stream classes.

svn-id: r45150
"
"422b732dbadde0b23aaec05b39edec9e1c81f91e","2009-10-16 07:42:23+00:00","Added a new convenience method to the video player, which adds the event of skipping videos with the escape key by default, thereby simplifying the video playing code in all places where it's used

svn-id: r45151
"
"788af1b81e92387db02bb666762f1820f19dfb06","2009-10-16 07:57:08+00:00","Fixed an assert in the introduction of the CD version of KQ6

svn-id: r45152
"
"600d5199fcc9728e70972d2b27d60a8b591b100c","2009-10-16 08:26:41+00:00","Moved the SEQ decoder outside the gfx directory, as it is completely stand alone now and no longer uses any GUI-related code

svn-id: r45153
"
"1c6e0e1cf96b502958a63624ed4a150806f454a2","2009-10-16 09:40:12+00:00","Update the WinCE panel image with the new style

svn-id: r45155
"
"af60e6761d5c581bd3ede7eac9c0dff8fd4095de","2009-10-16 09:44:00+00:00","SCI/newgui: SciGuiTransitions now supports vertical roll from/to center (e.g. qfg1ega)

svn-id: r45156
"
"0ea65c6d92c7e330e5392c231e198ec2f538bb25","2009-10-16 09:55:14+00:00","SCI/newgui: SciGuiTransitions now supports 'none' id used in longbow

svn-id: r45157
"
"08bf02ccf2ae4d81041d9cc1f9ae77b452bdb798","2009-10-16 10:46:09+00:00","SCI: Fixed debugger opcode names.

svn-id: r45158
"
"c213032da9483043cf994fe3921e8be35c146dfc","2009-10-16 11:22:06+00:00","SCI: insert comment about kq6 issue caused by new speed throttler. theoretically this could go away when reanimate/cel updates are implemented

svn-id: r45160
"
"b190fa358ae537f1b9b089158e9ef031c1c2fef3","2009-10-16 11:43:37+00:00","SEQ full frames which don't cover the whole screen width are handled correctly again. Fixes the videos in the GK1 demo

svn-id: r45161
"
"408411f3d1741a6b3c03353144af3ac244f7c3ef","2009-10-16 11:46:18+00:00","SCI/newgui: addToPic priority issue fixed (lsl5 dream sequences)

svn-id: r45162
"
"4a3f88ee1b0f1123f1b7b3d67360f68ce958a547","2009-10-16 11:49:56+00:00","SCI/newgui: changed comment

svn-id: r45164
"
"739b462753ab8d63ff5a001728a3195203f161ca","2009-10-16 12:45:53+00:00","PSP palette fix for bsword1: fixed cache coherency issue

svn-id: r45165
"
"2924dca0882f6f8ab0a21bf84d8af3a20573fb82","2009-10-16 16:03:32+00:00","SCI/newgui: SciGuiTransitions now supports diagonal rolls as well (includes bugfixes for other transitions)

svn-id: r45167
"
"ef0510596155d272d6541ffedf43a403f1da1d87","2009-10-16 16:13:57+00:00","SCI/newgui: SciGuiTransitions - removed debug delay

svn-id: r45168
"
"c957d75fd0e32f4a519d37e254c4a11378150064","2009-10-16 17:29:36+00:00","Fix for bug #2874489 - 'SCI: Larry 3 crashes at startup'

svn-id: r45169
"
"b43e99566ebad682d28e32fedae9606048284844","2009-10-16 18:05:56+00:00","Converting AVIPlayer into a class that inherits from VideoDecoder and adapt SCI to use this. Also, moving the codec and Codec class into their own folder. (Based on a patch by md5)

svn-id: r45170
"
"1d679723c3182994e7d4868b14a7f394a662f0c8","2009-10-16 18:16:23+00:00","Hide the mouse cursor when showing a video

svn-id: r45171
"
"620fa7c6414e98949537b9b759c65ea336fb64d0","2009-10-16 18:32:20+00:00","Override getAudioLag() in the AviDecoder (blatantly borrowed from the SmackerDecoder).

svn-id: r45172
"
"2ada85b6cc1331036cb0a24b7d085585ce30776d","2009-10-16 18:46:18+00:00","SCI: kAnimate now delays the first few calls less, otherwise sq3 will remove details graphicwise. Walter please check, if this creates a regression with lsl3.

svn-id: r45173
"
"f6716df853b70b3afa670d719da0f6bef947ea62","2009-10-16 19:35:55+00:00","SCI/newgui: defined unused signal flags

svn-id: r45174
"
"0479964ad7bc6f59d10638427f3f68406dd0e05c","2009-10-16 21:21:47+00:00","SCI/newgui: WindowManager change so that WinMgrPort will get 0 and picWind will get 1

svn-id: r45175
"
"e4c23834dd2972c75f6f698f9f55320c1784218f","2009-10-16 23:29:00+00:00","Moved sci_ffs() inside iterator.cpp, the only place where it's actually used, and removed tools.*. Also, removed all the unused includes to tools.h from several places

svn-id: r45176
"
"a6445d602d4109e45ee5fcd8c53ce114d710fc74","2009-10-16 23:31:31+00:00","Reverted an accidental change in the last commit

svn-id: r45177
"
"cc31846eb51cb42575f351f30c305d365fd3f812","2009-10-17 10:42:00+00:00","Added a new console command, 'play_video', which can play a SEQ or AVI file

svn-id: r45178
"
"4b3eb3388ef7c1dfff9d1cc29393abd466893ffe","2009-10-17 10:50:39+00:00","SCI/newgui: menuPort gets id 0xFFFF assigned, fixes kq5 mouse coordination

svn-id: r45179
"
"a7cdad157eb7ba83323b1a58413fa856942b0b26","2009-10-17 10:51:14+00:00","Update the Dreamcast icon

svn-id: r45180
"
"87247d1e4d93c4cd8c46b2234d963100fdf386f8","2009-10-17 11:35:49+00:00","Made find_unused_pixel() take the transparency mask into account, not
counting palette colours of masked pixels as used.  Fixes transparency
on the new default icon.

svn-id: r45183
"
"d14061fdd73fc703234788b40b7fb92338cbcb7e","2009-10-17 12:42:21+00:00","Started moving some of the old GUI code inside /gui32

svn-id: r45185
"
"4bc8d919d8d451f1072fa135bbed745df5aae3ef","2009-10-17 13:01:28+00:00","SCI/newgui: SciGuiTransitions now all transitions are supported, blackout flag support still missing

svn-id: r45186
"
"cada56749184ff3984d0772a3371db65c7431324","2009-10-17 14:12:42+00:00","SCI/newgui: SciGuiTransitions now supports blackout flag as well (used in e.g. sq1 intro)

svn-id: r45187
"
"c909bdd896462f03f4ca4d79a21c6d07854a4d0d","2009-10-17 14:28:25+00:00","SCI/newgui: Inserted comment about sq4 intro problem

svn-id: r45188
"
"b32cf088e2d648fd44d525f8cbca91903700050d","2009-10-17 14:45:05+00:00","SCI: kAnimate comment added about qfg3

svn-id: r45189
"
"0559d1e3ca0335a1a1be15805a1a41e3d252893f","2009-10-17 15:28:15+00:00","Include common/endian.h for SWAP_BYTES_32. Should fix compile on BE systems.

svn-id: r45190
"
"d87d41802cd118ad5aee42481001cef4f2af22ec","2009-10-17 15:37:16+00:00","Silence gcc warnings.

svn-id: r45191
"
"ebd3a726267b21a768aeff7e0045317fc8564007","2009-10-17 16:54:39+00:00","SCI/newgui: Transitions - include terminator into blackoutTransitionsIDs table

svn-id: r45192
"
"a19cfb48625321f5237d7225dbf45d91aac5167a","2009-10-17 16:56:33+00:00","SCI/newgui: SciGuiTransitions::doit will warn about missing blackout-transitions

svn-id: r45193
"
"387db36f4d7ab78d25dc4954fcad90a447c27f85","2009-10-17 17:35:41+00:00","SCI/newgui: set amiga palette immediately at game start and stop kPalette/animate to do anything on Amiga

svn-id: r45194
"
"42dffcdcb97744c1c60a23a1494b8e9bc5f58f10","2009-10-17 17:46:48+00:00","SCI/newgui: fix bug in kCanBeHere, fixes sq4 intro roger hanging not falling

svn-id: r45195
"
"a74fd218478656a376773f97f79f9c233f7cb4c3","2009-10-17 17:59:09+00:00","SCI: Fix delete/free mismatches

svn-id: r45196
"
"2e73b6472f1fc9b2fb34384ebb83ced118cc3b07","2009-10-17 18:03:31+00:00","SCI/newgui: SciGuiTransitions fixed fadeIn

svn-id: r45197
"
"ed964efe3d4662fa50490c4ff0d75e889fcab5df","2009-10-17 18:59:13+00:00","SCI: Fix delete/delete[] mismatch

svn-id: r45198
"
"b66d9895541926050b0107c45bc335c41d108810","2009-10-17 19:46:27+00:00","SCI/newgui: setup default transition, also dont setup transition if no transition-number was given by caller

svn-id: r45199
"
"a85b22e0924b615b9a29f7e8e13bbb971f5ce8fc","2009-10-17 20:06:46+00:00","TUCKER: fix several issues in ending sequences (tracker item #2872355 - Minor bugs outro)

svn-id: r45200
"
"d807d259b9b29b0603dbfd0ceeba48ec585a8753","2009-10-17 20:42:19+00:00","SCI/newgui: SciGuiAnimate::updateScreen() completed

svn-id: r45201
"
"0af29fa746c1f9e71aedcf867ff05efa85609798","2009-10-17 21:11:56+00:00","SCI/newgui: kDisplay restoreUnder completed

svn-id: r45202
"
"b1c35d548dbe1c36df554235cfe59758135cc8bc","2009-10-17 21:22:27+00:00","SCI: kStrAt added fixme comment

svn-id: r45203
"
"bc8cf7e98df452437dc0c4857ea18df4befbbfe6","2009-10-17 21:54:44+00:00","SCI: Add FIXME

svn-id: r45204
"
"3f3a166e66190820c4ae0f662e18cfcf22d12ab1","2009-10-17 21:56:40+00:00","Removed obsolete/resolved FIXME

svn-id: r45205
"
"7fed4643e2e96edba97729ae4647a070f8db016f","2009-10-17 22:00:33+00:00","Removed the obsolete and bitrotted testing code for the old SCI GUI

svn-id: r45206
"
"f62f3eea89afd5620e1ef411232d74c7999f4971","2009-10-17 22:47:21+00:00","Fix valgrind warning.

svn-id: r45207
"
"bcac203098a0d706724bcfba4789570220d10706","2009-10-17 22:47:42+00:00","Fix memory leak.

svn-id: r45208
"
"4b1f310f2ddf25a907bf45a36739c4ddeea7421c","2009-10-17 23:52:57+00:00","LOL: this (hopefully) fixes a minor glitch that might occur when using the freeze spell

svn-id: r45210
"
"6dc95abcfa87cf2aa86b054c8b020153ae3641af","2009-10-18 10:21:53+00:00","Limited the speed throttler in kAnimate to work on SCI0-SCI1. SCI1.1 games seem to work fine without it, and disabling it removes the very long delay at the Sierra logo in QFG3

svn-id: r45211
"
"c7e5c9f0edf9c59674152f71fc8143742e0964b7","2009-10-18 10:32:08+00:00","better actor positioning

svn-id: r45212
"
"6d5f1e4403217e143cc93d80ac96a40faf8bbae5","2009-10-18 10:39:10+00:00","Added a sanity check in kStrAt()

svn-id: r45213
"
"cdf6ea603f12dc5aec33f0155823cf94fa4ca1c4","2009-10-18 10:39:50+00:00","SCI/newgui: kDrawStatus now does BitsShow() a little earlier, so rect wont get messed up by oldPort (fixes status bar in qfg1ega, etc.)

svn-id: r45214
"
"a10929594d951ec31d8f4e4ec0e17178ca0d8a58","2009-10-18 10:40:36+00:00","Re-enabled the speed throttler for SCI1.1 games again, as disabling it makes CPU load spike up in some of them (e.g. LSL6). Added a workaround for the Sierra logo scene in QFG3, too

svn-id: r45215
"
"3a8a872a8f96232fd8cb23e6e7801ebe540fa02d","2009-10-18 10:46:42+00:00","fixed long standing bug with empty messages being processed

svn-id: r45216
"
"f5b7f85593e209c374a3870ab8ae86f7a1d737a2","2009-10-18 10:50:07+00:00","Removed unused references to operations.h

svn-id: r45217
"
"783198941e25459c113945a0e39dc4d6775eb79d","2009-10-18 11:44:17+00:00","SCI/newgui: Transitions workaround for lsl6 (till we find out what lsl6 sierra sci really does), fixes menu not drawn to screen

svn-id: r45218
"
"343bd3fb4d0eef928fe06c6cbc488e84d7a4185b","2009-10-18 12:13:58+00:00","added thumbnails for the save states. removed snprintf's.

svn-id: r45219
"
"0fd3a2f842bfee04b9423ee683445d98189369c6","2009-10-18 12:44:51+00:00","SCI/newgui: listbox now finally working correctly

svn-id: r45220
"
"8b993ce86381352e022641896fd28f3472f083bf","2009-10-18 12:47:54+00:00","LOL: this should fix a valgrind warning

svn-id: r45221
"
"dc1637b6fb57d6b3e0af7798f7caf062f07e6de5","2009-10-18 13:47:42+00:00","SCI/newgui: Window manager cleanup

svn-id: r45222
"
"b7b32cfe26144d26d65dfb00854bd363c38b3a7d","2009-10-18 14:35:36+00:00","SCI: AvoidPath: skip polygons without vertices

svn-id: r45223
"
"2ab93510d37d8420f546e18e80ad0125a87691f0","2009-10-18 15:38:49+00:00","SCI: cleanup text alignment

svn-id: r45224
"
"4b06d7be8bc8f83386c14b81ec17c4980c99f3fb","2009-10-18 16:44:14+00:00","Remove unused variable.

svn-id: r45225
"
"e392f939b6c8025c33c37b489d161286db250100","2009-10-18 16:59:33+00:00","gob - 'Windows' Gob3 has errors in scripts, calling .IMD videos instead of .VMD ones. This modification fixes that.

svn-id: r45226
"
"237b66becad31decb5230389ac91459f19db7545","2009-10-18 17:28:00+00:00","LOL: - added some updateInputs to spell animation code
- improved sfx volume code

svn-id: r45227
"
"b7c6ae3f742216146b75191dc61bb4e30513adc2","2009-10-18 17:28:02+00:00","gob - Cleanup of previous modification

svn-id: r45228
"
"c8853f0cc0bf9ce0423a8edbc79ba5bfd32d1a01","2009-10-18 18:47:53+00:00","Move the SeqDecoder to the Sci namespace, it makes more sense than Graphics because it's only used in Sci.

svn-id: r45230
"
"32810a30b575d7c11bd0f409d0c09549e53e5437","2009-10-18 19:07:22+00:00","Mark an old change made for SQ4 in updateMultiSong() in rev. #39347 as a workaround

svn-id: r45231
"
"64861f1e40ee5084bcbfa3e5bd3adbe746d7dfc5","2009-10-18 19:29:50+00:00","SCI/newgui: kDisplay fixme comment added for kq5 credits

svn-id: r45232
"
"2bbf708deaf2d60c70786ec1ef2f9ea0d1f0bd4a","2009-10-18 19:41:59+00:00","Introduced new type Common::DisposeAfterUse::Flag

svn-id: r45233
"
"f3ab3051d889fd03e9abaeb00a0735cd8a9a9d54","2009-10-18 19:42:56+00:00","SCI: Make the implicit segMan param to GET_SEL32(V) and PUT_SEL32(V) explicit

svn-id: r45234
"
"9e64255bd1d81e5432d02f5183f202f2c1eb75ab","2009-10-18 19:43:27+00:00","SCI: Rename game_obj to _gameObj

svn-id: r45235
"
"be4078823abf1057038f9a03d476e9e70f814692","2009-10-18 19:43:47+00:00","cleanup

svn-id: r45236
"
"cdcd465a9575746f14f2f2961a7e1ecca04dde10","2009-10-18 20:30:31+00:00","SCI: kDoSound doesnt reset nodePtr on fade anymore, fixes lsl5 endless music loop at patti exam scene

svn-id: r45237
"
"c6d20868151aec9223a5f03fa0e80ca506752eb3","2009-10-18 20:33:02+00:00","SCI: kDoSound typo fixed

svn-id: r45238
"
"2f9d24f932e2fc076f6da96a11c80091d186bff5","2009-10-18 20:34:37+00:00","SCI: kDrawCel priority is signed

svn-id: r45239
"
"22116b488e78a01e39c8baa5379e6956a8d2e507","2009-10-19 04:19:11+00:00","Fixed cppcheck warning.

svn-id: r45241
"
"a4704352e4854af6d9ad00ba75178a238f1e8033","2009-10-19 09:56:11+00:00","Changed mapPointer() to accept a Common::Rect, thus removing the reference to gfx_widgets.h

svn-id: r45242
"
"4ac5e3512501a8effee878bd072caf7875cf20b3","2009-10-19 13:26:13+00:00","SCI/newgui: kAnimate support for globalVar 84 in kq5 to fix cels drawn into talking boxes

svn-id: r45243
"
"c1e7191bc96c209141b80b0efb27409165c3f226","2009-10-19 14:33:48+00:00","Made the check for global var 84 more generic (checking for the fastCast object)

svn-id: r45244
"
"9e8473de8a00044563e90c606fcaa017a924c2f0","2009-10-19 14:40:48+00:00","SCI/newgui: kAnimate comment changed on fastCast

svn-id: r45245
"
"2824e302baa6f69a0b40c4679e8b5bde30f8202f","2009-10-19 16:06:32+00:00","Move LOL sub engine enabled check inside the KYRA check.

svn-id: r45246
"
"4d43c8a121d40a1e66640e0d137a7808dca4b0f1","2009-10-19 17:46:50+00:00","Added operator== and != to Common::Array

svn-id: r45247
"
"4d9d0411ea428ec787e2edb0a7ecd4094be60291","2009-10-19 17:47:25+00:00","BUILD: cleanup cross compilation code

svn-id: r45248
"
"86c8bb6bbfcc4422ebc6a1b2ba8b26485c1026d6","2009-10-19 18:06:33+00:00","SCI/newgui: SciGuiPicture - fix drawing of mirrored embedded cel-data in vectordata (fixes lsl5 scene)

svn-id: r45249
"
"bf4cf09eeca19a3bf614060d9e3b71d8e210b0c4","2009-10-19 19:38:42+00:00","SCI: kRandom behaviour fixed, fixes lsl5 patty random door code

svn-id: r45250
"
"7b8bc76453336eab50c7bcecc98e70481d86bc02","2009-10-19 19:58:10+00:00","SCI/newgui: old cursor uses now hardcoded white, fixes cursor color changing in lsl5

svn-id: r45251
"
"557f32cdb14eeddff558abd9da6b64430ee56de9","2009-10-19 21:27:39+00:00","LOL/PC-98: match vaelan's cube behaviour with original code

svn-id: r45252
"
"02837a322964956d4edf091bf7dcec07e026575e","2009-10-19 22:13:51+00:00","SCI: Cleanup the grammar/vocab code: Move defs from vocabulary.h to grammar.cpp where possible, turn comments into doxygen format etc.

svn-id: r45253
"
"ebff7dbb1a5d1846a91f8862c0f8e655553e37ad","2009-10-19 22:15:10+00:00","SCI: Oopify ParseRule/ParseRuleList stuff a bit more

svn-id: r45254
"
"03953bf2925240401677cbda428209fd4b49c54a","2009-10-19 22:51:37+00:00","AGI: Remove some global vars

svn-id: r45255
"
"c0f6657797d1d7bfeb64acf6cb3f2b1c0748e7ef","2009-10-19 22:52:01+00:00","AGI: cleanup

svn-id: r45256
"
"a88aa2f45f651f61b7c2ff851eff13cfe15a37c0","2009-10-20 10:08:28+00:00","- Fixed the pathfinding issue for LSL5 room 640, where Patti walks off-screen (we still need a proper way of detecting this, though...)
- Made warnings where invalid pointers are dereferenced more precise

svn-id: r45257
"
"a41292a92fae04863070e84744bc2620235b7887","2009-10-20 10:35:49+00:00","Move Draci's entry to make the plugins list sorted alphabetically

svn-id: r45258
"
"50435d6bae2a89180676dbdbc83986d952ffb717","2009-10-20 11:13:00+00:00","AGI: Turn g_tickTimer & g_mouse into members of class AgiEngine resp. AgiBase

svn-id: r45259
"
"3fe7363d40f9ec87aedf126497f85ae3b88d25cc","2009-10-20 11:13:22+00:00","AGI: cleanup GfxMgr::testButton

svn-id: r45260
"
"3a1495f2476d72ede060f63d3c6877b046b55980","2009-10-20 11:13:42+00:00","AGI: Make scancodeTable const

svn-id: r45261
"
"86b81c8eb6f95530379c402ab228cccb79a94535","2009-10-20 11:14:04+00:00","SCI: Fix warning about double being silently converted to int

svn-id: r45262
"
"255349b262b3ad0d000fe2e9c573263fa40a5faa","2009-10-20 11:14:22+00:00","SCI: Fix for _vocab_add_rule (term was not being inited)

svn-id: r45263
"
"53e08b32e8a082e6451dc8768bf6859b1531f167","2009-10-20 12:00:37+00:00","SCI/newgui: kDisplay fixed so text centering will work correctly (based on sierra sci disassembly) - fixes kq5 credits, lb2 intro selection

svn-id: r45264
"
"5ce23633e26a66f8a3ba4bfe88b4bb7f23622d6e","2009-10-20 12:21:43+00:00","AGI: Oopify LZW decoder

svn-id: r45265
"
"66fae7bc8a2557e876ed7fbcc2738adad175ad88","2009-10-20 12:22:30+00:00","AGI: Change g_useChorus to SoundMgr::_useChorus, and add FIXME comment about it always being true (so maybe it can be removed?)

svn-id: r45266
"
"95c572c8b90ba5cafa55ae9df5d91683f0d6d7b3","2009-10-20 12:23:21+00:00","AGI: Cleanup AgiEngine::agiSprintf

svn-id: r45267
"
"5b514a9bd1f29bf8558c31c2f12eb27d50568f33","2009-10-20 14:05:35+00:00","TINSEL: Start cleanup BMV code

svn-id: r45268
"
"00822d5661a81546c45c83b38c1c9a4e999dd89b","2009-10-20 14:06:17+00:00","TINSEL: Move BMV player code into a new BMVPlayer class

svn-id: r45269
"
"774183ddce4c7c85b172976ea33819643a5a0a5c","2009-10-20 14:06:40+00:00","TINSEL: Make lots of stuff in dialogs.cpp static

svn-id: r45270
"
"8870b5dbbfbe7763a3dedc70fda9733ab467ad11","2009-10-20 14:07:27+00:00","TINSEL: Fix apparent bug (?) in the support for the 5 flags version(s)

svn-id: r45271
"
"55dd109653c56c2847a06f9acb2fc3bf3834f730","2009-10-20 14:43:44+00:00","Changed kAvoidPath() to always avoid screen edges, after talking with waltervn. Also, formatted the comments of the dijkstra() function

svn-id: r45272
"
"361977e7ed074ab0a099360ef58a0bf5a8b5182a","2009-10-20 16:11:31+00:00","SCI/newgui: kPalette cleanup, preparing for sq5 paletteAnimate support

svn-id: r45273
"
"907134076d81294753ac32cbfda23f5a2d4d0d64","2009-10-20 16:18:29+00:00","SCI/newgui: kPalette/animate - accidentally changed speed to uint16 in prev. revision although its signed

svn-id: r45274
"
"a60836c5eee662ec54ea8c232385b21edf1a2fa5","2009-10-20 16:55:12+00:00","SCI: Fix _vocab_add_rule by re-adding the 'if' statement I accidentally removed in rev 45263

svn-id: r45275
"
"1fb02d2c4b33f8341c659429a07661cbff1a43dc","2009-10-20 18:34:12+00:00","LOL/PC-98: fixed glitch in text displayer

svn-id: r45276
"
"1e1172af499dd995651e3f8a80d8af291f0f177d","2009-10-20 18:45:46+00:00","SCI/newgui: Changed kPalette(animate) and implemented setFlags/unsetFlags

svn-id: r45277
"
"4f69e0a753fe22236e88c3cbebcf910d41f90a27","2009-10-20 19:10:51+00:00","SCI: Fix for _vocab_free_empty_rule_list

svn-id: r45278
"
"08fb97ee59db67c8d1a5e8281fd4c9c11ffd9bc9","2009-10-20 19:11:22+00:00","SWORD1: Resolve FIXME about weird static var 'k' in Router::smoothCheck

svn-id: r45279
"
"b935f0119ac1542f099c806a4af75494f0b99f5c","2009-10-20 19:11:46+00:00","SWORD1: Resolve FIXME about weird static var 'left' in Router::slidyWalkAnimator

svn-id: r45280
"
"774eefe6882f9c123535872d17434d7d6dd20dd5","2009-10-20 19:12:08+00:00","SWORD2: Resolve FIXME about static var 'left' in Router::slidyWalkAnimator

svn-id: r45281
"
"c5c12130f5b88e69f5ee7e6f0f1d58d65fbbbd27","2009-10-20 19:12:31+00:00","SWORD2: Resolve FIXME about weird static var 'k' in Router::smoothCheck

svn-id: r45282
"
"91ba886e012da48ec1e676ed4aa859fab87068a8","2009-10-20 19:12:54+00:00","TINSEL: Move Common::List instances mouseButtons & keypresses into TinselEngine.

Global C++ objects are not portable, as their constructors / destructors may
never be called.

svn-id: r45283
"
"6d9cb7ab14ef5fedc0393aa5f7442a6a5970b797","2009-10-20 19:51:32+00:00","SWORD2: Turned static vars in Logic::fnISpeak into member vars of class Logic

svn-id: r45284
"
"2df38ec61ee4264cef7cf3852d2a314eea4600c7","2009-10-20 19:51:57+00:00","LURE: Turn HotspotTickHandlers into a proper class; convert static vars in various of its methods to member vars

svn-id: r45285
"
"0b04cbbdf6a3e83db0e1a94663b4403a4d41f9c3","2009-10-20 19:52:18+00:00","cleanup

svn-id: r45286
"
"35071a25b4d3d8f1c5464a5b704586c813349747","2009-10-20 19:56:37+00:00","SCI: kPalVary basic

svn-id: r45287
"
"d7ce8440baf3a2b2d99fa9157102c4080836d9bd","2009-10-20 20:08:33+00:00","SCI/newgui: Listbox control now draws text up one pixel, so that it matches sierra sci

svn-id: r45288
"
"9e864ff95b81e49317dde30635b16b3ef477e6b1","2009-10-20 20:12:50+00:00","SCI/newgui: textedit control also changed to draw text like sierra sci

svn-id: r45289
"
"42af771de001b3006ff5885033ae17c22923b4d6","2009-10-20 20:15:13+00:00","Fixed regression introduced when adding support for looping background sounds.
A.k.a. 'I played through the whole game looking for regressions, and missed the
one at the intro cutscene?!'

svn-id: r45290
"
"f2c69509836ae82b1eb377ffd6b5a71d0dbc5389","2009-10-20 20:57:08+00:00","SCI: kPalVary - pause

svn-id: r45292
"
"257d086aa1855ddf80066eeb3034e898f731bc5c","2009-10-20 21:25:50+00:00","SCI/newgui: palVary logic as comments (work in progress)

svn-id: r45293
"
"433f7088fb94d2b3192534450650dbab29c5915b","2009-10-20 23:07:32+00:00","PS2: disable text console, command line support and DOSBox OPL

svn-id: r45294
"
"6114381b4c88800d2766692d671b6a71d0f673a9","2009-10-21 01:01:23+00:00","Fix a regression in agiSprintf.

svn-id: r45295
"
"91dcca89b1374823f147493985d6ae356eaeabcd","2009-10-21 01:23:05+00:00","Fix another regression that didn't append data in safeStrcat.

svn-id: r45296
"
"9785eca16b3d3ff901cba5a917b267ee50df2dcf","2009-10-21 08:28:39+00:00","Fixed the bug where ego would not walk properly after he's swapped in LSL5 (from Larry to Patti and vice versa)

svn-id: r45297
"
"8d8b4dc50a4ad235c3692a2d136e5e4c64d8f4d4","2009-10-21 08:41:57+00:00","Enabled music.

Several TODO's added.

svn-id: r45298
"
"e5d28892447e1e614032257f9070c90886e460ce","2009-10-21 08:45:24+00:00","Small formatting fixes

svn-id: r45299
"
"4b1b5346b3295ec636a1446f912b796c53258b90","2009-10-21 08:50:53+00:00","Updated the MSVC project files of the draci engine (added music.*)

svn-id: r45300
"
"0b965ac2d45de7ed37e69fe0eff0b58ad546297a","2009-10-21 08:54:03+00:00","Added bmv.h to the MSVC project files (added in rev 45268)

svn-id: r45301
"
"745be029b2ecf2c18c5462213aae699b37c0450a","2009-10-21 09:59:18+00:00","SCUMM: Get rid of 'static int sortArrayOffset' by tweaking ScummEngine_v90he::sortArray

svn-id: r45302
"
"1e8883dcccfd490ba8844bb46cc90d5437c6f3f1","2009-10-21 10:00:08+00:00","SCI: Fix warning, and reformat a multi-line comment

svn-id: r45303
"
"746258f882b74cea1c5d5a34ef6c67e0669cdf09","2009-10-21 12:59:10+00:00","Add patch from Tobias, for graphic support (backgrounds/objects) in PCE version of Loom, with minor changes.

svn-id: r45304
"
"bb0cee730ef14cd347fca6a9da2942e755bef693","2009-10-21 13:21:26+00:00","Add/remove comments.

svn-id: r45306
"
"1e4e76af0f231bc02871d36fae65810f6cf9a994","2009-10-21 14:13:08+00:00","Fixed self-intersecting pathfinding polygons in SQ1, room 66. This addresses the issue where Roger is able to walk anywhere on screen. However, there is still a separate issue in that room, which makes him stay stuck in one direction (like he's 'moonwalking') and it only occurs in the new GUI

svn-id: r45307
"
"c9e618b6a5b682f2bc1b62a1c6b09bad3e7391b0","2009-10-21 15:12:10+00:00","SCI/newgui: updating flags separately to fix issue in sq1 (almost at the end) where wilco will go michael jackson otherwise

svn-id: r45308
"
"95cefe311c29a5ea81ac17db25ecf142bd8352de","2009-10-21 15:23:05+00:00","SCI/newgui: kAnimate - now reads out signal again in .dispose loop, just in case. Currently there is no issue known.

svn-id: r45309
"
"b105d690e398b47063b332245a783190f2cc84de","2009-10-21 19:19:03+00:00","- Removed kShow() and the related code it uses - it's a debugging function, and we have the same functionality in the debug console
- Merged the view signal flags from kernel.h and gui_animate.h, and named them appropriately. Also, updated the notes next to them, cause some were incorrectly marked as not used in our engine
- Added a note about a hack used in the old GUI in the view signal flags
- Moved the control state flags inside gui_helpers.h

svn-id: r45310
"
"033910c6af95e38bb6d70a38588ee47455672505","2009-10-21 19:23:37+00:00","Removed the accidental inclusion of deprecated code for LSL5 - this has been superseded by commit 45297

svn-id: r45311
"
"4f58d913093925b655d9e999210999dff512c1c1","2009-10-21 20:10:23+00:00","Fixed animations in LSL1VGA again

svn-id: r45312
"
"8f8af8a19b13e6ed8d0e15709d3cd5a5e972bbe3","2009-10-21 20:25:05+00:00","Make the check for global variable 84 inside SciGuiAnimate::invoke() simpler and faster

svn-id: r45313
"
"fd9a062452e5299fad95c25ca187284d0614e7b9","2009-10-21 20:57:42+00:00","SCI/newgui: kAnimate - fastCast change (again)

svn-id: r45314
"
"e3d03ce22b3cce8994f28e4c12b1accb2394ad57","2009-10-21 21:07:21+00:00","SCI/newgui: kAnimate added comment about fastCast

svn-id: r45315
"
"e0f12f8c6b3fec7b845f06c8c6bc60d7e5001d2f","2009-10-21 22:39:36+00:00","Patch #2875721: vkeybd and keymapper enable by default for motomagx

svn-id: r45316
"
"48013f16f8c0cec8f501094c7c9b6f1b8433331f","2009-10-21 22:40:00+00:00","Patch #2871861: fix for mgx-packet in linuxmoto.mk

svn-id: r45317
"
"48e3d9a767741e612b24ecfbdb230d1a43c0793f","2009-10-22 01:07:49+00:00","Update detection of PCEngine version of Loom.

svn-id: r45319
"
"3f3353c520341ec0813b165be6ba1accf87d6f3d","2009-10-22 01:25:23+00:00","Update detection of Loom PCE Japanese.

svn-id: r45320
"
"1f4ad52c61e2dbaca95a99bfcf20f4c298fdd41c","2009-10-22 05:41:50+00:00","Moved the view loop counting code in the new GUI

svn-id: r45322
"
"89febd360f343a4ceb03b4c8ac11aa77f969d351","2009-10-22 05:42:14+00:00","Cleanup

svn-id: r45323
"
"958bc7ba8116a5de1fc92c036c9d2fb1688a3d79","2009-10-22 06:05:34+00:00","Avoid opening and closing BArchive files all the time

svn-id: r45325
"
"3903be61e750ddee32350dc52c75a9f4893da475","2009-10-22 06:21:39+00:00","Improved music handling:

- reading the volume from the configuration
- error handling of non-existent MIDI files
- pausing/resuming music

unfortunately, sometimes music stops playing or slows down, and my log
messages have so far not helped me to identify why

svn-id: r45326
"
"8f75ee9a37114115ed5f3093c305b5d4d599a5b5","2009-10-22 06:41:11+00:00","Fix uninitialized channel volumes.

This fixed stopped music after calling the configuration dialog.

svn-id: r45327
"
"f79d3bb7cd181326e8ddba5d7f5a43a3871dac65","2009-10-22 06:50:59+00:00","PSP: small fix for cache coherency affecting nippon and some others. Trunk only.

svn-id: r45328
"
"93517e7649da286cd5b86efb3ee2e5cf7e7be436","2009-10-22 07:18:37+00:00","Applied a modified version of patch #2881486 - 'Add volume changing to SCI'

svn-id: r45329
"
"819449d09907f97c09048268eb52e54b9d9b33c0","2009-10-22 07:34:43+00:00","Implemented GPL2 commands for music.

Debugged everything.

svn-id: r45330
"
"a1c23f4487b75d3646f8267d8925c1ae953a4a60","2009-10-22 08:46:34+00:00","Added the rest of the detection entries from bug report #2612718 and removed some extra whitespace

svn-id: r45331
"
"8f0e47e671046707bd03c71772a6bde5e3e9b7d9","2009-10-22 08:55:54+00:00","Fixed signed/unsigned issues with the property() function of the Adlib driver

svn-id: r45332
"
"ebd04d4479c56297e45581ae6bcbc66b47cd1c1c","2009-10-22 09:13:45+00:00","Fix verb display in PCE version of Loom.

svn-id: r45333
"
"512c9cae11d9f83f2fbf84e66a0b0b9799b4ca96","2009-10-22 09:36:46+00:00","Fixed a crash when selecting menu items

svn-id: r45334
"
"4350f7b8c05a4ba22927f273c89171d840387c4e","2009-10-22 11:33:05+00:00","Fix objects structure and object scripts in PCE version of Loom.

svn-id: r45335
"
"161f49ac481d380660b2aef4d8d92e72d63ea902","2009-10-22 12:04:56+00:00","Fix bug #2703992: OSX: make bundle fails

svn-id: r45336
"
"42068f58537c988173d4c1e018ea9a7819f13db4","2009-10-22 15:12:54+00:00","Cleanup

svn-id: r45337
"
"4095d92a5e6ff7a114d7e175fc66c693de4ef5cb","2009-10-22 21:04:45+00:00","SCI/newgui: make cursor left work in textedit control. some wip changes, because i need to backlevel

svn-id: r45340
"
"12cdcea516530fbcf2744f59f6eefe8f4f9452a8","2009-10-22 21:19:03+00:00","SCI: kAnimate disable throttler for SCI0 and SCI01 games cause of issues in at least kq1. temporary solution only!

svn-id: r45341
"
"8e6291f7bbaafeed0718264ae401dcf052559cab","2009-10-22 21:30:30+00:00","SCI: kGameIsRestarting - implemented speed throttler in here for sci0/sci01 games, test only!

svn-id: r45342
"
"770fbdcf538b3185d28752c37bb1f06e9bfb5e22","2009-10-23 07:51:08+00:00","Add opcode difference in PCE version of Loom.

svn-id: r45343
"
"9c9181eed6c650cedd359f56f36c3418eefb3e9e","2009-10-23 11:25:48+00:00","SCI: speed throttler moved to kGameIsRestarting for all games. Also made the delay shorter. sq3 now seems to work fine, kq1 also has animations and lsl5 mud wrestling is also working correctly.

svn-id: r45345
"
"8bb99f4571302fd8b0c7dc01e2a67500083bac74","2009-10-23 12:50:51+00:00","Fix object names in PCE version of Loom.

svn-id: r45346
"
"8fa9f9b0eef5c1d74d6ec674528176e76f12187f","2009-10-23 18:05:14+00:00","SCI/newgui: Priority band (old gfx) now gets correctly initialized, fixes kq4 intro logo

svn-id: r45347
"
"bed7206ee34d1c938227112393c8ef516c0c2fdf","2009-10-23 19:08:32+00:00","SCI/newgui: fixed EGA palette code in SciGuiPicture so that palettes 1+ get applied correctly (fixes qfg1 nighttime)

svn-id: r45348
"
"6248d3a21d99b1e0ab7a7cc81a8c28616d4475b9","2009-10-23 19:20:59+00:00","LOL: fixed minor regression

svn-id: r45349
"
"f0c429028705e5a7d9a434dd3357b18b416c0f96","2009-10-23 20:10:51+00:00","Reset the graphics input after reconstructing game scripts. This fixes savegame loading in KQ4

svn-id: r45350
"
"701caea8d7b5f462df106a093051f534b3f1699b","2009-10-23 20:41:59+00:00","SCI: kAddToPic - abort when list is null reference (fixes qfg1 saved game loading on some screens)

svn-id: r45351
"
"ee9273b3c0a975ff22b6b9fa306eb013e9646d31","2009-10-23 21:48:28+00:00","Gob - Fix animations without extension

svn-id: r45352
"
"553555445523ab8041883180d6879c8b3f488f5d","2009-10-23 22:00:51+00:00","Gob - Add a workaround for gob3 Sofa bug #2867294. It's now possible to exit the animation by clicking

svn-id: r45353
"
"a5c97673eb8ed705ad58634cef889cbdd808ed64","2009-10-24 03:52:38+00:00","The CD music was hard coded in PCE version of Loom.

svn-id: r45356
"
"cc19ed27a1ef411886ca22ca09e0b52c355e39b9","2009-10-24 09:51:28+00:00","Made the 'drafts' debugger command work with the PC-Engine version. The drafts
appear to be stored in the same variables as in the DOS CD version. Other than
that, I only have the DOS floppy version, so other versions still may or may
not work as intended.

svn-id: r45358
"
"ff78169680249e3a8f48b8198f08b2b8aadac496","2009-10-24 12:33:18+00:00","Correct error in CD music table for PCE version of Loom.

svn-id: r45359
"
"4a3ebce6991f96f743e00e9544c51f64f091c286","2009-10-24 13:26:12+00:00","SCI: Restore accumulator after executing send from debugger

svn-id: r45360
"
"b07e8d3c20d9569000bc4194652e3a0721c8af53","2009-10-24 18:52:57+00:00","LOL: fixed bug in spell casting code

svn-id: r45361
"
"8551e6cfe39530558ea1b9fd498fb7ec4285719b","2009-10-24 19:29:06+00:00","SCI/newgui: support for EGA mapping in SCI1 games, fixes qfg2 character selection

svn-id: r45362
"
"c45efbe9abbb649d6bf47522f96f1553a3835b40","2009-10-24 19:47:53+00:00","SCI/newgui: dont react on paletteSet when playing an EGA game (fixes Xmas card EGA)

svn-id: r45363
"
"56181a475cd754d5a9e7f3936341964e137bbd36","2009-10-24 21:55:53+00:00","Change '=' to ':=' in some module.mk files for consistency.

svn-id: r45364
"
"9b6f2be526f8fee3c2451d2f180f70ee4e976f4e","2009-10-25 00:13:08+00:00","Mark Jones CD with the CD flag and add CD in the extras field.

svn-id: r45365
"
"452ae8a5769142a934676b7fdc721910e12aaf5e","2009-10-25 02:36:51+00:00","Cleanup

svn-id: r45366
"
"55e0efeb8f1f15aa2da37bedd2bb649645fb261f","2009-10-25 03:26:20+00:00","Add support for CD Audio in Jones in the Fast Lane CD and KQ6 CD.

svn-id: r45367
"
"410c29875700abe1104ea8634f207e2e57de7a71","2009-10-25 08:10:57+00:00","Cleanup

svn-id: r45368
"
"6e5dd8e357ac5f8c08e9713b59d1858086073a36","2009-10-25 08:46:56+00:00","SCI/newgui: circle bitmap table fixed, fixes qfg1 character selection graphic

svn-id: r45369
"
"4064d35d1582e6d18b92c5ec352bde902b41e0d8","2009-10-25 14:20:47+00:00","Add patch from Tobias, for initial costume support in PCE version of Loom, with minor changes.

svn-id: r45370
"
"f6d8c1c40d0ceb75cd4c51d92dfc1f7590a66cab","2009-10-25 17:37:44+00:00","SCI/newgui: removed list parameter from addToPicDrawCels()

svn-id: r45371
"
"f0fc4810fdb094d99d16fb349be752d47aec8c40","2009-10-25 18:43:23+00:00","SCI: kAddToPic - removing support for argc==0 case, if this really gets used somewhere, we need to set _picNotValid in that case

svn-id: r45372
"
"ce9dcd7aa844c09167558a1fac5a1aadb16b52a9","2009-10-25 19:04:36+00:00","SCI/newgui: kAddToPic - behaviour is different between SCI1EARLY and SCI1MIDDLE (fixes graphic glitch in qfg2 intro)

svn-id: r45373
"
"5a465c86c2c8ed5fe3fb1b7713201ffeccb3703f","2009-10-25 19:49:09+00:00","SCI/newgui: SciGuiView disable undithering when EGA mappings are available (support needs to get implemented for this case), also fixes a part of the undithering code

svn-id: r45374
"
"c0235a268d2717fbcf5c19c25f1cd6bec9f6715f","2009-10-25 20:03:10+00:00","SCI: kGameIsRestarting - changing speed throttler to 10 msecs, lsl5 is still 'somewhat' playable, codename iceman and qfg2 didnt show some animations cause of the higher delay

svn-id: r45375
"
"fa627f4233e56f3ecf8d66d52cb598070a84f9ac","2009-10-25 20:12:12+00:00","SCI: kGameIsRestarting - another change, setting back delay back to 30msecs, but no delay during initial 50 calls. This seems to make qfg2 and iceman happy.

svn-id: r45376
"
"0315264328af6b34a4c9e1028bba07a636da5df8","2009-10-25 20:46:14+00:00","SCI/newgui: SciGuiView is now able to detect 'straight' EGA mappings and will then ignore the mapping. This will result in undithering working for those views. All EGA-mapping views in qfg2 seem to be special fx related so they dont need undithering at all

svn-id: r45377
"
"1a4b61739832a1f1d597b9c56e67dd8b80b32f76","2009-10-25 20:53:07+00:00","- Removed graphics options code from the old GUI. Almost all of them are not supposed to be modified by the user (e.g. the way lines and brushes are drawn), and we can implement any of them again if needed in the new GUI (but they shouldn't really be needed).
- Added a config option to disable dithering in the new GUI if requested, called 'undither', which is set to true by default and can be changed to false if needed per game
- The per-resource palette code has been removed for now, to be replaced by regular hashmaps (once the FreeSCI scifx reading code has been converted)

svn-id: r45378
"
"b5feeb60b64a62434ace4f316b51aa7849b2702e","2009-10-25 22:33:08+00:00","Moved the cel count calculation to the new graphics code

svn-id: r45379
"
"6672468b2346ed5146e17d576cbbc5b2f23f8f92","2009-10-25 22:47:43+00:00","Initial check in of a tool which is able to create MSVC project files out of the configure / Makefile based build system.

svn-id: r45380
"
"290f7b3937d684d24b5bdd303698ea040c03de16","2009-10-25 23:03:12+00:00","Use slashes instead of backslashes in internal path representation.

svn-id: r45381
"
"7e98cf5ca9d6c41c4c97a83cebdfd9840d55f06d","2009-10-25 23:12:46+00:00","Remove unused variables.

svn-id: r45382
"
"3d8492cd300231f159829c25cefc56789821fbc2","2009-10-25 23:14:15+00:00","Allow overwriting the file prefix in the relative path arguments of MSVC project files.

svn-id: r45383
"
"811764e8cc5450c950cc531ad207a27fe2c65f93","2009-10-25 23:17:58+00:00","Add warning when no engine definitions are found (or the configure file is missing).

svn-id: r45384
"
"6b404cf5cf44cfbd42bdaf80ec1630863602b0af","2009-10-25 23:29:48+00:00","Allow overwriting of the output path.

svn-id: r45385
"
"cac32b61ceb271631efe297b39e1d2b93af726e3","2009-10-25 23:36:09+00:00","Typos.

svn-id: r45386
"
"6b61700a7bf9ac66acc01b69f19703196b497320","2009-10-26 02:45:26+00:00","Add patch from Tobias, for masking support in PCE version of Loom, with minor changes.

svn-id: r45387
"
"74da9e5e3bd842b6b5f44a01aff6fd26dee510ec","2009-10-26 04:59:52+00:00","Fix Escape in the intro, and switching map and the inventory

svn-id: r45389
"
"463ccc896af1e024784abe65f872e64226fe50ed","2009-10-26 05:19:43+00:00","Removed unused variable.

svn-id: r45390
"
"994408a770a50cf698eb98e67b7b54d41b9b6a88","2009-10-26 06:20:13+00:00","Fixed some cppcheck warnings.

svn-id: r45391
"
"7bec12bbec0190890425d173e48339c9de3813a5","2009-10-26 09:03:54+00:00","Fix 2 MIDI bugs

svn-id: r45392
"
"ea91714b173a625e9b68f92168eb45953931d19f","2009-10-26 09:11:18+00:00","Switch PCE version of Loom to 16bit color, since it used 9bit color.

svn-id: r45393
"
"485ee55308a5461653aace831bb1b8a33869d8e9","2009-10-26 09:13:58+00:00","Ooops, that part should not have been commited.

svn-id: r45394
"
"e35b6a6e8051ce8efa35df48a36312d4f498accd","2009-10-26 09:47:55+00:00","Cleanup

svn-id: r45395
"
"88c7ca6f8fb20b04a31c85fe921404f1981e1ca4","2009-10-26 10:15:05+00:00","Add patch from Tobias, for object masking support in PCE version of Loom.

svn-id: r45396
"
"a4c27cfe98d1f975a8c0d0bbe6cc1fccdcc242bc","2009-10-26 10:39:51+00:00","TINSEL: Some cleanup to the BMV code

svn-id: r45397
"
"240f230c1ea087d53b3b8fbf1fd607b4324e7954","2009-10-26 10:40:16+00:00","TINSEL: Cleanup

svn-id: r45398
"
"d19a831d290190ca37a42018c5590f28b4fae746","2009-10-26 10:40:35+00:00","TINSEL: Move ExtractActor from scn.* to play.*

svn-id: r45399
"
"9065dca09aeb046d2e4b76a3edf82b9b8360a7e4","2009-10-26 10:40:51+00:00","TINSEL: cleanup

svn-id: r45400
"
"bbe0b81aff36cc188d598ba3d66cc2521e14c0f2","2009-10-26 10:41:11+00:00","TINSEL: Remove DWM_FIXED and add new MemoryAllocFixed() function

svn-id: r45401
"
"e963dfbd172dd461bf246a09552eca5c07cb52b1","2009-10-26 10:41:28+00:00","TINSEL: Remove dead stuff from memory managment code, doxygenify some comments

svn-id: r45402
"
"bf20d530a310c19d01be7e92143fd081819777f7","2009-10-26 12:29:57+00:00","Add patch from Tobias, for costume palettes in PCE version of Loom, with minor changes.

svn-id: r45403
"
"c669b8472ce8ee5dde6bb712c2df0a4cd0bf2202","2009-10-26 12:35:15+00:00","Fix cursor image in PCE version of Loom.

svn-id: r45404
"
"bd781fad910636044d5b959d4b8afd941abedb39","2009-10-26 12:44:26+00:00","Increase the _palette size for PCE version of Loom.

svn-id: r45405
"
"dec5406e416418952a898b57439e707523341a26","2009-10-26 13:22:05+00:00","Fix charset display in PCE version of Loom.

svn-id: r45406
"
"b0b1ab70c3a5f71d2c62dcc178611ef51cb0428b","2009-10-26 14:49:01+00:00","Fix charset color in PCE version of Loom.

svn-id: r45407
"
"b9534216edd6d95ec94ac342c8a612e7a59f9289","2009-10-26 16:01:12+00:00","TINSEL: Remove MemoryHandle(), some unneeded #includes and the return value of MemoryReAlloc()

svn-id: r45408
"
"6591010f66a05538ddc29b3404d64a27dfc29b3f","2009-10-26 16:01:34+00:00","TINSEL: Further untangle memory managment.

* Add new function MemoryNoAlloc
* Make MemoryAlloc private
* Get rid of params to various memory related functions

svn-id: r45409
"
"49d4e3c46719e08c26d025e3adad3a39c6a8ba71","2009-10-26 18:09:21+00:00","Removed some duplicate code

svn-id: r45410
"
"c7476aa16ffe54020f5fea7ad74e76f2e67584cf","2009-10-26 19:06:36+00:00","Groovie: Fix some styling issues pointed by cppcheck

svn-id: r45411
"
"efd41ffc46d993a266920aa204fbb87789c73b92","2009-10-26 19:33:07+00:00","SCI/newgui: SciGuiText created

svn-id: r45412
"
"939d8d1a373a9c4dc0feb780f57894296acf4148","2009-10-26 20:03:07+00:00","Silence GCC warning.

svn-id: r45413
"
"a30b8f0bdc54ac2336535165356840365b02d4d4","2009-10-26 20:07:37+00:00","- Fix some missing initialization warnings from cppcheck
- Fix two invalid memory accesses reported by cppcheck

svn-id: r45414
"
"692a4b74dc69f9b8be99456cb02a4421df7c5d6a","2009-10-26 20:08:33+00:00","Change assert parameter to match the comment above it.

svn-id: r45415
"
"e1de772e721a7dc0d62223c17617f72af3d2308f","2009-10-26 20:35:06+00:00","TINSEL: Fix handling of free memory blocks

svn-id: r45416
"
"d2e64a350ae9aa6955b2dd7a3715958cdb5477f5","2009-10-26 20:36:44+00:00","TINSEL: cleanup

svn-id: r45417
"
"6c1c9eda3a18ed7a545a9fc6725cfa3891ae2ac5","2009-10-26 20:38:34+00:00","TINSEL: Make MEM_NODE internal to heapmem.cpp

svn-id: r45418
"
"5672f353dd795aac9bec4f4b65b342d402fcad1f","2009-10-26 21:08:15+00:00","TINSEL: Fix warning again

svn-id: r45419
"
"7e0f8a9af9b78c43f73879118cbfe6f20731a71f","2009-10-26 21:41:41+00:00","Added proper detection and handling of transitive SCI1-SCI1.1 games, like PQ1 VGA. These used SCI1 resources and compression with a SCI1.1 kernel (thanks to waltervn's observations)

svn-id: r45420
"
"23173ae2c7dfc4d0a86092c7c118f6852aedea4c","2009-10-26 21:52:11+00:00","Cleanup.

svn-id: r45421
"
"46cb0be173ead8fbbc5394dd1cf3056d8902cff3","2009-10-26 22:04:03+00:00","fix free/delete

svn-id: r45422
"
"9008406e80172d2a77524929bdc194f45fc57437","2009-10-26 22:15:19+00:00","SCI/newgui: fixes text in jones

svn-id: r45423
"
"4b1a8c4d5f8506a78e7af0df4c1c3e9ca6074bbe","2009-10-26 22:32:55+00:00","- Add support for AMD64 (x64) builds in automatically generated MSVC project files.
- Fixed some file prefix bug, introduced when allowing to overwrite the file prefix via command line.

svn-id: r45424
"
"76942d6c86d11fb1a3a5fead501b544920763760","2009-10-26 22:43:58+00:00","Cleanup.

svn-id: r45425
"
"05508d8dcd9589b6c083a2849630af8fd3bf8f53","2009-10-27 00:36:56+00:00","TINSEL: Change MemoryAllocFixed to return a (kind of fake) MEM_NODE pointer; add MemoryDeinit()

svn-id: r45426
"
"e07a9b052464748657183a83c718d05b8f7afd40","2009-10-27 00:37:23+00:00","TINSEL: Changed heap manager to use malloc internally

svn-id: r45427
"
"79734dbc15b67e5fabca0231207bbde83727201f","2009-10-27 00:37:54+00:00","TINSEL: Make HeapCompact local to heapmem.cpp; add code to print heap statistics

svn-id: r45428
"
"02636c20714156327524b6a85b36dae64f6eeb06","2009-10-27 00:38:19+00:00","TINSEL: Rename Poly pp to ptp in various places, for consistency; cleanup

svn-id: r45429
"
"4b681f7ec7e42ea17ed97c80372cf564a8648682","2009-10-27 00:38:41+00:00","TINSEL: Add some debugging code; fix LockMem() regression

svn-id: r45430
"
"b132c65ff3b6e374c94bb57187284740d75a5fb8","2009-10-27 02:23:45+00:00","Make Jones in the Fast Lane use up the whole screen as did the original game.

svn-id: r45431
"
"e49065c8214e409226ce9ab9e72f09fa3fb6ee02","2009-10-27 09:17:09+00:00","Add support for distaff images in PCE version of Loom.

svn-id: r45433
"
"a6195bc1752c4e44fcdd4cdfb25e640608afd785","2009-10-27 09:24:00+00:00","Reset _distaff after drawing distaff image in PCE version of Loom.

svn-id: r45434
"
"64515d892c709867ca4984a5c02e48c9645b5684","2009-10-27 09:29:47+00:00","Fix restoring distaff, after reloading saved game in PCE version of Loom.

svn-id: r45435
"
"3d80bb47a859e2508b77f1795941eefd248b4e90","2009-10-27 09:44:13+00:00","Load/save the 16BitPalette data in PCE version of Loom.

svn-id: r45436
"
"26948eca76ff1abc020bbd6a2b98eb1c5c456ff5","2009-10-27 11:32:33+00:00","Add patch #2846425 - MM C64: walkbox fixed, with minor changes.

svn-id: r45437
"
"ba979cbd565f152b7a1d657f23cce5417d8b2205","2009-10-27 12:08:19+00:00","Add patch #2856940 - MM C64: corner walkboxes fixed.

svn-id: r45438
"
"d9f4e446e90bdda254b6ea18eb0055c1436dbe9c","2009-10-27 12:30:42+00:00","Update detection of Loom PCE Japanese.

svn-id: r45439
"
"a59d39a8c0c67874346b63c315d05a31437ccea0","2009-10-27 12:35:07+00:00","Oops, forgot to commit the txt file too.

svn-id: r45440
"
"1ece76618652ebbccc4c6044408409319efa7ee0","2009-10-27 18:35:20+00:00","Add missing include.

svn-id: r45441
"
"a52c45e7505ac7b52d634fece3d9e35d1afe0b23","2009-10-27 18:36:06+00:00","Got rid of use of exceptions.

svn-id: r45442
"
"60920305998841d41cdbf30c5421bc6a6ca64c42","2009-10-27 18:36:42+00:00","Add another assert to check for return value of 'new'.

svn-id: r45443
"
"36aae577d1b3437f9e305896769bd23938eca5ef","2009-10-27 18:37:09+00:00","Fix whitespace usage.

svn-id: r45444
"
"ec1141f7dfbdd06155d593c13ca9d6814bceced3","2009-10-27 18:37:42+00:00","Implemented a working createUUID for *NIX systems (and some minor cleanup).

svn-id: r45445
"
"2df5d5188302c0ae9374f6054149ec567abd4437","2009-10-27 19:06:42+00:00","Implement support for 'scanFiles' for POSIX systems, now the tool should work fine for *NIX too.

svn-id: r45446
"
"6b2d85945cbea6c5f5b366ba460003a9e82e41ef","2009-10-27 19:11:23+00:00","Include support for 'create_msvc' in the Makefile based build system.

svn-id: r45447
"
"13894c389d0510cc699b1f18c20d2a34d5fc3e0f","2009-10-27 19:21:47+00:00","Fix building under MSVC.

svn-id: r45448
"
"502c48167068ee08e5187ec20708e03bf9dc8ba2","2009-10-27 19:24:49+00:00","Only use std::srand once. (Fixes bug that createUUID always creates identical UUIDs, when run only with a short span of time in between).

svn-id: r45449
"
"7d6e96fa80373d5eceae6cb3a776c24d4adcb8cd","2009-10-27 21:34:43+00:00","TINSEL: Formatting cleanup, remove a dead var, tweaked comment to Get/SetNoBlocking

svn-id: r45450
"
"ed87e5cd318c9d869934daaf0cb6d67270d54c75","2009-10-27 23:51:32+00:00","Don't change mouse cursors so ridiculously often.

svn-id: r45451
"
"bbb72eee553ce9ad89ca1a9dfc0a934862c53250","2009-10-28 00:04:59+00:00","Fix entering the same room when re-loading the game.

(Most objects were not loaded due to incorrect cleaning of a flag).  Also,
clean up accessing some boolean attributes.

svn-id: r45452
"
"e75637ec1f77384bd8df9c2887b0b0f7661f6d11","2009-10-28 00:20:45+00:00","Fix initialization of the mouse cursor.

svn-id: r45453
"
"4f5a99655caeef5479e42d0472ee3076ae14d59a","2009-10-28 04:57:54+00:00","Fix charset masking for 16bit color games.

svn-id: r45454
"
"c781f013210faa35bff381ca2b537e2f40750bf5","2009-10-28 07:34:17+00:00","Implement palette fading

svn-id: r45455
"
"c6f96d6ac39cfe24d38d30a4b6cc7a0c707f181a","2009-10-28 12:58:13+00:00","SCI/newgui: SciGuiControls created, SciGuiText now active

svn-id: r45457
"
"f28fe1b07423941c245e06376761054507d188c1","2009-10-28 13:00:32+00:00","SCI/newgui: Added comment about jones hack

svn-id: r45458
"
"04ab6bc9fc831702a26c229027dada1436509b83","2009-10-28 13:20:30+00:00","Enclose all of the old graphics code within the INCLUDE_OLDGFX safeguard (defined in sci.h)

svn-id: r45459
"
"e8cff408b4c2798c9a27004c203ae10a16759f18","2009-10-28 13:34:20+00:00","SCI/newgui: Jones windowMgr Port adjustment, added explanatory comment

svn-id: r45460
"
"0b83a8eec03fac3fe3a7ea656be6ea8752477554","2009-10-28 13:43:09+00:00","Reimplemented isItSkip() using new graphics code

svn-id: r45461
"
"effb6b60eb179c6b7b78ba30e20fd819a3b5bba9","2009-10-28 13:43:57+00:00","BUILD: Reduce build overhead by marking *.d and *.mk files as .PHONY, thus preventing Make from futile searches for rule to rebuild those files

svn-id: r45462
"
"394fc76719a05c1bb8e06145fa6bd036abfe4d3d","2009-10-28 14:23:23+00:00","Rewrote kBaseSetter() to use new graphics functions and behave like the original, and fixed a bug in the process (the previous code ignored z when calculating the height)

svn-id: r45463
"
"6ac2680e8285d66bb6431855af3bc062652ad344","2009-10-28 14:25:39+00:00","Oops, removed leftover code (z was taken into account after all, but in a different place...)

svn-id: r45464
"
"0851b00d4fd215bc2fef69e845cc6a9484b5838e","2009-10-28 14:35:47+00:00","Cleanup

svn-id: r45465
"
"fbbd0b1575fe8344cacc8ab5abb8aeaa8792a17f","2009-10-28 14:45:26+00:00","Fixed the rectangle top inside kBaseSetter()

svn-id: r45466
"
"6550e66a57003fef1abeb07c9f775a77a15445fd","2009-10-28 14:52:53+00:00","Removing trailing spaces

svn-id: r45467
"
"0aea18dd74b6f84bc3bc9123e9ee38ab13ef42ab","2009-10-28 14:53:35+00:00","Style fixes

svn-id: r45468
"
"449b3cfd6d1bb9e13dc2b6a293f5d0de93aadcc7","2009-10-28 14:56:32+00:00","Adding another Windows Lost in Time version, German/French

svn-id: r45469
"
"31006320a6882c51ebe96ee0fd1b83a9fa2c9cdb","2009-10-28 14:57:13+00:00","Fixing 'graphical glitch in Bizoo level' (bug #2867361)

svn-id: r45470
"
"e4df5071178b48e5ddd100f31193da6db16646b6","2009-10-28 15:07:24+00:00","SCI/newgui: floodfill fixed (hopefully), fixes kq5 priority issues

svn-id: r45473
"
"c3d75ced87cf7eaa1a46712348eea578dd5de73f","2009-10-28 15:15:18+00:00","SCI/newgui: another floodfill change, fixes sq3 this time (this is madness)

svn-id: r45474
"
"021edb1ef43d19d056595a305bcb42b4b1a99a6c","2009-10-28 15:18:22+00:00","SCI/newgui: update whole screen when show_map console-command is used

svn-id: r45475
"
"3986434c2c96e712303755ed414de1872f4f6d5f","2009-10-28 18:19:41+00:00","Add multilanguage EN+FR versions of gob2 and gob3 found on english Adi 4.10 English+Maths Year 8

svn-id: r45476
"
"5abe6c8054c1ad78e2052b5a172e0f75e7d7a09f","2009-10-28 18:59:11+00:00","SCI/newgui: Cleanup

svn-id: r45478
"
"88e56f87eb351f2a2ed7df6ada8f7d81e99f02ec","2009-10-28 19:10:39+00:00","SCI/newgui: IsItSkip moved into SciGui

svn-id: r45479
"
"5f71650520b81ec5f83191a8726ddfe577e72184","2009-10-28 19:19:35+00:00","SCI/newgui: BaseSetter moved to SciGui

svn-id: r45480
"
"142d2e73c02851783d5fc1c4836477d93612e595","2009-10-28 19:28:43+00:00","SCI/newgui: fill screen with white instead of black before picture drawing, fixes some pixels of some screens

svn-id: r45481
"
"3263191c264b798ac1d91fd7ec41895862eb72b6","2009-10-28 20:24:55+00:00","Fix bug createUUID, which caused our custom createUUID implementation to fail to convert some UUIDs to a string correctly.

svn-id: r45482
"
"d220c2dc5b4bf9ac749bf9ec5df73b2400191a74","2009-10-28 20:37:16+00:00","Change help text to nicely fit 80xY terminals.

svn-id: r45483
"
"5b537c35618ce92a133417f5ca4cfd08e6436987","2009-10-28 20:39:58+00:00","Cleanup.

svn-id: r45484
"
"168275be5f4ced629ae940592963868d4059e3c8","2009-10-28 20:56:05+00:00","Fix possible use of double backslash in relative file path value.

svn-id: r45485
"
"921269fe142a541e9bc3abdd777cb3cd5d2a94c1","2009-10-28 21:01:05+00:00","Replace our custom MSVC project files by automatically generated ones. Note that this is for active *testing*, I myself had not encountered any problems building a x86 and x64 binary with he msvc9 files. So if you are using MSVC, it would be nice to hear back some feedback whether it works for you or not.

svn-id: r45486
"
"5d037f64ef459b1c1b4b911732281f740ddf428a","2009-10-28 21:46:27+00:00","Added detection for pq1, cnick-lslcasino and cnick-longbow to the fallback detector. Simplified the code which distinguishes between demo and full versions. Some cleanup

svn-id: r45488
"
"d62342b32bf7903ef48d81dd7bd66f2b4d77b541","2009-10-28 21:49:16+00:00","Wording. Added warnings for unimplemented menu-related functions in the new GUI code

svn-id: r45489
"
"21323a8d12624c33236f6397be559a238b36d845","2009-10-28 22:01:42+00:00","Wrapped some more oldgui-specific code around INCLUDE_OLDGFX safeguards

svn-id: r45492
"
"2d9d9bca13244b398c08fe2980e130cb205b57f6","2009-10-28 23:04:56+00:00","Changed some of the menu code to use new graphics functions

svn-id: r45493
"
"8150fc07bc8b997a0d61332a5d9ebc31e4acdb5d","2009-10-28 23:32:28+00:00","Added a workaround for the casino door in LSL1

svn-id: r45494
"
"0a1a4c7eb4b57728e483063f17658bc9e40b83f0","2009-10-29 00:14:09+00:00","Fix regression in r45414.

svn-id: r45495
"
"fa3305ee0162643c3e5694c8185365584aec180d","2009-10-29 01:10:10+00:00","Moved some menu code outside the INCLUDE_OLDGFX safeguards

svn-id: r45496
"
"25b3e687a7e4aa9fcd643aed24f9ac15cb88ec48","2009-10-29 01:55:06+00:00","Fix several palette fading bugs.

svn-id: r45497
"
"e5e80dd6d692b0b352913198a1bb5aa91da4402e","2009-10-29 09:58:36+00:00","Fixed the deletion of save games - the wrong save game would be deleted with the previous code, as we sort the list by date

svn-id: r45499
"
"8178d548eb2e822cfc7a9c21fa7c569f5b695398","2009-10-29 14:16:20+00:00","SCI/newgui: Defining color white and others in SciGuiScreen and using that. Also clears screen with 0 on sci1.1 games (needs further investigation), fixes pictures

svn-id: r45500
"
"403668898fcf59012aa405c36fad8d18dfbf205b","2009-10-29 15:26:48+00:00","Implement flipping the QuickHero and SpeedText flags in GPL2.

All GPL2 callbacks are now fully implemented.  It remains to implement
proper walking.

svn-id: r45501
"
"caa5136b5cc1ba9471fd86d90c13e6c5bf8acde1","2009-10-29 16:05:24+00:00","Automatically create memory.drv (the file containing the LSL5 password) for non-English versions of LSL5, so that the games don't abort if it can't be found.

svn-id: r45502
"
"6eea032245a6b3d34b5e830e2d98ed20be5dcc90","2009-10-29 16:27:23+00:00","Disable the 'Delete' button for all versions of SQ4 floppy, and the 'Change Directory' button for all games (English and non-English versions)

svn-id: r45503
"
"ebfcea35ec5167b1ac1d2cd92c1901aca2004f18","2009-10-29 18:07:39+00:00","- Implemented savegame deletion for SQ4 floppy
- Added a more proper way to disable the 'Change Directory' button, by checking its name, rather than the string it contains

svn-id: r45504
"
"cbf2b03c221a8e1206a266af6ade1dcbd325a69e","2009-10-29 18:15:12+00:00","Silenced GCC warning.

svn-id: r45505
"
"89811d1ea45d51732daa7490fe678eca2c1d651d","2009-10-29 19:32:27+00:00","Cleanup

svn-id: r45506
"
"c8546fd92ff3626d398e3e56a96323dd95db1e2a","2009-10-29 20:31:35+00:00","Stop SQ4 floppy from updating the unused sq4sg.dir file when deleting a saved game

svn-id: r45507
"
"fc1c05586f898d32ff754976ba5a0c63107958d5","2009-10-29 20:32:55+00:00","SCI/newgui: SciGuiPicture now acts like sierra sci when drawing cels, so we dont need some hardcoded variable and differ when clearing screen

svn-id: r45508
"
"1526fda715118d75b37dafbf1da58770289cbcae","2009-10-29 21:07:24+00:00","Poll for events while performing screen transitions, so that ScummVM remains responsive

svn-id: r45509
"
"a20e42efb9272e74e8bd36b74c485a0d5ca88ee2","2009-10-30 00:52:05+00:00","Move WalkingMap into new module.

Also, fix a bug when loading the default walking map (wasn't implemented)
and setting font size.  The reason I move this code into a new module is
because I will augment it with other walking-related algorithms soon.

svn-id: r45510
"
"c778efaca5b9d20f73e9d12cc8404d8948f8e522","2009-10-30 01:41:57+00:00","Remove most of default parameter values.

Also, add comments to the last commit.

svn-id: r45511
"
"d662c4aa20342e74ed5d82a14e3fc8e62a45ca8c","2009-10-30 01:56:52+00:00","Remove the last 2 default parameter values.

They usually just add unnecessary confusion and this is definitely such
an example.  Removal will clarify the code.

svn-id: r45512
"
"55da0503f4b0bf82acec34a2e9acb8282301ded3","2009-10-30 02:12:55+00:00","Add special thanks for DW.

svn-id: r45513
"
"ebe5db4be28ad71b0b41c67697cfe8fef68e0405","2009-10-30 02:13:51+00:00","Fix typo

svn-id: r45514
"
"f3700a23e9ff404d0ed9e670a168c70dfb91f50a","2009-10-30 02:15:41+00:00","Move WalkingMap instance to Game, and clean up parameters

svn-id: r45516
"
"fefda816f2a7f63fa376c4c4447a91bef154d986","2009-10-30 03:12:32+00:00","Added Dragon History

svn-id: r45519
"
"e36798585fae492e425fdf5697cd9c31bb42c1d7","2009-10-30 03:27:27+00:00","Add Dragon History's authors, now properly

svn-id: r45520
"
"dba613ecd254906c1fb4128ddecfae3121dc39d5","2009-10-30 03:54:50+00:00","SCI: AvoidPath: Don't discard contained-access polygon when starting point
is right next to it.

svn-id: r45521
"
"27df03a18efb31fd89ed1a4efbb057d2b302e7fa","2009-10-30 04:47:02+00:00","SCI: AvoidPath: Add workaround for pathfinding problem when Patti walks to
control room in LSL5, room 660.

svn-id: r45522
"
"839a7d5db64af758190cdc3dd5ad23613df6c6d7","2009-10-30 05:21:44+00:00","Fixed svn:keywords

svn-id: r45523
"
"6411125f39c5b02bec5dc4c38e26916a3b7a0304","2009-10-30 06:11:04+00:00","Moved all one-line getters/setters to the header files

svn-id: r45524
"
"afcd186bef64a4ebbfbdad5706434e3d4da1d13e","2009-10-30 07:26:43+00:00","Move drawing of walking map to walking.cpp

svn-id: r45525
"
"87aa24e1740bb9aa957537c5dfe96fa3c0f4fb29","2009-10-30 08:22:53+00:00","Started porting ReAnimate() from Greg's SCI engine

svn-id: r45526
"
"6c101f7c1aad4d401e793ada760bba33432773b1","2009-10-30 09:26:14+00:00","SCI/newgui: Reanimate implemented

svn-id: r45527
"
"4009f6836ba4aacc8630d88938b9ace1874ed972","2009-10-30 09:50:31+00:00","Fixed Terry Pratchett's name in the credits

svn-id: r45528
"
"0c2ab7182966b1897413e145fe80b95fca454edc","2009-10-30 10:06:35+00:00","SCI: kStrAt / dont do call, when offset exceeds maxSize. fixes crash in kq5

svn-id: r45530
"
"932cd54bbe0bb612eb828637c13ee068b4640b95","2009-10-30 11:26:00+00:00","Rewrote the avoidpath debug code to use new graphics functions

svn-id: r45533
"
"0cecbffb608bc1de8a908092ff083d58d3afcc59","2009-10-30 12:03:31+00:00","Restore the pen color after changing it in graphFrameBox()

svn-id: r45534
"
"272cc757152e0fc8f2c1821871c8f108f05c20ce","2009-10-30 12:26:24+00:00","PSP: Fixed serious issue in plugins due to way gcc sometimes works. Was only observable in Kyra engine but potentially applicable to all

svn-id: r45535
"
"ff284c9f5bea8a9eaeadf0328230cfc72ab2f96c","2009-10-30 12:33:05+00:00","Remove unused includes when INCLUDE_OLDGFX is not set. Implemented the full screen updates that the current menu code is doing using new graphics functions (still unfinished). Some cleanup.

svn-id: r45536
"
"3ec76350ec48f41850c9e65815427f5e334e0f66","2009-10-30 14:22:22+00:00","SCI: kStrAt offset checking fixed

svn-id: r45537
"
"57266a7cbaf46d83632be6eef32078c070cae12f","2009-10-30 14:39:26+00:00","- Removed status_bar_foreground and status_bar_background variables from the engine state
- Implemented clearMenuBar() in the new graphics code
- Removed the 'status_bar' command, which was used to set custom colors for the status bar

svn-id: r45538
"
"b2ab8fd77bff53cf8dffe705959e6d4abd2b0f5c","2009-10-30 16:20:24+00:00","Updated the MSVC project files of the draci engine for commit #45510

svn-id: r45540
"
"371097d27cca28c1d7163f288fe8b229841d9b8d","2009-10-30 17:13:25+00:00","Added caching for mouse cursor views

svn-id: r45541
"
"8bf3e5b5499d53235912bb6082424eae9ca6efcd","2009-10-30 17:38:11+00:00","Added caching of views

svn-id: r45542
"
"e87808d89b4af208504a75809e5fa91fd61a367b","2009-10-30 18:01:27+00:00","SCI: validate_variable fixed and now using bool instead of int (fixes pq3 demo crash on my computer)

svn-id: r45543
"
"9e78f4693c0e2d270a17d18eba7cdbc1165f88b7","2009-10-30 18:32:55+00:00","Fixed a crash in the old graphics code from commit #45542

svn-id: r45544
"
"f55da32ca59b0b0c5cc982198b29e8ee01454501","2009-10-30 20:25:12+00:00","Fix credits.

svn-id: r45545
"
"59eb37a76c390d2394304364c3cabef15359afa7","2009-10-30 20:30:28+00:00","Fix bug in 'add_paragraph' in tools/credits.pl, now the '&' should be fine in credits.h again.

svn-id: r45547
"
"92fdf79d5bd8c601d8e39b673c1a8436aef13e4e","2009-10-30 20:44:11+00:00","Fixes for TEX and RTF output of 'add_paragraph'.

svn-id: r45549
"
"29fb3b0f3fca31c36f13175627f9bc06effe8e97","2009-10-30 22:50:21+00:00","Plugged some memory leaks in the new graphics code

svn-id: r45550
"
"1c158c52a1217225cfa4aadb289a537287eec6a2","2009-10-30 22:53:00+00:00","Cleaned up kPlatform() a bit, and changed it to return appropriate values for the CD hires version of KQ6

svn-id: r45551
"
"86cafd561f8777fc06913dda10e3fe561ecf137e","2009-10-30 22:55:35+00:00","Some work on the kPortrait kernel function, used to show hires character portraits in the Windows CD version of KQ6

svn-id: r45552
"
"086712939949bc464cde2e9421b6c5c98ef6a6c8","2009-10-30 23:44:12+00:00","Formatting.

svn-id: r45553
"
"d76c1c65522a852562d213ca1c5410251b065774","2009-10-31 09:48:19+00:00","Add patch from Tobias, for menu keys in PCE version of Loom, with minor change.

svn-id: r45554
"
"71db8b851bf27bb4c76e5122161b3a0fe38c3ed3","2009-10-31 10:54:19+00:00","Some more work on KQ6 hi res version - screen scaling should be done now, but other methods haven't been updated yet

svn-id: r45555
"
"cd3f9336abe5ac9c99c817bd4abcf37c8c940bde","2009-10-31 12:17:38+00:00","Cursor positioning now takes screen scaling into account

svn-id: r45556
"
"43f476b5716e797525abf893ae58025109857176","2009-10-31 12:19:35+00:00","Properly fixed putPixel() for scaled screens

svn-id: r45557
"
"773bc170a3f99c26fe061ff31ab98999147e60cc","2009-10-31 12:38:08+00:00","Fixed Valgrind warning caused by always reading four bytes at a time from the
cursor source buffer.

svn-id: r45558
"
"f7fcec1ce283ab5536358334193244f6b4d9a3ee","2009-10-31 13:15:49+00:00","The verb images for distaff have no mask data, in PCE version of Loom.

svn-id: r45559
"
"2f7f5bb4f1e4635c33cf05aff3852ba967d99304","2009-10-31 13:34:31+00:00","Fixed flashlight drawing in 16 bpp games. (Which probably means PC-Engine Loom
is the only game where it makes any difference.)

svn-id: r45560
"
"149d784d0b2be7c0a968f856557724b216cd8a95","2009-10-31 13:43:46+00:00","Kirben suggested using vs->bytesPerPixel instead of _bytesPerPixel when drawing
the corners on the flashlight. He's probably right, since 'vs' is what we are
drawing to.

svn-id: r45561
"
"f36e9cbe4d40dc5235a2a1315eee28ab229bc6dc","2009-10-31 14:38:25+00:00","SCI/newgui: UpscaledHires implemented including undithering support, cleanup

svn-id: r45562
"
"4b9066ef6911f373c53f5ca804d843e3c393da2f","2009-10-31 14:41:28+00:00","SCI: accidentally set newgui to default, reverting

svn-id: r45563
"
"99cd8d5d2f489cdfe764da46903446eb2f6d5914","2009-10-31 15:25:47+00:00","SCI/newgui: kGraph support for Save-UpscaledHires-Box (not sure if coordinates are really hires, it seems that they are not)

svn-id: r45564
"
"6fd5fdcf7ba66daf6e1de53efe2197a75afcaada","2009-10-31 15:44:59+00:00","Upscale the mouse cursor when the screen is upscaled. Also, reapplied some code which was accidentally reverted in commit #45562

svn-id: r45565
"
"2b29b53b473af96e910066ce090e526dc0a5fb62","2009-10-31 17:02:11+00:00","Slight optimization to the 2x scaler

svn-id: r45566
"
"c64fa600b7cd1eb185f29a29de75dd19497c4857","2009-10-31 17:54:28+00:00","- Added some TODOs
- Disabled the kGraph case used in KQ6 Windows for now, as it's problematic and crashes the game
- Added extra param to kDrawCel(), used in KQ6 Windows

The icon bar in KQ6 Windows is shown a bit better now

svn-id: r45567
"
"9450661f72bac2aed6ca3ae6fee5262012e4f379","2009-10-31 17:55:03+00:00","Added some default directories

svn-id: r45568
"
"cda9b293fdc9310f788adb51ff8372448ca58237","2009-10-31 18:00:22+00:00","SCI/newgui: Changed code for graphSaveUpscaledHiresBox to not scale the position, its not needed and would actually result in a crash cause of 2 times scaling.

svn-id: r45569
"
"d5421d93d4b1a23aaaf552c60d334857714d377b","2009-10-31 18:12:19+00:00","Silenced GCC warning.

svn-id: r45570
"
"58299f4bfdf6ec10c37702c94e7cdd4462c595cf","2009-10-31 18:26:31+00:00","Added a comment that the current implementation that we got on drawing already scaled views is a temporary hack

svn-id: r45571
"
"93d26113fd4ddccbf9cfa09bc0e24ccbb1d7325c","2009-10-31 18:32:17+00:00","Fix some memory leaks in Kyrandia 1 (this hopefully fixes crashes on NDS after a long playtime).

svn-id: r45572
"
"67a7492fa2e46c113b15469a9b44ffdb1ece2af9","2009-10-31 18:36:13+00:00","Comment out unused variables.

svn-id: r45574
"
"d033899a0595d6a371ca9c2861b85ce5604f6ba6","2009-10-31 18:49:47+00:00","added cutscenes where needed, fixed invalid skipping of fullscreen messages.

svn-id: r45575
"
"b1671eb2d39900618f6e1077f2b9aeda5f2618f0","2009-10-31 18:53:30+00:00","added missing cutscene

svn-id: r45576
"
"5f77a350a3d3b88c2bbfde6053f841cceb49670b","2009-10-31 19:03:44+00:00","fixed bird-assert from chapter 1

svn-id: r45577
"
"6205c5f4de3c02148b2cf5251e1b34a522dfbf1c","2009-10-31 19:34:27+00:00","better scene cleanup

svn-id: r45578
"
"b29fd4dacd54e672ffa52179dd02e0367ef14707","2009-10-31 19:48:28+00:00","SCI/newgui: SciGuiPortrait created

svn-id: r45579
"
"45208bc53d8bf43b2b30697787f17db6a1247e91","2009-10-31 19:52:46+00:00","Fix certain scenes incorrectly appearing as fireberry bushes in floppy/FM-Towns/PC98 versions of Kyrandia 1.

svn-id: r45580
"
"fa506b5f0a8914af0c84524eb654f4b0a9ca8b7d","2009-10-31 19:53:52+00:00","Fix missing inventory in Kyrandia 1 PC98 16 color version, when loading a save via launcher or command line.

svn-id: r45581
"
"f70904616721b174dc6fb78139e2dfe30e830b07","2009-10-31 19:55:49+00:00","Fix compilation.

svn-id: r45582
"
"a510481202670fb9d579faff3d3b26099777e02c","2009-10-31 19:59:48+00:00","Clean up comment a bit.

svn-id: r45583
"
"0af1d66d2d972b2ff52a5cee3f3a4c58a20c0e16","2009-10-31 20:56:14+00:00","SCI/newgui: added portrait data layout as comment (not completely done)

svn-id: r45585
"
"4d2cfd544973e3d2840d325e0f0ab385bb53ca71","2009-10-31 21:21:23+00:00","SCI: AvoidPath: Switch to A*

svn-id: r45586
"
"fdc6524fb30b5e52114558adf619e3293d87a552","2009-10-31 22:50:05+00:00","SCI/newgui: fixing kDisposeWindow so that reanimate is correctly called (fixes cels disappearing after removing windows)

svn-id: r45588
"
"0bf6303213240dc9d93a9e81b8e1706fafb9a2ad","2009-11-01 01:31:23+00:00","Kyra/FM-Towns: make sure that at least the synthesizer music plays when no cd audio tracks are found

svn-id: r45589
"
"6522df6d6dd8c94c091b25c1bdde10ca11f4856b","2009-11-01 03:32:28+00:00","SCI: AvoidPath: Add simpler visibility algorithm (still disabled).

svn-id: r45590
"
"c8534e180270a4718132a0c7d9b1bff3909db34e","2009-11-01 09:34:07+00:00","Implemented some utility functions for path-finding.

In particular, breadth-first search algorithm for getting the shortest path
in the walkable area and an algorithm making the path oblique when possible.

svn-id: r45591
"
"b3eef9e066d8155bb9ba28bf1935f3024deebccf","2009-11-01 09:39:16+00:00","AGOS Simon1 Windows fix. Fixed careless use of setChar function.

svn-id: r45592
"
"f91c89560f9e50f6cecfe93795d4c00513f45206","2009-11-01 10:03:37+00:00","Get rid of doubling memory allocation and a lot of copying.

The Sprite class points to the original buffer (which is cached in the memory
thanks to BArchive machinery) instead of allocating its own buffer and
copying the source there.

svn-id: r45594
"
"7927196b3f1d210cc5c7ca76e377363f6db0654a","2009-11-01 10:15:48+00:00","Fix mistakenly ordered flushing revealed by the last commit

svn-id: r45595
"
"5c7a120471000a1e048c5bc7688af77e95886caa","2009-11-01 10:58:34+00:00","Add methods to draw computed walking paths.

svn-id: r45596
"
"c1cc230e4b41c9e6fff7b531158e50d0bc18a57a","2009-11-01 12:57:06+00:00","Debugged computation and displaying of optimal walking paths

svn-id: r45597
"
"170918afabaf8a34a2dfcc581f9bc3e851e05161","2009-11-01 19:22:41+00:00","Cleaned up the walking code.

PathVertex replaced by Common::Point.  Do not update the path sprites if
not in the debugging mode.

svn-id: r45598
"
"504973a0738843aed968d287416b7945bfa8f32c","2009-11-01 19:30:51+00:00","One more clean-up of the path-finding code

svn-id: r45599
"
"f2dbd3357fdc78c1123253e0d039533102908bc4","2009-11-01 21:14:33+00:00","SCI/newgui: kBaseSetter ported from gregs engine, kq5 pathfinding works now correctly

svn-id: r45601
"
"0470c25881a59815dcc2bd14312de1530c92e27b","2009-11-01 21:19:39+00:00","Small bugfix in path-finding

svn-id: r45602
"
"8a7c5dbc6fdf54d1dce1c1d279ccbe3c2b7f2189","2009-11-01 22:27:10+00:00","Add command line parameter to automatically create a search table entry from a given file + offset/size pair.

svn-id: r45603
"
"f77446a500046ae156e07ea7cdbebbf23c5877b3","2009-11-01 23:04:56+00:00","Commented on loop() before refactoring.

svn-id: r45604
"
"9ad86a800af7124684fca7fbf762feec5cd83574","2009-11-01 23:20:19+00:00","Fix SIGSEGV when quitting the game during playing sounds

svn-id: r45605
"
"9f711bd0ced5368a0dd5a28be7db5d7128849c01","2009-11-01 23:20:46+00:00","Commented the rest of the loop() logic

svn-id: r45606
"
"c45f0343f4c386263025f1c39536ec9c6a2e566e","2009-11-02 02:28:43+00:00","Refactored running loop().

- shouldExitLoop() is a bool again and introduced new flag isReloaded() instead
of adding special hacky value 2
- loop() accepts 2 parameters: loop substatus and shouldExit flag, because each
caller previously had to set and restore these manually.  loop() now also
tests whether the substatuses are properly nested.  reordered the
loop-exitting code.
- renamed loop substatuses to logical names
- enterNewRoom() returns bool whether loop() should continue so that start()
doesn't have to test and clear shouldEndProgram().  it doesn't need
force_reload as a parameter anymore.
- dialog selections use new inner substatus instead of outer substatus, for
consistency

svn-id: r45607
"
"6de74446ab75fb19b62ab5fc6ef492d7b05e1f15","2009-11-02 05:31:03+00:00","Split loop() into several cleaned helper methods

svn-id: r45608
"
"ab3eb81dfb3839fcae13edb83fc85a5759106b1c","2009-11-02 05:37:17+00:00","Little clean-up after the refactoring.

svn-id: r45609
"
"10a902735afa9f1a7c5eeef868293bee68003a66","2009-11-02 17:59:19+00:00","SCI: SciGuiMenu created, kMenu-related stuff now using SciGui

svn-id: r45612
"
"abf63e1be9060f2435c23088875af503b19f5f5b","2009-11-02 19:50:17+00:00","SCI/newgui: Removed GuiCast structure

svn-id: r45613
"
"3a2833867f2f8f720afb5e89180a95d1aa4b3236","2009-11-02 20:33:34+00:00","SCI: Fix warning about unused variable

svn-id: r45614
"
"400ee8c461e8060393b62be639c27dd3820dccd4","2009-11-02 21:42:21+00:00","Enhance VOC debug output

svn-id: r45615
"
"51933629d1f1a17839ddbb75b2b619effe117abb","2009-11-02 21:54:57+00:00","Changed foo(void) to foo() in almost all non-backend source files

svn-id: r45616
"
"5cf868b75711c69736d3b2eb6f1068bdc48349ae","2009-11-02 21:56:29+00:00","TINSEL: Turn config code into a simple C++ class

svn-id: r45617
"
"26981a5ffc7ab7ab8c0d201ad9e9f6f77d4c3e8b","2009-11-02 21:57:16+00:00","TINSEL: Add isValidObject(OBJECT *obj) function; make objectList & currentCD static vars; merge two logic blocks ('ifs') in DoRestoreSceneFrame

svn-id: r45618
"
"7f8a8732a15d2f713eff4e356f93fe9cc7bfa691","2009-11-02 23:06:30+00:00","SCI: Fix hoyle hack

svn-id: r45619
"
"d10fe42416aadf26178b1281f08a60d45f13781b","2009-11-02 23:42:30+00:00","TINSEL: Fix regression caused by the introduction of _vm->_config; proper fix will be introduced later, when dialogs.cpp gets objectified

svn-id: r45620
"
"e959ef33e5934a9c45615af2bdb585c325096489","2009-11-02 23:48:21+00:00","TINSEL: Small correction to the previous hotfix for _vm->_config crash

svn-id: r45621
"
"75bf8237b0e09507a667f7db20802e01a5b8c0f3","2009-11-03 03:24:59+00:00","Greatly improved the quality of obliqueing the shortest path.

The current algorithm is much better than the original player'ss one and it
find really nice curved paths.

Also, started preparing interface for actually walking along this path.

svn-id: r45622
"
"0d5627d8f11db377ee3c32d684ddc0f19f57fa95","2009-11-03 03:38:28+00:00","Run the path obliqueing process repeatedly until it converges.

svn-id: r45623
"
"bf8f8acb47381dacb168243589df56b2832df434","2009-11-03 08:23:02+00:00","Don't keep a reference to SegManager, as it gets deleted when loading. Fixes a crash when loading games

svn-id: r45624
"
"9ec6208e2ac364b35142c741db6c089fd0d50c40","2009-11-03 08:23:58+00:00","Plugged a memory leak

svn-id: r45625
"
"f0c628cc3c4cf227e8b5df7bc8a052b567a5bdde","2009-11-03 09:01:12+00:00","Remove the SegManager-related hacks for the selector defines, as the segMan parameter is explicit now

svn-id: r45626
"
"ff9c4908a7e5f500398a911f8d3d74e7d4278cc8","2009-11-03 11:32:23+00:00","Fixed a crash when loading in the old GUI

svn-id: r45628
"
"a5058b2022d1fe988ff2bd86a675d865a8ae53be","2009-11-03 12:48:32+00:00","Use the new built in ScummVM.svg icon. Its now compatible with S60vx (previous version rendered very strangely)

svn-id: r45629
"
"74dba071b87dd73906d6ba8ad403235f97defb9b","2009-11-03 14:20:57+00:00","Fixed the deletion of cursorBitmap

svn-id: r45630
"
"34aaac37fc565624abb0e52bcc07d7bfed5f5c67","2009-11-03 14:24:47+00:00","Removed some more hacks for accessing the segment manager

svn-id: r45631
"
"d758538eaa6a4c6651d4b5b1aabe18228997a25f","2009-11-03 19:33:31+00:00","SCI/newgui: SciGuiMenu partially implemented

svn-id: r45634
"
"7bed008f8eeb6b47282ee7eeb43c89aa4fb4f9fe","2009-11-03 19:43:21+00:00","SCI/newgui: fixes for statusbar and transitions, so menubar shows up in intro of qfg1ega

svn-id: r45635
"
"55ebcf69e527baec00b4970f6693c89a7a28e2bc","2009-11-03 20:13:14+00:00","Turn off warning 4267 ('conversion from 'size_t' to xxx, possible loss of data'), thrown in 64bit builds

svn-id: r45636
"
"0fd0d1a09f5e40c65cb62d2bb4285492d7a96524","2009-11-03 20:47:10+00:00","SCI: Fix warning (declaration of 'FOO' shadows a member of 'this')

svn-id: r45637
"
"45308a2bd5e2aa0cff92375fac877a0b1a166d93","2009-11-03 20:49:53+00:00","Fix for bug #2890038 (FT: Crashes when entering inventory)

svn-id: r45638
"
"9ad5e7461fed883710a0937a919cbee911a6e0a8","2009-11-03 21:05:26+00:00","Let setPath() store path with pixel precision, and update the map sprite when reloaded

svn-id: r45640
"
"0071829aee9d1bb97402c42d1abcaa17a39b2838","2009-11-03 21:30:24+00:00","Implement properly stayOn instead of using walkOn

svn-id: r45641
"
"b506b9f7c2f24bf7f0b8a281b856b3807f362028","2009-11-03 21:34:38+00:00","Removed an old FIXME

svn-id: r45642
"
"49a8462c5babed7953ccb0275658fdb8320a4172","2009-11-03 21:51:24+00:00","Capitalize the word Sequel in The 11th Hour's title.

svn-id: r45643
"
"930910fe5c1f94093f74ca085f2fe7dd7e4f0b11","2009-11-03 22:13:37+00:00","Created walking-callback infrastructure and converted the code to use it

svn-id: r45644
"
"400f31ff9804d1416e046d8f9fd4f321f5b6282f","2009-11-03 22:56:22+00:00","Deleted all the MSVC project files, since they can be built quickly and reliably from the gcc files using the create_msvc tool. Added some brief instructions on how to use the tool.

svn-id: r45645
"
"4ec4eedf49ce3ab69f20fdec626b1aefb4bcd2d2","2009-11-03 23:06:25+00:00","Enable FLAC by default for MSVC, since our new prebuilt library package supports FLAC as well.

svn-id: r45646
"
"692aea8e8d09163da3e05181784fd0b79efea8af","2009-11-03 23:20:28+00:00","Added batch files to create default project files using the create_msvc tool

svn-id: r45647
"
"14f268513487f0eafbe1cbf7c9b7b928d77a6148","2009-11-04 00:42:37+00:00","Implemented and debugged the walking framework.

The hero does not walk yet (it still teleports to the target immediately),
but that is just because the actual walking algorithm is left trivial first.
However, the main game loop, callbacks, and waiting all already work with
the general framework.

svn-id: r45648
"
"f147fbb93672b3490b6265cf5f912ef23799c907","2009-11-04 04:27:31+00:00","Properly animate the last phase of the walk before running callbacks

svn-id: r45649
"
"f45a1a5a0b3cc3e343448659c60973a6a2e95a7f","2009-11-04 08:05:12+00:00","Provide compatibility with 2000/XP, where the 'choice' command is not available, and made the prompt more verbose

svn-id: r45650
"
"a6f1280fcc5f0811f799824dab9b29e46dbb989f","2009-11-04 08:38:32+00:00","Added support for loading the game's object list

svn-id: r45651
"
"66d3540f2caf23a4ba9fd59bd30d13302f1d8064","2009-11-04 09:31:35+00:00","Cleanup

svn-id: r45652
"
"597524b255a75bb61830c8c518d990a38a4923b5","2009-11-04 09:36:18+00:00","Moved most of the code for playing sound effects and speech into a separate class

svn-id: r45653
"
"611f5dd95f30012a8c98c4285837a1ce32bdc19a","2009-11-04 09:49:28+00:00","Moved sound sync related variables inside the AudioPlayer class and fixed compilation

svn-id: r45654
"
"2dbf6662fce6e1c0b72bf860d1573aa05fadf850","2009-11-04 10:20:25+00:00","Moved the sound sync code inside the AudioPlayer class

svn-id: r45655
"
"7d00c4a7f1932e21e69c0f032f82a72e5c089a47","2009-11-04 11:22:46+00:00","Moved the audio CD handling code inside the AudioPlayer class. Some cleanup

svn-id: r45656
"
"f5d1ca32f2626ae1eb6c6c598e129698123a3aab","2009-11-04 11:48:17+00:00","Fixed compilation when INCLUDE_OLDGFX is not defined

svn-id: r45657
"
"f755311114121ce67efc17db4a67996382affc47","2009-11-04 11:52:11+00:00","priority_first and priority_last are not used by the new drawing code, thus the new code didn't handle priority changes by kGraph()

svn-id: r45658
"
"effdfcd4b8c92475d41a15cefbfd711724280924","2009-11-04 12:16:08+00:00","Added references to the scaleX and scaleY selectors, used for SCI1.1 view scaling

svn-id: r45659
"
"12e3375f3b47e6e626d8457257fd2036ed835ab1","2009-11-04 12:19:05+00:00","Removed the reference to SciGuiCursor from EngineState

svn-id: r45660
"
"429c06c5ae7d9a1cd144994aaff46f87a13a1943","2009-11-04 12:54:27+00:00","SCI/newgui: kGraph / InitPriority changed to reflect sci0 implementation, also moved code

svn-id: r45661
"
"205a6c2299f5860397e2a95ace4628401aa319db","2009-11-04 12:57:11+00:00","SCI: forgot to adjust gui32 as well

svn-id: r45662
"
"7030588e2208d14df275f871f272de068cff6335","2009-11-04 13:26:43+00:00","Removed the reference to EngineState from the SciGuiGfx class

svn-id: r45664
"
"f83d7c6339258cef9d1c53d91a4e2d7b2637d1ec","2009-11-04 14:17:14+00:00","Reapplied the LSL1 casino workaround, which got disabled accidentally in commit #45661

svn-id: r45665
"
"c8fbac1517cd2cd60791d598fb1922846ff0b867","2009-11-04 14:22:17+00:00","- Changed the segment manager to be a static part of the engine, and stopped deleting and recreating it when restoring games
- Merged game_exit(), script_free_vm_memory() and script_free_engine()
- Cleanup

svn-id: r45666
"
"2aeb892e0626b91de6aeee4289f8117c1608a3f2","2009-11-04 14:27:03+00:00","Cleanup

svn-id: r45667
"
"5daca46946a57b668dd85c8d5805e41380db22a9","2009-11-04 15:32:25+00:00","Removed unused variables and placed some more old code inside INCLUDE_OLDGFX defines

svn-id: r45668
"
"d2b76368e11edaea60bcbbd40a2195a38eb0d586","2009-11-04 15:41:40+00:00","Fix CD Audio in JonesCD and add some comments.

svn-id: r45669
"
"6ea1cf73769a17a556588347e9177e49960bff6f","2009-11-04 15:51:50+00:00","Applied patch #2891230 - 'SCI sfx: fix song iterators from not getting freed'

svn-id: r45670
"
"a53fda32bb0a90dc945a2e921513e8cd3aaa774e","2009-11-04 16:11:44+00:00","SCI/newgui: SciGuiMenu - set()/get() implemented

svn-id: r45671
"
"5910e32b36d99a7b417f58a98b6399815aff724b","2009-11-04 16:11:46+00:00","Applied patch #2891232 - 'SCI sfx: Let each SongIterator remap its own channels'

svn-id: r45672
"
"c975c288eedbe4f2e0fea320148e3318aed57c97","2009-11-04 16:16:55+00:00","SCI/newgui: SciGuiMenu select() created, little cleanup

svn-id: r45673
"
"14447f7e017170913981a36407531f4f4b938ab4","2009-11-04 21:03:57+00:00","SCI/newgui: select() implemented (interactive modes not done yet)

svn-id: r45674
"
"90eba9310a78235dd8517f338f2d64c52b274f11","2009-11-04 22:54:14+00:00","Brought back one old line, just to be sure.

svn-id: r45675
"
"1f49679db5256221958bd336f47616a14b28b10f","2009-11-05 00:04:53+00:00","Moved the audio related command enums inside audio.h

svn-id: r45676
"
"fc2e2e27fc85b01b35f853bef8c93741162c4a81","2009-11-05 00:21:54+00:00","Added helper functions for dragon animations

svn-id: r45677
"
"9b7e6aed7c2a81962a777c65c40856a21dd80c54","2009-11-05 00:32:54+00:00","Clarify demo fix.

svn-id: r45678
"
"c720c4b24d15ad790ae81b3621d2790f02c134cb","2009-11-05 00:41:32+00:00","Correct bugs listed under incorrect game engine.

svn-id: r45681
"
"20a3c484d546a782999586300482c6985812a291","2009-11-05 01:35:43+00:00","SCI: Converted FreeSCI Amiga sound driver. Some cleanup.

svn-id: r45682
"
"b64afbdac0c66d04eac662454d2f450688b0d57b","2009-11-05 07:27:36+00:00","SCI/newgui: kDisposeWindow - changed to reflect actual sierra sci behaviour

svn-id: r45683
"
"0b8a2ff617ee1b1901fd8264daad1083a1c7c2d3","2009-11-05 07:28:44+00:00","SCI/newgui: SciGuiMenu interactive keyboard support added (menu drawing still missing)

svn-id: r45684
"
"25025f58f0bbf06b1969bd09ede36e4eaff1a706","2009-11-05 11:40:33+00:00","Add fix from Tobias, for bobbing Bobbin in PCE version of Loom.

svn-id: r45685
"
"455f27f0561a5ef723b74f44bb9e26bcda1d9cdb","2009-11-05 13:47:17+00:00","GP2XWiz: Tweak configure to ensure that the correct ABI is used for the ASFLAGS and enable Virtual Keyboard.

svn-id: r45686
"
"f8a19bb4a9be128de321522b92037774e1625b69","2009-11-05 14:22:39+00:00","Implemented proper walking.

First shot, not debugged yet, but seems to work (even though a bit hairy)!

svn-id: r45688
"
"45aa06a83fc043bd9a4878b32387da54fc6e8cc8","2009-11-05 21:09:46+00:00","Fixed compilation when INCLUDE_OLDGFX isn't defined

svn-id: r45689
"
"73cf7a55fcc75712f1c9944f425af2f2d31454b9","2009-11-05 23:59:26+00:00","Fixed several gross walking bugs.

- SIGSEGV by not stopping walking when changing rooms
- reset of the mouse cursor and object title during gate scripts
- updating the previous animation phase, also when starting new animation
- swapped up and down animations

svn-id: r45690
"
"10d1288c7253a965b9aa94813f25fdb3bffc10d7","2009-11-06 07:49:25+00:00","update readme for release

svn-id: r45691
"
"881bf37554b1d33b3c77bf7a6718b98c7766fd83","2009-11-06 16:48:37+00:00","Add safe-guard against collision of animation IDs.

When debugging another issue, I preloaded all animations, and horrible things
happened that I debugged for a few hours.

svn-id: r45695
"
"d66e284bde397476075990303455fb0da4a1c3cb","2009-11-06 17:21:43+00:00","Commit digitall's patch for bugs #2892510 and #2892510 with an additional comment.

svn-id: r45697
"
"060d6710896cd2cd2752a31e07b783ad0858aa85","2009-11-06 19:47:32+00:00","Sync with the NEWS file in the 1.0.0 branch.

svn-id: r45700
"
"bd2b6f396ff572fb9eda10f1b0530b6357475c33","2009-11-06 23:02:09+00:00","Correct a few items.

svn-id: r45702
"
"c65eefbdf769a90c7b5d8b883a5a2e870b65516a","2009-11-07 00:06:46+00:00","Set date for release 1.0.0

svn-id: r45709
"
"fdad4e7b543af2debcc35492e46c979ab1dd8fec","2009-11-07 00:36:23+00:00","Done research on ignored animation flags and commented the code

svn-id: r45711
"
"357d9989d4c6ae73e02a044b388f36069e093ce0","2009-11-07 01:28:27+00:00","Implemented relative animations.

In these animations, each sprite can specify a relative shift with respect
to the previous sprite.  Moving animations (such as walking of the dragon)
are easily described in this framework.  I have sort of hacked their support
and it seems to work.

The current walking code does not interact with the new code yet, but it will
be easy to do.

svn-id: r45712
"
"638305fcbb9a1c53425b546a0deb2ea6c3208f5a","2009-11-07 01:54:47+00:00","The hero turns the right direction after walking

svn-id: r45713
"
"f534c12289cca1152fc57545aeab12d5973720ed","2009-11-07 04:56:28+00:00","Add helper functions to retrieve dragon position from the animation.

To implement proper walking, I have to respect the relative shifts defined
by the sprites as opposed to apply some constant velocity.

svn-id: r45714
"
"aaeafde32530607a253304fd6e966727886cdf12","2009-11-07 08:35:24+00:00","'constify' dump and save methods, added intersects_hline/intersects_vline

svn-id: r45715
"
"ac1f49d7c957c333b573b3399aa755ed22b20c2b","2009-11-07 09:16:00+00:00","removed magic coordinates

svn-id: r45716
"
"a826c483b9f99c50d610b169c41b5d869a5502b3","2009-11-07 09:18:30+00:00","added actor position, orientation and dump() to hotspot struct

svn-id: r45717
"
"71eae24902d18d1cd45eab7dce4a4f4612bfd780","2009-11-07 09:19:49+00:00","improved walking code

svn-id: r45718
"
"5a22a255926b1d50975cbc65b3e4533dcb3b35f2","2009-11-07 09:40:11+00:00","added default delays for the messages

svn-id: r45719
"
"db58f6b998293caf2d99b5caba75a2b1634dacc3","2009-11-07 09:52:05+00:00","removed background bartender animation, played by mistake

svn-id: r45720
"
"0b67aa406e4c19edd9c264ce6f1447aee8ff4c8e","2009-11-07 11:45:13+00:00","Debugged updating the position of the hero during walking.

I project the hero immediately to the end of each edge for the time being
though.

svn-id: r45722
"
"f3f382ba37bdee7e0d3f530d72bdcd704dc4bb66","2009-11-07 12:00:56+00:00","implemented waiting for the particular frame in animation.

svn-id: r45724
"
"b92c5ea7578b9bfa1106984422a65d03a6d3f194","2009-11-07 12:01:45+00:00","added waitForLanAnimationFrame() everywhere

svn-id: r45725
"
"72157e1077b48d4454819eac330be0ccc4f4c0ff","2009-11-07 12:05:59+00:00","skip intro only by escape

svn-id: r45726
"
"9f1a756576ccbfaa01521697142a1e715fe57a5d","2009-11-07 12:20:27+00:00","Gradual walking implemented.

It is not fully smooth yet due to rounding errors.  However, it otherwise
does what it is supposed to including perspective correction.

svn-id: r45727
"
"404b2099990344f2c8345c99450ffe32c5b7bb6a","2009-11-07 12:33:59+00:00","do not bail out from the waitAnimation event if restart frame requested.

svn-id: r45728
"
"373b5d10136e2ee497b2bec2ff4c3799029dd3cc","2009-11-07 15:06:03+00:00","Formatting.

svn-id: r45729
"
"0d79ace422cee533bc852b4d52e22829f1a61947","2009-11-07 15:06:25+00:00","Access _keyMap a little different, so that no additional entries are created, when an unmapped key is pressed.

svn-id: r45730
"
"c2a5b3feea0c4428480a4c1864d031266b4103fc","2009-11-07 15:06:49+00:00","Fix some delays in Kyrandia 1 when clicking very often, while a sequence plays.

svn-id: r45731
"
"286e71fdcf8b41599891a073a42d20f9dae5294f","2009-11-07 22:23:41+00:00","fixed rendering order

svn-id: r45735
"
"354d7f6366d11628030bcfde9186fc6e1c819f9a","2009-11-08 03:16:22+00:00","Debugged smooth walking except for 1 bug.

Adjusting to the edge is done such that it respects slight sideways movements of the dragon.
Fixed rounding issues in the whole game.  Improved debug messages.  Made sure that the dragon
does not turn like crazy around when clicking on the same pixel: the final point is always the
clicked one although the middle points made by shifted to make the animations smooth, and
preserve the dragons direction if he has not walked.

There is a bug with running turning animations as they seem to disappear for 1 frame and have
incorrect Z coordinate.  Will investigate it next.

svn-id: r45742
"
"57b22e3688fa8f4abbb4db71f2117574978dd10d","2009-11-08 05:29:12+00:00","Walking animations are fully smooth now

svn-id: r45743
"
"0640b5e402d596e9e18e0cd1ff58fa68cd17c38a","2009-11-08 05:44:50+00:00","Renumbered path segments.

Increasing _segment by 1 makes the code much simpler.

svn-id: r45744
"
"bea00d86cbf6c41e5a93e97fd13f9e2cf1d00361","2009-11-08 05:47:39+00:00","Tuned Z-coordinate of the dragon.

Adding +1 made the dragon sometimes flip before an object when it should
have been behind.

svn-id: r45745
"
"5c8aa6ee91ed9342b991827d0a93bbc32f1bbb38","2009-11-08 06:16:25+00:00","Fixed mistake with two inner loop caused by not clearing the path.

Also, optimize play() and stop()

svn-id: r45746
"
"a4393d46b203c183d26f931e247f30d760b6ad0b","2009-11-08 06:30:10+00:00","Do not immediately clear the path when it has just 1 vertex.

This fixes the previous bugfix, which causes that I could not re-run the same
program (e.g., by repeatedly clicking on the hollow tree) if the hero did not
move at least one pixel.

svn-id: r45747
"
"4341a366410bc2f15d0001b69261a37d56016b10","2009-11-08 06:46:24+00:00","Implement QuickHero walking.

Pressing Q during the game enables/disables faster walking; all animation
phases are flipped after one refresh instead of after given delay.

svn-id: r45748
"
"75bbe04280d1a919d6113097e21636265ff412d2","2009-11-08 06:56:30+00:00","Fix enabling mouse cursor when entering a room.

It used to have a wrong palette.

svn-id: r45749
"
"4e662b22ca3019af8519900c6889f532a2707a23","2009-11-08 11:04:22+00:00","restart default animation in the slot after custom animation has ended.

svn-id: r45750
"
"99bd90cfac6f7c5f54bc9544368773fdef25d2b5","2009-11-08 11:04:48+00:00","removed noisy debug message

svn-id: r45751
"
"f8ab3f866e4592a4dd6c984b9d58f21844ea132f","2009-11-08 18:55:18+00:00","Silence gcc warning by putting parentheses around an && expression nested in an || expression.

svn-id: r45752
"
"121baa2660bada2d5c57f07db46c5c8c9d1ec592","2009-11-08 18:55:41+00:00","Fix running clearing IsReloaded().

Currently, if gate programs used loop(), they exitted immediately due to not
having cleared this flag.

svn-id: r45753
"
"778e1830bb10256b87d1a029326c23462a69b9f7","2009-11-08 19:10:24+00:00","adding proper dialog colors, various fixes.

svn-id: r45754
"
"c1b1d42b8740f31cc0dbb1a11e934d6db9de08b5","2009-11-08 19:11:57+00:00","removed font::color, added debugger console with enable_object/disable_object commands.

svn-id: r45755
"
"54d163c9661d86ab6d4364dde208e28ce42553d3","2009-11-08 20:00:31+00:00","implemented async messages (some animation requires it), added custom positioning.

svn-id: r45756
"
"1477c85697f07327d752da04144f728bfa091042","2009-11-08 20:01:07+00:00","fixed typo

svn-id: r45757
"
"63c6918a8cd994eb4199938b82b93afdd3cbcfc3","2009-11-08 20:37:33+00:00","clear current_event only on async messages

svn-id: r45758
"
"fac5aeafbd6b811125ea4dc4e05f8c5163bc1f16","2009-11-08 20:38:04+00:00","fixed wrong debug output

svn-id: r45759
"
"276ee4a4f89a34a6366fa7009bc40492c3daa67b","2009-11-08 20:53:55+00:00","fixed more village glitches

svn-id: r45760
"
"d5bff15b228d229336b0822cd5b7d6b99213db92","2009-11-08 21:22:32+00:00","added set_ons command to console

svn-id: r45761
"
"abbb3dccd7fa909d1746b00a88eb55494514334f","2009-11-08 21:26:04+00:00","Items put into inventory are placed correctly.

Also, named correctly GPL2 parameter types.

This fixes all FIXMEs

svn-id: r45762
"
"99037380ee72166e360675cb18ac0671f59a6cfb","2009-11-08 21:35:19+00:00","Removed old hack for cyclic animations.

This makes the hero's walk even smoother.

svn-id: r45763
"
"e9c6fd5e39d95cfb3c8a17a7cac3748f651ed930","2009-11-08 21:44:30+00:00","Fixed aligning items in the inventory

svn-id: r45764
"
"b257892387a61ee5d150f573b9178ccfa9e60c8f","2009-11-08 21:49:40+00:00","Removed almost all TODOs from the header files

svn-id: r45765
"
"79409d8ef1b14c3bf6d0863cb5bd6b8c81277574","2009-11-08 21:59:26+00:00","more improvements, added setTimerCallback()

svn-id: r45766
"
"ea0b2a8cb8e1e23c62442f248c5b6551469e8db8","2009-11-08 22:37:03+00:00","implemented mouse-rock-glue time challenge

svn-id: r45767
"
"8edfd6b56c7a7be7a2950d687678269f2aaf7010","2009-11-08 22:48:27+00:00","Updated the list of TODOs

svn-id: r45768
"
"83713e92fac141bfdf79e81ca30d79bed9d1a44e","2009-11-08 23:32:01+00:00","implemented drinking guard time challenge

svn-id: r45769
"
"99b68b3a1349f41ea149e48192d750361c088cba","2009-11-08 23:56:06+00:00","fixed boat bug

svn-id: r45770
"
"ed348133d172ff8a2729b664f9d228b6b6da13d2","2009-11-09 04:27:08+00:00","GPL2 callbacks accept const Array& instead of Queue&

svn-id: r45771
"
"dfc4dc6d85e5da9590e4647284fbc2c133f76fc9","2009-11-09 07:58:27+00:00","added 'ignore' flag, ported guard and anchor challenges to it. minor fixes

svn-id: r45772
"
"e9f2f2b291410af7a61d59e377e16e1bdf0172e9","2009-11-09 08:23:19+00:00","do not trigger examine object while inventory is inactive

svn-id: r45773
"
"005624a2a6661437268d4ffb823839617ccbc2ee","2009-11-09 08:23:56+00:00","more fixes

svn-id: r45774
"
"9290966e273330799d3d483fd23bbc3cdca1e443","2009-11-09 14:29:53+00:00","added samsung tv backend

svn-id: r45775
"
"4c2491df3b843948af9be61fa75dbbe8c0bc6043","2009-11-09 14:43:05+00:00","added support for samsung tv

svn-id: r45777
"
"ecaa7a3fe7a7bfc6cd63a32e0455ef8e449699de","2009-11-09 15:13:59+00:00","Fix compilation on unix

svn-id: r45778
"
"46ef23a7b913aa6ad4352ba8868010603b63384b","2009-11-09 17:51:20+00:00","disable hardware surface, for some unknown for me reason it broke drawing engine cursor

svn-id: r45779
"
"6e0a8895a245e1489ebc639ef2f12389923e0cc5","2009-11-09 21:26:07+00:00","added special case of loadScene

svn-id: r45780
"
"69b4d020fe7947d45f0f403477477f0f196eb447","2009-11-09 21:34:01+00:00","chapter 2 completed

svn-id: r45781
"
"2bb7476a20fbd78e0dcfeeb77f08fb8bb2df393e","2009-11-09 22:18:25+00:00","TINSEL: Add EnablePointing() & DisablePointing() to pdisplay.h; turn DisablePointing from a coroutine into a plain function

svn-id: r45782
"
"10b8741c8b995962f3bcc51276b38e01ca398422","2009-11-09 22:19:21+00:00","TINSEL: Simplifying PolyTinselProcess

svn-id: r45783
"
"80b8d0af6564af7aa6602251b8d371e6bfeeb634","2009-11-09 22:19:54+00:00","TINSEL: Make some const tables static; move static int priorVolMusic into SetMidiVolume to reduce its scope

svn-id: r45784
"
"1497c4120e907ab116e4d70e095804d8ba7c5841","2009-11-09 22:20:25+00:00","TINSEL: Mark all functions in dialogs.cpp explicitly as public (=extern) or private (=static)

svn-id: r45785
"
"53d0bcd594e180b6dc9a464f4aab69d03f9ebf21","2009-11-09 22:20:59+00:00","SCI: Remove remarks about in-place loading, at least for now.

Not loading in-place has the advantage that it allows to cleanly
cancel loading a savesate, e.g. if we detect a defect during
loading. This is much harder (if not impossible) to achieve if
loading in-place. So I'd prefer if we took advantage of this.
Right now, though, we don't.

svn-id: r45786
"
"b3c3222c231b599c6891d63e8c7ca1c478ae44c0","2009-11-09 22:21:23+00:00","TINSEL: cleanup

svn-id: r45787
"
"49c443149f3bacf0bd47c66dfea807a7e7b87ad4","2009-11-09 23:11:00+00:00","WINCE: Formatting fixes; added a FIXME to OSystem_WINCE3::checkOggHighSampleRate

svn-id: r45788
"
"1c5d8849ab61a02fad4f1930fb655bcd085997ca","2009-11-09 23:22:10+00:00","fixed rendering order again

svn-id: r45789
"
"a1496515ce02e3ab39ce076622c639d18577311f","2009-11-09 23:22:35+00:00","more fixes for chapter 3.

svn-id: r45790
"
"9d816caf560bd53c8be6b1f804f97d0a4d658df2","2009-11-09 23:29:33+00:00","SDL: Make first param of OSystem_SDL::remapKey const

svn-id: r45791
"
"fc1758f33b31a9cbc5630643cf7c4017923fac7f","2009-11-09 23:31:46+00:00","SDL: Factor code from OSystem_SDL::pollEvent into various new virtual methods, to make it easier to customize these (no code indention changes for easier diffing)

svn-id: r45792
"
"be0e94f4cd06694665e0a622310eb29a34e6ad2b","2009-11-09 23:33:05+00:00","Indention

svn-id: r45793
"
"b3a07754e23f026d842ccc5b414b535c51ff3d56","2009-11-09 23:50:19+00:00","whitespace

svn-id: r45794
"
"d6d2c5d7b83027c21f8e00d364c925ca5f45c392","2009-11-09 23:52:50+00:00","SDL: Separate Symbian specific main() from standard SDL main() -- to be moved into a separate file

svn-id: r45795
"
"1f37da26263d137397f8787500d771dca0d460fe","2009-11-09 23:58:12+00:00","Revert rev 45791 and make the first param of OSystem_SDL::remapKey again non-const (as it may have to be modified for remapping. Of course. Silly me :/)

svn-id: r45796
"
"885cbb53025e04a0cf5c414df07d3eb49ee79ffb","2009-11-10 00:01:43+00:00","SDL: Remove const from new handle*() method for now, to allow using remapKey (ultimately, the goal is to get back the const by changing how remapping works)

svn-id: r45797
"
"501dfa24895b15f3be8b50406e62fe557f3d0fb1","2009-11-10 00:10:30+00:00","WINCE: List each object in MODULE_OBJS on its own line, for readability

svn-id: r45798
"
"e2ca397e63861b256d50ba5ea9550db3ac4421e5","2009-11-10 05:16:34+00:00","Huge refactoring of data structures.

Replaced IDs of objects by pointers, which saves many lookups, each of which
is horribly ineffective.  Moved a lot of code into methods of structs now
turned into objects.

Tested the new code a lot and seems to work as well as the old code.

svn-id: r45799
"
"c51674200b6f3a77eccfe0fe5ef9d5dff14d46a8","2009-11-10 07:29:06+00:00","added special animation 0 case

svn-id: r45800
"
"102cc9679b4780d72fa8cb96be4a471a5414dfe5","2009-11-10 07:29:29+00:00","more fixes for final part

svn-id: r45801
"
"65136b9acfe034a0065b216644866238fe01259f","2009-11-10 08:01:48+00:00","Move Symbian main implementation from main.cpp to SymbianOS.cpp

svn-id: r45802
"
"e4e9080187b363dc73b3a777b9e0ff75acd6aa75","2009-11-10 09:31:47+00:00","Missing template argument for MIN (added <uint>)

svn-id: r45803
"
"9ea10940943dbc4d74552475361d12adc49bc724","2009-11-10 09:37:49+00:00","Use the original scummvm.svg icon.

svn-id: r45804
"
"02165cff5a901e4508b4b10da23258c0d802bad7","2009-11-10 11:20:35+00:00","make samsungtv backend subclass of sdl class

svn-id: r45805
"
"095172d57ffafc1ff313515948dc22a3b88094f3","2009-11-10 17:18:19+00:00","fixed linking in samsungtv target

svn-id: r45806
"
"2bb14776e4b0e8fcdbbe10668103833d33c61db2","2009-11-10 19:13:02+00:00","added myself and sanguine to credits as suggested by Max Horn.

svn-id: r45807
"
"bbd8c302a3e624f23bb0dd2d81a7b32ecbe7435e","2009-11-10 19:15:30+00:00","fix warpMouse(), add missing setMousePos on cursor events

svn-id: r45808
"
"92bd012b55a2918c43b16026ad9c87f5b5852757","2009-11-10 19:23:47+00:00","fixed mosue move

svn-id: r45809
"
"c25739b839c51d7116db1c5e454e5b6148a46786","2009-11-10 19:51:40+00:00","properly fixed mouse positioning in game engine

svn-id: r45810
"
"5859a9a8928bcdd123349dbd32d1821701cfc249","2009-11-10 20:29:19+00:00","Enforce alphabetical order in the credits again.

svn-id: r45812
"
"7b7763021b86fbebb79397dd7eec8024e7cb1a6d","2009-11-10 20:42:46+00:00","Fix for bug #2895217 'MSVC compilation broken with r47595'.

svn-id: r45814
"
"f23784b422d08b31b76af414cafbb593eb4bfbbe","2009-11-10 21:14:27+00:00","Add an ugly HACK to fix bug #2895217 'MSVC compilation broken with r47595'.

svn-id: r45815
"
"8b8f1548919b39458b7a682b8ef67f2d69c9ce02","2009-11-10 21:14:48+00:00","Add some FIXME comments about defining types from stdint.h on our own.

svn-id: r45816
"
"58ed9271f52c61a077a2235181fc821e77e96ff0","2009-11-10 22:12:10+00:00","SDL: cleanup

svn-id: r45817
"
"5283c55cdd3261be6fbd120bca8fbb551abf863e","2009-11-10 22:17:43+00:00","Fix compilation of create_kyradat (at least on Mac OS X it was broken because 'uint' is not a valid type)

svn-id: r45818
"
"f107f7fc367c62c8af0659548d86d5418d794988","2009-11-10 22:18:12+00:00","AGOS: cleanup

svn-id: r45819
"
"c3905f60ee71a4794fb11705b204f5ab0dbd0778","2009-11-10 22:18:41+00:00","Move definition of stdint types to the only file that needs them (mpeg_player.h)

svn-id: r45820
"
"6a9024b1e31d2d24c93d0209116b3f87a175072a","2009-11-10 23:06:09+00:00","Gob - Add detection for another win31 Lost in Time found on french ADI 2.6 Franais-Maths 4e

svn-id: r45821
"
"9ba6e8138c9eb1c4fc603a7dfebd70d781cc3872","2009-11-10 23:21:29+00:00","Fixed two bugs.

Putting items back to the inventory into clipped coordinates, and exiting
running GPL2 programs when the game engine it to be interrupted.

svn-id: r45822
"
"dea7e181727e851e32e9e513f1005d1cb4986e92","2009-11-10 23:23:40+00:00","Fixed walking to unreachable positions

svn-id: r45823
"
"78a10999ab241c6dd4496e6d66e9a608a0e78c30","2009-11-11 00:19:23+00:00","Cleaned up searching the closest point.

The old comments were completely misleading although the algorithm was good.

svn-id: r45824
"
"9dd61159cd75551b4780c159bfc4abc588357692","2009-11-11 00:27:08+00:00","Documented palette shift

svn-id: r45825
"
"8ed71d903a81a8bfb744ad7bf652c52f062a18c9","2009-11-11 02:25:42+00:00","Refactored draw() according to drawReScaled()

svn-id: r45826
"
"faaec05e65c4d4d1b2e079120df5cc14b003d3fd","2009-11-11 09:55:05+00:00","Removed all the '- 1' from calls to get vocabs, centralising it in the getVocab method. This is correct, as the first element in the game vocab list is '1', not '0'.

svn-id: r45827
"
"feab5f63ffba57498cdbbcd3127a770a81903777","2009-11-11 09:56:29+00:00","Beginnings of support for AA file animations. The mads_anim.cpp commit is part of this, not the previous commit

svn-id: r45828
"
"565fcbcc8de5367c9dc2b97dd88af3b616fc1784","2009-11-11 13:52:03+00:00","samsungtv: remove keymapper, its pointless here. fixed key mapping

svn-id: r45829
"
"6bc410ba347e5578089713be9866580bb815323d","2009-11-11 14:10:17+00:00","samsungtv: add missing .

svn-id: r45830
"
"a3363e6e1ffccc1d9ae9908466e37e43b2f579ee","2009-11-11 14:21:58+00:00","samsungtv: move DEFAULT_CONFIG_FILE into main sdl code to prevent code duplication

svn-id: r45831
"
"7556fddeb96b3b7ed8cb0b23ede353d50d0e70c1","2009-11-11 14:27:22+00:00","Remove (now) obsolete HACK for WIN32.

svn-id: r45832
"
"2c95e82e26d1108e2f0078d4ced384b307eaba8b","2009-11-11 14:27:45+00:00","Comment out unused variable.

svn-id: r45833
"
"22e94ddd61bbb044f99088311d53df60128bd935","2009-11-11 14:28:07+00:00","Add missing ')' in #if check.

svn-id: r45834
"
"2a1cd33a46853b50dd5061a104618f00cdff01d3","2009-11-11 14:36:46+00:00","added more cases for samsungtv to allow reuse main sdl code

svn-id: r45835
"
"b7a2c8dfe6d4ffb0297911b2bc992aefee3e9d1c","2009-11-11 14:42:56+00:00","samsungtv: reduction of includes

svn-id: r45836
"
"1b3a3de946d0ba404b9666f16cfc46661512d66b","2009-11-11 15:23:44+00:00","samsungtv: disable selecting resolution based on aspect ratio for now

svn-id: r45837
"
"429d8be2dc86b93416adf387353a30e3c0bd97dd","2009-11-11 19:43:51+00:00","SCI/newgui: Almost done with menu support

svn-id: r45838
"
"e035ef032bda4697ecd3410698e5b69ed9ce8d2b","2009-11-11 20:08:55+00:00","SCI/newgui: menu now only missing: menu invert, separators

svn-id: r45839
"
"7f83e9873920ce4a5fb7756a011f1803abe30682","2009-11-11 20:29:39+00:00","SCI/newgui: separator line support for menu, also fixed item adjustment

svn-id: r45840
"
"889687c0c37e2bc525431c447e45123a2b8b5ff2","2009-11-11 21:02:49+00:00","SCI/newgui: menu done, separator line adjusted slightly, menu is now inverted as well

svn-id: r45841
"
"958ad94d8c54e97dacde560418758eb044945544","2009-11-11 21:06:06+00:00","SCI/newgui: setting as default

svn-id: r45842
"
"1bc60e9d8515c91576debcba6d618bc74258db11","2009-11-11 21:22:04+00:00","SCI/newgui: call menuReset() on game_init(), fixes double menu in pq2

svn-id: r45843
"
"94d05b3d0ad77fc80b2176ebb436360982d24c10","2009-11-11 21:32:07+00:00","SCI/newgui: if left/right walks into a separator line, do down instead of repeating left/right and thus skipping the menu

svn-id: r45844
"
"417487848238368ad9296df16e5292a53696e89c","2009-11-11 21:38:50+00:00","SCI/newgui: inserted comment about not following sierra completely here in interactiveWithKeyboard()

svn-id: r45845
"
"e0ae43ded79f1b968e6939b863f5e1bcd7144732","2009-11-11 22:19:17+00:00","removed default args from pop/show, added showMark/showMono options for dialog.

svn-id: r45846
"
"c0fc64ecbf8964a6047faf2c86240ca5e8608f4f","2009-11-11 23:05:19+00:00","LOL: - fixed transparency tables in PC-98 16 color version
- renamed some variables

svn-id: r45847
"
"d281fe4717f4dad20a0390e81ada17d10cead2bb","2009-11-12 00:45:28+00:00","Added runWrapper() calling run() and some actions around it.

This simplifies a lot of code calling run().  Also, scripts called from the
inventory are now called with disabled mouse and title, as desired.

svn-id: r45848
"
"c17e4f1b684daaf5a7c9b8a4e1985c66edb46401","2009-11-12 00:57:38+00:00","Subtitles are positioned correctly in the inventory

svn-id: r45849
"
"793761c6954d68e7b38afe54665a1f668f8acc68","2009-11-12 03:09:15+00:00","Fixed Script::icoStat()

svn-id: r45850
"
"13a2b24ab56335d95889f6c015414d1798d37be1","2009-11-12 03:25:10+00:00","Removed 2 TODOs

svn-id: r45851
"
"e36594dbe90c36d09e2c3c2d31b11476c5ddffbd","2009-11-12 07:41:33+00:00","LOL: - cleanup

svn-id: r45852
"
"c8f1afd24cfbb53b7e96c8ad376672092b9fa42f","2009-11-12 08:28:59+00:00","SCI/newgui: changed behaviour of menu when left/right to follow sierra. Added other differences in implementation, added reanimate TODOs, added mouse interaction TODO

svn-id: r45853
"
"226f0bd23d40f4c807c33ee32f77d449a4f06837","2009-11-12 09:24:46+00:00","The menu bar code is no longer used in the new graphics code, and the menu state is no longer stored in saved games

svn-id: r45854
"
"44afaf9bf1fb8a0c4c77bdf033324a7bea82a151","2009-11-12 09:27:41+00:00","Display/remove the inventory based on mouse 'gestures'

svn-id: r45855
"
"94f5c0a2f85a181c6b42f2851270b46de603e1cb","2009-11-12 10:07:44+00:00","Added a staticres file with the MADS articles list, and added an article field to the MADSObject class

svn-id: r45856
"
"ec235d7463c69784fb2de1cdf915279f37a714e1","2009-11-12 10:32:29+00:00","fixed dialog positioning for mark

svn-id: r45857
"
"c45c335e0d303bd179beabe9013caf67893768d4","2009-11-12 11:47:28+00:00","Some more tweaks for skipping the menu data in savegames, when INCLUDE_OLDGFX isn't defined (it still problematic and goes out of sync)

svn-id: r45858
"
"d1dc586aa39cbcc2b1f8136f50494d0bb5fc9757","2009-11-12 12:49:17+00:00","SCI/newgui: SciGuiMenu now has said support (used in at least codename iceman)

svn-id: r45859
"
"1351703dc0f911cb94d73275371007132295bbdd","2009-11-12 13:01:35+00:00","SCI/newgui: SciGuiMenu adjustment, when no right aligned text is available at all (makes lsl6 menu pixel perfect)

svn-id: r45860
"
"3d796d6c088677ab30f1aae0226651f46d46013f","2009-11-12 13:29:09+00:00","fixed intersects functions

svn-id: r45861
"
"fbfafb576e14bdd31d69eb1b6a262bb8d667e852","2009-11-12 15:24:11+00:00","Started objectifying kDoSound()

svn-id: r45862
"
"b85c254c5f06dd4cbcc2f2d17cc28f0dc59bc579","2009-11-12 16:20:19+00:00","SCI/newgui: support for disabled menu entries, changed textface (int) to greyedOutput (bool)

svn-id: r45863
"
"b3f97d9b73d4948f68882ab304bcc7cc78bd1b32","2009-11-12 18:27:16+00:00","Silenced GCC warning. Since command is unsigned, it's always >= 0.

svn-id: r45864
"
"d4057ea90a65eea08068b1076834d2ac4836fcf3","2009-11-12 18:46:51+00:00","samsungtv: disable SDL_UpdateRects it make worse

svn-id: r45865
"
"f716959c1a67a5381470a387055e71cf4eb4ed33","2009-11-12 19:02:59+00:00","SCI: Fix crash in Iceman/amiga.

svn-id: r45866
"
"83c7b6b6b6f0b30876384d9d6e4b4fd27a604ba9","2009-11-12 19:11:50+00:00","SCI/newgui: SciGuiFont fixing delete

svn-id: r45867
"
"32ec8647a6717768b92c4c3dff5950c0700417a8","2009-11-12 19:16:55+00:00","SCI: Fix uninitialized variable in Amiga driver.

svn-id: r45868
"
"67ce14622ad62e9ba874e45772bcbd46079c885d","2009-11-12 19:27:26+00:00","SCI/newgui: SciGuiMenu forgot to reset memory handles after restoring

svn-id: r45869
"
"06c73ee29f6bf361bba724992ca483f02db53173","2009-11-12 20:44:37+00:00","samsungtv: fix sdl surface type

svn-id: r45870
"
"5aaf66641bbffdde69ef9df4cf142ebf764e8744","2009-11-12 21:20:04+00:00","Fix warning

svn-id: r45871
"
"fc0c195ea39a2c6026a5a261ab89059db03245d2","2009-11-12 22:41:14+00:00","Implementing switching to/from the map room by mouse

svn-id: r45872
"
"24ccc94f7983700e7ae89532000b3a080f9a42f0","2009-11-12 22:52:00+00:00","Implemented 'Mute All'

svn-id: r45873
"
"0a2b2a22568d6d6fc5e4d4f54e77afa04570cd59","2009-11-12 22:57:01+00:00","Removed 2 old TODOs

svn-id: r45874
"
"5db47f54c3cf85fcc7f48e12029ac1032cc43031","2009-11-12 23:12:34+00:00","samsungtv: enable text console

svn-id: r45875
"
"de6dc9a78456e77dc10bda74b91d5f59f4c0fbd3","2009-11-12 23:33:22+00:00","Handled loading/saving from the map location

svn-id: r45876
"
"82dfea7e56f2530ed6f0e851d919d2de796df88f","2009-11-13 00:31:36+00:00","samsungtv: remove more code duplication in the backend, based on Max patch

svn-id: r45877
"
"0bbb62771a820cec774fecb605869d4664b2e83a","2009-11-13 00:37:53+00:00","rename sdl.*->samsungtv.*

svn-id: r45878
"
"42d0aa04e2f27b7b6895c7a65590f46215d8f160","2009-11-13 00:43:33+00:00","update includes

svn-id: r45879
"
"1f00ac2e19a03a0ad7ee596128658497b53f172d","2009-11-13 16:07:45+00:00","samsungtv: fix hasFeature flag

svn-id: r45880
"
"cb7b147881a3c47b015536884474d33e0cfe2e4c","2009-11-13 20:51:42+00:00","samsungtv: revert last hasFeature change, feature kFeatureCursorHasPalette is needed

svn-id: r45881
"
"f721078edfd81d7cab82aee6910a12356bad217a","2009-11-13 21:01:09+00:00","samsungtv: remove code duplication

svn-id: r45882
"
"f031cb2415494b5e8c2a4ad15bc4ef019af25fb9","2009-11-13 21:08:14+00:00","samsungtv: ops that should not go here

svn-id: r45883
"
"75c696fdc67624ed0083b8cc41c039c7c828c97e","2009-11-14 02:59:21+00:00","Removed some unused parts of the PCM sound playing code

svn-id: r45884
"
"e2985a41735f16ce17944b4d9c32004faac294d2","2009-11-14 03:15:20+00:00","Removed sfx/misc.h

svn-id: r45885
"
"40570ddf212c25c4879f9a359191b21bc93f9adf","2009-11-14 03:21:42+00:00","Cleanup

svn-id: r45886
"
"f449d6ded28393d3c6585280173bb581b0ae86fa","2009-11-14 09:02:02+00:00","Gob - Add MD5s for Gobliins2 and Little Red Riding Hood included on an old AD2 CD.

svn-id: r45887
"
"c91f89bd5643666ec1b681156a2342618eb83eba","2009-11-14 09:46:51+00:00","Removed more dead code

svn-id: r45888
"
"bed40c5a1331f88a6dc9cfe03ad59c16bfb2da91","2009-11-14 11:20:00+00:00","samsungtv: there is no point enable 32 bit

svn-id: r45889
"
"a6f954c365cc186bfd8770d088ffc3333c9224a8","2009-11-14 11:29:37+00:00","added cancel() for current action

svn-id: r45890
"
"772ac8ca709771fde478513addce3eec2eb4bbff","2009-11-14 11:32:39+00:00","made rects signed

svn-id: r45891
"
"cc1119940c833f7b61a977306c0a1a9cdf98cd6f","2009-11-14 11:32:58+00:00","added pathfinding

svn-id: r45892
"
"813fa3d3753618fc83311359d32412cc51f15309","2009-11-14 11:45:15+00:00","stick to the closest points to the destination instead of walkboxes' centers

svn-id: r45893
"
"5e136e559624ee1114adfe4b4c90f72d97bf49a7","2009-11-14 12:58:39+00:00","reduce code duplication, unconst pixel format

svn-id: r45895
"
"05a735c4428c51e8a050c4c55d06dedf34aace66","2009-11-14 13:04:17+00:00","SCI: Silence warnings (none of the code in seq/gm.cpp is used)

svn-id: r45897
"
"81762edf338be5394120787696d9af61a00a0f9d","2009-11-14 13:11:06+00:00","Remove Igor engine

svn-id: r45898
"
"1de89723fd07183a07a29e0d26efddf174529b1f","2009-11-14 14:02:53+00:00","gob - Add MD5s of english Adi 4.10 and german Adi 2.6

svn-id: r45899
"
"ace686aa3f0143aec0445a4dfe1a039cb80ac900","2009-11-14 15:46:38+00:00","samsungtv: continue reduction of code duplication

svn-id: r45900
"
"39695bcb024d6dcf2917234630bdfd9640385dc1","2009-11-14 16:16:47+00:00","Removed unused code

svn-id: r45901
"
"7c73bc2965e7a90e7e7a2de012b66fd321349d31","2009-11-14 16:19:25+00:00","Cleaned up the file handling functions and removed the C IO wrappers. Apparently, the special case that these were meant to handle never occurs (i.e. reading and writing to the same file), and the current code works well enough to justify these extra sanity checks

svn-id: r45902
"
"b6c46c752ccc5f5239d492c9b668ef89cd606f81","2009-11-14 17:53:30+00:00","Moved getAngle() inside kmovement.cpp, the only place where it's actually used

svn-id: r45903
"
"b9b5511b3c5e916366c20e251461f217b679054e","2009-11-14 19:34:44+00:00","Cleanup.

svn-id: r45904
"
"9bd5e07d90ad5693d96a557d66c919cf3097d34b","2009-11-14 22:51:35+00:00","KYRA: added kyra 1 pc98 static data to kyra.dat (intro forest sequence is still broken)

svn-id: r45906
"
"c80456dd17817d87da5ac9c57f65d66b0b6ebc71","2009-11-14 23:01:51+00:00","Fix warning.

svn-id: r45907
"
"4f85684931d2cd390dbe0c76a40a2319458cfbdd","2009-11-15 00:53:57+00:00","KYRA: cleanup

svn-id: r45908
"
"d3fb917ee87f5bc000a7b803074e55599c8b05e9","2009-11-15 02:37:15+00:00","Formatting.

svn-id: r45909
"
"b2074291617725e35358d922847f890b9af55d8b","2009-11-15 02:37:37+00:00","Cleanup.

svn-id: r45910
"
"6bb2b8aa9a5c1e04828a6ce1ddde72b5d4292fa9","2009-11-15 08:22:14+00:00","Added support for needed MADS game configuration options

svn-id: r45911
"
"67442c230ca364524eb245e203e2d3cc96db7e05","2009-11-15 08:22:57+00:00","Added display of the rotating inventory objects

svn-id: r45912
"
"ed81c0c35dd652c54bab4b345ec647d9d5b99635","2009-11-15 09:51:54+00:00","added missing callback

svn-id: r45913
"
"73a8d06cf46cdddb8bef87ee8bb01d9a5bb5854b","2009-11-15 10:15:39+00:00","added face animation.

svn-id: r45914
"
"cae613cb05b5537519e0e811adc4610d3aef0eda","2009-11-15 10:49:57+00:00","implemented src_rect for surface blitting, added proper animation frames.

svn-id: r45915
"
"f0b2b924b1388679cd8be2f7c5110f18e92990d4","2009-11-15 10:54:29+00:00","added actor_talking flag

svn-id: r45916
"
"196401df628298f5f7b763aa1b71293aa4def705","2009-11-15 11:07:52+00:00","added real face animation handling

svn-id: r45917
"
"461bcae59f3bbb60071ffc69947dd02b7436cc21","2009-11-15 11:24:20+00:00","removed bogus message speed code

svn-id: r45918
"
"7a12bbd1cadc5bdeb8edff4ca5020ba0aa065b61","2009-11-15 11:59:31+00:00","xcode project update

svn-id: r45919
"
"b25afc85a69573ee81cebce788f839cba9c792f7","2009-11-15 12:18:13+00:00","Build fix for 64-bit OS X

svn-id: r45920
"
"3e34b1bbab49aa5b0e4a701589fcfe93c03e93d7","2009-11-15 12:20:22+00:00","Made Alt-s (screenshot) work again.

svn-id: r45921
"
"544daa5c315f2d598ebeefe43de675fdad1be18a","2009-11-15 14:14:49+00:00","- Started importing the music code from Greg's SCI engine
- Simplified some sound version checks

svn-id: r45923
"
"274b1306e301d638a65c92ae156e52c52012de29","2009-11-15 17:43:47+00:00","do not close inventory while displaying `examine` message.

svn-id: r45924
"
"58cd917bba1102be7f0be1708185619bb1978647","2009-11-15 17:49:26+00:00","hide mouse while displaying messages, hide item name while displaying item's description.

svn-id: r45925
"
"baf42879cb38542e5c4cfec18061b7f1f4767eb7","2009-11-15 19:12:46+00:00","added debug features for z-order testing.

svn-id: r45926
"
"9a57665abffa2aa3afcafabf3b4ecf0ad9cf458c","2009-11-15 21:25:26+00:00","LOL/PC-98: fixed regression (missing static data for pc98 version)

svn-id: r45927
"
"f6eae4aae526d9e8b992e01bf6f8c8f7263ba0a4","2009-11-15 21:31:04+00:00","z-ordering fixes again :(

svn-id: r45928
"
"bf1ab2f1db932a82a57c971d3ee9676c901f30a9","2009-11-15 21:49:03+00:00","Make _mouseKeyColor a uint32 when USE_RGB_COLOR is defined to fix key color with some cursors when using a >8bpp cursor.

svn-id: r45929
"
"1123f7bcc5b2e465ef8352ef8cc2d3c43c253ae9","2009-11-15 21:56:16+00:00","samsungtv: remove duplicate entry

svn-id: r45930
"
"737f9312e5c9f2974880314cd3c69d437ed2b69d","2009-11-15 21:57:28+00:00","samsungtv: no need anymore exception for broken SDL_ShowCursor

svn-id: r45931
"
"3013a63890679bfb7be9aa7d7398935c23751307","2009-11-15 23:26:47+00:00","LOL: fixed minor glitch in the ending sequence

svn-id: r45933
"
"8d99384ab99ed84eba2dd010b6a7a14748c419f5","2009-11-15 23:39:55+00:00","Some more work on music code

svn-id: r45934
"
"3ccdaa72c3b1dddff1db0421c847ead3e4714319","2009-11-16 17:15:33+00:00","gob - Preliminar saveload for Fascination

svn-id: r45937
"
"4d8ae559edb9fcdfcbf0ac2b630d5c051c120ae0","2009-11-16 17:21:18+00:00","gob - Add 'adibou2', rename 'adibou4' into 'adi4', add several Gob1, Gob2, Gob3, Adi2, Adi4, and Adibou2 MD5s

svn-id: r45938
"
"09cdfac8c4e3ec7b0780292c0403a2de384bb95d","2009-11-16 21:13:21+00:00","samsungtv: remap keycode, main tv software tell with SDLK_POWER to imediately quit sdl app

svn-id: r45939
"
"836e5c088eb0edbd224a27816768a0c6eda3c6cb","2009-11-16 21:27:09+00:00","samsungtv: no need workaround to subclasses, alternate sdl static library works fine

svn-id: r45940
"
"4f0dfb0d0965627eb0a01eecf5772da75ed7548a","2009-11-16 22:29:57+00:00","Gob - Add MD5 for Adibou 1, a new SCN demo and some Adi2, Adi4 and Adibou2 titles

svn-id: r45941
"
"4ce5d81a4d8fcd8a23e2db99f192887cb3922fa9","2009-11-17 06:39:28+00:00","Some more work on the sound command parser

svn-id: r45944
"
"61ed19f89259ecdaa828153a8d8b5272c37f6add","2009-11-17 07:35:57+00:00","debug walkbox displaying by ctrl-5

svn-id: r45945
"
"b0ca65a9a80513b86894659561c6b672871f343e","2009-11-17 07:44:40+00:00","reverted old z-order

svn-id: r45946
"
"6132537908a64dd1a867785854c28090faa0d49a","2009-11-17 07:55:24+00:00","fixed backtrace matrix initialization

svn-id: r45947
"
"c331ad155d9b0c2baba6fe20fdc914086f67d322","2009-11-17 08:57:51+00:00","corrected overlay z-order based on bottom coordinate (fixes chair in captain's room, and RGB chief table z-order)

svn-id: r45950
"
"98d14d19dabe74a381a6ce6653292b42c43cf208","2009-11-17 13:11:56+00:00","samsungtv: enable hqscalers

svn-id: r45951
"
"e105a6ffc24e48029ab285d34d3d1c2f95ca5a24","2009-11-17 14:13:15+00:00","samsungtv: since new sdl lib port support mouse and keyboard, adopting handle remote controller events

svn-id: r45952
"
"0d20aafb046b75d826037d061316a21ec0152a18","2009-11-17 14:27:11+00:00","samsungtv: cleanup

svn-id: r45953
"
"236eecac193138d3e1511e24fd7e2ccd18b28b99","2009-11-17 15:01:16+00:00","Some more work on the sound command parser

svn-id: r45954
"
"d6ad3c51aa444c5a6e673fe0c071a11360deca73","2009-11-17 16:21:25+00:00","samsungtv: added package resource files

svn-id: r45955
"
"99111a75c1b8a7df05a05cad53867c43918a1217","2009-11-17 16:26:40+00:00","KYRA: fixed save menu glitch in Japanese versions

svn-id: r45956
"
"a9dc8215bb90f7e6944b729fcf4751fa72bf0120","2009-11-17 20:47:03+00:00","found strange hack about room 7 and overlay.

svn-id: r45957
"
"f2a704cb4f3e719cd4b08fc803fc5fe4a99a2fd7","2009-11-17 21:00:28+00:00","corrected scene 7 hack

svn-id: r45959
"
"43f23ee523b05d77a61d4a0335edcc89d6ca1229","2009-11-17 21:42:56+00:00","added SurfaceList, ported overlay to it, fixed many z-order issues. (found meaning of the flags in overlay resources)

svn-id: r45960
"
"f70473e3cd7fa6c5d4691be7bdbd665dfb14e64d","2009-11-17 21:47:26+00:00","guard surface list from the sizes of zero

svn-id: r45961
"
"da1432cf21374b282c0cd2f85ae790fb792c925b","2009-11-17 22:09:16+00:00","implemented zoomed rendering

svn-id: r45962
"
"8f68974d2209020a16014d61374d48c180e8e205","2009-11-17 22:22:40+00:00","implemented real zooming in forest house

svn-id: r45963
"
"9013668a1648065806cdc58b30795da4d0175ae0","2009-11-17 22:24:49+00:00","removed noisy debug

svn-id: r45964
"
"618cade585dd5f5e260ba3c5fef46cab129cfbad","2009-11-17 22:45:41+00:00","added kEffect for screen shaking, fixed barman callback

svn-id: r45965
"
"79714a22c2767eab4f2b02703234ba58c356c9ac","2009-11-17 22:59:17+00:00","added face animation for the messages

svn-id: r45966
"
"2294c6f4667cbb3e7c32487b96c0e83d3f726420","2009-11-18 08:13:44+00:00","minor textual fixes

svn-id: r45968
"
"6e8595b814123cff18485998b50fe86430672348","2009-11-18 08:15:16+00:00","use actual actor position for overlay positioning to avoid z-order glitches.

svn-id: r45969
"
"c4c30ca3ce75dcc2059284f3751f0f124aa6dbbd","2009-11-18 08:32:41+00:00","more missing callbacks

svn-id: r45970
"
"424c5eea92ea9f272f6fee901725d528a060dd42","2009-11-18 10:14:30+00:00","samsungtv: no need make surface conversion here any more, sdl do that with internal emulation

svn-id: r45971
"
"b6b96d9452d1244f76f9c62d4ac4c297f9820ef9","2009-11-18 11:16:50+00:00","samsungtv: cleanup

svn-id: r45972
"
"9e5b8b4a331d142b50192a20e9b46c1739967018","2009-11-18 13:59:36+00:00","PS2: Remove custom OSystem::fillScreen implementation as well as clearScreen()

svn-id: r45973
"
"974b49ebfe6f71f45f38f70d12395bf1b3124888","2009-11-18 15:19:44+00:00","Put two of the WinCE downscalers into graphics/scaler/downscaler*, so that they can be used by multiple backends (more could be added as needed)

svn-id: r45974
"
"8aa4083bc9b41b49c582b1d342392c7e5d92dca8","2009-11-18 15:22:15+00:00","Modify WinCE, LinuxMoto and GP2xWiz backends to use graphics/scaler/downscaler* code (untested as of now)

svn-id: r45975
"
"a621435dc1ee0ba1ccca20da728c7b33422a1370","2009-11-18 15:23:16+00:00","cleanup

svn-id: r45976
"
"edee511ec24e6cf2c63777e21ff16f7533f33389","2009-11-18 16:02:10+00:00","WINCE: Use correct include paths

svn-id: r45977
"
"286a648ecd4bfd59aafc427ae8f5e563cbf4aac9","2009-11-18 16:09:38+00:00","Add -G2 to PS2 default build options; move some WinCE -D flags from CXXFLAGS to DEFINES

svn-id: r45978
"
"5e56184616d6ab0f971b0e84bb62756219ae786c","2009-11-18 22:59:31+00:00","fix compilation of null backend

svn-id: r45979
"
"6f45f68a0f255bf89b2dbea69064915e37e29dc4","2009-11-18 23:34:40+00:00","Some comments

svn-id: r45982
"
"c7e89bc18e03933aed48995d80af378a1f34f406","2009-11-18 23:35:50+00:00","oops

svn-id: r45983
"
"f9a1a5751ea246b23543cfd3e92dd5039c8bd158","2009-11-19 08:56:05+00:00","Fixed regression from commit #45862

svn-id: r45985
"
"113c720ee1b6bcde6fe1740ed9a059aad7a6967c","2009-11-19 17:42:51+00:00","Cleanup.

svn-id: r45987
"
"34b447147df73ba4ee282be69d8f4f9453ed3499","2009-11-19 17:43:15+00:00","More cleanup.

svn-id: r45988
"
"95eef902d529e4a4df2ad141d492dc347040a0d0","2009-11-19 17:43:39+00:00","Remove obsolete 'k2DemoVersionTlk' special.

svn-id: r45989
"
"2a4e630967036d5c308930609e06b86d24ab4158","2009-11-19 17:44:19+00:00","Properly handle Kyra 2 Talkie demo in kyra.dat.

svn-id: r45990
"
"34dd625228915141722af886d89722e928950abc","2009-11-19 17:56:48+00:00","Add newly added IDs to string table.

svn-id: r45991
"
"1a984d8e7d1e8e4e6456c73004d2d0f6bfae10ee","2009-11-19 22:17:27+00:00","LOL: add support for pc speaker sfx

svn-id: r45992
"
"746f391b8a05e56f9f3f9c810bf809e6e54415fa","2009-11-19 22:22:08+00:00","Cleanup.

svn-id: r45993
"
"eefa01af68ec398219daa8ca8c8389f03a8bc48a","2009-11-19 22:57:26+00:00","Simplified some music checks for SCI0

svn-id: r45994
"
"f1036e47ad41d01f15abf5832cee6904b1aff46c","2009-11-19 23:05:12+00:00","- Simplified the different feature detection types, removed some duplicate code and merged the feature detection code which relies on selectors
- Replaced the function checksum calculations to make it more apparent what the feature detections do
- Removed the now obsolete (and unused) firstRetOffset function

svn-id: r45995
"
"a50bb2ceb42cab37f3a7c7d9c43a30aa7b068b07","2009-11-20 00:12:28+00:00","Don't include windows.h & direct.h on WinCE (and Symbian?)

svn-id: r45996
"
"5c23e28a652ac45a56054f7251789cbe22fa3acc","2009-11-20 00:12:46+00:00","Several configure targets use long instead of int for typedefing uint32/int32. It is not clear why. In order to find out if this is needed I disabled the relevant code for each in configure. If this causes results for any port, we can add this back, along with a precise explanation as to *why* 'long' has to be used.

svn-id: r45997
"
"329516cf283f74d5b2f0f3201e27a9de2555bdd3","2009-11-20 00:13:03+00:00","Fix language in comment

svn-id: r45998
"
"1063a029a5768fab83aa6703cd15c8b484e15fbc","2009-11-20 07:35:48+00:00","Typo

svn-id: r45999
"
"81d3a24cce060574dcc4312b4f0f6c534225eda8","2009-11-20 08:52:32+00:00","- Rewrote the lofs parameter type auto-detection code
- Renamed dissectSelector -> autodetectFeature

svn-id: r46000
"
"2f6ded8727f645579dd958fa6c8a7127ce6cca00","2009-11-20 08:55:35+00:00","Shifted some code around

svn-id: r46001
"
"893a8bb808822b78573af80ce29b9e794331b482","2009-11-20 10:29:42+00:00","Some corrections for the lofs autodetection - SQ4 floppy works again

svn-id: r46002
"
"d1616ea74e1997756c757d33bf4bdf3a4ae7fc5f","2009-11-20 11:08:19+00:00","Added a sanity check to prevent a crash in LB1 and KQ4 (needs proper fixing)

svn-id: r46003
"
"a70aa90f6285b128bd75d537b504960b767e5468","2009-11-20 13:08:33+00:00","do not trigger any events while scene id == -1

svn-id: r46004
"
"e7820f972d3c186e241fff34b42ddada3583c443","2009-11-20 13:29:42+00:00","Selector cleanup: rearranged all selectors to be in the same order as in Sierra's dictionary files, and removed several unused selectors

svn-id: r46005
"
"551ca5f2c0d2806c77a7a6bb69d53c12a12021cc","2009-11-20 14:17:47+00:00","Changed the lofs detection to iterate through all the methods of the Game object again, instead of a specific selector - fixes Jones

svn-id: r46006
"
"7d3501397d71665f9ac195738b0aace3e4ce297f","2009-11-20 14:47:43+00:00","Formatting

svn-id: r46007
"
"94c8f77faac80cf9f431ad530d9ec5c6e3672c2b","2009-11-20 14:51:15+00:00","Added a game-specific workaround for setCursor detection in KQ5CD: the code for the setCursor selector has not been rewritten yet to use cursor views (it's the same as lsl3 and sq3, for example), but the game does use cursor views

svn-id: r46008
"
"662fc11d67edea9142f226e1fe73ef053ab476c3","2009-11-20 15:16:03+00:00","Check the overridden game object when performing setCursor detection, which properly fixes KQ5CD (thanks waltervn)

svn-id: r46009
"
"1ea30ca176441a2a440901cce4c99ffa5493b977","2009-11-20 15:17:14+00:00","Removed more unused selectors

svn-id: r46010
"
"22c09f521aa5d4a220d53a8f8b3b277623b128a6","2009-11-20 15:31:08+00:00","Removed more unused selectors - the canBeHere selector is replaced by cantBeHere in SCI1+

svn-id: r46011
"
"cf1d7f92591685db315e0f970787a64e835b6518","2009-11-20 16:39:31+00:00","- Removed the non-static selectors 'overlay' and 'setCursor' from the list of static selectors and introduced a new method for discovering the relevant features when selectors are missing - currently used for determining the graphics functions and setCursor types
- Simplified setCursor detection a bit

svn-id: r46012
"
"85b44876ea581170e13fb978ac5935d99271eec7","2009-11-20 16:48:51+00:00","Added a FIXME for the syncTime and syncCue selectors, for games which don't have a default selector dictionary

svn-id: r46013
"
"fd31881e60174a75dc3b5da52fabe790234a4e4f","2009-11-20 19:31:33+00:00","Some name consistency changes.

svn-id: r46014
"
"65075ffe97779fe2a3747ec7c1d5656cd9d0a290","2009-11-20 19:32:15+00:00","Merge two file game entries into one game entry, this allows for better input file validation.

svn-id: r46015
"
"cf28e38ae114554f4443b890dc4ec820d1992e89","2009-11-20 19:33:08+00:00","Rebuilt kyra.dat.

svn-id: r46016
"
"685ca0a58d0ef2d0492bfff8de65b81ca4e68a39","2009-11-20 19:40:40+00:00","Add a nice message, when none of the input files is used for processing.

svn-id: r46017
"
"16145c431a87a977db68617da08391d8b5685643","2009-11-20 19:48:07+00:00","Cleanup.

svn-id: r46018
"
"57c87745e11224c8b93d92ac5d286b803f5d6212","2009-11-20 20:30:31+00:00","Removed the syncTime and syncCue selectors from the list of static selectors, along with their relevant FIXMEs. These selectors are used for lip syncing in CD talkie games, which always got a selector vocabulary, so we don't need to hardcode them. Did some further simplification/rewrite of the static selector tables

svn-id: r46019
"
"c5a7208975f39e9ece0da4bdbf0ce90890040097","2009-11-20 20:32:25+00:00","Fixed a regression in the LSL1 and LSL5 demos, which should work correctly now. Some cleanup

svn-id: r46020
"
"f0aebf479f7bc1da6c51ab6e91611eaf341e2b00","2009-11-20 21:23:39+00:00","Readded output whether extraction succeeded or not.

svn-id: r46021
"
"90ba6a8c7a2d79bd91525262b1ca4af94ff1b37e","2009-11-20 21:24:15+00:00","Flag Kyra3 as talkie version in kyra.dat.

svn-id: r46022
"
"10749246862069d8a73fc2ae46776120fe72cf58","2009-11-20 21:24:40+00:00","Cleanup.

svn-id: r46023
"
"bb5d29be80b807a7b4b48795da87c8e5fd5e88d1","2009-11-20 21:25:01+00:00","Fix missing printf arguments.

svn-id: r46024
"
"3ee2d9375c1fb9ad3972036123c83695abe50caa","2009-11-20 21:25:36+00:00","Changed kyra.dat to use a global 'INDEX' file instead of INDEX files for every game variant.

svn-id: r46025
"
"8b4dabea834443d317a2f849e38d581fcb0eb86a","2009-11-20 21:50:17+00:00","Fixed game restarting regression

svn-id: r46026
"
"dac154e76cc175b5ef78cfa4088a724c141b177e","2009-11-20 22:38:50+00:00","Removed dead code

svn-id: r46027
"
"10fbefcd60893f67bb10755d72430e7e60208d65","2009-11-20 22:39:57+00:00","Simplified the doSound detection a bit

svn-id: r46028
"
"ece0444f9c1e1ae2485c7264214c2f29a2cfe92c","2009-11-20 22:41:17+00:00","Changed some comments back to DOxygen (inline) style and removed some more dead code

svn-id: r46029
"
"fd116847bdb1c606a116ff133bdfd078ec03d2c7","2009-11-20 23:37:56+00:00","Fixed sound detection for Jones CD

svn-id: r46030
"
"4fbfe1741c63fa3101003f9fcbc991589f5efc91","2009-11-21 03:45:25+00:00","Cleanup.

svn-id: r46032
"
"bde4cbb04d7f2e1dfda15f7128a28318a0bdc1cb","2009-11-21 03:46:52+00:00","Merge multi language games into one entry.

svn-id: r46033
"
"cb1e66f21e74c8c4a8673a8756f05403e9b10e0c","2009-11-21 03:47:54+00:00","Rebuilt kyra.dat.

svn-id: r46034
"
"1ede080ed9020e62468b7e43e44c5747f19b9231","2009-11-21 03:48:53+00:00","Add proper error messages, in case some entries aren't found.

svn-id: r46035
"
"0b8bc495aeb2bf497b7e4e37e7fe451a616e6681","2009-11-21 03:49:55+00:00","Fix various platform/language table entries.

svn-id: r46036
"
"641d55b1255a1a56b987895babb275e1c561c67f","2009-11-21 03:51:18+00:00","Speed up extraction by only adding matching providers to search list.

svn-id: r46037
"
"bada077c2657dd4aa5669b1ba087ddd2c09693d8","2009-11-21 15:41:01+00:00","Removed duplicate code and simplified some feature detection

svn-id: r46038
"
"53550e50cff640efc3ceefbf5ae6c7bda3ad6801","2009-11-21 17:04:52+00:00","Rename 'kPaletteList#' to 'kSpecialPalette#'.

svn-id: r46039
"
"7a8e452f12094a390e035c714832eb49084dddf1","2009-11-21 17:05:33+00:00","Change special palette loading for Kyrandia 1 from kyra.dat to match kyra.dat internals.

svn-id: r46040
"
"fcf9c4f5a24bf967077f69b2a497a0d70727c57f","2009-11-21 17:06:07+00:00","Cleanup.

svn-id: r46041
"
"3837f8ff83c89cb563020cea2b2999e90879f17c","2009-11-21 17:29:06+00:00","Resolve TODO.

svn-id: r46042
"
"33c31067987fcfbbd9b53d0f5d66075e8cd38645","2009-11-21 17:29:36+00:00","Naming consistency.

svn-id: r46043
"
"9297e62aed73f313f932276f392e68e17cfc04b6","2009-11-21 18:18:09+00:00","Fixed re-entering the same room using a different gate

svn-id: r46044
"
"aad8e8a2a218209e191f08b7ca415a0121d3f4d1","2009-11-21 20:18:51+00:00","Add comment why pattern is converted to lowercase in FSDirectory::listMatchingMembers.

svn-id: r46045
"
"e8c67bda4b1ac85ee4555247e30eb1b65e408055","2009-11-21 20:19:15+00:00","Change Archive::listMatchingMembers to match the pattern case-insensitively.

svn-id: r46046
"
"bf5ce985a0807e0756702e092ee43255a725c692","2009-11-21 20:20:24+00:00","- Got rid of hardcoded filename list for kyra.dat
- Synced static resource definitions between KYRA main codebase and create_kyradat
- Rebuilt kyra.dat

svn-id: r46047
"
"1ba750063c5034c8cfa383dc9f33e25ace95ee63","2009-11-21 20:26:55+00:00","Ooops...

svn-id: r46048
"
"1ade0efbf208ffb96b6ea8cfe474540530b340ee","2009-11-21 20:30:38+00:00","Flag credits data for Kyrandia 1 as language specific data. (Fixes language of credits for Amiga versions.)

svn-id: r46049
"
"849594fb30768d2c816f533cc9533dcb86f34373","2009-11-21 20:38:39+00:00","Fix Kyrandia 1 FM-Towns credits entries in kyra.dat.

svn-id: r46050
"
"ea5bf444d3654fcdcd649456ee5d63bb4deaa72a","2009-11-21 22:15:20+00:00","Fix mismatching resource type IDs for Lands of Lore in kyra.dat.

svn-id: r46051
"
"77fda6cf93497c738adf9cb87e4efbd9a009b000","2009-11-21 23:05:25+00:00","Cleanup.

svn-id: r46052
"
"d167197a528914a525cde5a62ff43b9c96e06c58","2009-11-21 23:06:22+00:00","Cleanup: remove never used support for builtin static data in StaticResource.

svn-id: r46053
"
"ed1c0fcde8c9e02e187b02caf8d30d9b17dc3150","2009-11-21 23:23:07+00:00","Cleanup.

svn-id: r46054
"
"a2b056c28802f1c69561dd22752f19e44173537e","2009-11-21 23:44:52+00:00","More cleanup.

svn-id: r46055
"
"509444cc9135e7d0bf7212ce01a1d61f8dcf0680","2009-11-22 02:42:15+00:00","Fixed Animation::getTopAnimation()

It does not return kTitleText and others.  This caused flickering of speech
texts on/off when the title got displayed under the mouse.

svn-id: r46056
"
"0ee8f879fa718a7507f1b22108b7d173edd7bdb5","2009-11-22 05:10:31+00:00","Fix positioning of one-time hero animations.

With the previous code, the position of the animation was doubled (due to
counting the position twice, the second time being a relative shift), which
put it mostly outside the screen.  This is because one-time hero animations
are actually stored using absolute coordinates.

svn-id: r46057
"
"5b9bfaee2b166f347225390ab0320343ccfd93a7","2009-11-22 05:35:36+00:00","Opening the inventory stops hero walking

(otherwise the relative animation would repeat itself unhandled until the
hero disappears from the screen.)

svn-id: r46058
"
"3ddf90a87206fa5b06b14c197deb4d5635699873","2009-11-22 05:42:46+00:00","Only enable changing rooms by left/right arrows when debugging

svn-id: r46059
"
"9886c8fb91f12e0e0fad9a9ae92a09d4a98a4a67","2009-11-22 08:02:27+00:00","fixed first mansion attempt animations

svn-id: r46060
"
"2d31fc3af87526eefb63746c77ea3e7e7d32e90a","2009-11-22 08:20:20+00:00","Add patch for Tobias, for Kanji support in Japanese PCE version of Loom, with minor changes.

svn-id: r46061
"
"9b20e622d956ebb092ba4762853dc51d78d08d05","2009-11-22 08:27:41+00:00","do not decrement timer while scene is busy

svn-id: r46062
"
"4b3e3d5601d32f2323634612124d2bf16aa7a4db","2009-11-22 08:36:05+00:00","minor callback fixes

svn-id: r46063
"
"94e75b8b6d24f3ad0e0dc9f4e6e789948e31f48e","2009-11-22 08:36:14+00:00","Fix charset palette in PCE version of Loom, based on information from Tobias.

svn-id: r46064
"
"d5d3ca66ce174e8c0b95c288f991a047f2f718d7","2009-11-22 08:49:19+00:00","Add patch for Tobias, for more accurate palette in PCE version of Loom.

svn-id: r46065
"
"d81bb78053453b02e36b1aa7b2a972931ddbd549","2009-11-22 08:55:36+00:00","Add patch for Tobias, for cursor palette in PCE version of Loom.

svn-id: r46066
"
"2397efd73014b6a4303e724360986f14ed29addc","2009-11-22 09:13:05+00:00","Fix SIGSEGV by an absolutely brutally horrible hack

I have thoroughly documented why this hack is needed and added ideas how to
fix it properly.

svn-id: r46068
"
"5ab550da20b86b3f09ec7a675616b942143f1f91","2009-11-22 09:17:33+00:00","Update game details for English PCE version of Loom.

svn-id: r46069
"
"4bd395a1eeaaddb96dce3ffe85ed7fb561c98820","2009-11-22 09:21:40+00:00","Updated an urgent TODO to make the game playable

svn-id: r46070
"
"354ddd8bc6e331f7d86beb1a96bbfc3a7ff378d6","2009-11-22 09:23:15+00:00","Update.

svn-id: r46071
"
"326eb2230b9892c7ea9ab673ed70bcb74386f48a","2009-11-22 09:31:07+00:00","Update game details for Japanese PCE version of Loom.

svn-id: r46072
"
"00708d056ace8c4646e296e47c48c919a258d7a9","2009-11-22 10:56:49+00:00","Added hard-coded cursor, and adjusted the colours slightly, for the PC-Engine
version of Loom, based on information from hennymcc.

svn-id: r46074
"
"55c03b9aab64fc2f8b38cc2442619e6a60702297","2009-11-22 11:00:14+00:00","Better make sure that cursorPCE[] has 16 elements, like some of the other
hard-coded cursors.

svn-id: r46075
"
"1d948f1012d362866faaa7a539d1f24e3e09ca62","2009-11-22 11:12:26+00:00","Virtualise drawBits1().

svn-id: r46076
"
"00d1143268bbc296fd69f04628904dbdf25e6ea0","2009-11-22 11:13:59+00:00","Fixes to the NEWS file:
- Fixed a typo
- Marked some GSoC tasks
- Fixed entries' alignment and line length
- Fixed punctuation

svn-id: r46077
"
"6c2cc3e1bbc626f671432fa0a37d6317222caa5d","2009-11-22 11:36:30+00:00","Removed the incorrect line in CharsetRendererPCE::drawBits1().

svn-id: r46079
"
"bb0c7657316942859a7a8575236320cf819d07c6","2009-11-22 11:43:12+00:00","Exclude Loom PCE engine specific code, from non-16bit color build.

svn-id: r46080
"
"40504d781032581d0a37d0d996909e5f7084dae9","2009-11-22 11:58:14+00:00","Add patch #2876221 - FBEAR: Fix for MIDI piano notes (DOS version), with minor change.

svn-id: r46081
"
"7b4771bd9f9e4776302fb2c1b2e7fb5153e7e539","2009-11-22 13:34:58+00:00","Add mapping of TM and (C) characters in PCE version of Loom, based on information from Tobias.

svn-id: r46083
"
"faceb8d41fd2e54af2d4354a1f9ba8cfe355616a","2009-11-22 13:37:33+00:00","Remove obsolete check, since HE72+ uses separate function.

svn-id: r46084
"
"0edf7332b253f7e42165c10b956598ce451aa15f","2009-11-22 13:38:18+00:00","Remove obsolete check, since HE72+ uses separate function.

svn-id: r46085
"
"054dd568a40bc82733cf001e9bdd4e16450f5e83","2009-11-22 15:06:32+00:00","Check which DoSound method is actually invoked from Sound::play, to remove a hack for Jones CD. Added code to handle games which don't actually call SetCursor inside Game::setCursor (like KQ5CD)

svn-id: r46086
"
"09f7df09e6d4a2b6a8396a41c6ce79a9736f2dd1","2009-11-22 15:22:23+00:00","Added a sanity check to the setCursor detection

svn-id: r46087
"
"a89fbc0fa5f424a69caaa4099cb827af2cd959d0","2009-11-22 15:58:34+00:00","Added a codesigning step to the iphonebundle make target

svn-id: r46089
"
"45856206e6eea615da78a00ba086cb2a1291c6d7","2009-11-22 18:15:07+00:00","Little cleanup.

svn-id: r46090
"
"d2d3a9a9eb821346632c46c26b0d750fea0d575e","2009-11-22 18:16:25+00:00","- Store ID map for static resources in kyra.dat instead of hardcoding it in the main KYRA source
- Changed how static resource types are specified
- Rebuilt kyra.dat

svn-id: r46091
"
"fa849494798c5df5f74d2895a6155093cd90b2cb","2009-11-22 18:17:05+00:00","Remove dead code.

svn-id: r46092
"
"485159f0dcfa41d9d95b0c5c7e5cc223dcd3caf4","2009-11-22 18:21:40+00:00","Slight simplification.

svn-id: r46093
"
"3d687d07f5d57b61fe2a454e6ec05667125dad00","2009-11-22 20:02:13+00:00","Fixed assert() on already loaded animation

Now the game seems fully playable with crazy loading all the time, even
though it is a hacky solution.  Updated the TODOs

svn-id: r46094
"
"00063b142303483cfea7fc2522ac45daaa7025f4","2009-11-22 20:17:39+00:00","Clearing object animations in a cleaner way

Verified that we really do not need object animations even if they are in
a different location, and clearing them thus regardless of their location.
Although the game was not crashing due to previous work-arounds at this
moment, this cleanup obliterates the most horrible hack and makes sure
animations will never get stale.

svn-id: r46095
"
"772b89682d7ae314d1b776f6c47ab10ac6d865cb","2009-11-22 20:25:27+00:00","Make sure hands are empty after loading the game

(otherwise we could have in our hands an unreachable object).  This works
thanks to moving clearing _currentItem into putItem(), which gets called
in inventoryReload().

svn-id: r46096
"
"d3d16422e0177942fcf5045cc65585c10d0da9b0","2009-11-22 20:44:37+00:00","Further cleaned up the hack with removing old animations.

Now only a long-term (complete rewrite) TODO is left in the code, but nothing
urgent to solve.

svn-id: r46097
"
"f6f8b66d455d73fb72e8c4547d763d9d9d115386","2009-11-22 21:12:23+00:00","Remove obsolete and unneeded logic bypassing reloading a location.

I have tested that this could only possibly happen when the game has been
loaded with last location being the map.  Then pressing Escape calls
enterNewRoom() and this superfluous optimization takes place.  It is harmless
to simply reload the map.  After having removed it, enterNewRoom() needs not
return any return value, because the test at the tail can be done by the
caller.  I have then restructured the code a little to make it cleaner.

svn-id: r46098
"
"604ed73b87e908475a8e2faf1d01d5e03fa14587","2009-11-22 21:27:30+00:00","Move setIsReloaded(false) in enterNewRoom() to the right place.

Last commit moved it below, but that cancelled GPL2 programs run right
after loading the game.

svn-id: r46099
"
"a7e6745ba49cf3fd2b0b2556c828d7d6b3202965","2009-11-22 23:33:58+00:00","Some PCE BIOSROM's have a 0x200 byte header. We need to skip that if it's present to get to the correct font data.

svn-id: r46100
"
"95d4c62efbf7b083716d1d2c4a0870eb58dcbc74","2009-11-23 06:44:40+00:00","Fixed breaking long lines instead of using smaller font (which is sometimes not enough)

svn-id: r46101
"
"ecbd0a0d539c7a0119b0cadef79527960ac22225","2009-11-23 15:31:58+00:00","Optimized object property access speed

svn-id: r46102
"
"016f343ca753077eb68b1fced19604aae785e755","2009-11-23 22:27:52+00:00","Remove SCUMMVM_USE_LONG_INT

svn-id: r46103
"
"68ebbf9022357b4a01063fe7354957c8df296346","2009-11-23 22:28:14+00:00","Remove obsolete OSX & NDS specific stuff from StdioStream code

svn-id: r46104
"
"6312da6d13b15c4b71f324c0106c8883ee024f45","2009-11-23 22:28:44+00:00","PS2: cleanup

svn-id: r46105
"
"f3c6e07feb97d6d7946ebaab0d27407722ca30af","2009-11-23 22:29:02+00:00","Fix bug #2901669: AMIGAOS4: Compiler error

svn-id: r46106
"
"3d342bec3c099039efe2452b08ea525002eac7b2","2009-11-23 22:29:39+00:00","PS2 & NDS: Remove ps2_fprintf and some useless typedefs and #defines; use fputs instead of fprintf

svn-id: r46107
"
"6b8dd7ab7af6353f656ece14fe13c6cc4a93c5e3","2009-11-23 22:30:22+00:00","COMMON: Remove various variants of the md5_file / md5_file_string funcs; turned the (disabled) MD5 test code into a working unit test

svn-id: r46108
"
"fe48378eb258bb045fac92213b70cbbf914c8c4b","2009-11-23 23:15:44+00:00","Remove unnecessary #include errno.h

svn-id: r46109
"
"9b8c088af5c56366f176fee334f636f40b1b156d","2009-11-23 23:17:15+00:00","Add patch #2898231 - LOOM: Sound player for PC-Engine.

svn-id: r46110
"
"fc84e258b29dc441f63dd53abd4cd494e03e4463","2009-11-23 23:17:50+00:00","PS2: Add new PS2FileStream class for std I/O.

* Add new class PS2FileStream as substitute for class StdioStream on PS2
* Remove PS2 specific hacks from stdiostream.cpp / class StdioStream
* Remove various ps2_f*() wrapper funcs, merging them into PS2FileStream

TODO: Merge class Ps2File into PS2FileStream

svn-id: r46111
"
"ddc4cc55fe5e9b35da8f278c8c0dcbdac87f8f6c","2009-11-23 23:20:54+00:00","Add PCE version of Loom.

svn-id: r46112
"
"dd0b4ed5dd1e2395dc4f1a3376814101b7ef473e","2009-11-23 23:26:16+00:00","Update credits.

svn-id: r46114
"
"e68a05ea60ecf561a4ebe440864941c9588fbede","2009-11-23 23:32:34+00:00","PS2: Further tweak PS2FileStream; fix potential leak in ps2_fopen

svn-id: r46115
"
"ebcb9b0ff01b8daf71e426978434506673d11609","2009-11-23 23:53:25+00:00","GROOVIE: Reduce header interdependency

svn-id: r46116
"
"e34f1415dba0d586e0b37350a082fd71bf50c5b8","2009-11-23 23:54:20+00:00","DRACI: Reduce header interdependency

svn-id: r46117
"
"65eae0b53e367f32af8bc38223726fafd27d3726","2009-11-23 23:55:19+00:00","SCI: Reduce header interdependency

svn-id: r46118
"
"47e358cd12dcb2fc044fda26e0c3216519bd1e22","2009-11-24 00:15:10+00:00","Exclude PCE sound player, from non-16bit color build.

svn-id: r46119
"
"b8b042d4bf22b62a55394fe50972d50335766a59","2009-11-24 10:33:30+00:00","PSP: Replaced virtual keyboard and cleaned up makefiles in the process.

svn-id: r46120
"
"83556930409e11803b40761c15220e2e4d739161","2009-11-24 11:54:17+00:00","fix psp port building

svn-id: r46121
"
"e5a919e1326fabad3be1a036c86d0d3cb58a8e9c","2009-11-24 11:59:38+00:00","revert psp.spec mutilation too

svn-id: r46122
"
"3d7155bd62efeba2c8323d47bb4ace46aa2ec73f","2009-11-24 12:10:39+00:00","fix building via Makefile

svn-id: r46123
"
"8109867acb0973b613379e42af31b1c3b78168b0","2009-11-24 12:16:10+00:00","formatting

svn-id: r46124
"
"7c90d8ff644d679dc5dd3256241651af771cdf8e","2009-11-24 12:34:31+00:00","fix spelling -> force buildbot rebuilding

svn-id: r46125
"
"bfc553081c5523ccc5ca0c30178decb374c26fbc","2009-11-24 14:18:46+00:00","PSP: Fix whitespace usage and code formatting

svn-id: r46126
"
"0d9609f7f9515a46a0c2c2dbe446b5c5d63cda75","2009-11-24 22:08:34+00:00","Fix incorrectly placed doxygen comments; replace Common::ID2string by Common::tag2string

svn-id: r46127
"
"df651bf20f1ddac3c28e55551e4fb81dfac1db38","2009-11-24 22:10:14+00:00","Added Doxygen comments for the various engine namespaces (currently mostly without details; help filling these out is welcome)

svn-id: r46128
"
"5e0f79a2edd388dd727ecf6377bc6b8f37c577ed","2009-11-24 22:10:34+00:00","typo

svn-id: r46129
"
"1a313a7eca87e9c135171d404ff10a90718f8c4c","2009-11-24 22:11:07+00:00","COMMON: Remove dependency on engines code (by using the inversion principle).

svn-id: r46130
"
"494a2ab94d516d56b481cfe7311152d5e89495c4","2009-11-24 22:11:27+00:00","TEST: Workaround for 'make test' when using -Werror

svn-id: r46131
"
"c43d9cacdae5cb1737e92ea37bc7293d4ceebea4","2009-11-24 23:33:51+00:00","Add comment.

svn-id: r46132
"
"3fda71b10c6a4c0bb6949c7cc032bd4b4d4a5323","2009-11-24 23:34:03+00:00","Add patch #2903170 - MM C64: costume fix.

svn-id: r46133
"
"a04f2e4affe57d138479c3330a2ea5e677b9038e","2009-11-25 00:22:38+00:00","apply patch #2903175: 'PSP: compile cleanup/fix for gprof and Windows'

svn-id: r46134
"
"9a391357588a52fb798417f6705141b5fe51abe0","2009-11-25 08:07:20+00:00","Typo

svn-id: r46135
"
"413a048a0605a4d43b33dddd0883face5e2c257c","2009-11-25 10:55:25+00:00","Fix 'randomly placed' doxygen comments (which lead to incorrect documentation, e.g. some of those ended up as doxygen comment for various namespaces, such as Common)

svn-id: r46136
"
"12828d3aafb5c235b47644e1bed4063651dc114b","2009-11-25 20:43:49+00:00","Cache resource file size to avoid excess file->size() calls.

svn-id: r46138
"
"776d735c2ef84c448f139725380aada51e84b533","2009-11-25 23:02:03+00:00","Do not fall back to a auto detection of the OPL emulator, when the user selected OPL emulator does not support a mode asked for.

We will now output a warning to the user in this case. That should be fine,
since SCI is the only engine so far, which uses Dual OPL2 emulation.
Albeit this is not supported by our MAME emulator the user will still get
sound output, since the SCI engine will do proper recovery and fallback
to single OPL2 emulation, which is supported by the MAME emulator.
In case a engine would require a specifc mode (like OPL3) and the
user selects MAME emulation, this might result in no sound output
(or a crash), in case the engine does not take any care of testing whether
the OPL creation succeeded. But luckily so far no engine does this,
so it should be fine to not worry about that for now.

svn-id: r46140
"
"611a58f19c8dbc47a9b350b24e58203d171c7e96","2009-11-25 23:17:16+00:00","Extend documentation slightly.

svn-id: r46141
"
"4e830d821cadbf1e29d2fe212a33e23770a890f8","2009-11-26 00:09:17+00:00","Fix SIGSEGV found by ValGrind

svn-id: r46142
"
"8783b0f2f7dbfb44c977812244a4ab4cde47a796","2009-11-26 00:31:19+00:00","Add patch #2839048 - MM C64 sound/music player, with minor changes.

svn-id: r46143
"
"117bcfde95058bbc85f7f720a8e1cad40ddc7ca7","2009-11-26 00:42:24+00:00","Remove dependancy on STL.

svn-id: r46144
"
"ef5d0226c13bb9a5366a5ef94c069691dbd3aba6","2009-11-26 00:43:43+00:00","Fix warnings.

svn-id: r46145
"
"34b781199c22bb38731ed12810af92e74924246c","2009-11-26 00:45:06+00:00","Add patch #2853844 - MM C64: walksounds.

svn-id: r46146
"
"74abd8de64b8f1be4615cd763a7a9af3cb157076","2009-11-26 00:55:18+00:00","Update credits.

svn-id: r46148
"
"1c4408f59378b6bc996f29283f0d6416d4154478","2009-11-26 00:59:57+00:00","Add patch #2857016 - MM C64: meteor landing as work around, with the explaination.

svn-id: r46149
"
"4a1080a597fff9f572037143030d961c7e8652e5","2009-11-26 08:19:56+00:00","Removed dead code

svn-id: r46150
"
"6f45ecff1a260ef404c6f30a5866d2130e9815de","2009-11-26 10:59:46+00:00","Renamed common/console.* to common/textconsole.* to fix compilation under MSVC again (broken with commit #46130). MSVC places all object files for each engine in the same folder (even if they're in subfolders), which resulted in clashing between gui/console.* and common/console.*. There's no easy way around this, other than turning the resulting MSVC files into a big mess, so a simple file rename is more feasible

svn-id: r46151
"
"5afc0e5ed7499e94201b7d2f723ef2556319be46","2009-11-26 11:48:43+00:00","Added the basics of a action list display

svn-id: r46152
"
"3f1093c16242334e7a83833de3e707a3173437be","2009-11-26 12:00:37+00:00","Added some comments on the status of the engine

svn-id: r46153
"
"f3b15df8e3a9013340e276396e0da7abea57a0b4","2009-11-26 12:07:01+00:00","Changed the game list in the doxygen comment to list all the games the engine will hopefully eventually support

svn-id: r46154
"
"abee5aeb3c3d32034637eeb69d196fcd7019ea25","2009-11-26 16:09:47+00:00","Some whitespace and formatting fixes

svn-id: r46155
"
"e98f789a02024c80f9e4275980587f962275cc13","2009-11-26 16:10:59+00:00","Fix warning

svn-id: r46156
"
"4e153c2f9ef041a547c72b148722c088e593e2aa","2009-11-26 16:11:45+00:00","SCI: Turn SfxPlayer::_mutex from a pointer into a plain member

svn-id: r46157
"
"40f038c7f1bef0367d877b599f285cf31e9a9703","2009-11-26 19:50:09+00:00","Initial doxygen description of the Kyrandia engine.

svn-id: r46158
"
"109dff89ddd45f12176f0a2e9546559e55fc0699","2009-11-26 20:33:27+00:00","Typos.

svn-id: r46159
"
"6e26b4a1c8fcfc6e3e71ee0d7229a1a1792afdbe","2009-11-27 06:46:07+00:00","Brief Groovie namespace comment

svn-id: r46161
"
"cb2cc67b41be25e78ef3abff540617d46a7c906a","2009-11-27 18:25:40+00:00","Extended the AviDecoder a bit

svn-id: r46162
"
"c8b8ab679fac5907222b33269fc2ee75ffd9aca9","2009-11-27 19:26:20+00:00","00AM is another compressed frame type, fixing this (thanks to digitall for figuring that out :D)

svn-id: r46163
"
"447711b597f2fc410b0efdbb9d09a4713930dcdc","2009-11-27 20:28:37+00:00","Fixing an invalid read in the destructor

svn-id: r46164
"
"87c26fe54b5f17e610a95c8fec9f10e0f1bef316","2009-11-28 00:07:22+00:00","Fixed bug with exhausting sound handles

It was caused by forever re-starting the same sample when the animation was
stopped and the same frame got displayed over and over, each time triggering
playing the same sample.

svn-id: r46168
"
"07d8f1c89b657ae663700e5bc4b6341693f2271d","2009-11-28 00:32:16+00:00","Fixing a valgrind warning by memsetting _palette

svn-id: r46169
"
"68b99f1c9585e073b66286a2a05dce71bde81263","2009-11-28 00:38:18+00:00","Adding a parameter to the AviDecoder constructor to allow changing the SoundType (instead of it being fixed to Plain)

svn-id: r46170
"
"63a6480057677f0e5326da56f7183e55dd9b8482","2009-11-28 00:57:42+00:00","Hopefully fix switching to the map right after switching the location

It seems that the mouse was simply on the below line and triggered the switch
to the map without the user realizing.

svn-id: r46171
"
"1c43f446c03d989bb53cc04786f93fd9e2cd8fca","2009-11-28 01:03:26+00:00","Enable Dragon History

I consider it stable now

svn-id: r46172
"
"5905b9e4795788e66a78fe4d8d58cb8ca677e481","2009-11-28 18:40:37+00:00","LOL: completed support for floppy installer files

svn-id: r46174
"
"6fb79b8b3c84e44445aa438914b7ebb294f3c47b","2009-11-28 18:58:55+00:00","Fix compilation on 64bit systems.

svn-id: r46176
"
"ac19f4146b10a1a62830108f7d592be85336fe91","2009-11-28 20:08:20+00:00","LOL/Floppy: fixed crash

svn-id: r46177
"
"0e5de0c36d8d17eae7a09cb411401e0357e69304","2009-11-28 20:13:45+00:00","Fix for bug #2905439 'AmigaOS: Recent Kryandia changes broke compilation'.

svn-id: r46178
"
"c7371320d61bcd48682167dc0ba42fc6f06de173","2009-11-28 23:34:12+00:00","KYRA: added HOF PC-98 static data to kyra.dat

svn-id: r46180
"
"5f3e54fcb734d7544fec94a0fe92698b8295a531","2009-11-28 23:44:06+00:00","KYRA: removed hack in staticres loader

svn-id: r46181
"
"67a96069a4838f87076ebe0fe9f96799d69a9f11","2009-11-29 00:23:14+00:00","Removed unused code

svn-id: r46183
"
"8b0f3ee4b50d64432ada907f5bbf3bc976f8f2db","2009-11-29 00:39:22+00:00","KYRA: fixed pc98 intro sfx (regression)

svn-id: r46185
"
"2e4aca24f24e927081177cf2cfc14bf9364c3078","2009-11-29 02:22:08+00:00","Added Dragon History

svn-id: r46188
"
"e3d354f63c31cdb0e45970403877e8b71e6d101c","2009-11-29 09:02:02+00:00","Bugfix for reactivating an NPC when it was previously deactivated at precisely the moment when it was about to do a pathfinding

svn-id: r46189
"
"4f841548759e6bd05303225f10ff2a88d661a8eb","2009-11-29 12:18:42+00:00","KYRA/PC98: fixed regression

svn-id: r46190
"
"ad620b5148575ab02c58953c6da9eedc9ab8b17e","2009-11-29 12:24:29+00:00","LOL: add missing data for PC98 version to kyra.dat

svn-id: r46191
"
"64d76a9e5ab1cff905d5a8275ac0a0c28079e538","2009-11-29 13:08:40+00:00","Removed unused code

svn-id: r46192
"
"bdddab7bd75b32767ce8c612f557163759221736","2009-11-29 13:42:14+00:00","SCI/newgui: handling of right aligned menu text changed

svn-id: r46193
"
"46cf13307d5aa760f08aef2670b1abe898525998","2009-11-29 13:52:02+00:00","Cleanup.

svn-id: r46194
"
"780ede2e71cebe617e528c49340a55e2e44d5720","2009-11-29 13:55:26+00:00","Formatting.

svn-id: r46195
"
"dc22fc1c9e7ad026990ed553ac368d1a125bf415","2009-11-29 14:44:12+00:00","Properly update the sound state in the sound command parser when loading a game

svn-id: r46196
"
"3cedd0f2b9d8df729ece264b8dfb39253a092937","2009-11-29 14:48:15+00:00","Started assigning the code from Greg's SCI engine to our sound commands - still WIP

svn-id: r46197
"
"798f3ab7959fca35dd52c5715dc68da68fed58c0","2009-11-29 17:31:17+00:00","Comment out unused variables.

svn-id: r46198
"
"5b562407c1373913b244991e0580f9c54fd013d9","2009-11-29 21:56:10+00:00","COMMON: Replace NORETURN by NORETURN_PRE & NORETURN_POST

svn-id: r46205
"
"cbf08155c5d311723f3de96da545d00f56ae9114","2009-11-29 21:56:37+00:00","add missing varag param

svn-id: r46206
"
"e4a659fd6233540d8ca877b1030c5ceae9d96e45","2009-11-29 21:57:05+00:00","Use common/ headers in our trunk tools

svn-id: r46207
"
"0894fa39b29abd92d4ff4854c586b4b3942ab1a0","2009-11-30 00:13:04+00:00","Proper GameCube capitalization.
Is there another way to force buildbot rebuilds?  We're starting to run out of these trivial changes =)

svn-id: r46208
"
"8ede0caf72b82dd7cf211428fdb5985ca72c0a28","2009-11-30 01:58:15+00:00","Properly clear the chunk headers again on closing

svn-id: r46209
"
"c7305331eebd2e97160024ec54f4fc4282d5db2a","2009-11-30 02:00:42+00:00","Only print sound information if there actually is sound (preventing a division by 0 exception)

svn-id: r46210
"
"343ded5f6ff9063d3cb58f2d3ac2bbbfdfe5ec87","2009-11-30 08:09:15+00:00","Add support for DRACI!

svn-id: r46212
"
"61d68b9d4a5e8549b9820f244118ee5cc6eaff71","2009-11-30 08:09:39+00:00","Removed <cmath> includes since a) not a part of Symbian OS b) Compiles fine without it (at least with Symbian OS GCCE 3.4.3 and CW 2)

svn-id: r46213
"
"509ca126042e3e8473d2e10d8b76ffa8030e1d38","2009-11-30 08:35:50+00:00","Add support for teenagent. Add missing support for Feeble files!

svn-id: r46214
"
"6d5f8edb42ca4a855697ac53034b32387b857644","2009-11-30 08:50:49+00:00","Add includepath to find gui\ includepath from sci

svn-id: r46215
"
"2811d0fd310a7a12d5dfb0f8dc0d7fc08044d2cb","2009-11-30 08:55:51+00:00","Remove use_scaler defines around enum in order for graphics to compile properly.

svn-id: r46216
"
"e557075e9059278e7d7dc8354c2d32e12e333463","2009-11-30 17:24:33+00:00","typo

svn-id: r46223
"
"df422c0894e7d7cfc0520ae91b1a1acfb582d3a1","2009-11-30 19:34:45+00:00","SCI: Fix kSetCursor (Sci1.1) to behave like Sierra Sci (fixes cursor hiding/showing in kq6)

svn-id: r46224
"
"7bbcc1830b27777627cbe2f04c0b2e03cc89b696","2009-12-01 07:54:50+00:00","display '&' next to the object name as in original game.

svn-id: r46226
"
"c839eeda81079d63394f96677c2afb86409c5bd5","2009-12-01 08:00:13+00:00","use selected object with both mouse buttons as in original game

svn-id: r46227
"
"8c4235d0c502a7bd2f1160b0c5ab0930a36e138e","2009-12-01 08:03:23+00:00","find out the meaning of the rest 4 bytes in walkbox structure

svn-id: r46228
"
"9bc2aa2afa45e225727e4f748f61d5049cab17b9","2009-12-01 10:47:39+00:00","Corrected the palette colours for the interface elements

svn-id: r46230
"
"039d7d5e1c0bbc073d85c94f3026613470c2d6a6","2009-12-01 19:19:58+00:00","Removed unnecessary semi-colons.

svn-id: r46232
"
"32d6366f29b446e527b8ee20391e1f97a7f01c7a","2009-12-01 21:49:45+00:00","gob - Add cursor handling for Fascination windows (close and move at least)

svn-id: r46233
"
"1259f8061a78dae1f9e8819fe7afa5233a64af9d","2009-12-01 22:10:51+00:00","Fill out doxygen comment about supported games

svn-id: r46234
"
"5bf7b71c0f2178bced8622ac3ee7a30b4b28bfb5","2009-12-01 22:21:16+00:00","Fill out doxygen comment about supported games

svn-id: r46235
"
"6ad031f74370d9406cd24b97ef13ec8ec71b0245","2009-12-02 03:55:06+00:00","Add sanguine's patch for bug #2905463 - Loom PCE: missing characters in US font.

svn-id: r46238
"
"6dad0ab29e6d2d290fc477ec17fce49287920408","2009-12-02 20:25:01+00:00","PSP: experiment to help resolve flicker bug

svn-id: r46239
"
"afee877c46b1a4fb9e88934862be383e23c61bc8","2009-12-02 21:30:43+00:00","SCI: Do clipping on celNo for case when celNo is below 0 (fixes crash in island dr. brain intro)

svn-id: r46240
"
"568f674c809c8c897e183bd4e57888f79a4b051f","2009-12-02 22:00:29+00:00","SCI: WindowMgr init correction

svn-id: r46242
"
"2dcbfeb31a22f468dc174598f3201684283fcd58","2009-12-02 22:13:56+00:00","SCI: Reverting 46242, wasn't a bug at all

svn-id: r46243
"
"3b7a2dad3ddee4220ef84744be3986d05e47c224","2009-12-03 09:12:20+00:00","added original-like pathfinding.

svn-id: r46244
"
"dbf850999a88af128a39f03d6ac487ae6d448ded","2009-12-03 19:18:47+00:00","Remove some unused struct members

svn-id: r46245
"
"c70a9e2cac5b26440310098a9f04623a1b84247c","2009-12-03 22:24:29+00:00","SCI: Dont init sound when using old sfx code (fixes assert)

svn-id: r46246
"
"e149a88b990bfad8d65e4780f22435d63e2c1f01","2009-12-03 22:32:48+00:00","SCI: Don't call SciMusic for volume changes when using old code

svn-id: r46247
"
"43abd8d2e9f1e6dee97052397d7dddc6f028ff46","2009-12-04 12:55:53+00:00","SCI: Fixed kSetCursor (fixes qfg1vga menu immediately disappearing after opening)

svn-id: r46248
"
"dde874392354ac625ccb61409053095bf39204df","2009-12-04 13:49:43+00:00","SCI: Convert characters to scancode, when Ctrl is pressed (fixes key-shortcuts not working in lsl5, lsl1, qfg1vga and others)

svn-id: r46249
"
"abbf2bf16214eddf1394e62ae052d8505cba4d3b","2009-12-04 14:25:31+00:00","Fix bug 2908376: FOA: Won't launch in Win32

svn-id: r46250
"
"055c8b087b383eeb556e9f0db03f9da8a7ad2a91","2009-12-04 14:32:32+00:00","SCI: Alt translation. Currently handles Ctrl-X as Ctrl-Alt-X so that bypassing questions in lsl1vga is possible. ScummVM currently doesn't give us event for Ctrl-Alt-X

svn-id: r46251
"
"a5f1808c83844c21a5e22543157fa341536b5406","2009-12-04 17:38:24+00:00","SCI: SciEvent created, kernel_sleep() created

svn-id: r46252
"
"4fb779dbaf85d93c776549cdc4903c5a671013a4","2009-12-04 17:42:32+00:00","SCI: Recreate SciEvent on loading saves

svn-id: r46253
"
"aa147a2f5af167048b3d57da558bc39a91c3a936","2009-12-04 17:52:42+00:00","refactor resource module:
- struct ResourceContext => class ResourceContext
- replace '*alloc','free' with array templates
- simplify createContexts routines

svn-id: r46254
"
"d982d1050585449a3c966161d2bde5ef46069895","2009-12-04 17:58:26+00:00","SCI: Make event constants more verbose

svn-id: r46255
"
"3db191275955ce6bf912a96edf39b2a38b9e4c77","2009-12-04 18:02:48+00:00","SCI: Renamed 'buckybits' to 'modifiers' in SciEvent

svn-id: r46256
"
"0db75cd812d5d805378b58ed860cdb2f49478775","2009-12-04 18:41:16+00:00","SCI: Typo fixed in SciEvent caused all Ctrl keys to get changed to Ctrl-Alt-X :)

svn-id: r46257
"
"01e12310ae134f429c9ba72fd776af6ccd654a04","2009-12-04 19:00:40+00:00","Silenced GCC warnings.

svn-id: r46258
"
"ad94de73d880116b02aa658765e9b32583463c96","2009-12-04 19:57:33+00:00","Prevent SDL backend from eating up keypress events with Ctrl+Alt set.

svn-id: r46259
"
"4c6fdce020a4888c0a1bbac4fcc3f5848627b462","2009-12-04 19:58:10+00:00","Fix warning.

svn-id: r46260
"
"1cc59d5a820e4e59e0316375faaddad43ed5c41b","2009-12-04 20:03:53+00:00","SCI: Removed Ctrl-X to Ctrl-Alt-X mapping cause Ctrl-Alt-X works now directly

svn-id: r46261
"
"60fa351d32a0d133583662bc4cd20057be418b7a","2009-12-05 05:44:46+00:00","Expanded the actions view into a full user interface view, and added support for highlighting of user interface elements

svn-id: r46262
"
"7aa92b7dcc8ae0e8019fb0bc72f4eb6dfdaec92e","2009-12-05 06:00:00+00:00","do not use walkbox more than once.

svn-id: r46263
"
"19eff3b77480fd9a9d32ae6563e505f7ffd25da1","2009-12-05 06:03:24+00:00","fixed multiline message positioning

svn-id: r46264
"
"cb9068583103ed7270484067e97a64bc7e092a1b","2009-12-05 06:14:04+00:00","Silenced warning.

svn-id: r46265
"
"0e85be840547009f60f25cf8f319a730d957be72","2009-12-05 07:46:41+00:00","Implemented support for the inventory list scrollbar and directly selecting an object

svn-id: r46266
"
"0841063a32f6468ab099546f6dd06ae8a0f015cb","2009-12-05 07:47:01+00:00","Added a new variation to the 'object' command to add an object to the player's inventory

svn-id: r46267
"
"f21810242e671da70ad92770d67a60f486b9ddb6","2009-12-05 11:32:19+00:00","Hooked up the actions list and object-specific actions to change the status text

svn-id: r46268
"
"3b7082c32b20eb33f8c9e6bbaf7ab4a79c3e7fa0","2009-12-06 00:54:24+00:00","Fix overflow of glyph count for CREDIT6.FNT, this fixes credits for Kyra1 floppy/FM-TOWNS/PC98.

svn-id: r46269
"
"4a189842bbfa54e76ee155633b752013becd5141","2009-12-06 04:38:20+00:00","Adding support for mono signed 16bit little-endian uncompressed PCM audio (thank you, clone :))

svn-id: r46270
"
"67fc4e420b5ef7da361af676d8780da400be22bb","2009-12-07 00:16:28+00:00","Rename the MT-32 emulator driver name from 'MT-32' to 'MT-32 Emulation to avoid confusion.

svn-id: r46271
"
"ebde568fe292475245fe6ec865b3286d3e27c7e6","2009-12-07 09:30:14+00:00","Stop using variables named 'byte', as byte is a variable type in ScummVM, and it gets confusing. Also, this fixes an error when language extensions are defined in MSVC - refer to patch #2909854

svn-id: r46272
"
"2797a3bd9ddc457aa2488e6129f4ce97df6fa7fe","2009-12-07 09:53:44+00:00","Applied patch from patch item #2909854 in order to fix compilation when language extensions are disabled in MSVC

svn-id: r46273
"
"28fce4383320b9e4028d27a0c7feec044697ea87","2009-12-07 09:54:55+00:00","Disabled language extensions in the generated MSVC project files (refer to patch #2909854)

svn-id: r46274
"
"bcdd7ee71a2ca2671ab92882f6ce8d8d12cf1898","2009-12-07 12:34:38+00:00","Applied patch from tracker item #2900436 - 'SCI: SCI32 Checksums' with some formatting changes

svn-id: r46275
"
"4482780424e8b87b8eecf938e4e173c172f3a625","2009-12-07 12:36:09+00:00","Slight cleanup/simplification of the TimerSongIterator

svn-id: r46276
"
"920df7a3b5d0daea68240383e05dc841774745ad","2009-12-07 15:34:27+00:00","Formatting.

svn-id: r46277
"
"babb38230e4cd69aaf79d0ade25a1cf37f6815bb","2009-12-07 16:21:33+00:00","Hopefully silencing C4121 in MSVC.

svn-id: r46278
"
"6d1e4dd0344f9baef12709e2c90ac98e17392786","2009-12-07 18:20:20+00:00","M4: Rename M4Surface::getData() to getBasePtr() for consistency

svn-id: r46279
"
"f8126d9da676e69dff384b8a8f7136ad27fb014d","2009-12-07 18:22:18+00:00","M4: Make M4Surface member w, h, pixels protected; some cleanup

svn-id: r46280
"
"d34cdae9cea0165253a8dcfe70911c792366ec08","2009-12-07 18:23:28+00:00","M4: Move 'determine transparent color' hack into a new M4Sprite method

svn-id: r46281
"
"0ff979e56d9571b4094f2fae816a78c7c3ea27f5","2009-12-07 18:24:10+00:00","COMMON: Document class MemoryPool; make MemoryPool::_chunkSize const

svn-id: r46282
"
"74fb3e6a1e5b67319db6e732953b17d9a3f2ebc6","2009-12-07 19:16:18+00:00","show main menu by f5 button

svn-id: r46283
"
"184a741757383bb90ac5f888f959a84f3d0c1a01","2009-12-07 20:32:54+00:00","For consistency, make F5 bring up the main menu in the Draci engine too, just
like megath just did in the TeenAgent engine.

svn-id: r46284
"
"e30db47a77943a3b65da7ea42eabe5d162e438d1","2009-12-07 20:46:19+00:00","Mention F5 in TeenAgent and Draci.

svn-id: r46285
"
"2e4a257e45031b79b2931e38d56d7c09ea4286fd","2009-12-07 21:59:50+00:00","skip walkboxes that contain source or destination point.

svn-id: r46286
"
"fce6502bd8de5233c38675b0108737e834813622","2009-12-07 22:11:45+00:00","finally fixed pathfinding

svn-id: r46287
"
"7b82ad1a8dc526974d8e7495c524a411af9606f7","2009-12-08 20:39:27+00:00","added missing orientation for kLoadScene event

svn-id: r46288
"
"f46e76c9b4bddb24eb69f4ca03ea3975d03f0ac6","2009-12-08 20:40:26+00:00","cleaned up final scene, fixed guard glitches

svn-id: r46289
"
"923cbff625f91c5afc6163813852e9a58ed43912","2009-12-08 20:44:01+00:00","SCI: Cleanup DirSeeker a little bit

svn-id: r46290
"
"5f178e86500b93d6d0c5fb65ce2908522319e703","2009-12-08 20:44:57+00:00","Fix some MSVC warnings (part of patch #2909981)

svn-id: r46291
"
"a2d7505e8118bd7af5fe8f3f2a184af5e6ac3834","2009-12-08 20:54:18+00:00","SCI: Saving picPort now (fixes loading saved games in castle of dr. brain)

svn-id: r46292
"
"601fd7973367da02bb6769771861bb37fc03b735","2009-12-08 21:04:40+00:00","SCI: SciGui::getPortPic now uses byref

svn-id: r46293
"
"84b910f7559aac2af505a9ff8761fa9e31cb9bf7","2009-12-08 21:22:22+00:00","SCI: new USE_OLDGFX for switching to oldgui, fixes loading of savedgames under oldgui, oldgui doesn't like calling of setPortPic during loading

svn-id: r46294
"
"88c99bc73386946799626ce9d21bdebce0caf176","2009-12-08 22:02:24+00:00","allow font to be rendered out of screen

svn-id: r46295
"
"c2f9c512a1790118b95c2b171f9931f423a9417f","2009-12-08 22:03:33+00:00","fixed default font height

svn-id: r46296
"
"5de8c469638cbd00b791a8cfc90e249628e1ea99","2009-12-08 22:04:00+00:00","added final credits

svn-id: r46297
"
"e3d1d914ac88036a8a2a627f8448110ea04e5f1a","2009-12-08 22:07:17+00:00","Attempt to fix MSVC warning C4121.

svn-id: r46299
"
"5b136d2f1a491279f68e08d2b4b1d5de9c89bb97","2009-12-08 22:08:33+00:00","Attempt to fix MSVC warning C4121.

svn-id: r46300
"
"4218d3f037da0c050d5b2d99de69c0f1ff29bc3e","2009-12-08 22:13:06+00:00","added message duration override, increased 'the end' timeout

svn-id: r46301
"
"8ec098d016c80e79793815bca12282ea338bad6a","2009-12-09 06:33:00+00:00","Fixed some simple cppcheck warnings.

svn-id: r46303
"
"7e1bf3fb4b0375c90a4adf3bc305c5b7aef0a5d3","2009-12-09 07:28:04+00:00","SCI: Save/LoadGame Common::Rect saving now portable

svn-id: r46304
"
"7bce8acd2e56eec870ffb7d269c6a8cb04af0735","2009-12-09 09:31:07+00:00","SCI: implemented _picNotValidSci11 for new kPicNotValid behaviour in sci1.1 (fixes island of dr. brain first pic after copy protection not showing up)

svn-id: r46305
"
"5df86e4cccf294f6e4eccd08fb82c94fe3817a60","2009-12-09 12:32:47+00:00","SCI: Paranoia tweak for EngineState::autoDetectFeature

svn-id: r46306
"
"421363a13258c149bdf976938e7dc8d8438aa9db","2009-12-09 16:41:08+00:00","Slightly modified commit of patch #2911414 'MSVC: conversions warnings in common code'.

svn-id: r46308
"
"fb5e747565e28a6863190e0e837899d5177244af","2009-12-09 16:44:48+00:00","GRAPHICS: Change font code to be identical on all platforms

svn-id: r46309
"
"626f85ae5e9d3aea2d528cbf847aee6ec6051407","2009-12-09 16:45:35+00:00","Move findCompatibleFormat from graphics/pixelformat.h to engines/engine.cpp

This function is used in only one place. Declaring it requires common/list.h;
by putting it into pixelformat.h, which is included by common/system.h, tons
of things suddenly included list.h for no good reason.

If we ever need to call this function in other places, we can figure out aborts
more appropriate place for it.

svn-id: r46310
"
"d60b5ca516e80aebe2183f1525d067ea1796c97c","2009-12-09 16:46:14+00:00","Include font.h instead of fontman.h in places that don't need fontman :)

svn-id: r46311
"
"8f34e4b11c77740ad9a8e316f30382e8ad9cd4dc","2009-12-09 16:48:33+00:00","Commit of the 2nd revision of my patch for FR# 2840967 'GUI: Display filenames in 'Add games''s file dialog', since it seems on 'Making it easier for users to add games' on -devel the majority of developers, who commented, are for this.

svn-id: r46312
"
"0d43cc61d26e9cd68611c1c45cbf220b50e3b3f3","2009-12-09 17:05:23+00:00","Cleanup: remove 's_initialized' from CursorManager and FontManager implementation, these classes are Singletons, so they will ever only be initialized once at most anyway.

svn-id: r46313
"
"414e6ffef30e8b86f3054bc89c092b96d3f8757d","2009-12-09 17:09:18+00:00","Some more slight cleanup.

svn-id: r46314
"
"84f3c98fad7d351611c879dddc86cd309b4f5281","2009-12-09 18:05:20+00:00","Remove the Audio::Mixer parameter from the midi/music plugins

svn-id: r46315
"
"c8873d8492ef8ae288e870b37c1c85f3b291d62c","2009-12-09 18:12:51+00:00","Changed MidiDriver::createMidi to take a MidiDriverType instead of an int

svn-id: r46316
"
"0a1d16ef6b8b0671d97642abb050e353485cd051","2009-12-09 18:15:04+00:00","Change GOB engine so that not all its files depend on gui/dialog.h (and thus tons of other headers in gui/ and graphics/)

svn-id: r46317
"
"27e03012d5ee6555ec1988ad455f78aa53eb2c7a","2009-12-09 20:08:57+00:00","This is hopefully fixing compilation of the fluidsynth code.

svn-id: r46318
"
"5cd176052c0016516b04ef208a9e262a4200920a","2009-12-09 20:11:02+00:00","Typo...

svn-id: r46319
"
"f3420c63721dd6a8d857d9c44f794c83beaa7cf8","2009-12-09 21:03:22+00:00","DRACI: Reduce header interdependencies; some cleanup

svn-id: r46320
"
"2f372d79d5b792b624dc585840131f8e5ad9be5e","2009-12-09 22:50:12+00:00","Fix compilation for systems without USE_RGB_COLOR defined.

svn-id: r46323
"
"7605a35fd7695c292c8176b3ea885d2be03e35cf","2009-12-09 23:04:54+00:00","Cleanup: Move constructor/destructor definition of CursorManager::Cursor and CursorManager::Palette to cursorman.cpp.

svn-id: r46324
"
"dce1d4aa4b319a934e94e45c3a264c75207a6577","2009-12-09 23:05:15+00:00","Properly clean up memory when destroying CursorManager.

svn-id: r46325
"
"9e04ca3633d898972f87c06c50195593ded4bf0a","2009-12-09 23:05:36+00:00","Silence gcc warning.

svn-id: r46326
"
"6b44a09a528ae219e6b3bf4d316a72ca067a7c9c","2009-12-10 21:40:38+00:00","Hopefully fixing linking on MSVC:

svn-id: r46329
"
"724d698a05bfda015e428ffa3ac4094ecbc1b4c0","2009-12-11 09:41:27+00:00","Beginnings of a dialog display class

svn-id: r46330
"
"22ca0c1e9249d68099db1135abe63a76b11394b8","2009-12-11 17:14:55+00:00","Renamed line() to drawLine() to silence warning about function parameters in
dialogs.cpp shadowing it. Actually, the function doesn't seem to be used
anywhere at the moment, but perhaps someone has future plans for it?

svn-id: r46331
"
"468c27979fe074512ced0fe9ada0ccfff2f443c2","2009-12-12 10:29:24+00:00","moved noisy debug messages to level 1

svn-id: r46332
"
"581fd0c42db877ac11ce045525977c6e659a586a","2009-12-12 10:31:48+00:00","tuned vertical speed for mark

svn-id: r46333
"
"cc22b76c3b7bda4532f82a6eb11aa1a62479366e","2009-12-12 10:43:17+00:00","added debug level to the dump() methods.

svn-id: r46334
"
"17435a0b6cd0b9cd3751f30598687e730d9af255","2009-12-12 10:50:41+00:00","render 'ons' after all stuff (needs to be discovered), fixed crumbs invisibility on screen with barman

svn-id: r46335
"
"72cb0036a3780ef89fa94cc92cbdf4da37d8fc56","2009-12-12 10:57:38+00:00","reverted the latest patch

svn-id: r46336
"
"8a3bb27f6395ce4530213171d6fe588d7120defc","2009-12-12 11:53:44+00:00","added Rect ctor from Common::Rect

svn-id: r46337
"
"d10bb1036e993ca2d4105076b468dc06f46d426f","2009-12-12 11:59:38+00:00","Implemented the rendering section of dialog display

svn-id: r46338
"
"476d52aab2af87bd188ac194c3d29953296ea0ed","2009-12-12 12:47:03+00:00","fixed typo in checking src rect height

svn-id: r46339
"
"d45385f98ed5453f25cefa19d687bd85ffc82324","2009-12-12 13:00:44+00:00","fixed non-default src rectangle rendering

svn-id: r46340
"
"100805144ab212b958159a733f35a0754db8b16a","2009-12-12 13:05:55+00:00","render 'on' surfaces only on mark (fixed many z-order issues)

svn-id: r46341
"
"f34d55211147d3753476df3daa19003d6d139a2d","2009-12-12 13:12:30+00:00","moved 'on' surfaces rendering into mark's code

svn-id: r46342
"
"435360d3ba7d979c7ed5c05e4ac07e113c6f2a0e","2009-12-12 13:33:35+00:00","added z-ordering of the animation slots.

svn-id: r46343
"
"1071c6d3981106c1baa2f27cc72ef117cb0117d8","2009-12-12 14:18:29+00:00","fixed skipped animation at lakeside house

svn-id: r46344
"
"65ed29b3be3ea735c581894882566355aa78a2eb","2009-12-12 18:07:20+00:00","do not play music while _rows is empty

svn-id: r46345
"
"b0a5c5869f696445e79ab40d7d07d22bd0c84107","2009-12-12 18:12:24+00:00","fixed dirty rectangle

svn-id: r46346
"
"7b223452b0b19172efae0f46eb2674ec1c660cc2","2009-12-12 19:50:25+00:00","fixed minor issues from the chapter 1&2

svn-id: r46348
"
"0cdde4963b92e41f57f36fe8863586bd428302bd","2009-12-12 20:00:44+00:00","fixed tv issues

svn-id: r46349
"
"0e7c2265b57b05b38929cbebf66feb446238d41c","2009-12-12 20:02:03+00:00","do not clear busy flag on !ignore animation, fixed invalid loop/ignore flags

svn-id: r46350
"
"f4c54fb636478b4bdf4a2e8c3a76b060459a0ca1","2009-12-12 20:06:42+00:00","LOL: moved TIM animation code into a separate class

svn-id: r46351
"
"90b4d4b45c662dbf3c829ef6cfdbed87f88f0326","2009-12-12 20:50:41+00:00","LOL: fix compilation when the LOL engine is disabled

svn-id: r46352
"
"ef6eb34a22eed9beefc740132a40fd630d37941b","2009-12-12 20:54:28+00:00","create_msvc: (littleboy) Fixed closing of search handle (should use FindClose instead of CloseHandle with handles from FindFirstFile)

svn-id: r46353
"
"35c695929a65529f710735d2f5d79f1e24952ddf","2009-12-12 21:21:38+00:00","LOL: fixed regression

svn-id: r46354
"
"adba314fc679be40f6341764ca9f45d0a027b865","2009-12-13 15:19:56+00:00","LOL: some cleanup for recent code changes

svn-id: r46358
"
"42c306208b7e58a2811b481c26c35f96259dd5f1","2009-12-13 20:37:26+00:00","LOL: fixed regression

svn-id: r46366
"
"43f9c1bce15c9878572d254577ab57ea2d94e1fb","2009-12-14 07:25:06+00:00","fixed tv/vcr callbacks

svn-id: r46377
"
"eb9b31782f094578d0d824962a5660d697e71486","2009-12-14 22:29:09+00:00","skip rendering if restart was requested

svn-id: r46378
"
"f692015301e6122b7d071a0ce52c81faa6c3b69f","2009-12-15 08:18:57+00:00","Got rid of ReadStream::ioFailed()

svn-id: r46379
"
"605037342be6c8dc40bd9c1380fd93727f3d3de3","2009-12-15 08:19:34+00:00","GUI: Fix some GUI hacks, add some comments, etc.

* Rename LauncherDialog::selectGame() to selectTarget()
* Get rid of the 'temp_selection' ConfMan entry hack
* Add some Doxygen comments
* Turn a printf(...) into a debug(1,...)
* Don't scroll around if 'Mass Add' is cancelled

svn-id: r46380
"
"6c98169dc3ab302a6fa1feecc6b053b515174e7d","2009-12-15 08:19:59+00:00","GUI: Shorten button labels if too long, and improve the shortening logic

svn-id: r46381
"
"f53d23d816942a8a773b01ba4be5ddf7bc0c252e","2009-12-15 08:20:19+00:00","GUI: Re-add ellipsis to various button labels

svn-id: r46382
"
"1bd23f11d5b15ee241c7c6acc69bf676b9f5a7ca","2009-12-15 09:03:04+00:00","added known bugs file, enabled teenagent in configure.

svn-id: r46383
"
"0fd2dd8f061412a521abd7a297c0be797ba3d7f4","2009-12-15 09:08:58+00:00","updated known bugs

svn-id: r46384
"
"f59b50253e36f62a599fd035e150e399689d60fa","2009-12-15 10:13:58+00:00","removed file as suggested by max horn

svn-id: r46385
"
"690a410423207c3df4c6cf9427167c0948f08ad4","2009-12-15 12:56:10+00:00","Fix a typo

svn-id: r46386
"
"575308cea724b214d7f83a06cf8819f15b1e4f75","2009-12-17 07:55:08+00:00","Implemented basic message parsing

svn-id: r46402
"
"3c5473f832694e69133fec656329e5660902f298","2009-12-17 22:50:34+00:00","gob - Add MD5 for LiT floppy part 1 'full', part 1 'light' and part 2. Part 2 still has to be properly separated between 'full' and 'light'

svn-id: r46411
"
"5e7ed05997c6c616e277f610020e235d3ab3f209","2009-12-17 23:07:03+00:00","gob - Split LiT part 2 detection in light / full.

svn-id: r46412
"
"7ca404355fda1992ac78ff3fc530e4d50e15cd28","2009-12-18 17:48:45+00:00","Moved the midi_writer struct into the place where it's actually used, and named the header file appropriately

svn-id: r46413
"
"2e6013947df83d3364073d971cdce7325297c889","2009-12-18 18:32:09+00:00","Moved the interface class for the the custom SCI MIDI drivers together with the actual driver implementation code

svn-id: r46414
"
"144bd33ec4f6499cbad469a885258f56edc4fdc1","2009-12-19 02:03:41+00:00","Silence some gcc 3.4.5 warnings.

svn-id: r46415
"
"26a5c1c3a5ea76a92ebe60f074c3fbfa64a06fa7","2009-12-19 02:12:17+00:00","Fix segfault when quitting. static const Common::String's shouldn't be used.

svn-id: r46416
"
"ae50fdca7238c6898e9289935ec392f66e0311ae","2009-12-19 05:46:26+00:00","Added an extra assert

svn-id: r46417
"
"63350a0ecca8bb1b3c102ffea698ace04337665a","2009-12-19 05:47:31+00:00","Further implementation of dialog/message script language

svn-id: r46418
"
"87c3a9dd8dac510d07ed8e04671864b801438cf1","2009-12-19 16:02:45+00:00","Removed unused include

svn-id: r46419
"
"b32748d81050f66b343b4e028207c2472de49d01","2009-12-19 16:05:47+00:00","- Removed unused includes
- Added a new method for constructing a new MidiDriver in the Adlib driver
- Added a hack to obtain the resource manager in the default open() method of the overriden Adlib MIDI driver (used in the new sound code)

svn-id: r46420
"
"0c1b646c7feb649ad8c0f77a5129d5ad1b3d84b1","2009-12-19 16:19:53+00:00","- Started wrapping the current sound code around appropriate defines
- Introduced a new resource type, SoundResource, used in the new music code

svn-id: r46421
"
"3da285432b0debb46e2f544b06a442cce47c256f","2009-12-19 23:33:48+00:00","gob - Remove detection of a cracked version of Lost in Time

svn-id: r46423
"
"b729218bb6f48a7e57cd938f76ca0065983b792e","2009-12-20 07:09:40+00:00","Changed the M4 event handler to encode the keyboard flags into KEVENT_KEY events

svn-id: r46424
"
"5c732e00ee61b3661ad3ca8679ff270ace6d7d10","2009-12-20 07:10:32+00:00","Started implementation of the original game's cheat mode

svn-id: r46425
"
"4f918cd68cdc1dc1b4eb1667185c193b8a5dceab","2009-12-20 12:43:36+00:00","Removed dead code

svn-id: r46426
"
"fa859f6ab13da7a1b9a998c433805f5587556101","2009-12-20 13:13:07+00:00","Directly modify the sound objects, instead of modifying a local copy. Remove duplicate code (which now resides in resource.*)

svn-id: r46427
"
"e22afe48231dae981a992cbbafe924bc84f4853b","2009-12-20 13:15:44+00:00","Wrapped some more sound code around appropriate defines

svn-id: r46428
"
"c388e891816878d14bc3c17c82bb191a27b16726","2009-12-20 13:28:23+00:00","Wrapped some more sound code around appropriate defines

svn-id: r46429
"
"980b8bb89937952529d0bc39ba04e9f306b1e792","2009-12-20 13:38:13+00:00","Moved all of the sound iterator code in its own directory, and added a slight hack to the SoundCommandParser constructor

svn-id: r46430
"
"a21a8082505ff2abf5d403e8d129e35cd7ea58fd","2009-12-20 14:11:56+00:00","LOL: fixed text fading

svn-id: r46431
"
"ef0898c0b1b16372b3d3052c16ee2109cc144501","2009-12-20 14:27:43+00:00","Started integrating the new sound code in the SoundCommandParser class. Some cleanup

svn-id: r46432
"
"c1eaafcac766b894c8272a73df3c8ac6bc78e908","2009-12-20 16:23:44+00:00","LOL: removed unused variable

svn-id: r46434
"
"c1e90ce3cc0e2b0993585691072b5427f6134d7b","2009-12-20 16:35:37+00:00","Implemented cmdUpdateCues() in the new sound code and fixed a crash when loading music with a resource number of zero

svn-id: r46435
"
"c261ecd055fda27c22745c612dad9fd2611103bb","2009-12-20 22:24:34+00:00","Update config.guess and config.sub to latest versions from upstream

svn-id: r46450
"
"ba51f8750ed1898d591cee7a60ccbec915f6c88d","2009-12-21 12:19:57+00:00","Brought back the INCLUDE_OLDGFX define

svn-id: r46459
"
"e86a16a64196fdca4a5522282a23969271aebd9a","2009-12-21 14:05:36+00:00","Fixed menus in multilingual SCI01 games

svn-id: r46460
"
"2a3cbcbc57bbb960e678b40692cffce69c88149b","2009-12-21 14:06:47+00:00","Fixed text controls when subtitles are enabled in multilingual SCI01 games

svn-id: r46461
"
"ef79d7f017610e15df5ea6b4c6d6a3b218d4d39f","2009-12-21 14:32:54+00:00","SCI32:
- Fully implement kArray and kIsHiRes and mostly implement kString (printf and atoi subfunctions still missing).
- Add a dummy SciGui class for SCI32 to bypass the views. Gabriel Knight 1 will now play the Sierra logo music and the main menu music.
- Some other minor SCI32 changes.

svn-id: r46462
"
"482812a1fffe8def124b41a1b1e713e59254626e","2009-12-21 14:46:07+00:00","Update/add some comments/TODOs.

svn-id: r46463
"
"9a0074ba5b9174edad4ae58f4d9599ab1fee4fef","2009-12-21 14:46:52+00:00","Silenced some warnings to make DrMcCoy happier :)

svn-id: r46464
"
"35e91fbddf029bd5dc251fda0f695805de315cfd","2009-12-21 15:22:42+00:00","Add a TODO for the SCI 2.1 message version (5).

svn-id: r46465
"
"11a9351ae53176bb6f2906d35ce21eca61d3a9be","2009-12-21 15:24:43+00:00","Restored sound volume functionality in the old music code

svn-id: r46466
"
"5a087101add53b78a147b950da7ee230daac1fba","2009-12-21 16:27:50+00:00","Some updates to the new music code

svn-id: r46467
"
"b1adefc487352464a76d0df0a89b6649cc6b3750","2009-12-21 22:24:22+00:00","Sorted game entries

svn-id: r46469
"
"2fec19aa6b566a484d130a1fa3a5ff41846ef210","2009-12-21 22:29:00+00:00","Add indy3 md5 from bug #2916434: 'New MD5 for Indy3 DOS-EGA, German'

svn-id: r46470
"
"f6880b98217783f9bc76959cf951e803c89092f0","2009-12-21 22:40:52+00:00","md5 from bug #2809149: 'AGI: SQ1: Checksum of Space Quest 1 Version 1.1A'

svn-id: r46472
"
"be67479aef238d8558438ccc31da69dde67ea807","2009-12-22 00:12:59+00:00","Some bugfixes to the new music code

svn-id: r46473
"
"958f197b42e7d889187008b12e8a7ebf43db7a76","2009-12-22 00:15:54+00:00","typo

svn-id: r46475
"
"fd5e548bb2266b7dadf440df73f4dee2cd11d922","2009-12-22 00:16:09+00:00","SCI: Fix some warnings

svn-id: r46476
"
"0d82924fbe76efd27f4b439940cd916cfa2c65dd","2009-12-22 00:35:27+00:00","Fixed looping sounds in the new sound code

svn-id: r46477
"
"899d5769765a165eb8fc326dba330b28b6596435","2009-12-22 06:02:49+00:00","The detectMusicDriver() function returns MD_-something, not MDT_-something.

svn-id: r46478
"
"b8aa17b6fbb3946e28033fd4bf731ba12e4dc250","2009-12-22 12:34:27+00:00","Started implementing SCI1.1 digital sound effect playing in the new music code

svn-id: r46479
"
"86dc69430b0286d4a90aa3390b59639dcb56291b","2009-12-22 12:35:48+00:00","Initial implementation of music fading in the new music code. Added warnings to all unimplemented/stub sound commands

svn-id: r46481
"
"ebd11a056f61d6b32c5323ab0cefbc3d9c28f480","2009-12-22 13:31:52+00:00","Silenced some warnings to protect DrMcCoy from incoming Borg

svn-id: r46482
"
"1682b302a8c9568dc9eabfda316506f1896b9754","2009-12-22 14:37:57+00:00","removed conflicting hotkeys.

svn-id: r46483
"
"ac28e8165f74a2f425ca78e8ef719179b77127d1","2009-12-22 20:44:03+00:00","SCI/new music code:
- Reverted the code to use local copies of certain sound object selectors, like what was done before
- Simplified and fixed the SCI1.1 digital sound effect playing code
- Removed some duplicate code
- Renamed some sound commands

svn-id: r46487
"
"ca92253da1f306162e01f0afcc5d77852ce29a34","2009-12-22 20:53:03+00:00","Disabled some currently unused code

svn-id: r46488
"
"d910861c5c6d7abe6ed3b08835bf0ac5f2b8cca6","2009-12-22 23:15:35+00:00","Specify file size for PC-Spiele German Indy3 as provided in bug#2916434

svn-id: r46489
"
"bac7961b3f8f5692fcdd5683866d6e9f935a7ca6","2009-12-22 23:37:31+00:00","Patch #2896875: 'dist update for linuxmoto-platform'

svn-id: r46491
"
"4be2788ffd8b9e8ec8a2ba6080bcd7701bd6c08a","2009-12-23 05:10:16+00:00","Some SCI32 (minor) String  bug fixes and cleanup.

svn-id: r46492
"
"957737d0182b9a99225e3645e60087d7fdc36a4b","2009-12-23 12:39:24+00:00","SCI: sound resource handling fixed (fixes lsl5 music w/ new music code)

svn-id: r46494
"
"162b6972207ae80e741d5671902b03cef8a142b9","2009-12-23 12:49:38+00:00","SCI: sound resource added data format comments

svn-id: r46495
"
"dfd09bc025a031ff64a118c9ef04619ba4f3fc95","2009-12-23 13:29:06+00:00","SCI/new music code: Do not cache the signal selector, as it needs to be always updated, so that animations can be synced properly by the game scripts. Fixes KQ6

svn-id: r46496
"
"aa8a227d143b30582a99dc45611237f79d9e6cca","2009-12-23 13:34:19+00:00","fix typo

svn-id: r46497
"
"fd861aaac4a4806bc53eecd6c7df4c9bac59da6f","2009-12-23 16:17:42+00:00","SCI: new music code / variable-names changed to make it more verbose

svn-id: r46502
"
"54ec4654e9fc65356ec8ed69066a39ff35b514b2","2009-12-23 16:21:32+00:00","SCI: new music code / removed unused sz from Track struct

svn-id: r46503
"
"9fb61bce1309dd63bc9ff4a4abff7409ece4c645","2009-12-23 16:33:12+00:00","SCI/new music code: Removed the checks for the nodePtr selector, as we already have equivalent sanity checks (so that it's easier to add SCI0 functionality, which doesn't have a nodePtr selector)

svn-id: r46504
"
"f716942919af0de50023188060592d648ceeb8ce","2009-12-23 16:43:24+00:00","SCI/new music code: Added a sanity check to avoid changing some selectors that don't exist in SCI0

svn-id: r46505
"
"096b46f1d5f77f97a59a7087d203efc4c834dccb","2009-12-23 16:51:41+00:00","SCI: new music code / wip support for sci0 music

svn-id: r46507
"
"a526e35d3d89754c801283588667168bc772c618","2009-12-23 17:07:01+00:00","SCI: Fix warning

svn-id: r46509
"
"77f5bbc4f4febf8298313e80e64edc18bb0f8adb","2009-12-23 18:34:19+00:00","SCI/new music code: Some fixes for SCI0 music, and removed a duplicate enum

svn-id: r46510
"
"caf1ab2a00ba2f58be29e89d780b69af2587119f","2009-12-23 18:46:10+00:00","Fixed compilation

svn-id: r46511
"
"51766d83ede7f2e22a4eebcc12c507a798cdfa92","2009-12-23 20:13:54+00:00","SCI/new music code: Song handles are now unique (as SCI0 relies on them, rather than on nodePtr)

svn-id: r46512
"
"f6b210bb8657261bce8d5888c291cfa29d119d33","2009-12-23 21:03:28+00:00","Patch #2898445: 'MM NES: Add support for original save/load dialog'

svn-id: r46513
"
"6dfa3c152ccf5d59dc333753cef2b1ec33c9feb0","2009-12-23 21:04:28+00:00","Mention MM NES save/load dialog in NEWS file.

svn-id: r46514
"
"1adf1cbb167c873d1f43798f6df299049c229399","2009-12-23 21:11:53+00:00","fixed invalid debug level

svn-id: r46515
"
"544a92a468d2a93fc26c42f6b323dadf3a7154c4","2009-12-23 21:12:15+00:00","Patch #2895458: 'SCUMM: Add support for SEGA-CD MI Passcodes'

svn-id: r46516
"
"0936378e3620f57562cbb6baddeec0cffbb25196","2009-12-23 21:13:27+00:00","Mention Sega CD passcodes in NEWS file.

svn-id: r46517
"
"67fa3a92fbd4ce7a456e2f9f7cdcce5a00fc7b57","2009-12-23 21:16:07+00:00","mentioned teenagent/dragon historie in NEWS

svn-id: r46518
"
"ff4769cbed8ebf4897e819dd26093257746cf689","2009-12-23 21:25:00+00:00","Sort list of new games in chronological order like everything else

svn-id: r46519
"
"963dc5f142160bc223cccfe699a9e4f4d8c1a84a","2009-12-23 21:35:32+00:00","Add more information to Italian fan translations of ITE as mentioned in
bugreport #2871990: 'ITE: Italian FAN translation regression'

svn-id: r46520
"
"65dcc0b2a366cdcf84601263b942448654e92c30","2009-12-24 02:43:07+00:00","SCI32:
- Fix dup for kArray/kString
- Implement kFileIO::rename (SCI1.1)
- Implement part of the SCI32 additions to kFileIO
- Implement the GetSaveDir part of kSave (SCI2.1)
- Torin (SCI2.1!) now shows signs of life -- it will create the torin.prf file with correct data!

svn-id: r46521
"
"b63cbe2577a6091fc832e5cdaadcc70109c664c8","2009-12-24 08:26:13+00:00","JPEG tweaks and optimization (thanks to digitall)

svn-id: r46522
"
"b2ae0e56c5f2870cdbcab20d89b9068d6be5f2f8","2009-12-24 08:33:37+00:00","Tweak Groovie2 video buffer handling

svn-id: r46523
"
"a55e0531e8ffae3e957f1f1e320b8bf5152f09db","2009-12-24 08:35:11+00:00","11H: Add some more opcode stubs

svn-id: r46524
"
"8e3d34c8a007b719efea04a909fcd648f069c112","2009-12-24 11:42:37+00:00","SCI: channels are now filtered for sci0 (fixes garbled music)

svn-id: r46525
"
"f5d8bb1d5e0c9e3d559d263bf7f02ca5a447e978","2009-12-24 13:20:23+00:00","SCI: new music code / dont filter channel 15 (control) at any time

svn-id: r46526
"
"69fa167902be5cdd28cd6d1620be7f0c9628c944","2009-12-24 13:50:50+00:00","SCI32: The view related functions pass a view object as parameter, and the engine should deduce the parameters it needs from that object. Added stub view functions based on that fact. Also, added a sanity check in kCelHigh and kCelWide

svn-id: r46527
"
"c8a3d163d1b06c71e397222becaed87f61bf9597","2009-12-24 14:18:16+00:00","Added a hack in kAddScreenItem to display the view in question on screen. Some parts of the main menu can be seen now in GK1

svn-id: r46528
"
"9072b0c26e01615d9a8b029ed703ede102659e99","2009-12-24 15:02:06+00:00","SCI32: Added some more stubs for picture manipulation, screen update and animation functions

svn-id: r46529
"
"f73e9c43c4aafc1689a0114d05c54f86f70c0efa","2009-12-24 15:24:48+00:00","Updated comments in kListEachElementDo() to show how it's called, with the help of waltervn

svn-id: r46530
"
"7867716b6e5619a9df57430d585a909b8bf70e0b","2009-12-24 16:46:15+00:00","Obtain channel mask from music drivers. Also, added a warning in cmdReverb() to indicate that it's a stub function

svn-id: r46531
"
"d7cd8345c0ea2688101b3a0d059f6dc7ae45abd6","2009-12-24 17:40:45+00:00","SCI: new music code / signals now almost correctly triggered

svn-id: r46532
"
"996da19fc98eba75c96cd0fa82ef440b0c45e4dc","2009-12-24 18:37:35+00:00","Stub SCI32's kOnMe to give better debugging info (used when clicking in the GK1 menu).

svn-id: r46533
"
"7bf92fc7957469cd35f438cd9b602ac2e7d26393","2009-12-24 18:41:26+00:00","LOL: fixed minor bug in lamp code

svn-id: r46534
"
"20c39b05eacbb761133820310422801c35c7a2c8","2009-12-24 18:43:18+00:00","Silence some gcc warnings.

svn-id: r46535
"
"98053616d18de1439438f962e2b63c0c33158710","2009-12-24 20:45:32+00:00","Silenced some MSVC warnings

svn-id: r46536
"
"49c41a0c6c860a57e4797d4f95ed3c0a6ad0eb7f","2009-12-24 21:36:57+00:00","Fix detection for ITE Floppy Italian

svn-id: r46537
"
"16166de90c2268351e44bb5f88edb3a78ad0e88e","2009-12-24 22:30:49+00:00","SCI/newmusic: support for 0xF8 delta in parseNextEvent, changes to channel filtering (including temporary debug output)

svn-id: r46538
"
"4e45107be1b34e7edfba0869f889a4208d9eb705","2009-12-24 23:53:16+00:00","SCI/newmusic: Set signal after waiting for delta and not immediately (fixes iceman intro)

svn-id: r46539
"
"74d28bf8e74b693157960883163cf5449b433236","2009-12-25 01:00:17+00:00","Commit of patch #2909981 'create_msvc: Updated default warnings + per-project warnings' with some slight changes.

svn-id: r46540
"
"f2dd376b385bd6b1b513fe97004aa2dfc3422d15","2009-12-25 01:00:57+00:00","Removed a const-away cast.

svn-id: r46541
"
"f642687638f809a7669d4154b8d70a3e7e013154","2009-12-25 03:29:17+00:00","Fix gcc warning (and along with it make the code a little bit easier to read).

svn-id: r46542
"
"c439937d46c13f4c5d7e67732a3a12ccff3e4dc5","2009-12-25 03:31:19+00:00","Consistency change: Use uniform copyright strings in getOriginalCopyright.

svn-id: r46543
"
"02f23a6113873c3bcabf3964dd0ef9c480f02bd6","2009-12-25 08:00:51+00:00","SCI/newmusic: Filter was processing one byte too much

svn-id: r46544
"
"16e548f67d749f19423a3dbe6f88fa90527abca1","2009-12-25 10:06:59+00:00","Slight code readability cleanup

svn-id: r46545
"
"8cd9b3bd760033ff794828e98fd97b6c0283469d","2009-12-25 11:08:12+00:00","Another readability change

svn-id: r46546
"
"55f55a14441536958d52639b73321a4f92597c1f","2009-12-25 13:13:42+00:00","SCI/newmusic: ignore vol selector for games prior sci1late, fixes amiga music in sq3

svn-id: r46547
"
"5989195d8433bd52574c0bf1a68629f6b6b97f1e","2009-12-25 13:17:30+00:00","SCI/newmusic: _signalSet, _signalToSet init, debug output added for signals

svn-id: r46548
"
"809e8c91235c69a4f035f8fceeb16a7cc0327170","2009-12-25 13:18:48+00:00","SCI/new music code: Some initial code for saving/loading the sound state

svn-id: r46549
"
"a5bb030b6eb7e9ab8e68b1c959c5178ac459fbbf","2009-12-25 13:26:09+00:00","Properly initialize the audio stream part of each music slot when loading

svn-id: r46550
"
"62234507813f8f9373201f8a2d1e9720a383cad1","2009-12-25 13:26:13+00:00","Fix compilation.

svn-id: r46551
"
"f5567d4605759c06f6ad24b2cc0b53b6d030247c","2009-12-25 13:37:55+00:00","Fixed variable capitalization

svn-id: r46552
"
"c03e7c8586429a8f65cf815c13024a38b1557377","2009-12-25 13:52:40+00:00","SCI/newmusic: find slot again after destroying it fixes kq6cd, lb2cd, added debug output

svn-id: r46553
"
"ec5c42e1f303973e48afcfe4509a1d053e6154ae","2009-12-25 14:02:28+00:00","Limit volume range to 0 - 255

svn-id: r46554
"
"586ec94df9d450f1f57372e48960a6e07b40f45b","2009-12-25 15:24:35+00:00","Adjusted volume clipping

svn-id: r46555
"
"924c950ed443c4e49ddbe31e6a48f96affff15e2","2009-12-25 15:44:25+00:00","Added mutexes in music functions

svn-id: r46556
"
"09081ce128575d88f97d2cf926c20cd443bc91a8","2009-12-25 15:58:18+00:00","Ignore internal SysEx events in the Adlib player

svn-id: r46557
"
"86701f4019b754c94a8b10b4a32d0b4dbef5a60f","2009-12-25 16:20:40+00:00","Added a stub for signal 0xA0 (polyphonic key pressure - aftertouch)

svn-id: r46558
"
"16eff8660dce2d60cfe5291041bbf618f149766c","2009-12-25 16:29:16+00:00","SCI/newmusic: Adlib driver / added comment that sierra adlib driver did not support aftertouch

svn-id: r46559
"
"113c0941ae8d79f23eb6ea54aaf9e784ecd670cd","2009-12-25 18:15:16+00:00","- Introduced a new version in the sound version detection routine, as SCI0 early games had different sound than SCI0 late ones
- Changed sound-related debug output from printf's into debugC calls

svn-id: r46560
"
"c2f17f9bb93787ec419b9b08659c6a6138c2b903","2009-12-25 18:25:15+00:00","SCI/newmusic: support for early sound resource format, early kq4 version now gets music, is not filtered yet

svn-id: r46561
"
"f9754ca68b3a38312890d6faaffc9694ce1900d8","2009-12-25 18:37:07+00:00","Remove extra debug output which sneaked in.

svn-id: r46562
"
"2f5f625b98230b345371c666a93602c4fec6ba7c","2009-12-25 18:59:15+00:00","SCI/newmusic: added filter support for kq4early and adlib

svn-id: r46563
"
"9255d43a16e1c3e65e46d198ec606fcef07ff71a","2009-12-25 21:51:02+00:00","SCI/newmusic: Change to channel filtering for sci0early to reflect actual sierra driver behaviour

svn-id: r46564
"
"ff00963a8b4dc6a8db9534d166406f37b12692c0","2009-12-25 21:54:31+00:00","Silence a bunch of gcc warnings (and Merry Christmas, if you celebrate).

svn-id: r46565
"
"4dbb9c0806abc83ab40db21728e616a9c31dfbab","2009-12-25 22:14:41+00:00","SCI: implemented command 0x80 (stopnote) for amiga music driver

svn-id: r46566
"
"46eb68090c36463f4683387ccc586ce3588af5b4","2009-12-25 22:58:45+00:00","SCI/newmusic: Added comments about sound resource headers

svn-id: r46567
"
"a88e4df7a0d01e572d7c942da67d53799fb4a6b5","2009-12-26 00:22:21+00:00","SCI/new music code: Fixed a bug where music was stopped when saving. Some cleanup

svn-id: r46568
"
"12b6d4ab032cad05e54b9a40bd8c36736597bb71","2009-12-26 00:50:09+00:00","Some more work on the new music code

svn-id: r46569
"
"ab2a5429f5c8e788d1a2ffa43c3b6128e1b5e68a","2009-12-26 01:20:12+00:00","Set the save game directory to something in pre-SCI32 games, as games like SQ4CD complain that it's invalid if it's empty

svn-id: r46570
"
"4807dbdb28896bbebb49d785f777327c82db31a8","2009-12-26 01:37:09+00:00","Remove obsolete skycpt Makefile

svn-id: r46572
"
"6c0dc96fd3ba2a8aa3498b3de71d9fea7cf57881","2009-12-26 01:37:31+00:00","Tweak and rename skycpt ReadMe.txt -> README

svn-id: r46573
"
"ddce48ed03a0bb5c28c5f13e9e3c5016e3bed2a1","2009-12-26 01:38:57+00:00","Remove x86 ASM version of sykcpt code, just use the generic code everywhere

svn-id: r46574
"
"c78c10b9ee4febba16614782c90975e7c85de36f","2009-12-26 10:20:57+00:00","SCI/newmusic: Removed mutex from onTimer, fixes freeze in sci1 games

svn-id: r46575
"
"bc0da4dce86f4cefd019ecb034d57f6c3d11f601","2009-12-26 10:43:37+00:00","Change teenagent engine to use CursorMan instead of using OSystem directly.

svn-id: r46576
"
"8940a1f537af66953bb8d4d32b7a2250744afc19","2009-12-26 10:50:05+00:00","Restored the mutexes in onTimer, and removed them from soundKill - fixes the freeze in LSL5 intro

svn-id: r46577
"
"c6a8d0e97399dc01f1d4263d752adcb73d7a95d2","2009-12-26 11:54:57+00:00","- Made the music playlist private
- Removed some leaks
- Fixed the destruction of the music playlist
- Made mutexes more sane
- Removed some dead code
- Cleanup

svn-id: r46578
"
"d39ac80f4a8667c20f09c765bcdb9701a828dc28","2009-12-26 13:20:07+00:00","Hopefully fixed the freezes/deadlocks in the new music code (e.g. in LSL5 and Castle of Dr. Brain)

svn-id: r46579
"
"21c6bbc588a981cf8facd63432845a2c81e73e48","2009-12-26 13:35:17+00:00","Fixed graphics functions detection in an old version of SQ3 - my initial thought to rely on the presence of the shiftParser selector was wrong

svn-id: r46580
"
"9d70103d9c84c0dc993faafddcf3fd00b02241ea","2009-12-26 13:35:57+00:00","The file selection dialog in OS X now uses Cocoa instead of Carbon, and lives in a separate file due to having to be compiled as Objective-C++. ScummVM can now run in x64 natively on OS X

svn-id: r46581
"
"925c1744ec7af876ef64d94b5f9250e80630317c","2009-12-26 13:48:14+00:00","Committing the actual new browser_osx.mm file, oops

svn-id: r46583
"
"0de0abb5d34575ebcb3cbf3d58357f17fc00ff96","2009-12-26 13:50:52+00:00","Case kSciAudioLanguage in kDoAudio always checks for audio capability in SCI1.1 games, regardless of parameters. Fixes a warning in SQ4CD

svn-id: r46584
"
"4f02900890297801c555b1fbd000f26690c37011","2009-12-26 13:53:59+00:00","Kernel function 0x26 is empty in SCI1.1 games, and it has been set to kPortrait in KQ6CD only

svn-id: r46585
"
"657b881c4ec1d39bf9d504bd135ee30b91fab6bb","2009-12-26 14:03:13+00:00","Updated xcode project

svn-id: r46586
"
"193b23bcad887fc3d6e5343f755e236936b9c969","2009-12-26 14:12:38+00:00","LOL: fixed minor bug in lamp code

svn-id: r46587
"
"71f6fede6030fcb6e9e05024146eac0840a8ba18","2009-12-26 14:58:23+00:00","Removed the file and line parameters from the selector handling functions

svn-id: r46588
"
"b2c170168e4e970c1d8025658800d4d45037a095","2009-12-26 15:47:57+00:00","SCI2: Implemented kListEachElementDo (a more advanced version of SciGuiAnimate:invoke()) and kListAt. Now, the Sierra logo music can be heard, and game logic is running on objects of the animated views list

svn-id: r46591
"
"b21679e56ee76be47bf5fb10bcd0592b7b19e6f2","2009-12-26 16:00:41+00:00","Buildbot compile fix for os x cross compile

svn-id: r46592
"
"4e743e1a467aab8250172d4bb57be5e8484eed0a","2009-12-26 16:16:02+00:00","SCI2: Figured out the screen coordinates of views. Now, part of the interface can be seen in GK1. Also, silenced the OnMe warnings

svn-id: r46593
"
"1a1b041d00084070da7f3e0d3564869ebe9a1f35","2009-12-26 16:57:34+00:00","Add 'End of namespace' comment.

svn-id: r46594
"
"d2ac0362694fcf6017662c3837e0d27836659e2f","2009-12-26 16:59:14+00:00","Fixed sentence -> buildbot rebuild

svn-id: r46595
"
"f6da0146b20913bf2ba9a4493eaec6d929e4facc","2009-12-26 17:10:43+00:00","Throw a warning when we're trying to invoke a variable selector, instead of swallowing it silently. This should never happen, so we shouldn't hide it, when it does

svn-id: r46596
"
"915c60c62978dbd15b1345d69a2c1f5db3f19a2f","2009-12-26 17:18:18+00:00","Using #include instead of #import to include some mac os x headers to avoid silly gcc warnings, that we'd otherwise have to remove -pedantic to get rid of

svn-id: r46597
"
"4950d0de78b270c4e1105f586dc6d06e1eef3e01","2009-12-26 17:46:22+00:00","Look for Makefile.common instead of Makefile, when determining whether or not we need to generate a Makefile for building outside the source tree. This to make sure any changes will actually take effect

svn-id: r46598
"
"78d268b21a65bcf4e7909f87374a08bec22c7ffe","2009-12-26 18:07:36+00:00","SCI/newgui: Added support for draw_pic command

svn-id: r46599
"
"2a0b03218c3d6afffac9bebff798850c27f67bd0","2009-12-26 19:02:16+00:00","LOL: - added workaround for portrait speech animations which would sometimes 'freeze'
- renamed some stuff

svn-id: r46601
"
"20c2d35a92bd4da5c97bc28687bc1019fc197ddb","2009-12-26 19:06:17+00:00","SCI: support for sci32 picture resource data

svn-id: r46602
"
"984cac84cf699495e5991d1eac3f13da583af41e","2009-12-26 19:23:57+00:00","SCI: support for 'no compression' pictures in sci32

svn-id: r46603
"
"0536f58670f54ab87b8f406999d108ec5d092753","2009-12-26 19:25:32+00:00","SCI: added TODO priority map of sci32 pictures

svn-id: r46604
"
"0d20ecc5d4e1496c853cdb4f627e5647e8b2d52d","2009-12-26 21:19:48+00:00","SCI: Added #ifdefs for sci32 picture format code

svn-id: r46605
"
"0e513a306dae9485801ee39f1135891c36bf01f1","2009-12-26 21:47:59+00:00","SCI/newmusic: Update state when music is done playing (fixes sq3)

svn-id: r46606
"
"6eb5c2f8096b8c25962a8c0970ab06010f3be9b6","2009-12-26 22:26:12+00:00","SCI/newmusic: added state change to sample play as well

svn-id: r46607
"
"a4990f6f334b3d52c5a593750df9bcd4034d8442","2009-12-27 01:49:39+00:00","Now using m_kiewitz's picture code to show pictures in SCI32. Also took some bits off a similar patch from clone2727. The Sierra logo screen and the menu screen in GK1 should now be shown fully!

svn-id: r46609
"
"93bdde93170ee9b75acaa7e6dfef7c1a6e33599a","2009-12-27 02:29:58+00:00","The state selector is only available in SCI0 games

svn-id: r46610
"
"b1c37aee206dd186eb80d971b98013d06b0a5134","2009-12-27 02:46:00+00:00","SCI/new music code: split the MidiParser class into a separate file

svn-id: r46611
"
"e93905463786da5e787f65818f263b911f33f4e5","2009-12-27 02:55:39+00:00","Silenced a chatty console debug message

svn-id: r46612
"
"88516633636680866d6ccb269756e81a85a7c2f4","2009-12-27 02:57:03+00:00","Turned some unimplemented debug related kernel functions into dummy functions

svn-id: r46613
"
"ebb391790f88f4eb370764062d6bd54e4479e47f","2009-12-27 03:57:59+00:00","SCI32: Partially implemented kOnMe. Now the main menu in GK1 works

svn-id: r46614
"
"60b33656863c080e69a845f02d2f6311850efb79","2009-12-27 09:54:11+00:00","added tests for sort() functions

svn-id: r46615
"
"18d4bbdccc1b1c2118b20cbbeb850d4b2d11d01a","2009-12-27 10:05:37+00:00","fixed typo

svn-id: r46616
"
"835c6c0d6325818f075c157ad57edb182b361c54","2009-12-27 10:47:34+00:00","Cleanup.

svn-id: r46617
"
"7f8beedda72d14216abe91fb5c24a06cd9dc9da3","2009-12-27 11:05:22+00:00","Use some pseudo random numbers in test_container_sort.

svn-id: r46618
"
"1cd917f67446be1438fabfdec43b87e6f6f797a7","2009-12-27 11:05:43+00:00","More cleanup.

svn-id: r46619
"
"cbeb0011897c85d19d76602cfa8f9cc49ee7315a","2009-12-27 11:06:05+00:00","Do not use TS_ASSERT_EQUALS in checkSort, but rather let return checkSort an
boolean, which indicates whether the sequence is sorted by the given predicate.
This allows for easier checking which order related tests failed.

svn-id: r46620
"
"11a835b6ce3a0bfe4b985c94361247f8916ea7e6","2009-12-27 11:12:05+00:00","Typo.

svn-id: r46621
"
"3c99391b49d1b4ee40d2f74f94b290f9cdcefb49","2009-12-27 11:12:26+00:00","Add some tests for checkSort just in case... :-)

svn-id: r46622
"
"0a771e14c1ffac674ac597d8960f9d7435436748","2009-12-27 11:43:34+00:00","SCI/new music code:
- Removed a lot of accessors to the music list, and protected the 2 which are used now with mutexes
- Rewrote the music list save/load code to be methods of the SciMusic class

svn-id: r46623
"
"6536432b30d222b0bf0e56f084b671fdba0734ff","2009-12-27 11:56:51+00:00","Changed some comments

svn-id: r46624
"
"19cb4ad6e02927607af851d08d1b176cbb1f8bea","2009-12-27 12:12:14+00:00","Hopefully fixed compilation

svn-id: r46628
"
"e6ad7523c8acdd1bf0fc37e841da627f568d6fcd","2009-12-27 12:17:43+00:00","SCI/newmusic: now adding digital sample data as separate channel for sci0 games (not yet playing)

svn-id: r46629
"
"6af32b5b3a5c2bf5cb96c91c8abc3dbfd7589f7f","2009-12-27 12:21:12+00:00","Really fixed compilation

svn-id: r46630
"
"fb237cd7aedf094621db54249fc41282a90d57ca","2009-12-27 12:33:47+00:00","SCI/newmusic: now playing sample data for sci0 games (this also fixes sq3 amiga freezing during pot exit)

svn-id: r46631
"
"f01a6c9adf5e4303b92aba82d15169a6d0c97095","2009-12-27 12:38:19+00:00","SCI/newmusic: moving commented assert

svn-id: r46632
"
"fabe51c129ef9d85e6f3c0f73ad16e66f7b3623b","2009-12-27 12:54:03+00:00","Renamed gameName -> gameId, to keep the same vocabulary everywhere

svn-id: r46635
"
"668ecc5d387e8acd7fd03a31fbabd062c76c8af7","2009-12-27 13:19:44+00:00","replaced bubble sort with quick sort
added distance(a, b) functions

svn-id: r46638
"
"17380ba06e4c8dd3574d443b3d874fd0a151d8ec","2009-12-27 13:25:07+00:00","added whitespace to conform code convention

svn-id: r46639
"
"cddb95d9c3fa57ccb4b73f5b697129d13efe00f8","2009-12-27 13:33:12+00:00","more code convention fixes

svn-id: r46640
"
"69ba1ee04d537c95b5dfc4d57506f7278ebdc94e","2009-12-27 13:58:00+00:00","Some more code format fixes.

svn-id: r46641
"
"9f37be314d29189a7709e400b2ded6afd0d1e3fa","2009-12-27 14:11:26+00:00","SCI/new music code:
- Implemented sound muting
- Now saving/loading the master music volume

svn-id: r46643
"
"3936861b7c40912123c687ed5999639cb6f00787","2009-12-27 14:13:39+00:00","allowed list to be sorted with default comparator

svn-id: r46644
"
"fbf1bada24e9ef415206780d4b3dc963e258e193","2009-12-27 14:25:25+00:00","cmdGetPolyphony always returns true in SCI0, according to specs

svn-id: r46647
"
"4cbac8a2bbca9ba519a66428df97e85ba5223b4c","2009-12-27 15:23:56+00:00","Added some currently disabled code to be used when sound fading is done (needs testing)

svn-id: r46649
"
"ac224a7f8a9b086f4cd26e5c30751edb7ba526f4","2009-12-27 15:24:33+00:00","Removed _hasNodePtr

svn-id: r46650
"
"e371c4a1bde1e3623cbbe0d525fc945a741259d2","2009-12-27 15:41:31+00:00","SCI/newmusic: Fixed fading (fixes intro of castle of brain)

svn-id: r46651
"
"95f90be7efde138d2792798cb013c3685be7cf25","2009-12-27 16:44:38+00:00","Fixed priority bug

svn-id: r46652
"
"3e915d9ec5b7b57d1d1914f18946a60bd4c93529","2009-12-27 18:21:49+00:00","implemented fade in/out effects

svn-id: r46653
"
"3b30b1dcfa8ec4017157b661ff2a52e558cc6c5f","2009-12-27 18:24:48+00:00","SCI/newmusic: fix getting of mastervolume. cause of rounding we will otherwise decrease mastervolume by 1 on every access resulting in no sound after a while :) (fixes lb2, sq4cd and others)

svn-id: r46654
"
"264bec306a642b4f40ef88b31c40e7421ddfab9a","2009-12-27 19:16:06+00:00","Implement kPlatform subfunctions 0 and 2, and stub 1 and 3 (CD speed and CD check). This fixes the DOS version of GK1 CD to play the SEQ's instead of the AVI's.

svn-id: r46656
"
"4f78c872d731bf5b567d191d533b3fc1081f04e4","2009-12-27 20:38:14+00:00","SCI/newmusic: Accept WAVE files as audio resources (needed for gk1 title music) - requires additional resourcemanager support (or rename sfx\5.wav to 5.aud and add 8Dh 00h header)

svn-id: r46658
"
"9511b474dcba3447120f0eda7f4eda2a954b7d2d","2009-12-27 20:56:10+00:00","fix resource refactor regression

svn-id: r46659
"
"420ab4306604db8c6ffe69d28b929c3b23a6ad30","2009-12-27 22:34:12+00:00","Add support for external wave files used as audio resources in the ResourceManager. The GK1 CD main menu music now works.

svn-id: r46660
"
"86306e1e4d5b24aef93d150b7b05ee0c05021521","2009-12-27 22:41:33+00:00","wCompressed is still a uint16 in SCI32, so correct the vol version detection.

svn-id: r46661
"
"538806af19285b3dcf2408b44cede4c70f3cc278","2009-12-27 22:55:37+00:00","SCI/newmusic: fixed warning

svn-id: r46663
"
"fedd4f10768771556c74ef24eacd31654b55af78","2009-12-27 23:35:22+00:00","Fix regression in SCI1/1.1 wave sound from r46660. I knew it was a bad omen to have that revision number :P

svn-id: r46664
"
"5adb6277eb3bf0badd6d2403177ce4411c89ee13","2009-12-27 23:46:11+00:00","SCI/new music code:
- Switched to Common::StackLock for mutexes
- Renamed Music::stopAll() -> Music::clearPlayList()
- Implemented a better Music::stopAll method, which stops all sounds with proper signals, instead of destroying them
- Renamed the SCI0 command cmdGetPlayNext -> cmdStopAllSounds and implemented it

svn-id: r46665
"
"6c8ee76f80117c03f68c4ea96cc51adb9b81b127","2009-12-28 00:15:31+00:00","SCI/new music code: Fixed music fading in SCI2 - seems like setting the signal when fading is done isn't necessary

svn-id: r46666
"
"84569c47920f3d51c538b5d1525a20ef0bdf79fd","2009-12-28 06:24:06+00:00","Added MD5 data for Russian Discworld 1

svn-id: r46667
"
"f93537b2e5fc65e397554024f2869d31666eeb1f","2009-12-28 10:27:56+00:00","SCI/new music code: Fixed a race condition when removing a sound from the playlist

svn-id: r46668
"
"f41674fd51aa79d096b4aba6f2bafba3d401a3f7","2009-12-28 10:42:14+00:00","SCI/new music code: Hanging notes now stop when a sound is paused/stopped

svn-id: r46669
"
"62c1c2633dbb94a84cffec093e6a2118946ef8c9","2009-12-28 11:23:20+00:00","SCI/new music code: Implemented the 'songlib' debug command

svn-id: r46670
"
"2973862488aebfbcdd954701ee1cf5875da5dda1","2009-12-28 14:22:11+00:00","Added a workaround for an off-by-one invalid species access bug in the LSL2 demo

svn-id: r46673
"
"9f63095688cea735e316b1f6d759d9135eb0bd41","2009-12-28 15:08:53+00:00","LOL: fixed debug message

svn-id: r46675
"
"b6ca638180acbe8b9b45f2a17b97a6c527eaf9e0","2009-12-28 15:53:13+00:00","Create the stream dynamically in playSoundData(), to avoid a crash (spotted by
salty-horse) when makeWAVStream() deletes it.

svn-id: r46676
"
"3c6b7ce3b5474fb893c8623e3af558806c6c76c6","2009-12-28 16:21:59+00:00","Fixed music pausing

svn-id: r46677
"
"0a6e2127acec9039d4cb98637d189fb84504e8d1","2009-12-28 16:23:00+00:00","SCI/new music code: Added a workaround for a music-related game bug in Castle of Dr. Brain

svn-id: r46678
"
"871d5c534d4669a075023f51bc06417418bd080e","2009-12-28 17:17:22+00:00","Moved the OLD_PATHFINDING define inside sci.h, together with the others

svn-id: r46679
"
"5cb5fe22ea2fc77473ba9d8714d66a712b061e1e","2009-12-28 20:10:15+00:00","SCI/new sound code:
- Made the SciMusic class private, and added wrapper functions for invoking specific methods of SciMusic from outside the SoundCommandParser class
- Many SCI games keep creating and destroying sound effects constantly (i.e. many times per second). Therefore, another scheme has been devised, which replaces the mutex that was in place. Whenever a sound command is run which operates on a specific object in the play list, we disallow onTimer() from kicking in. This isn't ideal, but it does stop random deadlocks because of locked mutexes without any noticeable side effects

svn-id: r46681
"
"3aded71f55487851b3c429a9788829d11a53533d","2009-12-28 20:58:00+00:00","SCI: Make some code comply to our naming conventions

svn-id: r46685
"
"594e202683d79ad7b34c7fa99938bb668dc89bbe","2009-12-28 21:00:59+00:00","cleanup

svn-id: r46686
"
"81a1d45821932bf847ccf9b5a6e805d59ba0f27a","2009-12-28 21:03:13+00:00","SCI: Start objectifying MusicEntry

svn-id: r46687
"
"ebbc33c3cafc2bd558f9ee2ae44e8ef1a291e0a7","2009-12-28 21:04:35+00:00","Spelling: Par*r*tition

svn-id: r46688
"
"34e21c3767118851c1fe5729a95b56e0ca575110","2009-12-28 21:06:44+00:00","SCI: Further objectify MusicEntry

svn-id: r46689
"
"f8abf06276ee0e6b0daf544f519ebe5c82fa577b","2009-12-28 22:35:53+00:00","SCI/newmusic: Accept object 0:0 in cmdPauseHandle, pause the whole playlist then (fixes castle of dr. brain during intro)

svn-id: r46690
"
"faff5b2123c644015df213010ebd9a05cc9d1ba4","2009-12-28 22:45:26+00:00","SCI/newmusic: Added comment about weird sierra sci behaviour

svn-id: r46691
"
"dd1fc9c14bb17d2a599799ed11f124db18b3fad7","2009-12-28 22:52:07+00:00","SCI/new music code: Implemented cmdSendMidi, and removed access to _argc from sound commands

svn-id: r46692
"
"b65e4a8f749d90b7c5109b5b2cb9e5ac188815c4","2009-12-28 22:57:43+00:00","SCI/newmusic: Added pausecounter cause sierra sci also does this

svn-id: r46693
"
"ac4551a39f838b945feb2847ebacc71eb3003c03","2009-12-29 00:22:39+00:00","SCI/new music code: cmdPauseHandle/cmdResumeHandle now work for SCI0 games

svn-id: r46697
"
"53068b9e429b90c4fe1618aa49dd960ba8976286","2009-12-29 01:24:02+00:00","Removed leftover debug output

svn-id: r46698
"
"a6aa3d6363b95422581eef80958246154b9b98be","2009-12-29 01:27:15+00:00","Better checking for the cmdMuteSound and cmdVolume special cases

svn-id: r46699
"
"dbbe7fd7f8e79632c1966872cbbc40e914b48e21","2009-12-29 01:36:54+00:00","SCI/new music code: Fixed loading of saved games. Also, stopped sounds are no longer paused

svn-id: r46700
"
"dabfe53c66c415b58e482d5b03ba9ac3951cbb11","2009-12-29 02:21:04+00:00","Reverted rev #46647 - the title music in Codename: Iceman works correctly again

svn-id: r46701
"
"2d7c1e2c71bce0181bf821001f7a30a02e71473f","2009-12-29 08:56:41+00:00","Corrected the Russian Discworld 1 MD5 values

svn-id: r46704
"
"e44cc2c72d1fb35dbb90cd0722f2d3ed62d01bb3","2009-12-29 09:28:05+00:00","SCI/newmusic: changed pausecounter behaviour within resume

svn-id: r46706
"
"b7206b048c7dad74e2d998645980edfc4737fe31","2009-12-29 12:25:53+00:00","SCI/newmusic: changed pauseCounter again ;)

svn-id: r46707
"
"881b8310740fdc9d9d0d2d7f885251959af01fd9","2009-12-29 17:10:14+00:00","Adding CoktelVideo::hasExtraData(void), for checking if /any/ extra data files are embedded in the video file

svn-id: r46710
"
"10e62ea99217eb5d4173c13571bb45c37c6e3137","2009-12-29 18:07:06+00:00","Adding a getFrameWaitTime() method to get the frame waiting time instead of directly waiting

svn-id: r46712
"
"0fb1c8b1062bfa501a301dc56068099dd6c0a862","2009-12-29 18:17:14+00:00","SCI/newmusic: dont do pause/resume on the whole playlist prior sci1late (soundversion)

svn-id: r46713
"
"ef0f48584729038189d8f31fd5a99f37f5a718e5","2009-12-29 18:28:26+00:00","SCI/newmusic: Removed playlist-feature from cmdResumeHandle cause that is sci0 only

svn-id: r46714
"
"14d4b75afb00a47be666c23fc8e740d67178d026","2009-12-29 19:42:26+00:00","Added a thin wrapper around the VMD player class, so that it can be used with the common VideoPlayer interface, to be used with videos from SCI32 games

svn-id: r46715
"
"c453790efc9f0850f66b6d5a60dc4de2a523c5c7","2009-12-29 19:44:08+00:00","Updated module.mk

svn-id: r46716
"
"bca313c6fc85d54dd6a7d969a4b82e55bf863f4b","2009-12-29 20:41:09+00:00","Typo.

svn-id: r46717
"
"3e5d8280fadb8cf98a181c65c08d0c43be7af912","2009-12-29 21:37:26+00:00","SCI: dont crash when scripts are trying to access invalid memory (fixes intro of lb2cd)

svn-id: r46718
"
"c992cd018c4d31dff86cf9cfa19f5f7ac803d363","2009-12-29 22:26:09+00:00","SCI: returning back raw == 0, when script trying to access invalid memory

svn-id: r46720
"
"5f1d2a88b51af43d8903866b46a424fe556abb3c","2009-12-29 23:13:30+00:00","Fix warning

svn-id: r46726
"
"0ea022d076c491d802431ee90b658d5e8c06d0e0","2009-12-29 23:18:24+00:00","Add Mohawk engine code. Part 1/3: main code.

svn-id: r46727
"
"fb8ecae7f1904f9d992ce3a01356febcd94d9e36","2009-12-29 23:20:23+00:00","Add Mohawk engine code. Part 2/3: common code changes.

svn-id: r46728
"
"2576f4b0bdff2bcff5f8667780c1254b3f2d84a2","2009-12-29 23:25:24+00:00","SCI/newmusic: fixed fading (fixes gk1 demo, park area)

svn-id: r46730
"
"516495a4a1a66e907257e8545dd668a1613d61f2","2009-12-30 07:00:16+00:00","Silence some warnings seen in the buildbot.

svn-id: r46733
"
"1a66ad80a4b9bec6440060c5f941ca5f53833703","2009-12-30 07:14:09+00:00","Re-indentet switch() blocks to follow ScummVM indentation style. (I've always
found this style a bit unusual, but I value consistency.)

svn-id: r46734
"
"69c71c7628c5792e7cc7b49760e640d2be778696","2009-12-30 07:30:04+00:00","Removed some unnecessary whitespace. Changed some spaces to tabs.

svn-id: r46735
"
"bcc33871c117c0d1322ce8d90965782cec0157db","2009-12-30 10:09:48+00:00","The wrapper for the VMD decoder is only used in the SCI engine for SCI32 games, so moved it inside the engine, instead of common code. Added support for VMD video playing from the 'play_video' console command

svn-id: r46737
"
"dbfdd744263cdc9e9f21085b93465e974663e80c","2009-12-30 10:42:52+00:00","Updated documentation of the VMD decoder to indicate which SCI32 games used VMD videos

svn-id: r46738
"
"0e63912970f62a969de28257d0c4b06d679cec6c","2009-12-30 12:55:24+00:00","SCI32: added some of clone2727's changes to kArray and kString, and implemented kListIndexOf

svn-id: r46739
"
"5430de79314b85b5b7eb7b3372e49111f6c60a0b","2009-12-30 13:19:52+00:00","SCI32: added handling of variable selectors in kListEachElementDo() and silenced some annoying warnings

svn-id: r46740
"
"bbc52c13ab57b8b686342b8e71defc76b8615911","2009-12-30 13:43:17+00:00","Implemented ListFirstTrue(), thanks to the help of waltervn. Now, buttons can be highlighted and clicked when the control panel is shown in GK1, and the options dialog pops up when the options button is selected

svn-id: r46741
"
"d8b67ed7c609b2204073fec084a8e6a100924e11","2009-12-30 14:00:30+00:00","SCI32: Moved all the list related kernel functions inside klists.cpp, and implemented kListAllTrue with the help of waltervn

svn-id: r46742
"
"dde1f2931e0ce660f8c9787994b403be46cf9f63","2009-12-30 14:13:25+00:00","SCI: support for uncompressed sci1 views (fixes qfg3 demo)

svn-id: r46743
"
"17454ee80f29268ca228383b08d97b831e466bd3","2009-12-30 14:31:00+00:00","Initial implementation of the SCI21 kList kernel function (which calls all the other list-related functions), thanks to the help of waltervn

svn-id: r46744
"
"3e96fd7dc79bf943889c6432ab2cf96a821800e3","2009-12-30 14:46:06+00:00","Whitespace fixes

svn-id: r46745
"
"5f9febd1aaa52117a6c9fcb51bc2225cdf00cf14","2009-12-30 14:55:33+00:00","Update comments to reflect the changes used for Mohawk.

svn-id: r46746
"
"6305dde687a13bce1358b8fbade3a55e2301adca","2009-12-30 15:01:54+00:00","Fixed warnings

svn-id: r46747
"
"ed41d797efc641c660247bc09d055ce8adbcbda4","2009-12-30 15:24:16+00:00","Wrapped some IHNM-specific code around appropriate ifdef's

svn-id: r46749
"
"b775c03c29f6b256e9e01c5481949bb11300ce3a","2009-12-30 15:29:52+00:00","Use the special Cinepak YUV2RGB function in the Cinepak decoder. This makes the Riven videos match up with the backgrounds better. Thanks, Torbjorn\!

svn-id: r46750
"
"a314df52dfe2eac32edb0bbcc03ae8df7e197444","2009-12-30 15:38:50+00:00","Switched to the new pathfinding code, after talking with waltervn

svn-id: r46752
"
"7475bbbc3ffca0dcbc305167b9d468c39e1491f0","2009-12-30 15:41:11+00:00","Fix bug #2923380 (AMIGAOS4: Compiler error)

svn-id: r46753
"
"fd2d0fc7182e97fedf901b276bc7e48dcdcb4c13","2009-12-30 15:48:43+00:00","Formatting.

svn-id: r46755
"
"5382aa1ab0ac0b42a33a4b73664e3a8064b4211b","2009-12-30 16:00:56+00:00","SCI32:
- Set signature for Array/String
- Add the kernel table differences for the GK2 demo
- Implement kMessage changes in SCI32
- Use an empty string as the default path for all games now (and modify kValidPath to accept that only as valid)
- Add dereferencing for Arrays

svn-id: r46756
"
"24ac1f63c88f89ca41a71962050c71605b8d2d42","2009-12-30 16:03:54+00:00","Commit patch 1 'Extract version specific code' from fr #2891357 'create_msvc: Add support for MSVC10'.

svn-id: r46757
"
"1d2d9ec6aaeddcc189e413be82757fa63cffced4","2009-12-30 16:04:59+00:00","Commit patch 2 'Simplify createBuildProp code' from fr #2891357 'create_msvc: Add support for MSVC10'.

svn-id: r46758
"
"5a55e7420782d4eb2c0548fdcc921cb71814a2be","2009-12-30 16:06:25+00:00","Commit patch 3 'Silence warnings (in project files)' from fr #2891357 'create_msvc: Add support for MSVC10'.

svn-id: r46759
"
"ae7a7047a1cdd28ab36537b93c87d8dd6b8ba0a1","2009-12-30 16:27:12+00:00","Commit of slightly modified (formatting only) patch 4 'Add MSVC10 support' from fr #2891357 'create_msvc: Add support for MSVC10'.

svn-id: r46760
"
"564b2b9225c94e53b096527ddcdb194c05fd1ea3","2009-12-30 16:28:23+00:00","Commit of patch 5 'Add MSVC10 project & solution' from fr #2891357 'create_msvc: Add support for MSVC10'.

svn-id: r46761
"
"16966727e988773eecfa2d0bdb8d15eb8ca5c6ef","2009-12-30 16:29:29+00:00","Commit of patch 6 'Add MSVC10 dists folder (batch file and readme)' from fr #2891357 'create_msvc: Add support for MSVC10'.

svn-id: r46762
"
"de0aba0c183a8c9e2cafe70858cb1dc7807308d8","2009-12-30 16:29:59+00:00","Commit of modified patch 7 'Mention 2010 version in tools README' from fr #2891357 'create_msvc: Add support for MSVC10'. Most important modification is that MSVC 2010 support is still marked as WIP, since MSVC 2010 isn't released yet.

svn-id: r46763
"
"7ff4d1e651f60a0ac989b6ea0606e37b3669506f","2009-12-30 16:30:34+00:00","Mark MSVC 2010 as experimental in the tool's help output too.

svn-id: r46764
"
"bfa0c4e9c3228d40d8ff999c44c47f22b07ac26f","2009-12-30 16:42:29+00:00","Now it says 'libraries' again joostp.

svn-id: r46765
"
"1e4a7752411317919f7420009abc59595774b1ab","2009-12-30 17:59:31+00:00","SCI/new sound code:
- call cmdDisposeHandle() instead of soundKill when a track is being replaced
- Added information about cmdReverb

svn-id: r46766
"
"d4556f5a26864171e4ff437aae855f8f79e9531a","2009-12-30 18:33:03+00:00","SCI32: Added sanity checks to kAddScreenItem and kUpdateScreenItem, so that they don't try and draw cels outside the screen

svn-id: r46767
"
"6d52bce14fb8e40a731fc02bce0e8594f67e0937","2009-12-30 19:06:34+00:00","Corrected an old comment.

svn-id: r46768
"
"ce88f5fb017be22b994a8ac4747d53133a585b4f","2009-12-30 19:59:18+00:00","SCI/newmusic: update loop selector when track is finished (fixes hq1 ending, letting one save the character data for qfg2)

svn-id: r46769
"
"b0b3c6c83686cbe79d4764136bc576c0fa33dd9d","2009-12-30 20:51:49+00:00","Patch #2923628: 'SOMI: Kanji support for japanese MegaCD version'

svn-id: r46771
"
"0de5bac3498e9e9d158e4055c08475e04a00e7b3","2009-12-30 21:10:41+00:00","Mention Sega CD in NEWS file

svn-id: r46772
"
"a108df30a753bc062d2e2c041c70a4477f08b671","2009-12-30 21:11:38+00:00","Add Nintendo 64 port to trunk.

svn-id: r46773
"
"c71fc9130d9a9dff8161f72063a2b152b937281b","2009-12-30 21:22:00+00:00","SCI/newmusic: fix loop logic

svn-id: r46774
"
"046d44ebe075a15fb883728f8c86e2422deffe6c","2009-12-30 21:43:57+00:00","SCI: fix palette merging (fixes lsl1demo right at the beginning and sq5 wilco on title screen)

svn-id: r46775
"
"dc5524bda56007c4ea2006bf5f970f35392beb82","2009-12-30 21:54:45+00:00","SCI: palette merging / comment addition

svn-id: r46776
"
"3a418c13a7ab9790bb9b43bfc435056827a79e64","2009-12-30 22:56:19+00:00","remove bad hackery caused by n64 port and avoid polluting StdioStream using a custom Stream subclass

svn-id: r46777
"
"47f48dd9121acc7b4ca526e9184e0f944ed9b671","2009-12-30 23:00:22+00:00","spelling

svn-id: r46778
"
"d083e02215c9ef2309f436284c750c78005df6c7","2009-12-30 23:00:55+00:00","Rename Common::Stream::readLine_NEW to readLine

svn-id: r46779
"
"a753f606ec105a287b6eda5ffbfa2b4d6342bb84","2009-12-30 23:01:16+00:00","MOHAWK: Stop using String::emptyString

svn-id: r46780
"
"b0e02675e79b2102f9d05de3d9f549b5438dfdcb","2009-12-30 23:01:36+00:00","Get rid of Common::String::emptyString, and also of some port specific hackery (getting rid of certain global C++ objs)

svn-id: r46781
"
"f31c452a5fc2e3da5c590d437b9a72362b55307c","2009-12-30 23:02:14+00:00","MOHAWK: Reduce header interdependencies

svn-id: r46782
"
"c27c9a84c28f324fae34d5e36984955060835070","2009-12-30 23:13:49+00:00","SCI/newmusic: cmdSendMidi / removed weird midiCmd code - fixes lsl5 des revers records piano session

svn-id: r46783
"
"9c430b5298dbd4fcb49fdf1e0ec2460448d4a11a","2009-12-30 23:21:33+00:00","Fixing an out of array bounds read

svn-id: r46784
"
"5c52ed9f4be95fb68267139a6e329112f234ef2e","2009-12-31 00:06:28+00:00","Make sure that enough data is read out of the script

svn-id: r46785
"
"85787988a03c247e01596ebbb1386a478ded2df7","2009-12-31 00:37:40+00:00","Remove the getBeginOffset() hack from Common::SeekableReadStream and introduce QTPlayer::setChunkBeginOffset() to allow specifying what offset to use.

svn-id: r46786
"
"eb2e45781749c31b2bd637fb40b6e0315d2601b6","2009-12-31 03:17:59+00:00","Add the Mohawk crew to the credits.

svn-id: r46787
"
"7d131627fe6296ea4ce46db62900e4800b6b6816","2009-12-31 05:11:58+00:00","Overload the = operator for SciArray which fixes the setType errors in GK1. Some other cleanup too. GK1 can now access the restore menu and get a bit further in the game (until a segfault in the Decompressor code).

svn-id: r46789
"
"92a8d1360a4b98fbf050123617e637df1042ad3c","2009-12-31 05:30:25+00:00","kLocalToGlobal has a 'Plane' variant in SCI32 like its kGlobalToLocal sibling. The restore menu is now slightly navigatable.

svn-id: r46790
"
"762bdc7caded769c6440bae0e17fca8c37f5d317","2009-12-31 08:10:51+00:00","SCI/new music code: Slight cleanup

svn-id: r46791
"
"54245f712d18860c1454d4d1b3878bad77d43728","2009-12-31 08:30:30+00:00","SCI/new music code: The loop selector for each music score is no longer cached, but read directly from the sound object

svn-id: r46792
"
"43f349f4875aabde66414a3b3ba83803b0467a4a","2009-12-31 08:55:13+00:00","SCI/new music code: removed some hacks

svn-id: r46793
"
"9f2b65888a1fffa4876f02e12371002fa931e563","2009-12-31 10:13:59+00:00","Worked around what appears to be a bad JPEG image in the Masterpiece edition of
Myst. If I dump the image to file, I'm able to read it into other programs,
such as The GIMP, just fine. It seems that the only thing that's missing is the
End Of Image marker, and what everyone else does is to just fake one.

svn-id: r46795
"
"70a1f7c89ad51579089fe2cd381ae9306a613bca","2009-12-31 10:49:16+00:00","Fix gcc warning

svn-id: r46796
"
"c7ea1a16138c87f0e4da3287ff9dcd049a6639fb","2009-12-31 11:14:13+00:00","Mention the fact that we derive from SSCI by not caching the loop selector

svn-id: r46797
"
"3b1d4ace4097fb213e5a55b3417465318e083319","2009-12-31 12:38:17+00:00","SCI/new music: trigger signal when fade is completed, fixes lsl1 dance with girl

svn-id: r46798
"
"2e0482efa7103a71ba8729de7d8d34895eca380f","2009-12-31 12:47:42+00:00","N64: some cleanup in osystem

svn-id: r46799
"
"cb6b1e8aff0e34c6cd556455ee173f925300acd3","2009-12-31 14:59:30+00:00","Changed kValidPath() to always return true, regardless of the value of savePath (so that it works with both SCI11 and SCI32 games)

svn-id: r46800
"
"ba8b15908ca2616f933694deb85888bfcb57431f","2009-12-31 16:50:26+00:00","SCI: keyboard events now dont use scancode anymore, fixing compatibility with foreign keyboard layouts (needs testing, cleanup will follow shortly after)

svn-id: r46801
"
"e53d82b28786f28ddb8761086c626d0672b41424","2009-12-31 17:43:17+00:00","Remove obsolete comment about Myst ME not working.

svn-id: r46802
"
"e56dedec3ff64ce21a2868b545d8e99ea5d21ee4","2009-12-31 17:43:54+00:00","SCI: keyboard change cleanup, fixed Ctrl and Alt related keys on foreign keyboards as well

svn-id: r46803
"
"6d879f15b7d30b623ebf66ff79e801f6ad5a017c","2009-12-31 18:25:35+00:00","Reading the whole buffer at once should be more efficient than reading it one
byte at a time.

svn-id: r46804
"
"d10fc79836c03647c5332475a5a43ccf489fc7c3","2009-12-31 18:52:42+00:00","Add support for Chinese translated games.

svn-id: r46805
"
"038c08eef3eb5da4ed65d6ddb2be902b9041f988","2009-12-31 22:49:56+00:00","removed magic first frame from actor

svn-id: r46806
"
"3ce017cc2d859e59fdd02d87ee7f36d794c5f594","2009-12-31 23:43:10+00:00","SCI: fixed typo in unwrapFilename

svn-id: r46807
"
"080d6da6e42cad623d0cfab37f6d753f121c470b","2009-12-31 23:52:49+00:00","Minor additions: added full keypad support to GUI and SCI

svn-id: r46808
"
"9fff10378670e836d7e939b209b7c1da7f72e4c3","2009-12-31 23:54:57+00:00","PSP: added disable_dosbox_opl to custom makefile

svn-id: r46809
"
"832779497ebdd78c803bcf6975aa077ea199168b","2009-12-31 23:59:07+00:00","PSP: added keypad to d-pad. Allows control of AGI,SCI0, and Indy3

svn-id: r46810
"
"ac7c92c67f3916ef0e5ad09835f161f65a7c3b8b","2009-12-31 23:59:28+00:00","SCI: kFileIO findFirst/findNext returns only game-specific prefixed files

svn-id: r46811
"
"afc4bc12959ffa9ac5a611f2f7de4da598b80857","2010-01-01 06:41:52+00:00","SCI/new music code:
- Resolved a deadlock with the mixer, and added appropriate mutexes (a result of the fact that SCI mixes MIDI and digital audio in the same list)
- Fixed sound playing when loading games, by properly resetting the MIDI driver
- Reverted savegame version to 14 - the changes in versions 15 and 16 don't have any effect on the currently enabled old music code, and the new music code is disabled by default, and is still prone to changes
- Now saving/loading signal, loop and hold for each sound, as well as reverb
- Added stub code for setting reverb and channel hold
- The signal, loop and hold values of each song are cached, like in SSCI and like what happens in Greg's SCI implementation. This allows a clear separation of the engine code from the rest of the engine. Reverted commits 46792 and 46797
- Removed duplicate song list accessing code
- Song cues are now updated in kAnimate for SCI0, like the old music code does, to compensate for the fact that SCI0 didn't poll for music changes via cmdUpdateCues, like what SCI01 and newer do
- Cleanup

svn-id: r46812
"
"ca83c13ec98a3ccd4f71d74c2e2554fc874a7113","2010-01-01 09:40:28+00:00","SCI: switch to previous gameid, when importing character data in qfg series

svn-id: r46813
"
"b1b6555cb51393928f8c3afc31906c8db998de54","2010-01-01 10:08:14+00:00","SCI: implement kFOpen (OPEN_OR_CREATE), makes it possible to save character data at the end of qfg1ega

svn-id: r46814
"
"82c890419855bf9ec1a0dec9f97442fb4d76279f","2010-01-01 11:44:33+00:00","Add Polish Windows 4CD version of The Feeble Files.

svn-id: r46815
"
"68f4e0f296f25c9a326d53195fc2ea395d9a7d68","2010-01-01 12:14:25+00:00","minor sizeof cleanup

svn-id: r46816
"
"a03d7b3ac2939e4e516faafb29ad75c5e9bdbebb","2010-01-01 12:39:54+00:00","removed position zeroing in varia resources

svn-id: r46817
"
"3ad4dc7c755a091bedff2ae2685e9136cde5c1af","2010-01-01 12:58:01+00:00","removed first point from path to avoid zero delta

svn-id: r46818
"
"ea86c41cc535b066b222a883cba4a9cf17697d6b","2010-01-01 13:11:34+00:00","Adding setNumLoops() to AudioStream class

svn-id: r46819
"
"7cf1d5bd5df915fe0f26182b1c2d696ca8d11a34","2010-01-01 13:21:30+00:00","SCI/newmusic: added fade and loop capability to samples (looping doesnt work yet), fixes lsl1 doll inflation endless loop

svn-id: r46820
"
"8ee5033bab56606d1cb792ba2b04ec0ce8829a82","2010-01-01 13:31:02+00:00","Added setNumLoops() for linear memory streams, enables looping of samples in sci

svn-id: r46821
"
"a8f7d7e61e8c70a52d74fc0e2b3591792c9243da","2010-01-01 13:53:40+00:00","removed commented out debug

svn-id: r46822
"
"0cdcd59322be384c9f2638cda2df50aa32105b1b","2010-01-01 13:54:05+00:00","found zoom tables, added original zoom support.

svn-id: r46823
"
"eec2109fd73d39830f10c6b31cc820f0a9b8516b","2010-01-01 13:57:15+00:00","Updated the notes about Broken Sword cutscenes to that which I posted to
scummvm-devel last year. (Or yesterday, if you want to be precise.)

svn-id: r46824
"
"5b9409859b641a29ef573b27467a231a5201b6c7","2010-01-01 14:15:07+00:00","removed debug output

svn-id: r46826
"
"385c462352f542b5b7a614b1f5b144ff9618b0a5","2010-01-01 14:22:07+00:00","SCI: fixing saved game compatibility

svn-id: r46827
"
"25e111bcac879bf9798e1b171a79ae5bc3237796","2010-01-01 14:23:16+00:00","SCI: changing volume to int16 again, fixes fadeOut of music and samples

svn-id: r46828
"
"810478e07ffe3be1b00242477d38ae6fbfbe85b4","2010-01-01 14:33:20+00:00","SCI/newmusic: better solution for volume - using int16 during fade, volume is now byte again

svn-id: r46829
"
"199765b415a531d7e163727e9aa6d97288931892","2010-01-01 14:38:46+00:00","aligned zoomed picture to the top and fixed actor head animation in zoomed state

svn-id: r46830
"
"7bb18a018aba0c2bd49abe9c44eb9b13c5b8e1b7","2010-01-01 14:41:11+00:00","SCI/newmusic: doing version check before looking for audio resource

svn-id: r46831
"
"5ebadb10d483864bd70350f41d264c35d5f1a37e","2010-01-01 15:35:12+00:00","Extend doxygen comment for setNumLoops()

svn-id: r46832
"
"74ae4ecc48ae51b2f19c8120918dc53de73bab9c","2010-01-01 15:35:27+00:00","Added a comment for the reason updateSci0Cues() is called within kAnimate()

svn-id: r46833
"
"153cf54850d49cadcd4adb322decce70c900b14b","2010-01-01 16:05:26+00:00","SCI/new music code: Moved processing of digital sound effects outside the MIDI worker thread. Some cleanup

svn-id: r46834
"
"d1b844d3c36b9011442d3a6538bc35878b3b694e","2010-01-01 16:15:20+00:00","SCI: syncing loop selector... again... fixes qfg1 ending... again... now sci0 only

svn-id: r46835
"
"622dd0d16dbf735323a6fae985f0231a4ef5d393","2010-01-01 16:28:22+00:00","Implemented setNumLoops() for common audio streams.
Implemented getNumPlayedLoops() for common audio streams.

Requested by m_kriewitz.

svn-id: r46836
"
"54d9bf4c57d265dd0d0539ed5eb0bfe324427ea7","2010-01-01 16:42:35+00:00","Fixed broken savegames when saving with the new music code

svn-id: r46837
"
"bba2c8ce952b5242e3ff80054f1ac9cc48bcd097","2010-01-01 16:57:23+00:00","Fix getTotalPlayTime for MP3, FLAC, Vorbis and LinearMemoryStream after the latest loop related changes.

svn-id: r46838
"
"763c59bd4617bb1adaaadc3f3d1808c87e63b033","2010-01-01 17:16:12+00:00","Fixed KQ5CD (regression from rev. 46656)

svn-id: r46839
"
"78b26921933fc1654f73377216acf26c05f66572","2010-01-01 17:25:44+00:00","SCI/new music code: Center pitch wheel when unloading music tracks

svn-id: r46840
"
"64d484bd99f0fef9ed56f075fdab8856bfa5fb26","2010-01-01 17:53:37+00:00","SCI/newmusic: adding debug output to setVolume

svn-id: r46841
"
"74159e12eb77dfc7c9fc47ecd962395aa8fbbbab","2010-01-01 18:57:14+00:00","SCI/newmusic: set speech soundtype for audio resources played by kDoSound, cmdVolume is supposed to set music and sfx volume only - this whole fixes volume issues in lb2cd and others

svn-id: r46842
"
"98194bfe1307a7dc5b75546fb17c447844d6d5f9","2010-01-01 19:23:23+00:00","SCI/new music code: The MIDI driver is now reset whenever the game's VM respawns, like what the old music code does. Fixes the MIDI music in KQ5CD, Lonbgow and perhaps others

svn-id: r46843
"
"e757e7a60a2c18faa81dea0486a0f127e77adac4","2010-01-01 19:45:49+00:00","Fix out of bounds access reported by syke.

svn-id: r46844
"
"7b0c1f262f3774dec945b6e9419ee668851e493d","2010-01-01 19:52:50+00:00","SCI: fixing bad sorting of saved games due MMDDYYYY date saving

svn-id: r46846
"
"2a9e83569513955805fde4bbe92e917a9c306c05","2010-01-01 20:26:18+00:00","SCI: Added TODO within kDoAudio

svn-id: r46847
"
"6385e77d85471ff0bc759122a8d0a4b064b13a28","2010-01-01 20:37:02+00:00","Fix undefined operation in setNoPendingVerb (someone with knowledge of SAGA should review this, see the TODO comment). (Thanks to syke for reporting this)

svn-id: r46848
"
"967853c03f03bc620ab82e1550a419d716ba3388","2010-01-01 20:49:56+00:00","SCI: volume for sci0 now set to 127, now using constant instead of value

svn-id: r46849
"
"379ae6df30b1014f2c6aa772d142d007ab4edffe","2010-01-01 21:04:20+00:00","SCI/newmusic: now clips volume against MUSIC_VOLUME_MAX (127) instead of the mixer max volume (which would be wrong of course), adjusts volume when setting sample channel volume

svn-id: r46850
"
"f3ca535038a50a4a98c1fb698cddc0a7f9cf1d64","2010-01-01 21:18:19+00:00","Fix a buffer overflow, thanks to syke

svn-id: r46851
"
"44dc3f9bfbac271fb566ea603f720616b958d31c","2010-01-01 21:26:46+00:00","SCI: kDoAudio now also clips volume and adjusts to mixer volume

svn-id: r46852
"
"37d56920effc9875de9cd5639435c9ddec07dd23","2010-01-01 21:44:50+00:00","SCI/newmusic: changed fade volume setting for digital fx to onTimer() again, because setting it in updateCues() wont work right. We are processing fading effectively in there any way, added TODO for working approach

svn-id: r46853
"
"d6d4a4f6e026b7bc3016a8528f4889d07f41df53","2010-01-01 21:55:51+00:00","SCI: fix build

svn-id: r46854
"
"671cc15bd1b4f56b95eccb68b792d369b4534d18","2010-01-01 21:59:11+00:00","- Add some asserts
- Renamed snd_unkOpcode3 to snd_stopChannel
- Cleanup

svn-id: r46855
"
"0a965ced69bbc28ce16e9ae4e80a74a60f95a5e1","2010-01-01 22:15:52+00:00","SCI/newmusic: changed setting volume from fade logic, implemented updating loop selector for sound fx

svn-id: r46856
"
"f3cd114c5ca8aa4b5b0d4db9f40c7b43dc117ce1","2010-01-01 22:16:53+00:00","init _numPlayedLoops inside LinearMemoryStream

svn-id: r46857
"
"03376d06f1ce211695939440d1856ee13b526eca","2010-01-01 22:17:59+00:00","SCI/newmusic: removed TODO

svn-id: r46858
"
"82b4b65bdc3f67fe97a0f9ae5af0c43a03039c0e","2010-01-01 22:26:26+00:00","- Fix out of bounds array access.
- Add some asserts in output related functions

svn-id: r46859
"
"8817d6eeb5990a3eae1ce93b7ea1e6605a0868e0","2010-01-01 22:33:45+00:00","Merge update_nop1 and update_nop2.

svn-id: r46860
"
"6109275750a3b9df41649a5787923e0578109f8b","2010-01-01 22:55:38+00:00","Properly reset _numPlayedLoops in setNumLoops in all AudioStream implementations implementing setNumLoops.

svn-id: r46861
"
"2e9d5a5f41636054f57b4a90b3f9165902963c3c","2010-01-01 22:56:18+00:00","Mention in documentation of AudioStream::setNumLoops, that this function also resets the number of loops played counter.

svn-id: r46862
"
"137744c40c5e5ab717c364a113cf5e83ca104663","2010-01-01 22:57:08+00:00","This time properly fix getTotalPlayTime for looped FLAC, MP3 and VORBIS audio streams.

svn-id: r46863
"
"205f7437ea668be302e22b278a106f27af23fabf","2010-01-01 23:48:22+00:00","SCI: Fix segfault in dual-language KQ5.

svn-id: r46864
"
"8407b4d723b7e0b88960a55308ba88db6a3ed3a0","2010-01-01 23:48:55+00:00","SCI: Adlib: Fix bug in master volume handling.

svn-id: r46865
"
"998d511eeb6d34825dbfc110cacf83dc5e453c74","2010-01-01 23:57:16+00:00","LOL: cleanup

svn-id: r46866
"
"a22fd021e9fe1e798bf72c537cce482268d1c9ed","2010-01-02 00:07:20+00:00","Move the LZSS code to the Groovie namespace.

svn-id: r46867
"
"be1d586cd5f10a7dfdfff97bf7747744976e1f6c","2010-01-02 00:22:46+00:00","Removing now redundant comment. The fix was correct.

svn-id: r46868
"
"032b23e8d869912fbc93e40f7ccaf796ba0c8ef7","2010-01-02 00:45:55+00:00","SCI/new music code: Fixed some mutex-related issues

svn-id: r46869
"
"c671c17258e2badd261ba0fdd63207a4b733b05a","2010-01-02 00:54:11+00:00","Use Common::StackLock.

svn-id: r46870
"
"94fb4762e21572a909ebd4a8af4473953e56c02f","2010-01-02 01:09:49+00:00","Changed wording from 'handle' to 'sound', as we're dealing with sound objects, not handles. Also, made the warnings thrown when a slot couldn't be found more verbose. Finally, changed the logic of when warnings should be thrown in cmdSetSoundLoop

svn-id: r46871
"
"a927cff2569ba78922639fd12a1ba7b91871e6af","2010-01-02 01:40:10+00:00","SCI/new sound code: disabled some unused code and named a previously unknown variable of the sound channel data

svn-id: r46872
"
"caf75e1bf59804a1f776f0931d82e799d1296e0d","2010-01-02 01:41:39+00:00","SCI/new music code: Implemented cmdSetSoundPriority

svn-id: r46873
"
"1f2c92076b8ab941a783920e16896ebebab212c2","2010-01-02 03:44:40+00:00","Fix the GK1 CD intro sequence (regression from r46839, which fixed a regression from r46656). kPlatform with no arguments is different in SCI32.

svn-id: r46874
"
"513a56cd5e6aaa06f1b88d94c4284a808c99c992","2010-01-02 08:15:01+00:00","SCI/newmusic: set default volume on MusicEntry creation, use volume selector sci1late (soundversion) only

svn-id: r46875
"
"df94844db0c80e4acb6e44f90478355ad2c6f8d6","2010-01-02 08:30:19+00:00","SCI/newmusic: now clipping volume in cmdFadeSound

svn-id: r46876
"
"2165dc1a25bba84bf7712379eb4975219096dd43","2010-01-02 08:53:06+00:00","Indentation fix. (Which still leaves a lot that probably ought to be fixed in
this directory...)

svn-id: r46877
"
"0c9b828db19e565720ae6660bdcd97fa9afea10a","2010-01-02 09:39:17+00:00","SCI: console behaviour changed for vmvars command, now allows entering decimal values, also accepts hexadecimal values (use e.g. 12h). hexadecimal addresses are still accepted as well

svn-id: r46878
"
"aaf66f20ef909122635da248c0eecb122cca5902","2010-01-02 11:03:12+00:00","Implement FR #2827944: 'SAGA: Hide in-game GUI on thumbnails'

svn-id: r46879
"
"d4dda4df831e3772d2ed5c134bafb2ae07c3eb47","2010-01-02 13:04:36+00:00","SCI/new music code: Implemented cmdSetSoundHold. Larry now exits the limo normally in LSL5

svn-id: r46880
"
"5b4b8e053fd6bbad8a5f96dfdfa26568dc3fd026","2010-01-02 13:36:12+00:00","SCI/new music code: Fix for a music related crash in SCI0 games (the sound object can get deleted while polling it)

svn-id: r46881
"
"2bc0ffdeb7734b4165a0426b3e533e477a5b0d0d","2010-01-02 13:57:36+00:00","SCI/new music code: hopefully fixed a race condition

svn-id: r46882
"
"d4738631d5d61bd341270f450676d32a2d775a2c","2010-01-02 14:08:26+00:00","SCI: implemented new console command 'listsaves'

svn-id: r46883
"
"1084b90fbb0d81b9c5add77e52968809552d18d1","2010-01-02 14:11:38+00:00","SCI: listsaves is now 'list_saves', also included entry in help

svn-id: r46884
"
"5b5499e06f273cbfb7155f7fb8eebdb0dfe439fc","2010-01-02 15:02:41+00:00","SCI/new music code: cleaned up cmdUpdateCues and changed the SCI reverb(?) SysEx in parseNextEvent() to a NOP for now, till its sorted out

svn-id: r46885
"
"6c16673305727022b67f9203a87cc14a014637b6","2010-01-02 15:37:17+00:00","SCI/new music code: Properly implemented cmdSetSoundHold, with the help of wjp and waltervn

svn-id: r46886
"
"f62e2b2571b970edf5bf334dbd5a8e1b225a5a91","2010-01-02 15:54:08+00:00","SCI/new music code: don't stop a music track if the fading effect has just finished. Fixes the music in GK1 (demo and full)

svn-id: r46887
"
"f1b1005b38bb307b705ae61504b8391f45d37229","2010-01-02 15:58:55+00:00","Notify the game scripts when fading effect is done

svn-id: r46888
"
"91ebf0f9162bdf40353e2b3d2f56b4fe24d232ec","2010-01-02 16:14:07+00:00","Removed obsolete code

svn-id: r46889
"
"2ef3983ed8fc1222546058e9db547e0a90dd92c7","2010-01-02 17:03:58+00:00","SCI/new music code: changed some SCI SysEx messages to enums

svn-id: r46890
"
"6fa3c10aedfc0a6277428707edd8b3b35d1df2c6","2010-01-02 17:16:59+00:00","SCI/newmusic: fading signal handling changed... fixes lsl1demo and gk1demo

svn-id: r46891
"
"c920abf50a5e6ca94045e08a7e6a1e7fa31ab6f7","2010-01-02 18:02:21+00:00","Changed the default case of setAttribute() to a warning, so that loading works in LSL3

svn-id: r46892
"
"5c56d726b28287cdc7b8054238007efd3f97860d","2010-01-02 18:16:12+00:00","SCI/new music code: Improve midi hold handling a bit. Still broken.

svn-id: r46893
"
"4cd46253654fda8c8595378b3d6cf7508ab74f79","2010-01-02 18:22:58+00:00","We are in 2010 now

svn-id: r46894
"
"48f023b472f2f32791ef5291a66701173b17e7b6","2010-01-02 19:01:34+00:00","Properly fixed cmdUpdateCues() for SCI0, removing a hack

svn-id: r46895
"
"0b3d3c37a590b116e280f0ffefc26cd3d27b16fd","2010-01-02 19:24:52+00:00","SCI/new music code: Fixed sound patch loading when restoring a saved game

svn-id: r46896
"
"13a242838fc9ad8c25fd6e250b0931d8564460a4","2010-01-02 20:20:36+00:00","SCI/new music code: Don't stop notes when looping for a hold

svn-id: r46897
"
"2b083c491d4dd3980fe85b3f5d34ec526fedc162","2010-01-02 20:44:47+00:00","added fadeout tables

svn-id: r46898
"
"3e0588c98cd5cc76ec0cee8ee2d5c9ff4651d898","2010-01-02 21:21:32+00:00","made fadein/out asynchronous, added fade type stub

svn-id: r46899
"
"4640b358320794db182e67b869c1628ef30bfcef","2010-01-02 21:32:34+00:00","removed useless `system' pointer from render()

svn-id: r46900
"
"2f65f8f7c62c0bb5d4e8e8043c877d03163aa1be","2010-01-02 21:55:39+00:00","SCI: kDisplay difference in SCI0 (fixes colonels bequest copy protection screen)

svn-id: r46901
"
"baf8575e36badf6d8379087e4fc7b2a2cc7b42ad","2010-01-02 22:04:05+00:00","SCI: adjusted kDisplay change to occur SCI1late

svn-id: r46902
"
"09a197d125b92035db7bbc487cd29f3fea40d998","2010-01-02 22:30:43+00:00","added unlogic logo

svn-id: r46903
"
"e2d14e0499174fe1769be8c5181cb304c14babe3","2010-01-02 22:32:24+00:00","fixed memory leak

svn-id: r46904
"
"400958b04562c713e2343901d7a9ad8ee554c354","2010-01-02 22:40:17+00:00","do not show logo while loading save

svn-id: r46905
"
"f1d800cb9da2bcdd53765a01d5992687585bd878","2010-01-03 00:55:56+00:00","improved mark's animation.

svn-id: r46906
"
"dcc4f179ac0d7efa273d2a9a8ab93d62a3fbf8de","2010-01-03 00:57:20+00:00","fixed vertical/horizontal speed ratio

svn-id: r46907
"
"ea513b33048132b46b3c2d6ad240122b4e0437a5","2010-01-03 01:06:42+00:00","fixed h/v animation switch ratio

svn-id: r46908
"
"58f4794221664be687345e4d3aef8a1b145d338f","2010-01-03 01:07:59+00:00","increased vertical speed

svn-id: r46909
"
"1131c48f267ead31a21eaf91a8ab2175050bf983","2010-01-03 01:10:07+00:00","fixed broken pathfinding

svn-id: r46910
"
"c951b14a15479857fbec6cbf9c14a03f28b91d21","2010-01-03 01:25:08+00:00","moved scripted mark's animation after all sprites

svn-id: r46911
"
"ce40ad325ca6968c33e0d4dd9652311810535497","2010-01-03 01:40:10+00:00","removed noisy debug message

svn-id: r46912
"
"0b92bf472a7e67dfa9069d2564bfdb199c957553","2010-01-03 01:52:36+00:00","fixed zero speed issue

svn-id: r46913
"
"2fc79f197f5e0f6c336a26067334896ae321016e","2010-01-03 01:57:05+00:00","improved accuracy of the speed calculations

svn-id: r46914
"
"711fcccfa6ee93afc8244945ee7171268093b715","2010-01-03 02:04:43+00:00","fixed font color and positioning for the well callback

svn-id: r46915
"
"6ba2bd8bfcd622d0651a81aa70813d6140f2377d","2010-01-03 03:37:50+00:00","Add support for wave files in the audio volume. This is used in Pharkas CD and GK1 CD.

svn-id: r46916
"
"7d5e91337e31f89b28a85b65ce09d88b0e698040","2010-01-03 04:46:00+00:00","Fix the GK1 view segfault. szUnpacked was overflowing in SCI32 -- it should be uint32. GK1 now is a bit more playable, with many many glitches.

svn-id: r46917
"
"986a75b7ee11ef74746a9291c469016dec5dd764","2010-01-03 05:29:30+00:00","Implement kInPolygon for SCI32. GK1 now responds when you click on things.

svn-id: r46918
"
"715b48b987a5abd1052e3638673d3830b5fa1e21","2010-01-03 08:27:33+00:00","Mohawk : Stop Myst Script Opcode 200 continuously reloading the same image...

svn-id: r46919
"
"1abbfb810f68ff24968bc4c56683272b2952a9c7","2010-01-03 10:30:38+00:00","improved walking animation once again

svn-id: r46920
"
"3fbf1293d81725316c45faf9d0bc93424a2e18bf","2010-01-03 10:46:14+00:00","started music before logo

svn-id: r46921
"
"2861cab3221ea5fb92854ebbbc14563b9849bcf6","2010-01-03 13:13:13+00:00","SCI: windowMgr port fix (using id 1 now on that port instead of 0, still accessible via id 0 as well) fixes qfg1vga, sq4 (-10 pixel walking) and castle of dr. brain (computer room puzzle)

svn-id: r46922
"
"72a020320f1e9e5b9b4d6c99b95fc93cc126e440","2010-01-03 13:28:59+00:00","SCI/new music code:
- sounds are no longer stopped in cmdUpdateCues if their signal is set
- cmdSetSoundVolume no longer throws a warning if it can't find the associated sound (in some games, it's called before the actual sound is loaded)
- removed unused parameters to the SciMusic() class and to MusicEntry::onTimer()
- removed a hack to get the sound loop selector

svn-id: r46923
"
"454fb24c852b05dbd7b4fbcd3f74f902e1877aa8","2010-01-03 14:39:38+00:00","SCI/new music code: don't throw warnings for MIDI commands which are handled by the music driver

svn-id: r46924
"
"2f23eb99ee75db397593fc0dc8f389fc1f3316ce","2010-01-03 15:08:26+00:00","The 'room' command can now set the current room number, too (more straightforward than changing global var 13)

svn-id: r46925
"
"85c8b370cfb77e19aaea4baa9c85ed0dfd175dfa","2010-01-03 15:18:20+00:00","added metropolis/TEENAGENT logo

svn-id: r46926
"
"d7f5f078b0c459eb907f315243d4bafe539aeeb8","2010-01-03 15:25:07+00:00","fixed typo

svn-id: r46927
"
"cf5e5f6c92b2eaa581c65999e60afb57b5ed6dff","2010-01-03 15:59:43+00:00","svn-id: r46928
"
"3da232ffdc1b5043ea1e43bf04e1f9686a0d0aa4","2010-01-03 16:03:27+00:00","more walking frame offsets correction

svn-id: r46929
"
"56963dc092dca549c80b1393e7395be81a920789","2010-01-03 16:11:31+00:00","SCI/new music code: Some cleanup. Previous commit (rev 46928) should read: 'Added some more commands from BaseSongIterator::parseMidiCommand()'

svn-id: r46930
"
"913616dc98adf73ccebd300931836d0b418f0ab8","2010-01-03 16:14:09+00:00","Removed junk characters

svn-id: r46931
"
"eed763529702db94191f865780154f4583f1a66d","2010-01-03 16:33:03+00:00","Sort language list (and showing that Lure is really broken).

svn-id: r46932
"
"6271dc2821c85eb162be15647e71596e887eb23a","2010-01-03 16:43:59+00:00","'normal' game speed is about 10fps, not 12

svn-id: r46933
"
"6a25bd2b8a135dff9760e45ffd0501d3b7c928bc","2010-01-03 16:50:27+00:00","The backtrace command now outputs to the graphical console

svn-id: r46934
"
"6cc4dacf5ee6919cbd41aa6b0e35b16ba424b4c5","2010-01-03 17:40:17+00:00","SCI: Support pointer arithmetics in +ag, +agi, etc. too

svn-id: r46935
"
"0cfd6a4d769a8aae2dbd442a0b7e09ff0c94ee7c","2010-01-03 18:04:52+00:00","Fix a buffer overflow (thanks to syke) and modify the way the instruments are loaded (bytes instead of uint16). This (sadly) doesn't fix the MDY player.

svn-id: r46936
"
"7fa62cdd2bf1cc364f8459e56cf642310ae5b399","2010-01-03 18:06:48+00:00","SCI/new music code: Proper handling of disposed sounds when loading a saved game. Also, addressed a possible mutex issue with cmdPauseSound

svn-id: r46937
"
"1b6b4c5c085ea1e359dbfeef3aacc320dcdca536","2010-01-03 18:37:13+00:00","Fixed memory leak (as reported by eriktorbjorn)

svn-id: r46938
"
"870c99b4d437d997e9f4fb3b2a8d760c6409a05b","2010-01-03 18:43:17+00:00","SCI/new music code: Only reference the mixer for music slots which actually contain digital audio data

svn-id: r46939
"
"910ffb53a0b6c74a965df9a1270cdfc3885252ec","2010-01-03 19:27:20+00:00","PSP: Limited movement of virtual keyboard onscreen

svn-id: r46940
"
"72eb9ec9eab5efcb3aa99a962a80423e8c0a3232","2010-01-03 19:37:43+00:00","Fixed a bunch of cppcheck warnings. Mostly about checking if a pointer is null
before freeing it, which isn't necessary.

svn-id: r46941
"
"8ad5694cb18bc7c7f3378889a0f645da31d4ca22","2010-01-03 20:15:44+00:00","Reduce header dependencies for AGI engine.

svn-id: r46942
"
"eeb3502fa43856a6e03424b9e24700485a7fb852","2010-01-03 20:18:36+00:00","Made the 'version' command more verbose, listing all the automatically detected game features, along with the detected SCI version

svn-id: r46943
"
"f15db40927443953aeb880fac1d4093301004e03","2010-01-03 20:42:51+00:00","Don't uses strcpy() on overlapping memory areas. It's undefined.

svn-id: r46944
"
"c83058d30b8e58576e1604fc48581027b0a150d0","2010-01-03 20:47:04+00:00","LordHoto spotted the same kind of overlapping strcpy() call in one more place.
I didn't notice it because it never executed that part when I used Valgrind.

svn-id: r46945
"
"eccf0cc429a0d79ce81a0813305279b9377169f9","2010-01-03 21:07:40+00:00","Introduced new ADGF flag ADGF_USEEXTRAASTITLE.
Documented ADFlags.

svn-id: r46946
"
"770b2f78d4120074e544f9acc0c6449a9c032fa6","2010-01-03 21:07:56+00:00","Setup the dimensions of GuiObject in the constructor, by using reflowLayout.

This properly initializes _x, _y, _w and _h, which might be used
uninitialized otherwise. This probably lead to a creash for _sev,
when drawing the tab widget, before GuiObject::reflowLayout had
been called. FYI GuiObject::reflowLayout is usually only called
on layout changes (i.e. resolution changes etc.), thus it might
not be called before drawing a newly created widget.

svn-id: r46947
"
"c36caea501fe2eab3fa3d1e968d80b1d224b0523","2010-01-03 21:09:26+00:00","Use new ADGF flag, ADGF_USEEXTRAASTITLE for AGI Fanmade games for giving them
more user-friendly names.

svn-id: r46948
"
"781dd3b18369bebe4c089526be9f470c12311e48","2010-01-03 21:12:44+00:00","Fixed compilation with DISABLE_VALIDATIONS, and fixed a bug in kPrevNode

svn-id: r46949
"
"d13b23d688c51849509de267fa469af7334a94f9","2010-01-03 21:17:58+00:00","SCI/newmusic: this fix will make qfg1vga character selection music work

svn-id: r46950
"
"df81b68967d379c527b60c4bca2203a88c4be5d9","2010-01-03 21:20:05+00:00","Change BS 1 & 2 to I & II (see discussion on -devel)

svn-id: r46951
"
"e71754b64d8c0f590a40a0766c7293afd46df8da","2010-01-03 21:50:13+00:00","Add detection for a french Myst

svn-id: r46954
"
"dccc1db768240fe7e8d814fae92606be6b5bfe47","2010-01-03 21:51:30+00:00","Fixed regression from commit #46950 (fixes KQ6CD, Pharkas CD, and others)

svn-id: r46955
"
"b92a744a04a17bfdce7d9fba5e90864375f281ac","2010-01-03 21:53:34+00:00","sane_nodep() and sane_listp() should not be dummy functions when DISABLE_VALIDATIONS is set, so that the engine doesn't try and refer to null pointer objects (and subsequently crash)

svn-id: r46956
"
"5433ba01fa52501f5624de1615c3e9f72bb26fd9","2010-01-03 22:11:08+00:00","Mohawk : For what it's worth, Add detection for a french 'in the 1rst degree'

svn-id: r46957
"
"b2355cac9fd4ce6bec6d8058bd5dd4718d47d3ca","2010-01-03 22:41:35+00:00","- Remove unsafe default constructor of Audio::Timestamp.
- Add an assert which prevents the _frameRate from being 0 in the Audio::Timestamp constructor.

svn-id: r46958
"
"c0aad0508c16318a8e178c3eaaa0d028f2724d19","2010-01-03 22:50:39+00:00","Renamed SCI_VERSION_AUTODETECT to SCI_VERSION_NONE to signify its actual purpose

svn-id: r46959
"
"54dbd75ed9c149c7e629939b122c4096e1839c73","2010-01-03 22:54:51+00:00","Code beautification (fixes a false positive, too)

svn-id: r46960
"
"9182c37a06fcbc7b6518da257ced5ff8a23b3883","2010-01-03 23:24:59+00:00","Removed obsolete notes about Broken Sword cutscenes not being supported.

svn-id: r46961
"
"8fb870b0e385a888585b00f4a38e19a3c37cd901","2010-01-03 23:30:23+00:00","SCI/newmusic: support for SCI0 fading, doesnt work yet because channels[] is currently not correctly filled out inside SoundResource class - because it wasnt previously needed

svn-id: r46963
"
"ed06df7a25874f1ba98ed51fbc3669a4ef637501","2010-01-04 08:06:11+00:00","SCI/new music code: The number of voices is now obtained from the MIDI driver

svn-id: r46964
"
"ae9cf4d51e8c5f91e9009cab7cef54e23eb83a51","2010-01-04 08:10:29+00:00","Mohawk : Improved code formatting conventions compliance.

svn-id: r46965
"
"3218da897572d5fe0eb9754696c3b49de64c1cf8","2010-01-04 08:28:09+00:00","SCI/new music code: Now the the music driver to use is  obtained directly from the sound options, instead of asking for a driver which supports the requested MIDI driver flags

svn-id: r46966
"
"c25f24efc74340c45e25382430b8b9b820a68775","2010-01-04 08:34:07+00:00","Removed the now unused GuiDummy class

svn-id: r46967
"
"50245ba5710df184af5b5e8f0037e87b33491cfe","2010-01-04 11:12:19+00:00","added idle animation

svn-id: r46968
"
"01ebbcf101efc6897ec11a18ca389aed24371e77","2010-01-04 13:21:35+00:00","SCI: channels[] work, sci0 fading still not working (volume is changed though)

svn-id: r46969
"
"60ece55fb97eb9cd18a4803df174f2a28de55a86","2010-01-04 13:50:43+00:00","Fallback detector:
- Added detection for SCI2 games (GK1, PQ4, QFG4)
- Rewrote the way demos are detected
- Games are no longer distinguished from the existence of certain files

svn-id: r46970
"
"d437b25c5774261f727a2e91f8e1b6a200ca5d4a","2010-01-04 14:43:14+00:00","SCI/new music: Resolved another possible deadlock when pausing all sounds

svn-id: r46971
"
"f245917d6f08be640574df2ce128ef7bd248b0b6","2010-01-04 15:17:46+00:00","SCI/newmusic: fadeout in sci0 (not stopping music yet), revert of SoundResource changes

svn-id: r46972
"
"5560f93c2a9fe2b686072c717d978adb353498fe","2010-01-04 16:16:58+00:00","SCI/new sound code: update sound cues when kGetEvent() is called, instead of kAnimate(), fixes music fading in LSL3

svn-id: r46973
"
"8cc690935a8fbd236c1b854ce281b3abb7b0a759","2010-01-04 16:18:35+00:00","Updated comment

svn-id: r46974
"
"01eb329be2df445f3374f8183bec5d9031450062","2010-01-04 16:44:58+00:00","SCI: kPalette / animate adjustments to behave more like sierra sci, also doesnt crash in island of brain anymore

svn-id: r46975
"
"bf3973051beb03d331c3ce3a06aa106ad817e1a4","2010-01-04 17:27:36+00:00","Merge the Mohawk Video class into QTPlayer and general cleanup.

svn-id: r46976
"
"380190ee127dc0b015d69bc3cbce1af853717496","2010-01-04 17:30:47+00:00","Fix a memory leak spotted by cppcheck. Thanks salty-horse\!

svn-id: r46977
"
"8cc208ba2e7d1f4b67d368b8aacfad3905d45eb6","2010-01-04 17:37:25+00:00","Minor cleanup; remove GF_10TH, it's not used or needed anywhere.

svn-id: r46978
"
"fe2529ce172730da239cc11846592cbc74fe9fbb","2010-01-04 18:06:59+00:00","fixed flame effect

svn-id: r46979
"
"89e18f5f1207caa3a2dcc827da0ae0e7f6c577cf","2010-01-04 18:10:45+00:00","original code uses exclusive random intervals

svn-id: r46980
"
"97fc845a078293c1de1faf1ab72c98bd898e0d8b","2010-01-04 18:24:58+00:00","SCI/new music code: Fixed the code that handles mixed Adlib/MIDI mode, and added better comments on what it actually does

svn-id: r46981
"
"590a687ce14964ab06f34830f2e8f8bfedefbce1","2010-01-04 18:33:31+00:00","Comment out unused variable.

svn-id: r46982
"
"b9c8e6edb82ff398ecc699bd964143cd430c9c89","2010-01-04 19:39:33+00:00","Code optimization: removed unneeded string comparisons when executing a sound command (including cmdUpdateCues, which is executed very often)

svn-id: r46983
"
"39cf9576af9a3340e750f27d7c23475e3d5c636f","2010-01-04 19:50:58+00:00","SCI/newmusic: initialize _volume in constructor

svn-id: r46984
"
"184090cb46c5590f42ca4cf5daf452c92e31fef3","2010-01-04 20:52:25+00:00","SCI: Add support for SCI2 to AvoidPath.

svn-id: r46986
"
"f7855e1c071fb85e968e7b1446ce668b0cd59e86","2010-01-04 20:57:38+00:00","Implemented the same fix for tag2string() as in commit #44920, thereby fixing an assert in MSVC with the QT player when playing Myst. The parameter passed to isprint() should always be unsigned

svn-id: r46989
"
"05a16d7cba889c3daf947a727917ce2dc9bd1eab","2010-01-04 22:14:34+00:00","SCI: surprise for this DrMcCoy guy

svn-id: r46992
"
"a6aaeb70e6dfb3a9727e8861041601cf658aa5cd","2010-01-04 22:23:45+00:00","SCI: fix crash due accessing invalid object (implemented deleteScreenitem)

svn-id: r46993
"
"4ae9412a3aea75990008c3a32080c54533fdb389","2010-01-04 22:48:28+00:00","Make some improvements for Audio::Timestamp.

* Add convertToFramerate() method
* Add framerate() method
* Add operator == and !=
* Improve frameDiff() to work for two timestamps with distinct framerates
* Improve Doxygen comments

svn-id: r46994
"
"645f73cb186024547702cf66d0fcc5ca6b2904e8","2010-01-04 22:48:52+00:00","Switch Channel::getElapsedTime() to use a Timestamp for its computations

svn-id: r46995
"
"3767d3a71810c6160cb869211754ead095708e74","2010-01-04 23:09:57+00:00","SCI: now filtering screenItems against planes

svn-id: r46996
"
"01d68c7eafa4e2851076f69976948181da2b297e","2010-01-04 23:17:51+00:00","SCI: adding #ifdefs for temporary gui work

svn-id: r46997
"
"6c001b7ffd93a151a7309e4a23bb3d7e6c54829a","2010-01-04 23:31:50+00:00","SCI: removing warning() from kFrameOut

svn-id: r46998
"
"c26ac879c6ae1c41f8be48fea0337448f1bf4e46","2010-01-04 23:32:41+00:00","Silence gcc warnings.

svn-id: r46999
"
"3c0805550eec0405c2812ac9aeb3c82e25168fa4","2010-01-04 23:37:29+00:00","Remove the planes/screenItems count and use the arrays' size() function instead.

svn-id: r47000
"
"f8ba8886ce2694f7fe0867e264d8209e1d3c4f4e","2010-01-04 23:39:22+00:00","Oops, forgot to commit this file too.

svn-id: r47001
"
"575bc45301f7c510dd9aced29b597ba6bd040618","2010-01-05 00:12:31+00:00","SCI: adjusting cel drawing according to left/top of plane

svn-id: r47002
"
"86cad51d0798ddad02fadc2380f39a8db2aa30fa","2010-01-05 00:25:49+00:00","Set the new sound code as default

svn-id: r47003
"
"f66d5a7f534ad2869aecfcacc90bf337cc33571e","2010-01-05 00:54:53+00:00","SCI: Removed the old graphics code

svn-id: r47005
"
"d8c59f5baa386a6baaf62685b794c2531b9cdd64","2010-01-05 01:14:08+00:00","Disable the planeLeft/planeTop code as it doesn't work under the current code (and left a FIXME explaining why it doesn't work).

svn-id: r47006
"
"84cd8d2dc7673bf883945cfdf600d98769817bc6","2010-01-05 01:22:16+00:00","Renamed /gui to /graphics and /sfx to /sound, to better illustrate their purpose

svn-id: r47007
"
"2f1a909696838533758acdb026b1fd9c3631d6f0","2010-01-05 01:29:04+00:00","Fix compile.

svn-id: r47008
"
"d99aa0f12634bed7b5101b4b5a64f50ee744961b","2010-01-05 01:37:57+00:00","More renaming

svn-id: r47009
"
"e72e1300488e8124d94ea8c9a8df52650f7d97bb","2010-01-05 01:47:44+00:00","Yet more renaming

svn-id: r47010
"
"e87cc86665b49da7edfab35588a9d7645a3f5610","2010-01-05 01:51:09+00:00","Fix walking in SCI32. Gabriel now will walk and DrMcCoy can now hear his precious 'Gabriel is a lout' line :P

svn-id: r47011
"
"00e48f687ff0b0302383abfb9971f5420dc3c265","2010-01-05 01:52:56+00:00","Cleanup

svn-id: r47012
"
"f5c3bd887e2257fc7fdfb0d141ddbae592f1e83b","2010-01-05 02:27:24+00:00","- Add a new SeekableAudioStream interface. Soon to be used to replace audio stream specific looping code by generic code in Mixer...
- Adapted some existing AudioStreams to implement that interface (not tested!)

svn-id: r47013
"
"2ef2064f44764e53b7317265dad471f5ee160300","2010-01-05 02:42:35+00:00","Make RateConverter::flow return the number of sample pairs written, like it's documented in the .cpp file.

svn-id: r47014
"
"5b9f267e71e634670cfbcdc92eab164d145e68cf","2010-01-05 02:42:55+00:00","Use the return value of RateConverter::flow to calculate the decoded samples and not the upper bound 'len'. (This should only be a difference when the audio stream has no more samples left)

svn-id: r47015
"
"d485d0c2959a57141bed12be95f69d1a0c7fb4d6","2010-01-05 02:48:38+00:00","Oops somehow I must have missed CopyRateConverter::flow, in r47014.

svn-id: r47016
"
"5fbbd5b8d998b086a20749e79aee4e9ab81b8cc9","2010-01-05 04:00:13+00:00","Zero the array before using it. You can go talk to Grace now, DrMcCoy.

svn-id: r47017
"
"c8f991e89b96aa33b221cfc2988f00e811044877","2010-01-05 05:25:18+00:00","Bugfix for crash if an error occurs before the game object (and thus the debugger) is created

svn-id: r47018
"
"43f19bc722977d5df1d200ecb9dce750f6b579be","2010-01-05 08:24:27+00:00","Added a new LureLanguage enumeration of supported languages, and changed game code to use it

svn-id: r47019
"
"4cc1d4ffb884501a8f912e0548e98da3d9359b1b","2010-01-05 09:59:25+00:00","Changed the create_lure tool to use the explicitly defined lure language list

svn-id: r47021
"
"8ccbe5acd56662cd66a9892c9d12f34408ae3434","2010-01-05 10:03:55+00:00","Fixed compiler warning about excessive bit-shift

svn-id: r47022
"
"3b8512b10429157ebf6f065247ec67e82d04c96d","2010-01-05 10:28:09+00:00","Cleanup, fixed fading of digital sound effects

svn-id: r47023
"
"928322314d82c9c7f549d6d9881025e30f5b9a8f","2010-01-05 13:21:39+00:00","Removed duplicate code

svn-id: r47024
"
"b2fd2a83105518a1a0a9a99f10879fb5eab14c47","2010-01-05 13:51:47+00:00","SCI: sci32 pictures are now fully drawn to screen (including all layers)

svn-id: r47025
"
"45bf6fc0d7bb440208b21f9201a80e92db328df7","2010-01-05 14:17:47+00:00","Removed a leftover unused hack from the old graphics code

svn-id: r47026
"
"9606e7fca72645a05ecdce97cc484351e23c7ead","2010-01-05 14:19:53+00:00","Some initial work on SCI1.1 view scaling (not working yet)

svn-id: r47027
"
"cc87f4a741a2b9d85b31b6bae3617beb1a7da6e9","2010-01-05 14:59:43+00:00","Renamed the version of drawCel() which calls BitsShow() to drawCelAndShow(), to avoid confusion

svn-id: r47028
"
"50888f5b65fe4a03eb92b848ec8228f78c5a006a","2010-01-05 18:32:26+00:00","- Fix a bug in Channel::pause for recursive pausing.
- Fix bug in Channel:getElapsedTime, when called while the channel is paused.

svn-id: r47029
"
"c4106653a8e6c618a96d593a837993fdc45444b0","2010-01-05 18:52:39+00:00","Fixed bug #2924968, 'AGI: Can't click 'cancel' in Save/Restore Game Menu'. This
regression was probably introduced with r45260, 'AGI: cleanup
GfxMgr::testButton'.

svn-id: r47030
"
"63bccc213becabbfbaa56969b85601d3468f3ccf","2010-01-05 19:51:48+00:00","Create a generic Channel interface for the default Mixer implementation.

svn-id: r47031
"
"4ebcd1c61c30da21b322f40201be1cecdd130e87","2010-01-05 19:52:12+00:00","Get rid of public variables in Channel.

svn-id: r47032
"
"7d5b2b118a79c60de046fbdfcff262fcd120b594","2010-01-05 19:52:32+00:00","- Do not calculate left/right channel volume every SimpleChannel::mix call anymore, but do it once
- Notify a channel, when it's channel volume type changed from inside MixerImpl::setVolumeForSoundType

svn-id: r47033
"
"7d126de793f476021d7d34e5eb3e25eff9398b05","2010-01-05 19:52:50+00:00","Add some basic documentation to the new Channel interface.

svn-id: r47034
"
"1712e223e2e520320a5ef4edfc8ad36cd82cc4a1","2010-01-05 19:55:05+00:00","SCI: removed uint16 limit within view class (allows hires views)

svn-id: r47035
"
"e9a94ecb9b6eb20cb7cdc4f838df3f9b049d2de6","2010-01-05 20:13:31+00:00","Add a 'getLength' function to SeekableAudioStream.

svn-id: r47036
"
"920dac2f9d271889ffdc6c05313c89a6077ec2d2","2010-01-05 20:14:28+00:00","Remove unsafe getTotalPlayTime from AudioStream.

svn-id: r47037
"
"e4a6b1c455e57d24595db27e0239e01fb8bd5bf9","2010-01-05 20:15:29+00:00","added subtitle speed option
fixed bug when idle animation could be displayed in a middle of the dialogue

svn-id: r47038
"
"d183fb3c8107c5d990edf64a69486692040b0013","2010-01-05 20:39:21+00:00","SCI: fix debug command draw_pic to accept higher resourceIds

svn-id: r47039
"
"3bf03039b86681673eba16e2c94ec0079ec54998","2010-01-05 20:49:03+00:00","SCI: removed hardcoded screen width/height from windowMgr menuPort

svn-id: r47040
"
"8bafb71df3ee0666bdaa7b1115fdeaf987ca36e7","2010-01-05 20:52:19+00:00","SCI: remove lowres limit from picture class, makes hires sci32 pictures work

svn-id: r47041
"
"7e5a7533ca4223ea26b258e624f58766be785da6","2010-01-05 20:58:41+00:00","more accurate timings.

svn-id: r47042
"
"be9507fcb1851966ee58539abc8825dd6859b188","2010-01-05 21:03:33+00:00","SCI: implemented new debug command 'draw_cel'

svn-id: r47043
"
"3e911cd6e8295b5d499a90ce1774f86d893d9133","2010-01-05 21:05:32+00:00","Changed an error to a warning in execute_method(), so that Torin's Passage scripts continue running (and crash at some later point)

svn-id: r47044
"
"caa3db465955ea9fee8fc78c908b7050e587487f","2010-01-05 21:10:34+00:00","- Initial implementation of looping of SeekableAudioStreams in Mixer.
- Adapted AudioCD code to use this for audio CD emulation.

svn-id: r47045
"
"083cab51573612f46e0a2aa6d65afb3c097fd7fa","2010-01-05 21:10:58+00:00","Cleanup.

svn-id: r47046
"
"d183420c8659181990dc8abf21ca9211473fd09e","2010-01-05 21:25:59+00:00","SCI: implemented debug command 'set_palette'

svn-id: r47047
"
"61c413e1149d56f491a6e66bf931755384ac58bf","2010-01-05 21:56:13+00:00","Update ARM version of rate filler code in line with LordHoto's change
in revision 47014.

svn-id: r47051
"
"2d3a06f8051d2f68d1d29e0ebf2ae83eac6f17fe","2010-01-05 22:00:06+00:00","Cleanup.

svn-id: r47052
"
"664ace90e7e735ff33142664f9c1d3424f8383b2","2010-01-05 22:00:38+00:00","Add some test for operator== in Timestamp.

svn-id: r47053
"
"7591a09365c9a4cb93fa13c54ae067a90cd02738","2010-01-05 22:01:05+00:00","Implement Timestamp::operator== as equality in time.

svn-id: r47054
"
"e38b7b3cc53fe02312fcaee5e95c37dfa1c65c92","2010-01-05 22:02:04+00:00","Properly initialize _pos in LoopingChannel.

svn-id: r47055
"
"841e2d34242418ed0c86a6d8d3a4a97faa085ae6","2010-01-05 22:09:16+00:00","separate timers for mark, scene and messages.

svn-id: r47056
"
"88b4bbb95243eeecc3dd3a204a33cced1ca4c2c6","2010-01-05 22:18:09+00:00","Fix broken Scumm dialogs, which is a regression from r46947. (They used a dummy name, which didn't exist in the theme config and later on just calculated the size on their own...)

svn-id: r47057
"
"711fada15c18e84f5b58475bf9eebe774ad7017c","2010-01-05 22:23:58+00:00","added logs about EVENT_RTL

svn-id: r47059
"
"79ee2b0895b4b64fab878f1f3c028e9bfdf5fcf3","2010-01-05 23:05:31+00:00","Properly adapt AUDStream to be a SeekableAudioStream and switched KYRA3 to use playAudioStreamLooping for its looping purposes.

svn-id: r47060
"
"81a94a06444fcefa8645b26ba34a5ee0e45851db","2010-01-05 23:59:28+00:00","- Put the new factories for MP3, Vorbis and FLAC in place.
- Marked the loop factories with loop related parameters as deprecated.

svn-id: r47061
"
"0e420431fdfa826f555cb7fb2236e950c7341595","2010-01-06 00:00:25+00:00","Adapt KYRA to use the new FLAC, Vorbis and MP3 factories.

svn-id: r47062
"
"fb9017c51e22c0121dafa124fb59de603e4f11b1","2010-01-06 00:00:50+00:00","Adapt SAGA to use Mixer::playAudioStreamLooping instead of relying the depracted in AudioStream looping support.

svn-id: r47063
"
"5243157eb10179b6fab3dd791cacc5cdd9b10396","2010-01-06 00:01:27+00:00","Adapt digital iMuse to use SeekableAudioStream::seek, instead of ryling on the deprecated FLAC, Vorbis and MP3 interface.

svn-id: r47064
"
"8638d6ce61414c8cb6ed87ef6101e6c113f97065","2010-01-06 00:01:57+00:00","Change the AudioStream::openStreamFile API to return SeekableAudioStreams and remove parameter for depreacted loop support. (We could consider moving this to SeekableAudioStream).

svn-id: r47065
"
"668f6e5de852a2a378cdff3c9e0f33d0836c4d11","2010-01-06 00:02:19+00:00","Adapt TOUCHE to use the new FLAC, Vorbis and MP3 factories (it didn't use any looping features anyway).

svn-id: r47066
"
"789f2ce25501757a91b0c6d426a73e4108e5e4b1","2010-01-06 00:02:49+00:00","The current AIFF stream implementations returns a SeekableAudioStream, reflect that in its factory method.

svn-id: r47067
"
"427a15cd05e248e6da93eb56426420df9caabfef","2010-01-06 09:38:56+00:00","minor cleanups

svn-id: r47068
"
"69566f6bf127af0ebdca73d2f33e30b6a0321094","2010-01-06 10:11:38+00:00","do not interrupt any actions (test for wii)

svn-id: r47069
"
"5b635fd610a2d1f895adadbb43af3a76a36f1fd0","2010-01-06 12:09:14+00:00","Change the way Timestamp stores its data.

Instead of storing milliseconds and frames (which causes rounding errors,
and causes ambiguity in how a given time is stored), we now do things
differently: We store a number of seconds, and frames. To make sure that
we can still handle milliseconds accurately, though, we change the
framerate to the least common multiple of the original framerate and
1000. So 60 becomes 6000, and 44100 becomes 441000. There are no visible
changes for client code, except for the increased accuracy.

svn-id: r47070
"
"1c6ccf8000c8eb34e4ae3d68312a23261f87862c","2010-01-06 12:15:05+00:00","Add more comparision operators to Timestamp

svn-id: r47071
"
"bcf7535c97ef6a49bbc9d110257caf7de49cfaed","2010-01-06 12:17:03+00:00","Removed all hardcoded screen sizes

svn-id: r47072
"
"3d3d0dee1b8cbc570d1626b1ca8e690f84cf54c5","2010-01-06 12:21:27+00:00","SCI2.1 and newer games always run at 640x480

svn-id: r47073
"
"86c1171b11edcfe28dab7a3ba282e8e75060b01c","2010-01-06 12:55:51+00:00","Removed one more hardcoded screen dimension

svn-id: r47074
"
"7d7d23ce2b8d7d2a4725303d893f273f366be18c","2010-01-06 13:05:14+00:00","SCI: making most of the variables in screen class private (some of it was needed for old gui)

svn-id: r47075
"
"ce5320d814869bac2cbba78a0182077964f74b81","2010-01-06 13:11:10+00:00","SCI2+ games no longer use priority bands (fixes memory leaks in true hires games, too)

svn-id: r47076
"
"07ce38db5fbc4dd54e1d88e35ecf005efe325920","2010-01-06 13:22:36+00:00","SCI: changed screenHeight to 200 fixed inside initPriorityBands() because the algo is meant to work on lowres only

svn-id: r47077
"
"9272822486e00db030b335c1ad2c5cceac231908","2010-01-06 13:26:53+00:00","SCI: initPriorityBands() now aborts when getting called and screen size is not 320x200

svn-id: r47078
"
"027fe079c946d2fc367bebe15244520b035e8990","2010-01-06 14:04:56+00:00","The error inside execute_method() has been restored, it's only a warning for SCI2+ games for now, till we figure out what's wrong

svn-id: r47079
"
"84f30344060ef382efa7d86fa8f7e55859e82421","2010-01-06 15:23:33+00:00","- Move openStreamFile from AudioStream to SeekableAudioStream.
- Fix documentation of openStreamFile.

svn-id: r47080
"
"e72707b04e2080c6f780fed54df3a57ce3c6d460","2010-01-06 15:33:54+00:00","- Add some functionallity to query the seconds and number of frames stored in a Timestamp.
- Add tests for these

svn-id: r47081
"
"297a95557946555e5cc51279abafc0dc362af5f7","2010-01-06 15:40:49+00:00","- Simplify Audio::calculateSampleOffset.
- Made Audio::calculateSampleOffset accessable from outside audiostream.cpp.
- Adapt KYRA's AUDStream to use Audio::calculateSampleOffset.

svn-id: r47082
"
"dd76e2bda0e33ad78c8c7dd8c998c6e51c8a04ca","2010-01-06 15:56:04+00:00","Rename some Timestamp methods: getNumberOfFrames -> numberOfFrames and getFramerate -> framerate

svn-id: r47083
"
"c58c870159fb1b337fd10d154381222eb5557294","2010-01-06 16:09:57+00:00","removed all magic about mark's velocity

svn-id: r47084
"
"8c79b6f6ee2cb11e1352df5fa4faf70903eca364","2010-01-06 16:11:21+00:00","Adapt FLAC and Vorbis to use calculateSampleOffset in their seek implementation.

svn-id: r47085
"
"9a99226d31570e83eac727fb2f001d1cbc7ac218","2010-01-06 16:39:48+00:00","Removed a hack from the fallback detector, used to distinguish some demos from their full versions

svn-id: r47086
"
"254850aa23c2dfc227d4f3176fac8ad37fbb0d56","2010-01-06 17:25:54+00:00","- Some work on kLocalToGlobal and kGlobalToLocal for SCI2+
- Removed the custom types MemoryHandle, LoopNo, CelNo (cause we ended up having code like LoopNo loopNo = ...)
- Improved the sanity checks in frameOut()

svn-id: r47087
"
"11d9f150106cbcc6be196902f3970badb8de70f5","2010-01-06 18:25:43+00:00","SCI: search for %J in text resources to identify japanese games, switch to upscaled hires when japanese games are started, removed TODO

svn-id: r47088
"
"edc7fcf121bf56052858498d3168c344c00d7442","2010-01-06 18:59:39+00:00","SCI: sync displayScreen with framebuffer after successful video playback (fixes background vanishing in mainmenu of gk1demo)

svn-id: r47089
"
"fc582c0e5975b0591268694fd02430504242b4a2","2010-01-06 20:22:00+00:00","SCI: Fix overflow in LZS decompressor

svn-id: r47090
"
"f32aeb01bfc905ce2fdbc5b2f79e6f91a3f7b769","2010-01-06 20:24:56+00:00","Add a constructor to Timestamp, which allows for specifying seconds + start frames directly.

svn-id: r47091
"
"b6b8a23cee82a7011b4007fa1506d42e64e0c284","2010-01-06 20:25:07+00:00","implemented clipping for mark

svn-id: r47092
"
"b6fb8b349a3260e8e3377366ccda45fc3b8c869e","2010-01-06 20:25:19+00:00","Fix FLAC's getLength implementation.

svn-id: r47093
"
"1f12957a50bbc38173c4f28f6ccaa82af8624c8d","2010-01-06 20:39:17+00:00","fixed special agents blink

svn-id: r47094
"
"dfc039e4bed4fcc9fe9e2a2a7c24bc9385991363","2010-01-06 20:49:16+00:00","better z-ordering for the mark's animation

svn-id: r47095
"
"72ecf8b61e2e5ddad37a62831d4c7295e60cda9d","2010-01-06 20:54:18+00:00","SCI: add robot/.rbt files to resourcemanager class

svn-id: r47096
"
"d2978e3d920ba82874c7d1886983335248c29437","2010-01-06 21:03:52+00:00","added hardcoded height value

svn-id: r47097
"
"1779a4488211903a0fe6efa145e3b8c265775bff","2010-01-06 21:16:11+00:00","better clipping for left/top sides

svn-id: r47098
"
"1bea3e387313a5bda02c5d6e4e75af538f69a243","2010-01-06 21:56:31+00:00","SCI: added a new class for robot resources

svn-id: r47099
"
"17feb75ae73826ee05a09e7d86d016ccef1c3ff8","2010-01-06 22:04:27+00:00","add new robot.cpp file

svn-id: r47100
"
"413b4291b4902783659775c651ee5b874871b43c","2010-01-06 22:24:52+00:00","Fix warnings.

svn-id: r47101
"
"5fa34f0415fb7595cf792f05f5f5d7d34c175c41","2010-01-07 10:00:51+00:00","Add browser to base.mmp
Create mohawk base mmp

svn-id: r47102
"
"ecc5307f3fc705946f08f7e601674d95b6dd1b73","2010-01-07 10:01:38+00:00","Add update of mohawk engine

svn-id: r47103
"
"74b998657d7b2e4df53ecd1400939b436afd6c7b","2010-01-07 10:22:31+00:00","do not render overlays over the animation sequences

svn-id: r47104
"
"58aab46f06834db23acbd75747b4df48b11f2a4c","2010-01-07 10:31:29+00:00","SCI: some portrait work (kq6 now shows the main bitmap as portrait, coordinates still messed up)

svn-id: r47105
"
"c37e772b8cde4c120064e4854f06d1e113bd7a39","2010-01-07 12:01:33+00:00","cleaned up player, fixed invalid delete's and memory leaks

svn-id: r47106
"
"12cd066e442eaedb4eacb575ee961657612be338","2010-01-07 13:30:08+00:00","SCI: fixed stupid bug in putPixelOnDisplay, fixes height of displayed hires graphics in kq6

svn-id: r47107
"
"4701d0799c997bb5479275ba0a3ff0ffd4113197","2010-01-07 13:56:56+00:00","SCI: small cleanup in view drawing

svn-id: r47108
"
"aa92e004f58470685e49b180ef19d92dc66c6436","2010-01-07 14:20:36+00:00","First step of a slight revision of the new AudioStream looping API:
- Create a RewinadableAudioStream, for streams which can only be reset to the start
- Create a LoopableAudioStream, which loops a whole RewindableAudioStream
- Make SeekableAudioStream a subclass of RewindableAudioStream
- Create a SubSeekableAudioStream, which allows of limiting the range of an SeekableAudioStream to be played.

- Adapt AudioCD code.

svn-id: r47109
"
"49e53ade008eb9cce1de00c45e41dbc6b52f8c49","2010-01-07 14:21:13+00:00","Switch Mixer back to use only one Channel implementation. (partial revert of r47031 + r47034).

svn-id: r47110
"
"b80779824f8fdec1bfbb59115cbcc01d07914a0b","2010-01-07 14:22:24+00:00","- Strip custom looping code out of FLAC, Vorbis and MP3 streams
- Adapt the legacy make*Stream factories to use the new AudioStream subclasses
- Change return value of make*Stream back to AudioStream *

svn-id: r47111
"
"e00f36f9c72a9b3264476e700c3f280204654264","2010-01-07 14:22:57+00:00","Cleanup.

svn-id: r47112
"
"6abc10c6eafd888db6c3da124155dd1c939c8e97","2010-01-07 14:23:42+00:00","Add a playInputStreamLooping for RewindableAudioStream to Mixer.

svn-id: r47113
"
"c57549184bc4239cb0ee58da13fc038f5cf266c9","2010-01-07 14:25:16+00:00","Add important note for engine authors about SubSeekableAudioStream.

svn-id: r47114
"
"5b063e2d939208415d6940eecfa56720108d4a27","2010-01-07 14:39:42+00:00","SCI: releasing sample stream as well (thx to LordHoto)

svn-id: r47115
"
"519e80ca8b57bb7b68a13cea6e83c0404fe0a414","2010-01-07 14:46:29+00:00","SCI: implemented additional drawCel for hires views, fixes menu bar of kq6 - still need to fix coordinates and implement save/restoreBits for hires

svn-id: r47116
"
"40f950616397dad5833751b755c11f92f4462acb","2010-01-07 15:07:36+00:00","The default keycolor for mouse pointers used to be 255.
This makes sense as a default for CLUT8 modes, but not really
for anything else.  As part of the gsoc2009-16bit merge, the
default was changed to 'all ones', with extra code in the SDL
backend to truncate this to the depth of the mode.  However,
'all ones' (white) still isn't a very useful default for RGB modes.
So rather than jumping through hoops to provide a bad default,
it's better to remove the default altogether.  Engines which relied
on the old default of 255 have been updated to specify it explicitly.

svn-id: r47118
"
"423094cd5f624feb259a0c6cbfefd269553ef44d","2010-01-07 15:11:46+00:00","Fix warning

svn-id: r47119
"
"32ec5746bebcfbaecece143f2ee75644a1000d17","2010-01-07 15:12:20+00:00","Add Timestamp::totalNumberOfFrames() method, clarify some comments

svn-id: r47120
"
"7f358e3bbdb8dbfbdd40f18af54d4fc4a3e8d21b","2010-01-07 15:25:03+00:00","SCI: changed kernel signature for kDrawCel, enabled upscaled hires savebox code ('crashed' before because afterwards kDrawCel will get the handle from the savebox call)

svn-id: r47121
"
"4f463e288e99c9b2adecfe91065da9cbd74950bf","2010-01-07 15:25:14+00:00","Get rid of calculatePlayTime, instead store playtimes as Timestamps

svn-id: r47122
"
"71b4b3dcba134a76d7490daf65523a6042efb94d","2010-01-07 15:28:58+00:00","- Adapt documentation, that keycolor in setMouseCursor may not exceed the maximum color value of the specified format.
- Change SDL backend to assert out on invalid keycolor values

In case we really need a way to specify 'no keycolor' we need to
discuss on how to do it *properly*.

svn-id: r47123
"
"8e54ce73a50f167e1b1f6efc0d128e1a9482eca2","2010-01-07 15:38:29+00:00","Moved creation of 'beep' sound buffer to sound manager constructor.

svn-id: r47124
"
"9577a45cdd70ca7b9e471434478f9eba8e60374e","2010-01-07 15:50:58+00:00","SCI: fixed save/restorebits within screen class for displayscreen case, fixes kq6 menu bar

svn-id: r47125
"
"8c03fffbf0c246b77b5d60604405aa898c58e6ea","2010-01-07 16:07:22+00:00","Nintendo64: Add FlashRAM support for saving if a compatible cart is available.

svn-id: r47126
"
"2e9bae44c5f80fe18aa0545b6c868682c380497c","2010-01-07 16:08:41+00:00","Let ADPCM streams subclass RewindableAudioStreams and thus allow them to be looped with the new looping code.

svn-id: r47127
"
"ca5e1379452f7777fd032baeb342ce88634d1836","2010-01-07 16:18:03+00:00","Create a wrapper makeLoopingAudioStream to reduce code duplcation.

svn-id: r47128
"
"d5fe29c3c949fda84a5a7a276160d57e646fc952","2010-01-07 16:34:56+00:00","Make makeWAVStream return a RewindableAudioStream.

svn-id: r47129
"
"4f52dcea66e412f2ccfb6527beb01777e5b2c850","2010-01-07 16:44:17+00:00","Adapt TUCKER to use RewindableAudioStream and Mixer::playInputStreamLooping. (Needs testing, please :-)

svn-id: r47130
"
"771867fd1bd96470d788644072f4f6ad8beca640","2010-01-07 16:49:23+00:00","Do not try to destroy an object on the stack via delete.

svn-id: r47131
"
"a597e5fef93523436e60eca18997fb5ca5196345","2010-01-07 17:04:01+00:00","Make VagStream a RewindableAudioStream.

svn-id: r47132
"
"b47725540f53694ce8d261a2b7b132aff6c6eb74","2010-01-07 17:04:32+00:00","Cleanup.

svn-id: r47133
"
"aa2f55ddc6730e8c3afce61efa241d5f1b1e6b34","2010-01-07 17:14:44+00:00","Remove the deprecated FLAC, Vorbis and MP3 factories.

svn-id: r47134
"
"45b6f84ba721d8388290b45d9f09d59d2e3d2068","2010-01-07 17:28:15+00:00","Some formatting fixes.

svn-id: r47135
"
"20a43c638cad067e361031a5fbdbdc2497e43497","2010-01-07 17:45:17+00:00","Premiliary adaption of SCI to use LoopingAudioStream. (This could really need some cleanup...)

svn-id: r47136
"
"127213f706bf5fff97942f9f88686c6323ad5750","2010-01-07 17:45:38+00:00","Remove setNumLoops and getNumPlayedLoops from AudioStream.

svn-id: r47137
"
"bd651c6c3d85bc4561fcd0a80492127ec359f894","2010-01-07 19:34:19+00:00","Fix a little bug in LoopingAudioStream::readBuffer.

svn-id: r47138
"
"a15cc002bbbba1666cde6b12daa72edb40ef2e89","2010-01-07 20:13:02+00:00","Cleanup.

svn-id: r47139
"
"140b22a37400abb65a999c46b6e5145af0bcf364","2010-01-07 20:29:48+00:00","SCI: implement crazy hack that fixes coordinates of some cel placements. I'm not sure if thats what sierra sci actually does or if we get coordinates 0,0 due some error somewhere. Fixes portrait window placement in kq6 - strangely they are still not at the correct height perhaps related to not adjusting 'correctly' (whatever this means in this ugly mess that hires was implemented) inside BitsSave()

svn-id: r47140
"
"7a636ead9d1ff8900815fa95a4f74d6665c8c59c","2010-01-07 20:36:00+00:00","SCI: sierra sci doesnt seem to adjust according to port on upscaledhires_save_box, this (and all the other fixes) finally fixes coordinates for kq6 hires cel placement

svn-id: r47141
"
"8a1583da9b2b6f545da2ab3f52fbffd7187b5505","2010-01-07 20:41:52+00:00","SCI: kPortrait actually gets lowres coordinates that need to get adjusted according to curPort (does this make sense? noooo), fixes portrait coordinates in kq6

svn-id: r47142
"
"2aca490e131bad1a2b199d3077f5c2f8ab8c58a8","2010-01-07 23:32:45+00:00","SCI: remove displaying tag in menu of some games (e.g. qfg1ega)

svn-id: r47143
"
"a5adbb851a2a16bf7b8edc918be27faf2e46cea9","2010-01-07 23:50:18+00:00","Fix use of getRate in VorbisInputStream's constructor. (Thanks to cyx for spotting this)

svn-id: r47144
"
"ad5e1e7c0309df7676ce42e7dacd5ee17fb97ef4","2010-01-08 00:05:48+00:00","Nintendo64: some cleanup, added a workaround in case audio buffers get depleted

svn-id: r47145
"
"cf9203a931bbe9f91f48abbde151228de655f09c","2010-01-08 07:45:48+00:00","cleaned up blitting, fixed zoom+clipping issues

svn-id: r47146
"
"65c29eb85183f8cecc1abff0d7776a767abf67ef","2010-01-08 07:58:04+00:00","added zero-object special case in combine table

svn-id: r47147
"
"adcb8cfa7d27ecfb4d2788a8b46ce4c8a6df6c94","2010-01-08 10:35:25+00:00","fixed inventory animation speed

svn-id: r47148
"
"35e01ef29a7859f9545d9273b41bc60b1bb18ec5","2010-01-08 10:39:00+00:00","removed mark's animation z-odering, which seems to be invalid

svn-id: r47149
"
"5f5225ea385b16b99d136fb34f09a0cdc16ba051","2010-01-08 11:05:59+00:00","minor cleanup

svn-id: r47150
"
"cd654b9616d1b44c24f276f4d53a322c6afbb5c6","2010-01-08 11:17:29+00:00","SCI: call gui-init right after loading a saved game, fixes weird gui issue that occurs only when loading a save through ctrl-f5 menu 'too early' in the game (where you couldnt load through original interpreter)

svn-id: r47151
"
"31d830e79dce314818812e8bf06de7f52724ecb0","2010-01-08 11:32:53+00:00","removed noisy debug

svn-id: r47152
"
"cac3510b670a74f1b5804f3c58cee5b939dc5e57","2010-01-08 12:17:41+00:00","removed useless initializations

svn-id: r47153
"
"3dda1c8073cee0ee35cafa8cdd28462e4727cc34","2010-01-08 13:45:44+00:00","SCI: Fix view detection in Hoyle 2

svn-id: r47154
"
"54fc5121568eda38ec21897cb295a32471ce6d3a","2010-01-08 14:02:08+00:00","SCI: Use adlib music by default

svn-id: r47155
"
"723ad1bdc13b959b423c0867e4f3441f8e0bc855","2010-01-08 14:26:26+00:00","SCI: changed handling when unsupported sound type is selected, we are switching to adlib or amiga sound then

svn-id: r47156
"
"52d264fac1b0c34a3a1192060f66eaabbdc960fe","2010-01-08 15:01:31+00:00","Fix unhandled case(s) in switch warning from g++.

svn-id: r47157
"
"abdebd9871aa4b07ced645ea76a2274f2dc80f48","2010-01-08 16:21:36+00:00","added warning on invalid sound

svn-id: r47158
"
"e976b1199538aa32067aed50f1886f2393ca148b","2010-01-08 16:25:51+00:00","Add another makeLoopingAudioStream factory for transparently looping a certain interval of a SeekableAudioStream.

svn-id: r47159
"
"616e4626f59ba354d420c60d59cb797b351de407","2010-01-08 16:27:29+00:00","Since AudioStream looping is no longer handled by the Mixer, drop Mixer::playAudioStreamLooping. (There's Audio::makeLoopingAudioStream).

svn-id: r47160
"
"85adbdb1ad7615b4d8177f9c3727ac4bcd5d1625","2010-01-08 16:31:48+00:00","fixed invalid volume setting

svn-id: r47161
"
"271956f2d7bff53eadaf658c25c423939c8ded65","2010-01-08 16:38:51+00:00","Add some warning inside makeLoopingAudioStream, in case the give start time is after the given end time.

svn-id: r47162
"
"b5603ee8227c0ea20cb3810748be8c65a3d5c4c7","2010-01-08 16:52:45+00:00","SCI: support '+' and '-' for menu (fixes speed changes via those keys in all games)

svn-id: r47163
"
"c067bf053d994f6c7dd8ab7d2658d8a46aea3cb9","2010-01-08 17:25:39+00:00","SCI: support 'Ctrl-' prefix keys in menu, makes Ctrl-keys work in lsl6

svn-id: r47164
"
"549da55565e170d2b92011a87d3f16da1b107785","2010-01-08 17:42:05+00:00","Remove custom AiffAudioStream and replace it by the use of makeLoopingAudioStream and makeAIFFStream.

svn-id: r47165
"
"b847a2be3582354429facec2a7e0a7c3764b8826","2010-01-08 18:03:34+00:00","added configurable timers/fast mode with ctrl-f hotkey

svn-id: r47167
"
"7bf9c22ec9f52b45c0685a6cd96297861bd064cd","2010-01-08 18:48:32+00:00","minor fixes

svn-id: r47168
"
"ae3dc2ddba6b5e6354de7e8b5e4124e35d221390","2010-01-08 18:56:12+00:00","Properly fix credits

svn-id: r47170
"
"3a163b960e70ce4d56db56312fdb3957b7f0ee5b","2010-01-08 19:58:47+00:00","This should fix bug #2928411, 'SWORD1: Macintosh Demo crashes after Intro'.

svn-id: r47171
"
"25226cdc23f39fd79c472342fcf84df90cb5ebc7","2010-01-08 20:11:27+00:00","SCI: updateCues() cleanup

svn-id: r47172
"
"0849da9564909ab4c283bbfd8dc34cfba3996c0d","2010-01-08 20:15:42+00:00","Fix documentation for setMouseCursor's format paramenter.

svn-id: r47173
"
"8ba776913dc34f6b213c9b013c67ff9f64e09ea4","2010-01-08 20:25:42+00:00","SCI: fixing sq3 again (state selector wasnt updated anymore)

svn-id: r47174
"
"5cfd241af9f4cad018cb3f8d9555e5a5e468c3bd","2010-01-08 21:44:18+00:00","SCI: we won't do keyboard mapping for sci1late+, because otherwise Ctrl-keys won't work. I couldnt find games that use Alt-keys, so I was unable to check those as well

svn-id: r47175
"
"f263393ef00517143876d26da2d35541307cb51c","2010-01-08 21:47:28+00:00","Fix sound effects in Sword1 PSX, regression from r47132.

svn-id: r47176
"
"95726dfe50eae85d0e7675f8891339fb0abb43fd","2010-01-08 22:04:30+00:00","Move Mohawk's QueuedAudioStream to sound/ (with some tweaks)

svn-id: r47177
"
"7efba850648777d2d562bfccf2f14868816d6391","2010-01-08 22:05:12+00:00","Switch Tinsel, MADE and some of the video players to QueuedAudioStream

svn-id: r47178
"
"474d49946f5254bff7ac6a490fcc3b02655fae23","2010-01-08 22:06:04+00:00","Rename QueuedAudioStream to QueuingAudioStream

svn-id: r47179
"
"0cf53b025d8136a2f20ba405da1a696d0aa8767a","2010-01-08 22:07:35+00:00","Move DisposeAfterUse::Flag from Common to global namespace, and into a new header common/types.h

svn-id: r47180
"
"490153232a89bc64deb8a2ea72443af986940e63","2010-01-08 22:07:56+00:00","Fix header guard

svn-id: r47181
"
"f720d99b0a4fdc97d4d5c01b8c4db43c318c62b1","2010-01-08 22:09:43+00:00","Switch Mixer::playInputStream to use DisposeAfterUse::Flag

svn-id: r47182
"
"c4892593538887d36858cbba609dbe34a4b60792","2010-01-08 22:10:19+00:00","Switch SCUMM from AppendableAudioStream to QueuingAudioStream

svn-id: r47183
"
"b8727aefcc6b73dba5338872ce6bc35b856e84f7","2010-01-08 22:14:55+00:00","Fix LinearMemoryStream::seek, when the stream was created without request to dispose the memory itself.

svn-id: r47184
"
"75a4ef14f1d75fc53b915cf3cfdaf59ae31c550f","2010-01-08 22:45:38+00:00","SCI: fix for platform difference between linux and windows, makes Ctrl-Alt-keys work under linux as well (e.g. lsl1, age questions cheat)

svn-id: r47185
"
"af8298d4f8f75b6fdc14ae6d21120bc82a1df560","2010-01-08 22:52:50+00:00","SCI: removed controlify() to ease readability of code

svn-id: r47186
"
"229c53d4851dd9acb784c62ef01bf9fef8d98776","2010-01-08 23:05:00+00:00","Use DisposeAfterUse::Flag

svn-id: r47187
"
"41eaeaa61d968442bf2055d07e30b0dd4d31d606","2010-01-08 23:09:30+00:00","SCI: Ctrl-Z now supported as well :D

svn-id: r47188
"
"be8371fb07936f27934909c4c0eb5184547a2656","2010-01-09 00:19:13+00:00","Replace AppendableAudioStream by QueuingAudioStream

svn-id: r47189
"
"6f78bc40dd04b0480c53e81772c3b2f8bd6cf0da","2010-01-09 02:14:12+00:00","SCI: Move music device IDs to drivers.

svn-id: r47190
"
"d1d4091281ea42528c89fadb48c7ab1409ed4583","2010-01-09 02:16:17+00:00","SCI: Cleanup

svn-id: r47191
"
"6e991dc73ec44165cce1c49f2e72a5a97893fc12","2010-01-09 02:16:43+00:00","SCI: Fix crash on exit when using PCJr driver.

svn-id: r47192
"
"ac7458f91608d89c5921f0de6581ac1f139c68bd","2010-01-09 02:17:17+00:00","SCI: Fix handling of output rate in PCJr driver

svn-id: r47193
"
"1e3679b4b6ef1645b1e4f8346d0b2e951417c78e","2010-01-09 03:08:51+00:00","SCI: Cleanup

svn-id: r47194
"
"30e360f5c519cd006f20ece0388be0206dd66701","2010-01-09 03:55:09+00:00","Yup, not checking for stereo sound was an accident here

svn-id: r47195
"
"e27ef211f80d48d79be29e8d5fe3409472b3697d","2010-01-09 09:27:40+00:00","Fix for a rare case where the NPC handler for Ewan the shopkeeper can cause an assert when you rejoin Goewin in the Weregate caves.

svn-id: r47197
"
"e50a24be15f2bf7f8c5c6ebe0ebb7bf33b57e6cf","2010-01-09 10:37:27+00:00","log when EVENT_RTL received

svn-id: r47198
"
"d7c46c154f840e8d102f729b3853ba256627572a","2010-01-09 11:39:01+00:00","fixed RTL

svn-id: r47199
"
"5d4ff2930bee11dfef21c66009245d144db5d205","2010-01-09 13:28:52+00:00","removed useless rtl logs

svn-id: r47200
"
"a815d0e12a42b8880b5f629d6053f96139a46acc","2010-01-09 14:09:45+00:00","SCI: added new debug command 'picture_visualize', which enables visualization of the drawing process of EGA pictures

svn-id: r47201
"
"30d787a829693a1fbffc6592fa70c7818dfb8ed7","2010-01-09 18:18:52+00:00","SCI: adding audio support to kPortrait, audio is now playing when portraits are shown

svn-id: r47202
"
"9c2fa534d115c2c38cc8249d738c747d22bb48eb","2010-01-09 18:51:25+00:00","Implement some safer handling of the 'Extended' block in VOC files.

svn-id: r47203
"
"7f78815e0e46c5549f1eb7b32455f053e11ada44","2010-01-09 19:12:53+00:00","SCI: kPortrait almost fully implemented (animation bitmaps still missing)

svn-id: r47204
"
"ac66783b5f5243163bcd06da43007e938e3b8f60","2010-01-09 19:32:39+00:00","Register default setting for 'mute' option

svn-id: r47205
"
"273da184ee4f63904e72e5aa9ae85daa93f5f95e","2010-01-09 20:38:22+00:00","SCI: kPortrait - animation included, doesnt seem right currently coordinate offset is missing (cause i cant find it) and mouth movement doesnt seem right...at least the basics work and graphic data is fine

svn-id: r47206
"
"c73927ee4cb070a026a05624086e4e3e95ef54c7","2010-01-09 20:43:24+00:00","SCI: deleting _bitmaps and unlocking sync resource in kPortrait

svn-id: r47208
"
"6619d95f48e2b3f5a67c58c4e951d2f371f21a62","2010-01-09 21:12:08+00:00","kPortrait: found the coordinate offsets, corrected actual bitmap size (sometimes extra bytes are appended per line) animation bitmaps now valid

svn-id: r47210
"
"8fdf6a8095286751c8e267b747c2168aa4213b6d","2010-01-09 21:20:39+00:00","SCI: kPortrait - drawing base bitmap before drawing animation bitmap

svn-id: r47211
"
"4a832ceb0179d280a5baca9db462cf9124d088e2","2010-01-09 22:36:32+00:00","Fix Timestamp::addMsecs; some cleanup

svn-id: r47212
"
"a44c6e43233ffd4b89fb6a6a96e156cd43412c3d","2010-01-09 22:37:10+00:00","Add Mixer::getElapsedTime() method returning a Timestamp, thus offering a higher precision than Mixer::getSoundElapsedTime(). Convert some video code to use it.

svn-id: r47213
"
"2c1ef90b8766d1abf2e484de989913e29436234c","2010-01-09 23:01:38+00:00","SCI: kPortrait - now drawing after wait, also using gui wait so mouse cursor still works during execution, makes lip sync perfect (thx to the other fix by fingolfin)

svn-id: r47214
"
"96068d30d937c5529e730ac61fd1ba26f69d7706","2010-01-10 01:25:37+00:00","Handle properly shouldQuit()

svn-id: r47215
"
"da09ee6732b77461d836f064ff7200b2f94ae80f","2010-01-10 08:55:19+00:00","SCI: switching to hires kDrawCel when 8th parameter is passed, fixed kDrawCel port adjust - fixes kq6 hires inventory

svn-id: r47217
"
"7d16dbeb3581924175cf7d63c6a4189e016e5413","2010-01-10 09:07:09+00:00","SCI: changed location of hack inside kDrawCel, coordinates of savedhiresbox may not get port adjusted

svn-id: r47218
"
"231e122c639e745094062e14273ab64b6bb84ea4","2010-01-10 09:42:55+00:00","SCI: updateBox now also supports hires mode

svn-id: r47219
"
"c371c395681b932535f40e1ebe768b14d77255f3","2010-01-10 11:01:36+00:00","SCI: changed SoundResource constructor to set values for digitalChannelNr/digitalSampleRate and digitalSampleSize at any time

svn-id: r47220
"
"7a5c119930f28f6a41c418cbe88b85f16ab13464","2010-01-10 11:21:55+00:00","SCI: ignore hiresMode when not being upscaledHires for kDrawCel and updateBox on kGraph - fixes kq6 dos

svn-id: r47221
"
"156e341e9b9902d67cb494c32678cab4d89ccddd","2010-01-10 11:29:58+00:00","SCI: kPortrait - error() out when resource could not be found

svn-id: r47222
"
"d2d740af2a5c7c67fdb823ca8e12fc6af2716c93","2010-01-10 11:33:10+00:00","SCI: fixed typo when getting resourceId on kPortrait call - fixes resource not found in kq6 within pawn shop

svn-id: r47223
"
"4122e411d045d8177deab74950bcb6d77ea6515f","2010-01-10 13:11:53+00:00","SCI: kPortrait - mouse click now aborts portrait

svn-id: r47224
"
"bda3fc940c3ecca011b04a32fb20970f53f49d1c","2010-01-10 13:22:45+00:00","SCI: kPortrait - abort on mouse presses only

svn-id: r47225
"
"6ca0570fe3bb3f3765677ff8cd3f9e0cbf062d6b","2010-01-10 15:20:14+00:00","- Add a SubLoopingAudioStream, which loops a nested part of a stream and thus features the same looping capabilites as LinearMemoryStream and LinearDiskStream.
- Remove custom looping code from LinearMemoryStream and LinearDiskStream.
- Adapt various client code to the changes.

svn-id: r47226
"
"0447a7f9f8850d209c5820fa7ee5350b54d96f76","2010-01-10 15:23:35+00:00","Fix a memory leak.

svn-id: r47227
"
"59471e3f4352396ba2e78c161b006e3d36e11682","2010-01-10 15:30:31+00:00","Fix missing type forward declaration in voc.h.

svn-id: r47228
"
"bfed78a5dbd1b7f528691f972757549eb5fcc6d4","2010-01-10 15:42:22+00:00","Add some more comments.

svn-id: r47229
"
"27957570bf36283df8218e519009a85765bf090a","2010-01-10 15:43:42+00:00","Typo.

svn-id: r47230
"
"09a2694f6f197c4f54a7cb08ab2b4cfe6c677847","2010-01-10 17:49:05+00:00","Check if game engine is already paused before pausing it again to show virtual keyboard. Fixes #2912148

svn-id: r47231
"
"8703b6929f20a926f04d90977e986fd23a0c0f10","2010-01-10 17:58:44+00:00","Mark the 'fix' in r47231 as a workaround for a probably deeper problem.

svn-id: r47232
"
"52fb0c59da70e0098ec8dfbc5d8b99d2e10067c5","2010-01-10 18:09:49+00:00","Fix bug in Engine::pauseEngine (this should fix #2912148 'Using virtual keyboard in menu mutes audio')

svn-id: r47233
"
"ecff81544c8b3c5cf4ad365553f27aad03987000","2010-01-10 18:11:36+00:00","remove unneeded workaround for #47233

svn-id: r47234
"
"2ae12749a981be8d0d915bf9ecb6b9596e6298f8","2010-01-10 20:58:59+00:00","fix #2926655: 'Teenagent: Inventory problems on BE systems'

svn-id: r47236
"
"a637f50862ca03f3af22ed71e29ae4792219219d","2010-01-10 21:13:38+00:00","Silenced warnings ('this' isn't defined on object instantiation, and commented out some unused variables)

svn-id: r47237
"
"9a18bfc22f2ee41b30a482937c1eac5cac00663c","2010-01-10 22:30:12+00:00","Nintendo64: use newlines when printing assert messages, to avoid wrapping

svn-id: r47238
"
"403c2f31bb9688a3284463913e97e9e2e4f85774","2010-01-10 23:55:15+00:00","SCI: Fix default optimization level in AvoidPath

svn-id: r47239
"
"8c4e0de67d5ed59754b7acc6a1890e3b253b242f","2010-01-11 09:28:00+00:00","Hide the mouse cursor while a video is being played

svn-id: r47240
"
"009b86e8cba47fa60213a84a7456671c35c553c5","2010-01-11 09:30:41+00:00","- Don't set the palette per portrait frame - setting the whole screen palette is a very expensive operation, and shouldn't be done on each frame, especially when all of the frames use the same palette
- Cleanup

svn-id: r47241
"
"5b043140ff0fdb621cde86c173621eab1f4556c8","2010-01-11 09:34:20+00:00","N64: a few optimizations in framebuffer drawing code

svn-id: r47242
"
"87cdc86580625abc12bbd4fde71764e4fd88a357","2010-01-11 10:17:23+00:00","MADE: Use Mixer::getElapsedTime and Audio::Timestamp instead of Mixer::getSoundElapsedTime

svn-id: r47243
"
"590481b12daf2287b37fdae757f8cca349912754","2010-01-11 10:17:55+00:00","Improve support for negative Timestamps, and add + and - operators

svn-id: r47244
"
"4996b7a7d4f6f910dcdf6c70bf1faf94f5ceb5d5","2010-01-11 10:31:40+00:00","Cleanup, fixed a memory leak

svn-id: r47245
"
"fc8fc3a664321b4cfce9f311fe9fb955372a74e3","2010-01-11 10:37:32+00:00","The portrait file data is now freed after the portrait animation is done

svn-id: r47246
"
"51afa7b0b65d484d77c72468f5025735d4828d87","2010-01-11 10:59:52+00:00","- Set the palette inside doit() again
- Removed a now obsolete TODO
- Portrait animations are now stopped when the Esc key is pressed, or when the engine should quit

svn-id: r47247
"
"002310f8c0965dde1de3c791a68c13a92dc72b00","2010-01-11 11:34:43+00:00","Added MSVC warning 4355 ignore for the M4 project

svn-id: r47248
"
"4400bac9ad00328aff6d00d90d5285fc5fef3b2f","2010-01-11 11:37:11+00:00","N64: optimizations in cursor drawing code

svn-id: r47249
"
"6a07bbd5f41960d5c773f116d24c4de741ef3541","2010-01-11 12:23:04+00:00","Moved all the cache limits inside helpers.h and removed an obsolete TODO

svn-id: r47250
"
"6d53dfe917ffdc6c569c29d82957214cc8a24afc","2010-01-11 14:12:52+00:00","Some portrait-related changes, to be used when portrait loading/unloading is done. Also, added a comment on where the class is used

svn-id: r47251
"
"70694f98580012a4cea668a43fbae9de78fa3596","2010-01-11 14:26:13+00:00","New music code: Implemented sound stopping after fading, and disabled MIDI sound volume fading, till we figure out what's wrong with fading in the Sierra logo screen in GK1

svn-id: r47252
"
"33db6acd7f616b4bedae2d7cf6c042b9f17d48c9","2010-01-11 16:28:46+00:00","Changed all kGraph calls which handle rectangles to use kGraphCreateRect(). Also, changed kGraphCreateRect() to return a rect, rather than update a rect pointer

svn-id: r47253
"
"61e792319d2381c58bbb45ab48b45343c5b71197","2010-01-11 16:33:00+00:00","Don't update the screen twice while waiting

svn-id: r47254
"
"59d4f14f391f7b7301e800b27750a3fc61212134","2010-01-11 19:22:19+00:00","Fix bug #2929619: 'IHNM: Small problem detecting German version'

svn-id: r47255
"
"3145ee5379044785fde3bc897b46f236d5797be9","2010-01-11 20:31:12+00:00","SCI: changed displaceY and displaceX for cels to int16, also inserted cast to signed char for sci1 displaceX - should fix wii flickering and incorrect cel placement problems

svn-id: r47257
"
"80ee1de8e4d1d7e56e703c86ca28377b02d6d59f","2010-01-11 20:41:07+00:00","Move Mac Binary resource loader to common class. Plug tons of memory leaks along the way.

svn-id: r47258
"
"65f11afe896bb9408b1a70343bb9bd9fb276f397","2010-01-11 21:45:48+00:00","Patch from tracker item #2909981 which documents the various MSVC warnings we disabled, and why

svn-id: r47259
"
"dc45c729a99714c27f5ce9d35cdf67e5fbcd8159","2010-01-12 00:18:40+00:00","Added mouse click handling for top menus (mouse clicks on menu items of each menu are not handled yet)

svn-id: r47260
"
"1a570df5dc3f1931eb9caadf2dddc1d08987c954","2010-01-12 00:51:37+00:00","SCI: Handle master volume inside music drivers

svn-id: r47261
"
"f2318e5fe4d80c3c04822734d73df54e89101e91","2010-01-12 10:23:16+00:00","N64: Icrease analog sensibility a little

svn-id: r47262
"
"6a5dbf6db737e976513ca840c41dcb3a9a346a3b","2010-01-12 12:00:00+00:00","SCI: continue when kPortrait is called with no sync resource existant for mouth movement, prints warning() instead

svn-id: r47263
"
"e4aed638b020a019dd6989541bd125cc93eb26c1","2010-01-12 12:58:48+00:00","Fix loop alignment check

svn-id: r47264
"
"52eb58a3e558a34b03c69ec5b4a60a5e6a1b9b41","2010-01-12 18:24:37+00:00","SCI: View::getCelCount now validates input

svn-id: r47267
"
"73bacd5d3a1b9a4c4646313c7efb8c81a185de73","2010-01-12 18:40:43+00:00","SCI: deleting _music in destructor

svn-id: r47268
"
"a14f044daa9210c55431a9683610064fa3594054","2010-01-12 18:43:10+00:00","SCI: deleting _font when changing active font

svn-id: r47269
"
"c1e4156587675f0412fcabdf93b97c5a113258fc","2010-01-12 18:46:42+00:00","SCI: added comment about 'not behaving like sierra here', also added TODO on mouse state change

svn-id: r47270
"
"003c62fee8d89cc4a06ca3193f72e086fdee41a2","2010-01-12 19:07:03+00:00","A null pointer can be safely passed to 'delete', thus there is no need to check against the pointer being non-zero in advance.

svn-id: r47272
"
"7ed214697701e021827cc1450fda880483873021","2010-01-12 19:52:43+00:00","SCI: changed interactive with mouse menu code (still not finished)

svn-id: r47273
"
"36444740b3e02318c8334475cdf5d5967c733719","2010-01-12 20:08:17+00:00","Fix some memory leaks caused by never deleting the objects inside SoundCommandParser::_soundCommands.

svn-id: r47274
"
"3578f8d091f55960868a4a36e4b48bf3a03d3659","2010-01-12 20:19:45+00:00","Fix some memory leaks caused by never freeing the allocated memory, which is pointed at by KernelFuncWithSignature::signature.

svn-id: r47275
"
"dd39b64ce4e5c508451be50d770e4b0f63b7e581","2010-01-12 20:26:49+00:00","Fix memory leak in MidiPlayer_Adlib.

svn-id: r47276
"
"a62bf2528f1cf8660b87015f135d70c846fb581d","2010-01-12 20:38:57+00:00","SCI: interactive menu with mouse fully implemented, mouse within keyboard menu not yet done

svn-id: r47277
"
"1ebe047972e2df513449db6aa615f6ab17dd6fb7","2010-01-12 20:51:45+00:00","SCI: using _menuRect inside Menu::mouseFindMenuItemSelection for easier code, also fixed stupid oversight that made the code crash in e.g. lsl6

svn-id: r47278
"
"0d995c592046aadbfcb8f46a252537da312912c5","2010-01-12 21:07:56+00:00","Rename all 'Adlib' uses to 'AdLib' to match the real name of the sound card / company.

Check this for reference:
http://en.wikipedia.org/wiki/Ad_Lib,_Inc.
http://www.crossfire-designs.de/images/articles/soundcards/adlib.jpg (note the upper left of the card)

This commit does not touch 'adlib' and 'ADLIB' uses!

Also it does not update all the SCUMM detection entries, which still use 'Adlib'.

svn-id: r47279
"
"ac668291acf04128793cd8442e718b3e787fd25d","2010-01-12 21:13:01+00:00","Fix bug #2930306: 'MANIAC - Italian NES version (extracted) not recognized'

svn-id: r47280
"
"3138ac98ba76a4c18b9133112dae075297491956","2010-01-12 21:18:28+00:00","N64: some cleanup and optimization of video code

svn-id: r47282
"
"62a87101d505d4f86a9504649ee7ffc3702b6189","2010-01-12 21:24:37+00:00","N64: forgot to disable some debug code

svn-id: r47283
"
"af1ba4229812b74ea7c543cd14b34be0c9af5db6","2010-01-12 21:46:50+00:00","Fix some memory leaks.

svn-id: r47284
"
"ef5c9f62d73bb3ebb5e140ea6ffb668999aed365","2010-01-12 21:49:43+00:00","SCI: implemented mouse interaction while being in keyboard mode, also ignore disabled entries/separator lines within mouse mode

svn-id: r47285
"
"587bbf4b3f142ab5b85054d7ac1814f740b3c09f","2010-01-12 21:52:38+00:00","N64: further commenting/cleanup

svn-id: r47286
"
"b44a56aa92c0411d034b71395b5f26494f367343","2010-01-13 08:14:16+00:00","Documented MidiParser_SCI, mentioning that it's an extension to the MidiParser_SMF parser

svn-id: r47287
"
"7db58ae29e9503a51ed27979b4959a9170ccd390","2010-01-13 11:14:04+00:00","SCI: fix kernel signature for kDrawCel (fixes island of dr. brain), added debugging output for kernel_matches_signature

svn-id: r47288
"
"6c6604d5897f828fb26f2884fa70c596671d30cc","2010-01-13 13:53:31+00:00","N64: if user has inserted a rumble-pak, rumble with shaking screen

svn-id: r47289
"
"24d1db6155513eb377f61bc75c61c34cc3d8c1ea","2010-01-13 14:46:45+00:00","The pitch wheel is now properly reset when a song is unloaded

svn-id: r47290
"
"29302d172b485eadaf4806a3dff6186791ce74b1","2010-01-13 15:17:22+00:00","fix comparison for platforms where char is unsigned

svn-id: r47291
"
"b59eebfea80e6c218bf04e64c74a07f41d85ba7d","2010-01-13 17:34:42+00:00","SCI: DoSound: when setting volume return previous value, fixes KQ6CD intro.

svn-id: r47292
"
"286d18b423509dbc57982975afa21b1056f4566c","2010-01-13 20:56:21+00:00","Fix bug #2924680: 'Large file support' with patch from same bugreport. Thanks to wjp.

svn-id: r47293
"
"a88b2639f5d4cfae5f8f8a115f2c703653dbd296","2010-01-13 23:57:53+00:00","SCI: empty() checks whether the map is empty... removing useless line of code :)

svn-id: r47294
"
"8559f0c3eb6af52c4bd97637f8bec17fe025c909","2010-01-13 23:58:25+00:00","SCI: Use prefix increment instead of postfix on iterators (more efficient); also correct code formatting issues

svn-id: r47295
"
"373700f00a391bcb38a4f54400330defac19be79","2010-01-14 01:44:11+00:00","SCI: Add MIDI support. Currently only the later MT-32/GM patch type works.
Support for the earlier MT-32 patch format will be added in the near future.

svn-id: r47297
"
"218d04afa127a110bec8056b74d96d77ec9c2680","2010-01-14 16:39:47+00:00","Hold pedal is now reset as well when a sound is unloaded

svn-id: r47298
"
"f1696ce7efe9be755a0e0f69bfbad210649a74c7","2010-01-14 20:53:37+00:00","SCI: change on reanimate kDisposeWindow behaviour, fixes sq5 window removal

svn-id: r47299
"
"69c1de90e4ee2ad9650ce40a6bd06a296494d160","2010-01-14 20:56:46+00:00","SCI: another change to reanimate behaviour of kDisposeWindow

svn-id: r47300
"
"177cfe4c92085991867fe82ad750e51620f55f6e","2010-01-15 07:40:07+00:00","When unloading a song, only reset the channels that it actually used, not all channels

svn-id: r47304
"
"7aa20a38a8b2e2f4682b37c1cf0006ae5f44da44","2010-01-15 08:23:48+00:00","Unified some of the code in midiMixChannels() and midiFilterChannels()

svn-id: r47305
"
"03381988766b5304b3ba955fc8d4ae24f359dd01","2010-01-15 13:33:26+00:00","SCI: adding scalesignal selector

svn-id: r47306
"
"c4d02f57846e4e46c6d9edb09a8900f90605b46a","2010-01-15 15:30:40+00:00","Updated kernel function check for kGetEvent in Mac versions and adjusted the comments for kGetSaveDir

svn-id: r47307
"
"0d81207e6886662994d07c08c652fb97ed397474","2010-01-15 15:37:40+00:00","SCI: adjust kNewWindow to support argc==15 (on mac according [md5])

svn-id: r47308
"
"552746951e5c034d1e740f81a6940f948cc36d19","2010-01-15 18:01:49+00:00","Fixed warning.

svn-id: r47309
"
"edb9487df58db906c30d2ac0f3338a9adb5951cb","2010-01-15 21:13:33+00:00","SCI: adding caching for scalesignal, scaleX and scaleY within kAnimate()

svn-id: r47311
"
"0dddf869fb2e358d425579f1ee37c46057a6ce08","2010-01-15 21:26:02+00:00","SCI: changed scalesignal to scaleSignal - selector works now :)

svn-id: r47312
"
"8689f1d8cc6a9684cb1c45a9d7f5016aac00f4c6","2010-01-15 21:32:18+00:00","SCI: added enum for ScaleSignal

svn-id: r47313
"
"7c8ae63101b90df24a894a64d3266dd2cf2a7a40","2010-01-15 21:40:58+00:00","SCI: more detail info about scaleSignal bit 1

svn-id: r47314
"
"fa079a6d6f118a09a9bdeb678f57584fb8e1d8d4","2010-01-15 22:15:58+00:00","Send a velocity off signal to all channels when a song is loaded

svn-id: r47315
"
"f1439b4fa7246c97820c69bf12625e9ec50e2221","2010-01-15 23:16:43+00:00","Fix QueuingAudioStreamImpl::endOfStream implementation. This fixes cut off speech in COMI for me.

svn-id: r47316
"
"c4a9d373ca30eed9df9aaf555f9798d131f0dd19","2010-01-15 23:35:24+00:00","N64: Use first controller found as input, easier to add support for different input peripherals now

svn-id: r47317
"
"22e8b3ed027669496e7ebd57e23eb391e61b33cf","2010-01-16 00:22:22+00:00","The GM patches from Sierra's GM utility can now also be processed with their original names. Thus, the user can just extract the patches from Sierra's GM utility in the extras folder, and it's not necessary to rename each individual file to '4.pat' and place it inside the associated game (works with the games that Sierra's GM patch updates, i.e. LSL1, LSL5, Hoyle3, SQ1, SQ4, Eco1, Longbow and Fairy tales)

svn-id: r47318
"
"944774e9f5fd93e077d3c0903603cfe0b9d27389","2010-01-16 14:20:00+00:00","SCI: created getCelScaledRect() inside view class

svn-id: r47319
"
"77ea73e9a5ce6d38e5f15dae9792909487fd3cb7","2010-01-16 16:00:21+00:00","Fixed a Valgrind warning about an uninitialized variable, from waltervn

svn-id: r47320
"
"220c118a8fd4459e8947b3896bef386dc8fe51c7","2010-01-16 16:06:41+00:00","SCI: Add support for earlier MT-32 patch format

svn-id: r47321
"
"e29c4e7af7b925bf5d04d80fa7deaaf8bcaa4005","2010-01-16 16:17:45+00:00","SCI: View::drawScaled() created (doesnt do scaling yet), removed scaling variables from View::draw, gfx calls drawScaled() when scaleX/Y != 128, getting scaled rect inside kAnimate()

svn-id: r47322
"
"0588e483b23df68a44394bb543352653474ea579","2010-01-16 16:21:17+00:00","Added detection for the appropriate GM music channel play mask

svn-id: r47323
"
"5437bf9cdae49b86eab4053fead633478576d860","2010-01-16 16:54:54+00:00","Disabled code which causes crashes/and or oddities with MIDI in later SCI games, from rev #47321

svn-id: r47324
"
"d1733bcf1526060e19411cbc6ddca8e1f772cfc6","2010-01-16 17:30:17+00:00","SCI: scaling support, upscaling not yet supported - not really tested, so there may be bugs

svn-id: r47325
"
"6caf8e3f89337e56d24ee7a7b412f4f5727e3723","2010-01-16 19:11:37+00:00","SCI: Fix rhythm channel handling in SCI0

svn-id: r47326
"
"7058e0fc9cc16678b681cc179b1e41495ecb2f20","2010-01-16 19:14:24+00:00","SCI: Cleanup

svn-id: r47327
"
"971cfcbd9eb73b5f0c035aa82273384698457269","2010-01-16 19:21:06+00:00","SCI: support for upscaling implemented, included clipping

svn-id: r47328
"
"bc3405cc9e4e29cbe1cbc9e5a8b77d8834a2ea10","2010-01-16 19:25:09+00:00","SCI: view scaling - dont fill left-over bytes if there are no left-over bytes :P

svn-id: r47329
"
"76dfdac6d49aa6a9c230f08e4fa676ac750d8010","2010-01-16 19:44:33+00:00","SCI: added TODO inside kAnimate for scalesignal bit 1, added comment about scaling into view class

svn-id: r47330
"
"3e0251eced95596260cf79e67db0497e3a6a121c","2010-01-16 19:50:59+00:00","SCI: Fix percussion volume adjust

svn-id: r47331
"
"570911b83ede482386a7c0212b982ce8a06c86bd","2010-01-16 21:00:15+00:00","SCI: fix kNewWindow code to match the code in gregs engine

svn-id: r47332
"
"b8f2a3a34271b73ab2cb84ea25e5fbf80e076658","2010-01-16 21:34:36+00:00","cleanup

svn-id: r47333
"
"7ec2da968c9c572daa888e4f3215e99ba0e9e86b","2010-01-16 21:36:08+00:00","Switch most AudioStream factories to use DisposeAfterUse::Flag

svn-id: r47334
"
"c7b258f87e504872e3b4a2dc2b619f6ffc626626","2010-01-17 02:13:40+00:00","SCI: Cleanup

svn-id: r47335
"
"e11e9338d151e659bbd8d23922375b550e362dd3","2010-01-17 02:42:31+00:00","Delay the time a sysEx takes to send instead of the old (incorrect) way of delaying only 45ms between two sysEx calls. (Code thankfully borrowed from waltervn).

svn-id: r47336
"
"bea8d931ff91d43e6369620a3a8b593a13a09bb5","2010-01-17 04:57:21+00:00","SCI: Add comment to channel mask code

svn-id: r47337
"
"d80606b397dee02bd81d82a0785009902db73099","2010-01-17 06:16:39+00:00","SCI: Cleanup

svn-id: r47338
"
"aa4d4f126ae979c1fd804cd9b2c94d96e23787b0","2010-01-17 11:24:29+00:00","New AmigaOS4 icon from Patch #2933748: 'AMIGAOS4: New Icon'

svn-id: r47340
"
"67f22f83d8b6ba94d45249bb7bc87fd253a501d4","2010-01-17 13:07:50+00:00","SCI: kDisposeWindow - use reanimate when argc == 1 (fixes iceman window removal)

svn-id: r47341
"
"cb1419ece9afa9f11d8ac5279f8fb8ea34fa960d","2010-01-17 18:27:57+00:00","SCI: another speed throttler, delays decrementing cycles/cycleCnt selectors, disabled code just for reference

svn-id: r47342
"
"3e44180e479c549403ff7144b460b453571f750f","2010-01-17 18:41:28+00:00","SCI: speed throttler changed, now gets triggered by kAnimate, removed initial no-delay, i'm still getting animation now in iceman and sq3, slow palette animation in longbow fixed

svn-id: r47343
"
"18da23407609040e700c6c759f1c0d2040c9e863","2010-01-17 19:32:19+00:00","SCI: Add MT-32 support for early SCI0

svn-id: r47344
"
"22ea4eb621b3b6f3267157368958af556b1ce68a","2010-01-17 20:00:58+00:00","SCI: Check GM patch before loading it

svn-id: r47345
"
"35c2469c0bd6e6af75c5642f52efd6e014abf4f5","2010-01-17 20:17:00+00:00","SCI: speed throttler - hardcoded exception for room 290/lsl3, should fix pushup count later in the game

svn-id: r47346
"
"fb178c0a62eb8b5ab9a56754c2320890154b98ee","2010-01-17 20:23:11+00:00","Mark lsl3 as a workaround.

svn-id: r47347
"
"055e17b60e522417089a8c752d138f13d894f4e0","2010-01-17 22:32:53+00:00","SCI: fixed detection to not crash when adding sierras pinball creep, also changed detection so that we dont 'accept' games that use unknown view resources (otherwise pinball creep will get detected as SCI)

svn-id: r47348
"
"7c646fb84bedec0d5906af24992d1fdb76248c44","2010-01-17 22:41:29+00:00","SCI: added warning() when detection fails to detect map and volume version

svn-id: r47349
"
"62a2ede60b60c4a013eab3614faa6faf76955ba6","2010-01-17 22:52:21+00:00","Fix SubSeekableAudioStream regression from r47226 (i.e. length was calculated as start - end instead of end - start).

svn-id: r47350
"
"9458b8a81ddd753e0deb79c6c6e1253d58261d3f","2010-01-17 23:09:40+00:00","Update debug message.

svn-id: r47351
"
"9593b72483a6646fbdbac4a1df961374a922bae8","2010-01-17 23:10:38+00:00","Fix SubSeekableAudioStream for stereo streams.

svn-id: r47352
"
"371a2a9ee9009d7acd6e837fa2ee6c0e383e058c","2010-01-18 00:56:30+00:00","LOL: fixed spell array size

svn-id: r47353
"
"4c9f323199933aaf5dfd76b566bc0ff03f9bb0ff","2010-01-18 07:21:54+00:00","LOL: cleanup last commit

svn-id: r47354
"
"ec34e88f7559dc946b75cb7793a848cee81cb3a9","2010-01-18 18:45:30+00:00","Fixed assertion when setting non 8-bit cursors in Myst, Masterpiece Edition.

svn-id: r47358
"
"0fd8008296d03ca7abba5ab6fae0e3c6f80b2797","2010-01-18 19:15:05+00:00","LOL: minor key map fix

svn-id: r47359
"
"7112cfe8a27bb5ae3a693332f26aa246d1c8c3e6","2010-01-18 21:29:43+00:00","Add detection for another french ADI4 environment disk

svn-id: r47361
"
"bab35a399156cba3d125c96e39ac96161289caf4","2010-01-18 22:39:56+00:00","SCI: dont set dataInc selector inside updateCues when dataInc is not available

svn-id: r47362
"
"3a34628e9e43985fe6a65d383eeee1b7127ab279","2010-01-18 23:01:05+00:00","SCI: added comment for merging together resource.p* files, if no volume file could get opened

svn-id: r47363
"
"8ff407e80aac35f1fc62a74881bc123aa3c93d07","2010-01-18 23:07:56+00:00","SCI: added comment about resource.p01 etc. (including possible TODO)

svn-id: r47364
"
"349fcd1d715091c1b1816ff610910531d5dd8544","2010-01-19 00:52:41+00:00","Rename 'Linear' audio streams to 'raw'

svn-id: r47367
"
"69be7476212916b166ac16db41253cd367fb0dcc","2010-01-19 00:54:06+00:00","Move raw audio streams to new header sound/raw.h

svn-id: r47368
"
"557bb394de6619dd1f360b72333fd2ec7b3defab","2010-01-19 00:56:29+00:00","Get rid of Mixer::FLAG_AUTOFREE.
Also fix several recently introduced new/delete vs. malloc/free mismatches.

svn-id: r47369
"
"9baa2acdca4a3d9440e836d917f14b5e1cdb6178","2010-01-19 00:56:52+00:00","SWORD1: Fix (?) sfx looping

svn-id: r47370
"
"c20df070f35557a8de5fbd3475ee5579abc584bf","2010-01-19 05:01:45+00:00","Make the workaround for the Riven intro background music work in the DVD version too.

svn-id: r47371
"
"2d776186f6755b3130f86036ef70aa2be821487c","2010-01-19 05:08:53+00:00","Missed copying a line from console.cpp; fixes a memory leak.

svn-id: r47372
"
"14a22567059ce6e456b213aae3f6052b0ce6ff7a","2010-01-19 10:47:46+00:00","SCI: added french lb2 floppy

svn-id: r47373
"
"f0a0ed8f9e01d3943f635b92af6f71ca83814f13","2010-01-19 11:19:53+00:00","Get rid of Mixer::FLAG_REVERSE_STEREO; also change SCUMM's iMuse Digital emulation to reverse stereo again, as it once seems to have been intended

svn-id: r47374
"
"b227c660c6f0491a409a35bbb317f8558258e338","2010-01-19 11:20:58+00:00","Remove loop start/end params from Mixer::playRaw; convert some code from Mixer::playRaw to Mixer::playInputStream

svn-id: r47375
"
"d2dd5a569a4033a46b2e5cd99b0dc71897c8d9bc","2010-01-19 11:21:25+00:00","SAGA: Move from Mixer::playRaw to playInputStream; add FIXME regarding sounds not being looped

svn-id: r47376
"
"5ee6c79b5d1bbdd2af6cd1471e6f4b82b988561a","2010-01-19 11:22:14+00:00","Convert more engines from Mixer::playRaw to Mixer::playInputStream

svn-id: r47377
"
"c01ef60cb90bc4ae7aa18010d584e8031eb024a1","2010-01-19 11:22:54+00:00","SWORD1: Fix memory leak in PSX audio code (seems to have been there for quite some time?)

svn-id: r47378
"
"bd4e6283af0cf2227a3a24ee6ee6be362d261adf","2010-01-19 11:30:41+00:00","sword1: removed a leftover semicolon

svn-id: r47379
"
"cf57f817b2a0ecbbf08bc985bd8fa4c12809a52d","2010-01-19 14:26:21+00:00","SCI: implemented priority bands support for sci1.1 picture resources, fixed lb2, kq6

svn-id: r47380
"
"136ae389d8858e8514052fd501ad502735c2fb4f","2010-01-19 15:10:48+00:00","SCI: don't limit priority bands in sci1.1 (fixes swimmer in lsl6)

svn-id: r47381
"
"d17e80f2147fcf9f70ac4ac6bf223abfbae0b306","2010-01-19 15:20:29+00:00","SCI: Still limit lower boundary in SCI1.1, moved upper priority boundary limit removal for SCI1.1 into init

svn-id: r47382
"
"54638f005b4232511a4d9417bf6c53ca28330b92","2010-01-19 17:34:24+00:00","Delete the inner music driver when MidiPlayer_AdLib() is destroyed, not in close(), as MidiPlayer_AdLib() is closed and reopened inside SciMusic::resetDriver(). Fixes savegame loading and resetting the game

svn-id: r47384
"
"e7c1a34b3f3f1197fa37cf437d06a79a293453ef","2010-01-19 17:45:14+00:00","SCI: Remove upper 4 bits when drawing lines on EGA games (fixes window colors in kq1 and others)

svn-id: r47385
"
"7b5a55a6a2b9406666d2017e27294f9f06c5d185","2010-01-19 18:11:09+00:00","SCI: use reanimate instead of BitsShow() when removing menus

svn-id: r47386
"
"425d0f7da3306487d2964f57dba1bac5c28938e7","2010-01-19 19:20:33+00:00","SCI: fixed displaying of menubar (fixes all sorts of ega games)

svn-id: r47387
"
"3738507d7fac1b9a349e658e59eb6532a63fa9c5","2010-01-19 19:21:31+00:00","Add support for the flyby videos in Myst ME Macintosh.

svn-id: r47388
"
"adc6e33f5b9d1a1421302f9269513e9ab9b347bb","2010-01-19 19:28:54+00:00","SCI: also fix statusbar

svn-id: r47389
"
"f2ddf8cdd872c5b474732bd8182d8cc1f81678ed","2010-01-19 19:48:56+00:00","SCI: call showBits() on the line between menubar and the actual menu (because reanimate clips to picPort, so that line wouldnt be shown as restored)

svn-id: r47390
"
"dbe665908e8536046593a6dfbb7087f53119f1dd","2010-01-19 19:58:36+00:00","SCI: dont directly set mouse cursor to visible state but call show() instead thus updating _isVisible so cursor wont get lost in sci0 games

svn-id: r47391
"
"f0e6c3f14204aec1d34860b0595495dbfd505b48","2010-01-19 20:02:17+00:00","- Removed the resetDriver() hack. The reason why notes stopped being played sometimes was actually mixer->stopAll(), which stopped the music stream as well (spotted by waltervn)
- Hooked setReverb() to actually set music reverb

svn-id: r47392
"
"428f8d6955202a238ea7a8e887d707503a487449","2010-01-19 20:41:51+00:00","Fixed some cppcheck warnings.

svn-id: r47393
"
"68826c27daabe92782053c17c838ef585cad28c8","2010-01-19 22:19:43+00:00","Get rid of Mixer::playRaw for good

svn-id: r47394
"
"dc5e08e623453aef8bbd92c484dde26d67d91d1e","2010-01-19 22:30:33+00:00","Move raw audio flags from sound/mixer.h to sound/raw.h

svn-id: r47395
"
"bce959e0465fd6d5f92b05f338ffde24820bb1ed","2010-01-19 23:48:55+00:00","LURE: Remove evil 'using namespace' from header files

svn-id: r47396
"
"cebaa0b0d305aecbdd60424eff1890ebde66312a","2010-01-19 23:50:33+00:00","Started to get rid of Audio::FLAG_LOOP

svn-id: r47397
"
"7ea3f6e3ed3975c76554beaaac8607f4bc76f35b","2010-01-19 23:51:38+00:00","The Shorten audio decoder doesn't seem to use looping, so use the non-deprecated version of makeRawMemoryStream

svn-id: r47398
"
"24ae816395059b5949d4123798bbe9cef6a82ed3","2010-01-19 23:52:49+00:00","cleanup

svn-id: r47399
"
"a2edf1cd1608573ccb88e4d701311f5f26148021","2010-01-20 00:00:50+00:00","Fixed cppcheck warnings. I usually stay out of backends I can't compile myself
but this change seemed obvious enough that it should work.

svn-id: r47400
"
"35580bbf790891b56e65c1239d8bd9bc5557bfca","2010-01-20 00:01:42+00:00","Fixed a small memory leak. Cppcheck again...

svn-id: r47401
"
"1891d37cd06daf14b396cfacf62ec5befedea33d","2010-01-20 11:47:24+00:00","New version for the trunk!

svn-id: r47402
"
"1e9c18a68cfe101c3035d85cb9519c0f7f0389e3","2010-01-20 12:06:05+00:00","New version nr for UIQ3 pkg

svn-id: r47403
"
"f5f6faaf971b4e900c6e14c14bebd465952ca8ca","2010-01-20 12:22:53+00:00","Add teenagent.dat file in dist.

svn-id: r47404
"
"7799dc3614b2987ced46905edf9eb6c46cbcd13a","2010-01-20 12:43:59+00:00","SAGA: Change Sound::playSoundBuffer to enable looping for all sound formats

svn-id: r47405
"
"31e39d221b6591c48d3855ca660c971dbfc4ed30","2010-01-20 12:44:37+00:00","cleanup

svn-id: r47406
"
"0b2453aed8f49840ed275ebb5e13f9215a4c19ff","2010-01-20 17:56:00+00:00","SCI: workaround for game menu/quit menu in freddy pharkas till vm issue is resolved

svn-id: r47407
"
"bbc2ec095802421f221046a3882792da52037eab","2010-01-20 18:51:22+00:00","N64: Initial support for n64 mouse, tweaking needed

svn-id: r47408
"
"49d3ba06bf8c249b440e4b3333a5dcebd8567fb7","2010-01-20 19:45:42+00:00","SCI: kDrawCel workaround documented and not temporary anymore

svn-id: r47409
"
"99896e8a45ee12962e6e60d7cbbf97280e4d9c23","2010-01-20 20:09:24+00:00","SCI: boundary check on getPortById()

svn-id: r47410
"
"e85d2a023d6603b919ae49fe89f5fc487c817154","2010-01-20 21:59:12+00:00","SCI: control icons now use objects priority selector instead of hardcoded priority 255. fixes jones speech bubbles

svn-id: r47412
"
"caf631055981dad3c1519b5e8bf16338c2d62b1c","2010-01-20 23:23:33+00:00","Add another Dutch Windows demo of Freddi Fish 4.

svn-id: r47413
"
"2b929ed96e66647cbad4b07e385afd2b971ea9da","2010-01-21 08:26:40+00:00","N64: increase sound buffer size

svn-id: r47414
"
"d5dfb7ef0a9132ce4041f10c30883a2fb0584963","2010-01-21 09:01:00+00:00","N64: optimizations to cursor handling code

svn-id: r47415
"
"c5409b2d7b1480934d4622b9b7e83928f53abc3a","2010-01-21 16:24:47+00:00","SCI: Add MT-32 to GM mapping

svn-id: r47416
"
"9f5e50c1304a8097a70761cc3e3c5eee7a4e3044","2010-01-21 16:25:39+00:00","SCI: Removed seq/ directory

svn-id: r47417
"
"208dbf1d9ad1bcb6e365d5ce9092de962d1d5cd9","2010-01-21 16:27:29+00:00","SCI: Renamed softseq/ to drivers/

svn-id: r47418
"
"b6742d12f6810801cf57cef5798a157c53e78515","2010-01-21 16:28:09+00:00","SCI: Cleanup

svn-id: r47419
"
"66f90a40c93c97ede730da880cfb86ffaf06d2b0","2010-01-21 18:31:46+00:00","N64: change input related code to better fit mouse support

svn-id: r47420
"
"93a8b469c03d05ddef0aa46a51887a68ff629eb7","2010-01-21 21:28:32+00:00","- Fixed pausing of all sounds in the playlist
- Sounds are now paused correctly when opening/closing the debug console
- Some cleanup

svn-id: r47422
"
"c46c42ceb0f6b847d156d90d182bf0a808ab38dd","2010-01-21 22:20:16+00:00","SCI: Saved games can now be loaded from ScummVM's launcher

svn-id: r47423
"
"c8e2b0f9674f4949b61f5dbeff931f7cc6328d2f","2010-01-21 22:33:35+00:00","SCI: fixing iceman intro again (dont set datainc immediately but after delta)

svn-id: r47424
"
"8257b1106cf8c037c56ee855edc3d8dd32d12dd8","2010-01-21 22:44:25+00:00","Fix gcc warning.

svn-id: r47425
"
"1928a7ba38bed50b2342fa0946538b6dc5330755","2010-01-21 23:05:33+00:00","Silenced some cppcheck warnings.

svn-id: r47427
"
"716a2bf2423dac64dff5080fc59d75a9ae0e3723","2010-01-22 01:01:08+00:00","SCI: Fix OB1 error in rhythm mapping in MT-32 to GM translation

svn-id: r47428
"
"c04f8d00b15d0ebedce6b27e60e64a48f9259e42","2010-01-22 03:43:57+00:00","Rename MohawkFile to MohawkArchive and OldMohawkFile to LivingBooksArchive_v1 (the latter originally having an ambiguous meaning) and move them to resource.* Also, renaming the Living Books game types to remove the ambiguous old/new.

svn-id: r47429
"
"0388e359e0d048327fd028e93c6155907986ae50","2010-01-22 04:24:04+00:00","Always loop sounds declared in the VIEW resources of Myst. While Myst specifies in the metadata of its sound resources, Myst ME does not have that feature so we have to specify the looping. Looping now works in Myst ME.

svn-id: r47431
"
"57a4c0b910b1548c21b3de53c68f620002b6d448","2010-01-22 08:38:53+00:00","Mark Audio::FLAG_LOOP as deprecated.

svn-id: r47432
"
"47c97f4a60c54952956e2eea58ae31939afe7fae","2010-01-22 12:26:12+00:00","- The reverb value is now obtained from the music driver
- Implemented kSetReverb (0x50) and kResetOnPause (0x4C)

svn-id: r47433
"
"b8d0c214ea58eab7d6a7d3466d010ceb1deabd25","2010-01-22 12:32:54+00:00","Reset the value of _resetOnPause when a song is loaded/unloaded

svn-id: r47434
"
"6bbca6ee24438e65004dc41df0d0bbbd5b93e69c","2010-01-22 12:37:06+00:00","Fixed typos (thanks to salty-horse)

svn-id: r47435
"
"7ab85cd0353cd8cd1bd41e1a34853c1a2d8012d9","2010-01-22 14:11:33+00:00","SCUMM: Get rid of some redundant enum vals in iMuse digitial

svn-id: r47436
"
"a8c8763da5fa358b03754891bf772b44df3cbff9","2010-01-22 14:13:10+00:00","cleanup, typos

svn-id: r47437
"
"90d503c74acaba56ca1233a0220ca98c4f58b87e","2010-01-22 14:14:28+00:00","Clarify that all blocks of raw audio data are assumed to come from malloc()

svn-id: r47438
"
"61acb22fc56c59331fa539fbd9d7920e97409ad9","2010-01-22 17:38:06+00:00","SCI: draw a black line under menubar when menu is active (effectively for jones, wouldnt be needed otherwise), adjust inverting menu selections accordingly

svn-id: r47441
"
"8f41cc0631914a6a743a1efa5275d8fa399b4f12","2010-01-22 18:20:57+00:00","SCI: removed error inside Menu::mouseFindMenuItemSelection, instead returning 0

svn-id: r47442
"
"48184679086094cc5d6067de8c31a6823fc71732","2010-01-22 19:05:02+00:00","Silenced some more cppcheck warnings. Some of these may seem silly, but the way
I figure it the changes are harmless at worst, and making them will make it
easier to find real errors in the (still quite long) list of warnings.

svn-id: r47443
"
"4500910b4929f36f89a96827fa7f77677a217c8c","2010-01-22 19:25:48+00:00","SCI: reverting r47412, change was incorrect and also resulted in broken animations inside text boxes in kq5. jones also uses hardcoded -1 priority for control icons.

svn-id: r47444
"
"fa80444a12cf5b0d1c4bbda81c4d7e969d905fee","2010-01-22 22:34:14+00:00","SCI: restoring r47412, we were right all along but this 'hack' was done on the sierra sci interpreter for jones ega/vga only (talkie NOT included). So this restore does it game specific now, causing no regressions anywhere else. We detect jones/talkie as 'jones' as well, may cause regressions for talkie

svn-id: r47445
"
"81e85b31862aac70d4998962afff5c0bd6e8ad6f","2010-01-22 23:02:33+00:00","SCI: dont swap coordinates on rects when both are 'wrong', will fix button placement and gfx corruption when challenging jones (caused by duplicate buttons having lower right 0, 0) - function needs some more work

svn-id: r47446
"
"8c9d82715e7edd76ba2cd3b92f760c2a5802cffb","2010-01-22 23:39:28+00:00","Update copyright string to show current year

svn-id: r47447
"
"eb7b90f3134facd5c624750f875daeedfe6e3d42","2010-01-22 23:44:43+00:00","Get rid of kGameTypeAdibouUnknown (which is a mix of other versions), and Add kGameTypeAdibou1.

svn-id: r47448
"
"b14396edf2f042231abb88c9371d42cb2d415a78","2010-01-22 23:56:25+00:00","Replace header by a standard header

svn-id: r47449
"
"e754d8e1d3ae09cc5ab0915be2d656a927ac41a9","2010-01-22 23:56:59+00:00","AGOS: Rearrange sound code a bit

svn-id: r47450
"
"e270da88a68cc30ad6804eddb2d891fa80da47af","2010-01-22 23:58:24+00:00","AGOS: cleanup

svn-id: r47451
"
"39af342fd17f2ba3ed4c289e8b90d3ce0d0dd068","2010-01-22 23:59:16+00:00","AGOS: Add FIXME for a memory leak

svn-id: r47452
"
"a58efede576ae79b6162bdf43ff874b3cd3c19c4","2010-01-23 00:00:11+00:00","AGOS: Start to refactor sound handling

svn-id: r47453
"
"0b7ae99ad4245695f490d8b41c90bf90a1213542","2010-01-23 00:01:00+00:00","AGOS: Get rid of FLAG_LOOP usage

svn-id: r47454
"
"c3c7071948010c6418f8246b82232832ef5c48c4","2010-01-23 00:02:01+00:00","AGOS: Unify code related to compressed sound

svn-id: r47455
"
"a193c91e9566ff63f60846902b7f616f2fa9df1f","2010-01-23 00:02:59+00:00","AGOS: Turn BaseSound::makeAudioStream into a pure virtual method

svn-id: r47456
"
"151906f14bce8087aba45b8862b266bc2921ebb9","2010-01-23 00:04:01+00:00","AGOS: Fix memory leak in Sound::loadSfxTable

svn-id: r47457
"
"409e44e7c34ed901f884eeea2824fae6c5cad068","2010-01-23 00:04:43+00:00","AGOS: Further unify code related to compressed sound

svn-id: r47458
"
"8508a97adde127b151d80d003b19f73160938f52","2010-01-23 00:35:14+00:00","Get rid of two more FLAG_LOOP instances

svn-id: r47459
"
"ed1de6e2081efc23bcdcc7f94aec9cca043f4a52","2010-01-23 03:02:56+00:00","Fix regressions, only the Amiga CD32 version of Simon the Sorcerer 1 used signed sound data.

svn-id: r47460
"
"ee653e19ec37346262959617b0095437e8655212","2010-01-23 03:09:29+00:00","Update comments.

svn-id: r47461
"
"e99adedac29f148e392e70ddd5a794caaa10e7f2","2010-01-23 11:00:24+00:00","SCI: separate fix function for kDrawControl rects

svn-id: r47462
"
"ed349aba0f4d4098742a0dba8c355cab91a720b2","2010-01-23 12:01:04+00:00","SCI: SCI0 games have a grey titlebar

svn-id: r47463
"
"f007435b821ddb4797b580dcbee6c6d7bcec9ea6","2010-01-23 12:10:31+00:00","sfx_init_flags is not used in the new sound code

svn-id: r47464
"
"0c5f1c3f970980c7b9a1956c3b496d7b6f5604ee","2010-01-23 12:30:15+00:00","Update HE version for Dutch Windows demo of Freddi Fish 4.

svn-id: r47465
"
"2c71e7b76db6beed9d9bb2d0e3ad5f1f64cdfbf1","2010-01-23 13:32:45+00:00","cleanup

svn-id: r47468
"
"56dea320e2769deda55efa7c1a9a1457e42f9191","2010-01-23 13:33:08+00:00","Fix (?) looping in IFF FORM-8SVX data

svn-id: r47469
"
"af536542ed360e824c0f1addb68e91b5ca367aa2","2010-01-23 13:33:27+00:00","Let the 8SVX code directly instantiate a SubLoopingAudioStream

svn-id: r47470
"
"7eb407be80857b27c718e4e6f22de61c4d88b183","2010-01-23 13:33:45+00:00","Cleanup raw looping code

svn-id: r47471
"
"b036392a7b1c49a3a9d1ac0d0dd035feb7063058","2010-01-23 13:34:29+00:00","Get rid of deprecated makeRawDiskStream variants; rename deprecated makeRawMemoryStream variant to makeRawMemoryStream_OLD; adapt some code to this change

svn-id: r47472
"
"f189cc39fce6a17892b52aa10ede02bb11679f67","2010-01-23 13:34:59+00:00","Get rid of FLAG_LOOP

svn-id: r47473
"
"18a18701f7dbe9ffeaf9d0c67003090fa8d68534","2010-01-23 13:46:43+00:00","Disabled the unused resource loading code for the unsupported QT MIDI format, used in the Mac version of IHNM

svn-id: r47474
"
"d6e0276119265f825bbd5ab4a418cf234d48ed82","2010-01-23 14:39:03+00:00","Added song manipulation debug commands: songinfo, startsound, togglesound and stopallsounds. is_sample now works with the new sound code

svn-id: r47475
"
"e488e0f7d5da43263ca373c60222e66d66852767","2010-01-23 15:00:11+00:00","Tools - Use standard header

svn-id: r47476
"
"27b37ed97e4a47200f9940c800cd913e006dba10","2010-01-23 15:01:17+00:00","Amiga SCI1 games had signed sound data. Fixes PQ3 Amiga

svn-id: r47477
"
"a469913c60657461541c6cb37442a92514440ed3","2010-01-23 15:27:47+00:00","Tools - Replace some more headers by standard headers

svn-id: r47478
"
"4fcc82e7a625a0b27927491ca03c41a9f3dca35b","2010-01-23 16:15:18+00:00","Paranoia change: add some explicit terminating 0 after some strncpy uses.

svn-id: r47479
"
"df149e1509d972b2d5bfe903531d9670c2fe83c7","2010-01-23 17:55:54+00:00","Separated the parser code

svn-id: r47480
"
"2489340cc888d69a2b3b81b3ee27845392c0493f","2010-01-23 18:11:21+00:00","Fix build broken with r47480.

svn-id: r47481
"
"edbc3683987faf7487b10513a812ca2857a04771","2010-01-23 18:24:11+00:00","Cleanup. (And along with it add some additional asserts).

svn-id: r47482
"
"722233fd0ddc4447b30f352f6b4bb19728d824fa","2010-01-23 19:10:56+00:00","- Moved all of the parser-related variables inside the Vocabulary class
- Moved the kSetSynonyms() function inside kscripts (as it's for script synonyms, not parser word synonyms)
- The parser vocabulary is now only initialized for SCI0 and SCI01 games, which had a parser

svn-id: r47483
"
"dcbcb4185586e30ac8f7d1366f272cf134317feb","2010-01-23 20:27:14+00:00","kSetSynonyms is really parser related, but it's an empty function in games without a parser

svn-id: r47484
"
"5b4fcfdbcb2c6b1e48bb560705ffe6e6f5261d0f","2010-01-23 21:33:24+00:00","Added some skeleton code for kPalVary()

svn-id: r47485
"
"084c1b8032f294fee6bdd3eaf1b5e28f5f4f278b","2010-01-23 21:50:26+00:00","Some more header modifications

svn-id: r47486
"
"a1b181cedd3b190e4d9a3eb0938ef4c37e50eaab","2010-01-23 22:13:40+00:00","Headers - Add URL in properties so it's displayed properly in the header

svn-id: r47487
"
"00b4e1440cbb339e759ad509ea94bf8688822e52","2010-01-23 22:29:05+00:00","Header modifications. Add standard header parts and properties.

svn-id: r47488
"
"1f79fd57881cd24a3b16c5775187487acee69dd9","2010-01-23 22:50:24+00:00","Some more header modifications ('Graphic Adventure Engine' and the legal property paragraph)

svn-id: r47489
"
"5cca3d8edd57fb1a647523a8fa2ab35910a71a96","2010-01-23 23:05:15+00:00","Oups, I missed a second copyright string

svn-id: r47490
"
"9369c9f3c518d394b50b04afcf91e7cc5f2f39be","2010-01-23 23:11:07+00:00","Add header

svn-id: r47491
"
"4b996e7de7d25a650f1ae73722af827fcab7b4d6","2010-01-23 23:55:35+00:00","Reorder params to Audio::makeRawMemoryStream

svn-id: r47492
"
"0be507e9c32932b8b578f857d35232a53a0d450f","2010-01-24 08:19:15+00:00","Silenced two more trivial cppcheck warnings.

svn-id: r47493
"
"d0b8a8e468017ce9096729a78fe3b19ff4f89a68","2010-01-24 10:06:27+00:00","SCI: supporting .used bit 1 in palettes (force direct palette setting) and clipping palette intensity results fixes fade in/out in sq5 intro (some timing problems remain)

svn-id: r47495
"
"135294068848fbe476658af4765f85fee75fa57f","2010-01-24 11:00:21+00:00","Replaced CHECK_OVERFLOW1 with asserts

svn-id: r47496
"
"bab94d58ba2a91c647c17a88e4ca3928ebe838b4","2010-01-24 11:54:55+00:00","Added missing documentation for the new music related commands introduced in rev. 47475

svn-id: r47497
"
"aab6485d322cc71e37aa3ec525b832169831fc1a","2010-01-24 11:57:10+00:00","Always memset the newly malloc'ed argument memory to 0 inside kFormat

svn-id: r47498
"
"0d2a75c75d7b0f5330fba59eaf51dd574366b9c6","2010-01-24 12:19:09+00:00","Fix indentation

svn-id: r47499
"
"bffdcc9e54f5228d11b30c6a1f848746b843181d","2010-01-24 15:21:51+00:00","SCI: Fix left aligning and centering in kFormat.

svn-id: r47500
"
"4eb077dcf374a77bdffb1e0a80ea0da31886f86b","2010-01-24 15:40:36+00:00","LOL: save/load menu speed up

svn-id: r47501
"
"53d8bd976034975b46d41227729e5aee64a3ce17","2010-01-24 16:25:08+00:00","Cine: Cleanup (Use an enumeration for mouse button states rather than values 1 and 2).

svn-id: r47502
"
"34581f12e4402e9fa66fa66c3b927f4e0928dd47","2010-01-24 16:40:37+00:00","Cine: Document branches in executePlayerInput and remove dead code (if-clauses that are always true or always false).

svn-id: r47503
"
"45cbc7b265708129b77543c89555edcd28555ad7","2010-01-24 17:24:11+00:00","Fixed warning.

svn-id: r47504
"
"414eadfb2aec530b21f0773ed6657017b650876f","2010-01-24 17:46:37+00:00","Cine: executePlayerInput: Combine mouse handling plus a few other things.

- Combines mouse position and button state fetching
from two branches (allowPlayerInput / !allowPlayerInput)
into a single loop with a little more exotic while-clause.
NOTE! Added manageEvents-call into the unified version although
there was no manageEvents-call in one of the versions that was
combined. Tested a little and didn't seem to matter, but hopefully
won't cause any regressions!
- Limit first possible 'renderer->setCommand(commandBuffer)' call
to Future Wars only (Checked with FW & OS disassembly).
- Combined all cases of 'left and right mouse buttons are down'
into a single if-clause (All those cases call makeSystemMenu).

svn-id: r47505
"
"10da245619c520791430147ce0229824c53083cf","2010-01-24 17:52:27+00:00","SCI: Cleanup

svn-id: r47506
"
"40cb795fe7bee0576026fd45fe8abc29485b6dc1","2010-01-24 17:56:23+00:00","Cine: executePlayerInput: Name used keys in switch-clause (F1-F10, Ins, Del).

svn-id: r47507
"
"7ce227b6700b55c1bc343c82d26eb70aea0f0450","2010-01-24 18:20:22+00:00","Cine: executePlayerInput: Combine 'left mouse button is up, right mouse button is down'-cases into one code part.

Additionally:
- Operation Stealth specific: Make makeActionMenu() use canUseOnItemTable.
This would seem to be the correct way according to disassembly
(Although there is of course a possibility that I have overlooked
some part of the code).

svn-id: r47508
"
"650a9b9c49b63b46829dd073ad4092f2f23c6fca","2010-01-24 18:27:56+00:00","Cine: executePlayerInput: Fix 'left and right mouse buttons are up'-case for Operation Stealth.

svn-id: r47509
"
"865b176b15a6a84c403129e6eac87694ce4d6be0","2010-01-24 18:40:29+00:00","Cine: executePlayerInput: Fix 'No player command is given, left mouse button is down, right mouse button is up'-case for Operation Stealth.

svn-id: r47510
"
"e7e90061228b4a680fa0a15cdfca413636d22396","2010-01-24 18:57:23+00:00","SCI: Fix list control scrolling in Jones EGA and VGA.

svn-id: r47511
"
"d8cb07251efb68da38b3c20323dd07867b20405f","2010-01-24 18:58:57+00:00","Cine: executePlayerInput: Implement 'A player command is given, left mouse button is down, right mouse button is up'-case for Operation Stealth.

- Also changed a do-while -loop into a
while-loop as it should be for both
FW and OS according to disassembly.

svn-id: r47512
"
"f2882cc2df2483218dfb42466807f9573541aec0","2010-01-24 19:14:09+00:00","Cine: executePlayerInput: Implement moving using keyboard for Operation Stealth.

svn-id: r47513
"
"e51721f7b19849c52cc5e1c8e58c53f5ec96012d","2010-01-24 19:42:12+00:00","SCI: handle intensity calls for amiga the same way as we handle palette animation (abort instead of process)

svn-id: r47514
"
"c19afec75aa25474561aad2ed3854356867d181e","2010-01-24 19:47:53+00:00","Cine: executePlayerInput: Add makeActionMenu-part to keyboard handling and a couple of TODOs for Operation Stealth.

- NOTE: This doesn't seem to work correctly yet.
My current guess is that it has to do with how
some keyboard events are handled in cine/main_loop.cpp's
processEvent-function and some in cine/various.cpp's
executePlayerInput.

svn-id: r47515
"
"ab730891ad254394842f603e26e3b8127fc4406e","2010-01-24 19:52:11+00:00","Cine: executePlayerInput: Revert r33872 as things should work without it now.

With the latest changes to executePlayerInput we
should now be able to free the girl at the bottom of the
ocean without the r33872.

The commit log from r33872 was:

'Fix for bugging moving at the bottom of the ocean when trying to free the girl from the ropes and swimming to the surface. Some global variables related to mouse position weren't being updated in executePlayerInput, now they are and things seem to work. Also enables moving in the labyrinth arcade sequence at the palace.'

svn-id: r47516
"
"bd7b9400a695e7b7f2fc698eb117a16c2821cb2a","2010-01-24 19:57:23+00:00","Cine: executePlayerInput: Add TODO about investigating why some buttons don't work currently.

svn-id: r47517
"
"710dd335920ec10187b3af339c502dab89262412","2010-01-24 20:16:16+00:00","Cine: executePlayerInput: Fix broken Y-movement in Operation Stealth (D'oh! Copy-pasted X to where Y was meant :-P).

- Hopefully NOW things should work without r33872!

svn-id: r47518
"
"69e6b2a27a6b359031eb0bd15a494b2474348273","2010-01-24 20:23:09+00:00","Cine: executePlayerInput: Operation Stealth: Fix target object name not disappearing when passing over an empty area with a verb already chosen.

svn-id: r47519
"
"b4ecf7f0e1f4fef6048d2d31e32b56376ca8d328","2010-01-24 20:31:01+00:00","SCI: self drawn stuff on amiga uses ega palette, we need to match it onto currently used amiga palette (fixes user interface colors for amiga sci1 games)

svn-id: r47520
"
"029154ab3ae1ba1954b3f3dc2962265f1878690a","2010-01-24 20:38:56+00:00","SCI: fixing amiga mapping for colors 0 and 15, those are hardcoded like everywhere else

svn-id: r47521
"
"2ef784858656f20ca50565f9edf7627ffb75648c","2010-01-24 20:47:35+00:00","SCI: changing white to be 255 for amiga all the time (works for our interpreter) - fixes mouse cursor on amiga sci1 games

svn-id: r47522
"
"75816d4ca16512932e130b0d67d3a185c97334f1","2010-01-24 20:51:34+00:00","SCI: added comment about using color 255 all the time for amiga games

svn-id: r47523
"
"44827b340fdf5f6ba1e22db35bdbe40cd1225e87","2010-01-24 21:01:21+00:00","SCI: changed amiga palette mapping table to map color 15 (white) again, scripts dont like it to be 255 :P

svn-id: r47524
"
"a1daf54425a6311f8c9837a95a63c7ba73604278","2010-01-24 21:11:26+00:00","SCI: never set palette for amiga games (fixes kq5 palette corruption at the beginning)

svn-id: r47525
"
"9d1dc48a6e39b69cadf332cfd7fbe832a6c2da14","2010-01-24 21:24:07+00:00","SCI: removed oldMenuId check for BitsShow in menu (was done for keyboard interaction) - using mouse its possible to leave the menu which would now result in inverted menu topic not displayed - fixed

svn-id: r47526
"
"afcfa58f5946323bd2fd8db7be79433258b4aa2c","2010-01-24 21:46:30+00:00","SCI: skip over amiga palette inside pictures for now, needs implementation (TODO added)

svn-id: r47527
"
"5903acf66cfadd1daf1af8712057f071615d0392","2010-01-24 23:39:27+00:00","Fill in the unknown values of the ADPC chunk in Mohawk sounds and update comments.

svn-id: r47528
"
"1a6573ab66d90bab9d3f73f26414a0aee05353bd","2010-01-24 23:50:22+00:00","Correct title.

svn-id: r47529
"
"69071078b331f91e16827f8a29d221b6a9c732e3","2010-01-25 00:13:32+00:00","Replace some more Adlib uses by AdLib.

svn-id: r47530
"
"c48076ea9c9eaa55413daead112a2489650da12d","2010-01-25 00:14:05+00:00","Use 'No AdLib' instead of 'No Adlib' in SCUMM's detection tables too.

svn-id: r47531
"
"bfcdbae648d3eeee4a93bb4fb55fef8b6a326bdb","2010-01-25 00:39:46+00:00","Change some comments to use 'AdLib' instead of 'adlib'.

svn-id: r47534
"
"8c28155848042bfdece32c02a91bc545c08f1da2","2010-01-25 00:45:52+00:00","Fix gcc warnings.

svn-id: r47535
"
"ec14cd6e6add76ce4f719edd7ce508d67ebd9f14","2010-01-25 01:27:14+00:00","Formatting.

svn-id: r47540
"
"aed02365ec81e77b3c8aa4f4ecd9a9d3893326f2","2010-01-25 01:39:44+00:00","Strip trailing spaces/tabs.

svn-id: r47541
"
"709bf1214c9abcdac7dcd4ebac01705e27766918","2010-01-25 01:53:32+00:00","Strip trailing whitespaces/tabs in documentation files too.

svn-id: r47543
"
"64491356b83ce16ac93c11706895d06ad408e16e","2010-01-25 02:08:28+00:00","Fix virtual-keyboard not changing size, when the user changes the scaler while it is not visible.

svn-id: r47544
"
"352841717ff6aca8b4cff0a65fb12991567cfb8e","2010-01-25 02:37:10+00:00","Mention support for Amiga menus in CinE.

svn-id: r47545
"
"98fb67ed200f6adbe53b77f4ede95b3811dbd6c4","2010-01-25 02:48:35+00:00","- Remove '(experimental)' mark from DOSBox OPL emulator description in GUI
- Merge in some small OPL emulator changes from DOSBox's trunk

svn-id: r47546
"
"dfe32f2f576b39a4b8166c382cd81016f1e3da3b","2010-01-25 03:04:58+00:00","g_engine is not used by any MidiDriver, thus remove the comment about it.

svn-id: r47547
"
"2eb16caade37b77928da2df73c5a86a055639c9d","2010-01-25 03:05:39+00:00","Remove HACK, which is obsolete because of r47336.

svn-id: r47548
"
"356bebc7b002a222c6450a4f613858a5aaf173fe","2010-01-25 08:56:50+00:00","Turn off ARM asm for Costume until its fixed

svn-id: r47549
"
"b0cab96cd0d49608d964215af001b40af12edc96","2010-01-25 08:59:47+00:00","Change UI name of Scumm Apps. Enable all engine in perl script

svn-id: r47550
"
"8d12d846098797df7904e9d128a14d3c05942d83","2010-01-25 10:17:55+00:00","SCI: support for both amiga 'palettes' (one is a left-over VGA palette, the other one is a real palette, no idea whats in there cause its just 32 bytes instead of 64 bytes)

svn-id: r47551
"
"9f1962d00681b0571c476d94b0c70b2151b27d7f","2010-01-25 11:15:40+00:00","SCI: support for amiga pictures that change the palette

svn-id: r47552
"
"e7e0810c9c93c14cbf861cf2c3e531126cb411df","2010-01-25 11:26:32+00:00","SCI: changed comment about amiga palette inside picture class (removed TODO as well)

svn-id: r47553
"
"5fa07183567ec91f0e3e220f296f23822b698c4a","2010-01-25 12:34:40+00:00","SCI: created isAmiga32color(), using this method instead of comparing against viewType

svn-id: r47554
"
"6bd6bc4bad3c449469ef4a9d3444c449db553380","2010-01-25 17:09:31+00:00","SCI: fixing skipping over dummy VGA palettes in amiga games

svn-id: r47555
"
"a28ac2881a8fc269ea200dc779d0420fbb4b5308","2010-01-25 17:21:55+00:00","Hopefully fix highlight background color in PC versions of CinE games.

svn-id: r47556
"
"dfafec64869f21924da3d8edd5796b397728fb98","2010-01-25 17:30:59+00:00","Fixed kSetCursor semantics detection for KQ5 Amiga, by making a hack for KQ5 CD specific to that version only

svn-id: r47557
"
"157a1df30d270b5bcc8a264fec0acd1e71fd7d4a","2010-01-25 17:59:05+00:00","Fix sample buffer calculation. Now it really asks for a buffer of 2048 samples for 22050Hz, like the comment states.

svn-id: r47558
"
"3b7af74af4f178e48b105a47841b4f86d9257e7c","2010-01-25 19:13:25+00:00","Fixed window port for Slater and Hoyle 3 (the top coordinate of the main window port is 0 like Jones, not 10 like in other games)

svn-id: r47559
"
"ba7eb790748fe455f3db269176666f52761a4a8e","2010-01-25 20:44:13+00:00","SCI: removed EGA mapping for amiga games, cause changing K_GRAPH_GET_COLORS_NR to support amiga also fixes it - also fixes other odd issues like the ones in kq5 and castle of dr. brain/sq1 (thx. to waltervn for finding this out)

svn-id: r47560
"
"fd5e26806e29e44a16d7ef443921f5765dcb11e1","2010-01-25 20:46:09+00:00","SCI: dont fix line color for amiga 32 color

svn-id: r47561
"
"326d64d07d528ce630698583b7f2fcb3db76e05d","2010-01-26 08:31:27+00:00","Let's Explore the Jungle with Buzzy uses VAR_PLATFORM variabletoo, but with different values.

svn-id: r47562
"
"e0293562de220544662f1cd0b39dba1f3dbe8732","2010-01-26 11:25:15+00:00","Ignore kUnload calls which are not made with less than 2 parameters. Apparently, according to the FreeSCI bugs list, SQ1 calls it with 1 parameter when exiting the Ulence flats bar

svn-id: r47563
"
"d154b9f008d860f2a04b88c248d6cd8ab55f092b","2010-01-26 11:28:11+00:00","Wording - we ignore calls to kUnload with less than 2 parameters

svn-id: r47564
"
"87ff1c7b7eba9aa0f599b00a280279018bdbf5ce","2010-01-26 11:40:54+00:00","SCI: removing now unneeded table EGAtable from palette class

svn-id: r47565
"
"31a3c98fa26e59e5cf9254efeb6e5711ee674aa7","2010-01-26 13:06:21+00:00","Removed the unnecessary fadeVolume variable

svn-id: r47566
"
"8c2daeb03d41232f3bb90728a65b2398b53f76c3","2010-01-26 13:44:27+00:00","SCI: Added comment about PQ:SWAT original release (has the same MD5s as the pq collection release although version is 1.000)

svn-id: r47567
"
"36c2243c4880524a3fb97a10f68ee08fceaaab0b","2010-01-26 15:22:04+00:00","SCI: also test for mapVersion == sci32 for setting viewtype to kViewVga11 - fixes kq7

svn-id: r47568
"
"0f7690206826cfbbd8a2c6c30695a764475bc2aa","2010-01-26 15:39:23+00:00","Mention that the signature of kUnload has been set like this because of the SQ1 bug

svn-id: r47569
"
"d6bb432a92c3600a5201217316aa7ed0321c898c","2010-01-26 15:41:24+00:00","Disable all detection entries for SCI3 games - they use a different script format (in .CSC files), and are currently totally unsupported

svn-id: r47570
"
"9861b04b935b84424b5b7950a2398dbfb44a99f9","2010-01-26 19:25:33+00:00","SCI: Add driver for Yamaha FB-01. Cleanup.

svn-id: r47571
"
"473d8b7c2fb8fccdf7716308a5faced5e6259566","2010-01-26 19:51:08+00:00","SCI: Add string support for odd-offset pointers into reg_t-based segments.

svn-id: r47572
"
"545e221d417346644f52cae35d412b40c4967f2b","2010-01-26 20:40:25+00:00","Added information about all the vocabularies used in SCI

svn-id: r47573
"
"f8a83cd61d4609be9b392e0ee7d7d71a489ebebd","2010-01-26 21:12:13+00:00","SCI: dont do real merging of palettes for sci1.1+, fixes sq5 wilco face, wilco blue thingie in the background of intro, island of dr. brain, sq4 white pixels in background and more

svn-id: r47574
"
"d5724a2eda6888a37534b5c14c92bcbf84a815a1","2010-01-26 21:27:13+00:00","Fixed reading of options file (game.opt) for Hoyle 3

svn-id: r47575
"
"46a05ce3326598e9b6b2de7465b17a98efcec2d5","2010-01-26 22:04:33+00:00","Fixed loading of old saved games

svn-id: r47576
"
"935ded3615bda21dc7e100b0e1f4b40793c518d4","2010-01-26 22:34:17+00:00","SCI: force palette merging for kq6 hires portraits (cause its needed on those)

svn-id: r47577
"
"e0d05a482ce93e029888ef388dfb1b90b438f2ee","2010-01-26 22:45:52+00:00","SCI: changed flags (uint16) to force (bool) for set/merge palette methods

svn-id: r47578
"
"1565f14bc13a63aee6a42cc4fac3fe7fa39eda44","2010-01-26 22:48:45+00:00","Moved audio stream implementations (for MP3, FLAC, etc.) to new dir sound/decoders/

svn-id: r47579
"
"ff783e4bb78f8442896e3f08a1b4234a6b89b9d7","2010-01-26 22:51:40+00:00","AGOS: Turn BaseSound into a subclass of Common::NonCopyable

svn-id: r47581
"
"77fe0215cd447ff55279b0b1feaf6b838d2dd71f","2010-01-26 22:52:08+00:00","Remove outdated comments

svn-id: r47582
"
"d4f08cbe818f2a7d80df10b468b30cc61975b422","2010-01-26 23:05:52+00:00","Correct our interpretation of the first four bytes of the RSRC section in Mohawk archives.

svn-id: r47583
"
"7c0dcf108cf3327525507b7784dbc725bd02b059","2010-01-27 01:47:41+00:00","SCI: Add pointer comparison support to signed comparison operators.

svn-id: r47585
"
"3f7b6f9472aa288f26500a049b95e6562c042485","2010-01-27 03:37:56+00:00","SCI: Restore pointer checks removed in r47585.

svn-id: r47587
"
"eabbe89971d420bcd9a464fb08f3daef20a910f8","2010-01-27 04:26:28+00:00","Improve support for the SCI2.1/SCI3 file naming scheme. Multiple maps can be used and have to be matched up with their volume counterparts. Adding detection for the Phantasmagoria Demo too.

svn-id: r47588
"
"0717491b5b4a4fd8de15445562f51fe20fe03eb6","2010-01-27 04:48:50+00:00","Downgrade the 'attempt to use invalid/unused file handle' error to a warning. This fixes the GK2 demo which now is playable and the slideshow is viewable. The GK2 demo scripts attempt to open the VERSION file which does not exist.

svn-id: r47589
"
"9f2a619c06851429e261264c7f4b18a75cd4d7fd","2010-01-27 05:10:38+00:00","SCI2.1 and onwards uses the 'new' DPCM8 which differs only by order. This fixes sound in the GK2 demo slideshow. Also, fix a logic bug with endianness in the DPCM decoders.

svn-id: r47590
"
"812603e29eef2bd0c224a9b3b4c2bf29b2d3b653","2010-01-27 08:08:33+00:00","Fix invalid sample position on Timestamp to sample conversion for Stereo streams.

svn-id: r47591
"
"8606982590bb3c124cc4d17fbe15aa722803201e","2010-01-27 08:40:48+00:00","Moved the Shorten decoder inside the SAGA engine, as it's the only one using it (and it's still unfinished, too)

svn-id: r47592
"
"7e1051d8ec24615089a88f632e3f865b37283cbe","2010-01-27 08:41:08+00:00","Fix seeking in FLAC implementation (FLAC's API uses the number of sample pairs, not the number of samples).

svn-id: r47593
"
"f27c8284a57bf77aa96a2950f5695d81a15b8bdc","2010-01-27 11:18:05+00:00","SCI: scaling for non-regular cels, scaling for reanimate (fixes pharkas demo, fixes lb2 cd credit windows)

svn-id: r47594
"
"b24be4f52620d01fd2928d8afddd9fe884b392ed","2010-01-27 12:13:39+00:00","Added support of the subtraction of two pointers, when they got the same segment. This operation will yield a number, like in C, and it's used by script 385 in Castle of Dr. Brain (the hangman script). Fixes exiting room 360 (the puzzle room) in Castle of Dr. Brain

svn-id: r47595
"
"0b4b3da4e4bf516e46d7bc43d2cf60569559993a","2010-01-27 12:20:01+00:00","Fix sound regression in HE games.

svn-id: r47596
"
"ed199f38b4fa2fd69077341f41609b4a84aa9ade","2010-01-27 13:14:28+00:00","SCI: Experimental fix for Longbow outlook crash.
When using a pointer in number arithmetic, substitute a large value instead
of 0 (cf. Hoyle hack in kAbs).

svn-id: r47597
"
"ef313aee02a0b1c289810bb9dda61ca587202f88","2010-01-27 14:08:06+00:00","Fixed comment about vocabulary, so that it doesn't refer to the line below it

svn-id: r47598
"
"ae7696e5f19555178056109514defaf27f49938e","2010-01-27 14:10:19+00:00","Oops.... actually close the defgroup :)

svn-id: r47599
"
"0f0e123e5ab5bb49cc6842800edf96b527128710","2010-01-27 15:06:47+00:00","Turned the asserts about the unknown sound field into a warning

svn-id: r47600
"
"1ddcd178c206889f051bc07ae7fd8d4ef9368233","2010-01-27 16:04:46+00:00","The two unknown fields point to the beginning and end of the sound sample

svn-id: r47601
"
"12569a5f325b2cdbcf3d696329a105ef5b94fd8a","2010-01-27 16:54:58+00:00","Only reshow the cursor after playing a video if it was originally showing beforehand. This fixes the GK1 demo menu.

svn-id: r47602
"
"9471e66940361e36cac8c266ab6c99a4e6d83a1f","2010-01-27 16:59:20+00:00","Don't patch audio36 resources, when the associated patches are for audio resources (e.g. the sound effects in LB2CD)

svn-id: r47603
"
"8ff7efea81d5d72c5d6358ca11c414bd7dfbed83","2010-01-27 17:31:11+00:00","Do not try and patch files for resource types greater or equal to audio36 (i.e. audio36, sync36 etc), as these won't work with the current patch scheme

svn-id: r47604
"
"a45af3457a3bdd75151d7219dc2e43bda8e708d1","2010-01-27 18:11:49+00:00","SCI: removing duplicate comment line that isnt right there (it documents the other view format)

svn-id: r47605
"
"155660c44370adcefeb994b9f0588730210202af","2010-01-27 19:28:13+00:00","SCI: changed the pharkas workaround to also cover pharkas-floppy demo

svn-id: r47606
"
"f376572ed825ab55666a02aa300c3674ca65eec5","2010-01-27 20:03:45+00:00","SCI: renamed exit console command to quit, so that systemwide 'exit' works (exits console instead of quitting game)

svn-id: r47607
"
"00413a0b04a461ac3a0356617e01be60ce697a92","2010-01-27 20:06:07+00:00","SCI: also change exit to quit in help

svn-id: r47608
"
"e81ddfcdccffa431532d5e6d604d49084dd212b4","2010-01-27 20:55:35+00:00","Removing obsolete comment

svn-id: r47609
"
"76ff84a62fcbec28b58ab14a157ec9fc74dd05d6","2010-01-27 21:11:24+00:00","Fixed the demo version of Longbow - speech was not played at all with the new sound code

svn-id: r47610
"
"90712388f88ea6279ddb9bad668335c4bbc2f60c","2010-01-27 21:33:51+00:00","SCI: added workaround for laura bow 2 game menu (same issue as in pharkas)...sigh

svn-id: r47611
"
"898135b7d0642fd3464b734f9b21d083d90bc983","2010-01-27 21:43:23+00:00","SearchMan.listMatchingMembers does not return files in alphabetical order, so we can't rely on the order of the lists. Rework the SCI2.1+ loading code to iterate through both lists in nested loops to fix multi-archive SCI2.1 games (such as GK2).

svn-id: r47612
"
"dfae4f7e99972a26a4ab8ffcc3958c935216b612","2010-01-27 22:53:09+00:00","SCI: fix for clipping code inside kGraph

svn-id: r47613
"
"34346bfd330b992f96084fe712d955a6091a8ed7","2010-01-27 22:55:30+00:00","SCI: fix view detection for sci1.1 pq4demo

svn-id: r47614
"
"08006eef1e2edf51c2c4c035d5708cf6968ddd9d","2010-01-27 22:56:00+00:00","Made the code inside SciGui::display() a bit more readable

svn-id: r47615
"
"705910f1221e707e2f7e9815277c8b1d8aca9aae","2010-01-27 23:39:16+00:00","- Fixed openWin, saveWin, restoreWin, closeWin, winMove and activeWin, so that windows are AT LEAST working
- Suppressed dirty traces. This has to be reviewed/rewritten. It looks better without.
- Add initialization of two variables in one exceptional case in winDraw. (Thanks Cyx)

svn-id: r47616
"
"2974ead245ab0d1fbe1d190ad59def806f5a6f1d","2010-01-27 23:43:23+00:00","Corrected assert inside load_script. Fixes loading in SQ4CD

svn-id: r47617
"
"f81735fffc54aff390a5737da0c60debf5c59286","2010-01-28 00:15:53+00:00","Fix regression in Let's Explore the Jungle with Buzzy.

svn-id: r47619
"
"ca7d670b4b701022d9f748bcc43d9dbf39f18984","2010-01-28 00:24:02+00:00","Fix regression in Let's Explore the Jungle with Buzzy.

svn-id: r47621
"
"0702bdab820ee6099011868009112b1a79b9deee","2010-01-28 00:28:08+00:00","Fix regressions in Let's Explore the Jungle with Buzzy.

svn-id: r47622
"
"da7d221d4028e1b8c652c77d00eeb74a9576226d","2010-01-28 01:45:20+00:00","Introduced a new console command, diskdump, which is able to dump files from resource files to disk

svn-id: r47623
"
"75ae56b0d41533a5769d26187f1d9220a3febd51","2010-01-28 02:15:15+00:00","Improved kSetCursor() semantics detection

svn-id: r47624
"
"33780aa3a5c82b9af32712b667bf39e299262636","2010-01-28 02:16:20+00:00","Fixed the demos of LSL1 and LSL5

svn-id: r47625
"
"9a85b1284b088b6a07afcc848f66be361025ed8d","2010-01-28 05:20:52+00:00","Silenced some more cppcheck style warnings.

svn-id: r47628
"
"1e6123ce89e306249f2c80d7afc13418dea70c37","2010-01-28 08:17:46+00:00","Improved the diskdump command so that it also writes the resource header, if it exists (e.g. in SOL audio files)

svn-id: r47630
"
"6fd8f7c0155f54af4a85c6a0e9d7b5bdf0fd71af","2010-01-28 08:23:40+00:00","Always try and load the associated digital track if the requested MIDI track couldn't be found

svn-id: r47631
"
"23f9891749b0f4ab736dd49109a79bf495b0cc58","2010-01-28 09:15:58+00:00","Fix MP3 playback speed.

svn-id: r47632
"
"f85c77d63ea85d62cb5bbf55fe71dd9c42e6924b","2010-01-28 09:37:50+00:00","Fix warning when using -Wuninitialized

svn-id: r47633
"
"1c906a1f08f9d1f316c2efd65a347c00e07bc469","2010-01-28 09:38:21+00:00","Hide VagStream implementation, only expose it via a factory method

svn-id: r47634
"
"0417c0ab888fcf674ea1a1138ce7a555a67c796d","2010-01-28 09:44:21+00:00","Fix seek implementation of our Vorbis stream.

svn-id: r47635
"
"383019c518248649b8b06e3d633e8cebfa60d4f1","2010-01-28 09:49:54+00:00","- The list checks now throw more verbose warnings
- Some obvious list problems are now fixed automatically when found, after the relevant warnings are shown
- kDisposeList now clears all the nodes in the list
- Some cleanup

svn-id: r47636
"
"a408a025b6fcab92442a6a0baa49e8b61b3bdfcd","2010-01-28 10:04:54+00:00","Since we fix the list problems inside isSaneNodePointer(), don't abort processing of the list

svn-id: r47637
"
"42c4316f98bd4b5042a058a0fbb2a20bb1f7398d","2010-01-28 10:08:54+00:00","Get rid of use of Audio::makeRawMemoryStream_OLD in SKY.

svn-id: r47638
"
"858eb1a283892d0dad25fad24546ceab4a9b7269","2010-01-28 10:31:37+00:00","Don't attempt to pause/resume sounds when the debug console opens if the sound subsystem hasn't been initialized yet

svn-id: r47639
"
"3f4ef3aff84c3aad0f8e0fd2336befe748ee155a","2010-01-28 10:34:11+00:00","Removed a hack for the demo version of Torin's passage. It errors out because the static selector vocabulary for SCI2+ games isn't implemented yet

svn-id: r47640
"
"0b987fe0668e24c9c608c9c77763bb3d8a6e98fa","2010-01-28 11:19:27+00:00","Added support for the SCI2.1 resource patches (resmap.pat and ressci.pat). GK2 goes a bit further now (but still dies because of a new script opcode)

svn-id: r47641
"
"104cc92d6be9928b252f65c7636109a001e3e0b1","2010-01-28 13:07:47+00:00","Changed run_vm() to use the sci_opcodes enum, and fixed several wrong opcodes inside that enum

svn-id: r47642
"
"1ceaf349486a76908f9336ceef517790967b13ed","2010-01-28 15:01:28+00:00","Handle calls to NewNode() with just one parameter.
Takes care of Phantasmagoria, Torin, etc.

svn-id: r47643
"
"8ecd76e415acfba94df2bcf6503b3db60f41ba0d","2010-01-28 16:30:46+00:00","SCI: process robot files again (i need those for REing)

svn-id: r47644
"
"d883b6215fe2af48bb7b643de57170f62a82c51f","2010-01-28 18:57:31+00:00","Detect whether to use the modified SCI2 or SCI2.1 kernel table based on the kDoSound call used in Sound::play(), which fixes at least my version of KQ7 - probably others. The kernel table initialization now occurs after the script signatures are adjusted as we need it adjusted before checking through Sound::play for the kDoSound call.

svn-id: r47645
"
"31728b32caaa9c574cd472c2b828b383ab45d42f","2010-01-28 19:22:58+00:00","SCI: Add debug opcodes

svn-id: r47646
"
"f7692e724f264312fb0a8ccc2d82197874fb79cc","2010-01-28 19:28:56+00:00","SCI: some progress on REing robot files (99% comments only)

svn-id: r47647
"
"493350e905a7840aa2a1076b17d18d7156379517","2010-01-28 19:57:14+00:00","SCI2.1: Added a dummy function for kRobot (with some info on its parameters), assigned IsOnMe to OnMe (needs verification, but seems to be correct) and changed kSave(8) to return nonzero. The menu of the Phantasmagoria demo is now shown, together with its creepy music :)

svn-id: r47648
"
"639fb4c3897f5d7c191ed084475549d6065cc18b","2010-01-28 20:29:45+00:00","SCI: Cleanup

svn-id: r47649
"
"3c46bc33aae7783361882e85cb0cb3653af3ede8","2010-01-28 20:53:33+00:00","Disabled the automatic list fixing feature, introduced in rev. #47636 (there's no point in fixing lists created by game scripts)

svn-id: r47650
"
"9e511e0751f0324bc424b75e02d25a3a3a095053","2010-01-28 21:01:57+00:00","SCI: detecting hires for SCI2+ games, qfg4cd is sci2.1 but still 320x200

svn-id: r47651
"
"347a97460913930d9a4e638b085bfbc5755e10e3","2010-01-28 21:05:10+00:00","Add some paranaoia assert (and a related TODO) to the MSIMA2 implementation.

svn-id: r47652
"
"a83fca1430c15dcbe29a897fac55d9c48aa93eb1","2010-01-28 21:05:42+00:00","kDisposeList() is not needed according to waltervn, as the garbage collector automatically clears unused objects

svn-id: r47653
"
"e85e0458512547969ebfbf211aa49b0b75b69223","2010-01-28 21:12:39+00:00","SCI: removed obsolete SCI2 upscaledHires

svn-id: r47654
"
"8653f62b15c53ff46d1cf4b40ac2579ce269775d","2010-01-28 21:24:28+00:00","SCI: added todo for upscaled hires on sci2

svn-id: r47655
"
"81a0d7d20def7b0383ebf1819dc41d6e37b35c06","2010-01-28 21:53:07+00:00","SCI: changing to upscaled hires for gk1 and kq6 when being on platform windows, added comment explaining the situation about gk1/dos

svn-id: r47656
"
"a35e1a2100fc7ebbfb2de2005feb51ee3a516316","2010-01-28 21:59:05+00:00","SCI: removed upscaled hires switch for sci2.1+ games (not needed anymore), added #ifdef SCI32 for gk1 upscaled hires switch

svn-id: r47657
"
"b20ccaa8abd2c2e0f7424dd469428c2fe8701339","2010-01-28 22:26:13+00:00","Corrected the map number for the GK2 resource patch files, and added some preliminary non-working code for the hires content in GK1

svn-id: r47658
"
"e110b028959961df13f9e0156909cba8fb59c99a","2010-01-28 22:58:09+00:00","Added some more information on the errors thrown by lookupString() and freeString() - Torin full currently crashes in lookupString, called from kString (strcpy)

svn-id: r47659
"
"39ebb168a1e891e89559f40e039ac3f7a779bad1","2010-01-28 23:11:55+00:00","SCI: Make SQ6 sound work. The meaning of these extra parameters is not yet understood.

svn-id: r47660
"
"981252b1fefacd9837001748e6701f4ccce109ec","2010-01-29 00:03:10+00:00","SCI: view class fix for hires views that are larger than 64k (fixes kq7 cel corruption)

svn-id: r47661
"
"5ffba8631dfba4bfb35b39a476911701b7d1034d","2010-01-29 01:09:41+00:00","SCI: Fix out-of-bounds error in MT-32 patch reading in GM mode.

svn-id: r47662
"
"52ef12547feee896c632b842f5aebbdcc9c84bd8","2010-01-29 01:31:05+00:00","SCI: Added OnStartup debug flag to start the debugger at the start of the game.

svn-id: r47663
"
"4ffec28103972992482dbb552d7f302ea09c1a31","2010-01-29 11:03:54+00:00","SCI: Move selector stuff to new header; reorder k_argc & k_argp param of invoke_selector

svn-id: r47665
"
"b124a0c1cddf2b3de9b8357752b9a44b14c1f5c1","2010-01-29 11:05:06+00:00","SCI: Reduce header interdependencies a bit

svn-id: r47666
"
"caeafb29ffa0d45998dfafa7e8d431636f1dab60","2010-01-29 13:48:02+00:00","SCI: little hack so that old views are erased in sci32

svn-id: r47667
"
"1bcbd71c976b1a1159c2a44ec9cdc41acfb6791c","2010-01-29 14:05:21+00:00","SCI: hacked up a bit sci32 graphics to support (theoretically) scaling

svn-id: r47668
"
"b374478cd0b85a05db7a52d9ce9e50a5fcc2c82f","2010-01-29 14:57:18+00:00","Added static selectors for SCI2-SCI2.1 games (fixes the demo of Torin's Passage)

svn-id: r47669
"
"f7a72c897a9657320ccd6a32873b364f77412e98","2010-01-29 15:07:20+00:00","Add duplicate entries of GK1 CD with the Windows platform set so that setting the platform to Windows won't appear as a missing entry.

svn-id: r47670
"
"01fd01122a3e4b018079d5d5dd0228b56f5701f5","2010-01-29 15:46:22+00:00","SCI: fixing cursor in sci32 for clone ;)

svn-id: r47671
"
"69b7497cf73018868aac5c64d434f08e1f2d9116","2010-01-29 16:20:22+00:00","SCI: calculating celRect the right way for sci32

svn-id: r47672
"
"233f81c5e1946a49da240a44b510a8b0710f4aad","2010-01-29 16:25:18+00:00","Added support for the hires graphic resources of the Windows version of GK1

svn-id: r47673
"
"266ff9934d223439a53175b4acb1f4acbb11a747","2010-01-29 16:26:40+00:00","SCI: removing bit 1 support (was introduced because of problems in sci1.1 games, isnt valid anymore), fixes kq5cd

svn-id: r47674
"
"be293572d2ba066574ce16449e783c60c386943b","2010-01-29 17:45:30+00:00","Don't modify the objects of sound slots that are already stopped, as the associated objects could have been disposed. Fixes odd crashes in SQ3

svn-id: r47675
"
"ddda7d12bde4ed88916fc077e049cf43394afa31","2010-01-29 17:47:17+00:00","Wording

svn-id: r47676
"
"31319de828b06dca82a7e878404663a5cb1fe4b4","2010-01-29 18:30:19+00:00","Always prefer MIDI drivers over the other ones

svn-id: r47677
"
"85517515a76069d77fde6ecfb933f2e133b52a01","2010-01-29 19:02:13+00:00","Reverting incorrect rev. 47675. The actual problem was that SCI0 doesn't clear a song's handle when stopping it, but when disposing it. Hopefully, a lot of the SCI0 sound oddities are fixed now...

svn-id: r47678
"
"a800855bf4799de2025f6f1220dc363e66aab475","2010-01-29 21:30:46+00:00","SCI: added new SciGui32 class, Gfx class needs some work though and hopefully i didnt overlook some kernel function that is also used by sci32. now using plane left/top

svn-id: r47679
"
"1bc1ff1705dd446538fb45744d3134ee35486e04","2010-01-29 21:34:59+00:00","Silence gcc warnings, have gui32.cpp only build when ENABLE_SCI32 is defined.

svn-id: r47680
"
"c6e095715c8901799aa384d2076742a2bd2e00f6","2010-01-29 21:51:21+00:00","SCI: adding shakeScreen() for gui32 for lsl6

svn-id: r47681
"
"5b9b6b6b7087555723665b0e243de1a9f2d5b018","2010-01-29 22:02:28+00:00","Fix compile when ENABLE_SCI32 is not set.

svn-id: r47682
"
"0e8b8f19624f4586f7b967993bcd8244faadc3a6","2010-01-29 22:17:27+00:00","SCI: uge? and ult? opcodes now work correctly when comparing pointers with 1000.

svn-id: r47683
"
"027b44673a62da07ca5cf913f93b86261d10f3bb","2010-01-29 22:29:03+00:00","Document my last change

svn-id: r47684
"
"595a2e16f15ce73fe7c7ae0a31f33ca760356ff0","2010-01-29 22:43:23+00:00","Fix use of undefined behavior. (Thanks to syke for reporting)

svn-id: r47685
"
"67035764524d98d3f528c75217db5db231fa788e","2010-01-29 22:51:22+00:00","SCI: Partly revert r47597, as it is superseded by r47683.

svn-id: r47686
"
"99f59d858e89c2cf7d5f96c919b2793b167c3099","2010-01-29 22:56:39+00:00","_gui and _gui32 are now properly initialized

svn-id: r47687
"
"8977c1a4aa64b3ce8f527969c01c9e8bd695fd9e","2010-01-29 23:08:12+00:00","Disabled the MIDI volume changing code till we figure out why it's getting volume values greater than 127

svn-id: r47688
"
"8e69a2478381b5b0f000de04e5d9f9cdf2cb34d4","2010-01-29 23:52:58+00:00","Fix yet another use of possibly undefined behavior reported by syke.

svn-id: r47689
"
"694d30eb31f1c1a45168178cc7ee69d97df43057","2010-01-29 23:59:50+00:00","Don't cripple setVolume(), but throw a warning when receiving invalid volumes and correct them for now - fixes the music in GK1

svn-id: r47690
"
"c8501e2b266baa9963344163da91f8066380240d","2010-01-30 00:21:32+00:00","Implemented kString case 12 - it was really kFormat in disguise :)

svn-id: r47691
"
"49cfbbaffc923b50c8467b3f98d5fe434fddf590","2010-01-30 01:02:29+00:00","SCI: Hook up AvoidPath debug mode to pathfinding debug channel.

svn-id: r47692
"
"42ec4e37801b7724380437033c86180e79b9a67a","2010-01-30 01:14:25+00:00","Ignore kString(printBuf) calls with more parameters than 3 - a list is probably used

svn-id: r47693
"
"928b4a6df6cc24c57ce899c431a5d98da4325af8","2010-01-30 01:45:59+00:00","Added support for String types to kFormat (seems to work but needs testing...)

svn-id: r47694
"
"b01a793e550dcd7254de5cecfa6d05b25de82846","2010-01-30 01:46:54+00:00","Added a sanity check to baseSetter() - Torin's demo progresses a bit further now

svn-id: r47695
"
"da46fc9b35287237ad6f9336159703e605ef565c","2010-01-30 02:03:59+00:00","Add support for saving/loading Arrays/Strings in SCI32. It's possible to save a game in GK1 now via the console, but not load (yet).

svn-id: r47696
"
"bc64dfb52e09345b149071674db480aebe456a76","2010-01-30 02:40:15+00:00","Implement kString(Printf) and resizing of SCI32 strings in kFormat().

svn-id: r47697
"
"d82b01cee99fbfd3b0177894b2479c11fde707ee","2010-01-30 03:37:26+00:00","SCI: AvoidPath: Allow solitary screen-edge vertices in path.

svn-id: r47698
"
"2f68af90d5e793cb2d76ec748e515c58d961b3f7","2010-01-30 03:57:58+00:00","Add the SCI2.1 variant of kShowMovie; KQ7 now shows the opening video.

svn-id: r47699
"
"7dbd0fc181fabbe21896ece009f8d31445e13e46","2010-01-30 04:01:15+00:00","SCI: Apply fix from r47683 to u> and u<= as well. Fixes Longbow.

svn-id: r47700
"
"1bb011a3aad765910444f97f5c0e643693171a6a","2010-01-30 04:19:55+00:00","SCI: Removed old pathfinding code

svn-id: r47701
"
"6066c9baa28a2937b1d359b0b50d4bab77d1c664","2010-01-30 04:33:46+00:00","SCI: Removed old pathfinding define from sci.h

svn-id: r47702
"
"28aee9c5f3462cd72db0b91b7f578649869738d5","2010-01-30 07:11:38+00:00","Silenced a very annoying warning

svn-id: r47704
"
"3285a4ba4d585739577176baddd8f48478d2f229","2010-01-30 09:21:07+00:00","Beginnings of a separation of the MADS and M4 engines into separate classes. This will be cleaner then having checks everywhere for whether the game mode is MADS or M4.

svn-id: r47705
"
"9449585893e72156579707f0f377527c6253be5f","2010-01-30 11:17:08+00:00","Fix warning

svn-id: r47706
"
"06bd17ee712f06971273d526f389f9a352f3e8ec","2010-01-30 11:59:05+00:00","SCI: Remove extra '\n's in debugC messages

svn-id: r47707
"
"c02b14d311cd980b36560996dc4b48fec9f2d522","2010-01-30 12:53:08+00:00","N64: Better analog nub acceleration, and added -mhard-float in CXXFLAGS when building

svn-id: r47708
"
"bff00f002bf14db55d2c9b5dd53148ac3ab4ab8f","2010-01-30 12:57:57+00:00","N64: added comments and slight cleanup

svn-id: r47709
"
"068e0c3ae89b0d10a132640ab83ec52ec6f06a1d","2010-01-30 13:22:29+00:00","SCI: Fix build without SCI32 support (#2942682)

svn-id: r47710
"
"ce5f91c785c5e1aae3b3aab2f1075d6f30da7162","2010-01-30 13:35:41+00:00","SCI: Do not prefer MIDI drivers, as MT-32 to GM mapping is still lacking.

svn-id: r47711
"
"17cebab3549bac2ae57d0550d477c6cafbee70c5","2010-01-30 15:16:55+00:00","Change RawDiskStream to use a Common::List to store its blocks internally.

svn-id: r47712
"
"ec3f58e626a0645c21bc76fbc7cbd2a58eeee43e","2010-01-30 15:17:57+00:00","- Mark makeRawDiskStream factory as deprecated.
- Introduce two new makeRawStream factories, one is using RawStreamBlockList instead of an RawDiskStreamAudioBlock array.

svn-id: r47713
"
"523181d7193d829c86e5b255b47c35a4c28bca14","2010-01-30 15:18:25+00:00","Add a factory which plays audio from a buffer via RawDiskStream.

svn-id: r47714
"
"8e3646e062528d1604d28676fa2faec5c5ac878b","2010-01-30 15:19:15+00:00","Get rid of Audio::makeRawMemoryStream_OLD.

svn-id: r47715
"
"a505d32eff97e31ac73495e202f9c01f6490dcf8","2010-01-30 15:26:54+00:00","Replace use of Audio::makeRawMemoryStream by Audio::makeRawStream.

svn-id: r47716
"
"3cc0ef6c1cf5574168456e74736baf8f4e231af6","2010-01-30 15:28:07+00:00","Remove RawMemoryStream.

svn-id: r47717
"
"75ba7ee0f84d83175ea105de4ffc53256c5025be","2010-01-30 15:29:48+00:00","Rename RawDiskStream to RawAudioStream.

svn-id: r47718
"
"ef99a7243610961354f6120d3c9c531ff7881633","2010-01-30 15:30:53+00:00","Typo.

svn-id: r47719
"
"3125dfe66e7cad99f262eb05d26df05ca15c7a95","2010-01-30 15:37:20+00:00","Add some asserts to the RawAudioStream code.

svn-id: r47720
"
"5539f0d3589ed5a30a31c71f3b8f1f9e899c5369","2010-01-30 15:38:31+00:00","Add some TODO item.

svn-id: r47721
"
"f79b474ea756774d4b4de443fbee47b182869935","2010-01-30 18:15:17+00:00","Use SubLoopingAudioStream instead of makeLoopingAudioStream in SCUMM. (Incorrect replacement introduced with r47715, thanks to Max for spotting this).

svn-id: r47722
"
"a652b603c97fb31d6943645603a6d585bda166ad","2010-01-30 19:03:11+00:00","MOHAWK: Don't remove save_slot config entries the user may have added on purpose

svn-id: r47723
"
"d0bcf4d281f503f7a7d74d8595c85958b0f26bd3","2010-01-30 19:04:21+00:00","SCI: Mark scriptState as one of the many evil global vars in the SCI engine

svn-id: r47724
"
"4f4b559d1cf9ecabe7d395428e14518ee7ed664d","2010-01-30 19:06:24+00:00","SCI: Correct comments which talked about 'loading from GMM' when they really meant 'loading from launcher'

svn-id: r47725
"
"87856c545c5b46a0d6062cf4f953e7ee4e0e2d8e","2010-01-30 19:08:00+00:00","SCI: Don't mess with save_slot just to be able to decide whether we already honored a load request or not

svn-id: r47726
"
"676bebe2be5d7cd685feb29059997f2a4b4f4442","2010-01-30 19:23:00+00:00","- Call the special debug channels 'channels' consistently. (Formerly sometimes they were refered to as 'levels').
- Along with it add some more descriptive commentary about what is the intention behind debug channels.

svn-id: r47727
"
"3d1a43bc5486de8d65b72a5385719e370f159298","2010-01-30 23:03:07+00:00","Worked on separating scene logic into separate classes for M4 and MADS

svn-id: r47728
"
"4a4b69dbeb8656e9e1bef132afa1bb2c42c378a3","2010-01-30 23:40:29+00:00","Fixed loading of saved games

svn-id: r47729
"
"a7165c02c1bdd6a8b25fb573726240e8bcd021ec","2010-01-31 00:13:16+00:00","Removed the hack for kResourceTypeRobot patch files

svn-id: r47730
"
"5b7d4305502dd02af32182541f60e82a3c3d1b26","2010-01-31 00:14:23+00:00","Fixed endless looping in Longbow, when the after market GM patches are used

svn-id: r47731
"
"dc8ff8c9d4405d5762a90ec2c69c5e7293581bce","2010-01-31 00:42:47+00:00","Further work on separating the scene logic for MADS and M4

svn-id: r47732
"
"9c178c2d3a3dcce79f12f0b14ea13f4c9261fb94","2010-01-31 00:47:29+00:00","Formatting corrections to conform to ScummVM formatting guidelines

svn-id: r47733
"
"8b9cdd671f1bb613b9efef3fec5acd21fdc297ea","2010-01-31 01:15:05+00:00","Removed an unused parameter from _game_run()

svn-id: r47734
"
"7f4aa161bcb0f989fe2b343909fd855679901d3e","2010-01-31 01:26:06+00:00","Removed duplicate code. Some cleanup

svn-id: r47735
"
"21e1cc4cf8b79a9f59e911514c52831113356f7c","2010-01-31 02:11:41+00:00","Switch makeADPCMStream to DisposeAfterUse::Flag

svn-id: r47736
"
"17ec0a840255d53734bf216257606c2bc47dee1d","2010-01-31 02:12:33+00:00","Rename ADPCMInputStream to ADPCMStream; make some members const

svn-id: r47737
"
"f3322bb1c88f4017a1652ed402833d0a7325533d","2010-01-31 02:12:59+00:00","Split ADPCMStream into several classes

svn-id: r47738
"
"7f2f9a811743cabd8c07c9a0dc961140569c8071","2010-01-31 02:13:38+00:00","Rearrange code of ADPCMStream subclasses

svn-id: r47739
"
"20f8503c23e89a8db14a5cca9feef92bfc5079d2","2010-01-31 02:14:11+00:00","Further OOify the ADPCM code

svn-id: r47740
"
"f59f03967bb5ec222c75f5d5ce12a864113d8b92","2010-01-31 08:28:10+00:00","- Fixed saving from the GMM
- Grouped game IDs per SCI generation

svn-id: r47742
"
"044ddf02a030ade948776d22a8edee62a4c060a5","2010-01-31 10:02:38+00:00","Fix warning format arguments. (Passing a Common::String ins't that much of a good idea)

svn-id: r47743
"
"5278b82f33dd1083b99470bb8dcf941debb6b446","2010-01-31 10:22:09+00:00","Slight formatting fixes to comply to our coding guidelines.

svn-id: r47744
"
"7929255cd9723ebba451d5b9dd4d4597ed32e6a7","2010-01-31 12:35:15+00:00","SCI: cleaned up graphics classes, removed gfx&windowmgr, added gfxports, gfxcompare, gfxpaint16, gfxcache. kernel uses gfxports directly w/o going through SciGui

svn-id: r47745
"
"1169109773bfa35b3b2dc67d213308675093fee8","2010-01-31 12:44:51+00:00","SCI: added new modules to module.mk

svn-id: r47746
"
"c67ba0536d1aadb75e18207992e0ce3e88f58283","2010-01-31 12:46:55+00:00","SCI: forgot the cache :P

svn-id: r47747
"
"d6611ec7dcca72c52021dcbb5c37e107b16361de","2010-01-31 12:54:48+00:00","Sort order.

svn-id: r47748
"
"2185f6b1644eb8420afd4b9579828d5cc4838dc4","2010-01-31 13:05:46+00:00","Adding some sanity asserts

svn-id: r47749
"
"6248362c38b97c40f0a71544381397657a2b041f","2010-01-31 13:18:32+00:00","Properly deleting the TOT resource table again when loading failed

svn-id: r47750
"
"c991a5bcebd9c46070e41361855969bed9754e57","2010-01-31 15:07:36+00:00","SCI: renamed SciGuiAnimate to GfxAnimate, moved code from SciGui into this class, now getting called directly

svn-id: r47751
"
"72c2d360f748d5c9934db2edf3c672bac7b1e165","2010-01-31 16:21:11+00:00","SCI: renamed SciPalette to GfxPalette, Screen to GfxScreen, GfxPalette is now called directly w/o SciGui

svn-id: r47752
"
"7184fa3bade28876787422e280f5475e7b23575d","2010-01-31 16:26:15+00:00","SCI: renamed kernelFind() to kernelFindColor, so that it isnt that confusing :P

svn-id: r47753
"
"b21255509a65045aa7551bcacd62c0565513fa39","2010-01-31 16:29:02+00:00","SCI: remove classname from header to fix build

svn-id: r47754
"
"594d82e287acd177b84f0db65ed86080ea1bbc82","2010-01-31 16:32:11+00:00","Fix possible memory leaks.

svn-id: r47755
"
"af5b9b14ca7d0eb7e5bdc8ddd88180f31680b137","2010-01-31 16:49:22+00:00","SCI: changed the way font class is initialized

svn-id: r47756
"
"4bdae74b1091ed6f45b6dbdabd7a39392f879c77","2010-01-31 16:49:24+00:00","Formatting.

svn-id: r47757
"
"6a3308150fd401b25cb2cab1c8c494fbf3af1a12","2010-01-31 17:05:07+00:00","Yet another little formatting fix.

svn-id: r47758
"
"66c88b98f54fb750bebb038ef92636bcc906db55","2010-01-31 17:14:58+00:00","SCI: GfxCache is now also called directly w/o SciGui nor SciGui32

svn-id: r47759
"
"2cf1efac7827629cbbede10628a585b85dbb5cae","2010-01-31 17:19:17+00:00","Silence gcc warnings.

svn-id: r47760
"
"3b411f65767256f3d55fd361a253d06f6426654c","2010-01-31 17:30:58+00:00","Fix compile without ENABLE_SCI32 set.

svn-id: r47761
"
"aaf756e7364658bcde053932907bbf009e1762ab","2010-01-31 17:45:22+00:00","SCI: implemented font caching

svn-id: r47762
"
"5507cb6247c22ea4f8548dff8424d5757c1d8418","2010-01-31 17:57:07+00:00","Fascination - Partially fix the intro

svn-id: r47763
"
"299fb1a9cc893ee895b40a17a02dc82906cca558","2010-01-31 17:57:51+00:00","SCI: dont delete _font inside text class, its already deleted inside cache

svn-id: r47764
"
"699a525db4f932095bd5b2033b4293446e1e30cf","2010-01-31 18:01:49+00:00","SCI: removing unused DrawChar()/StdChar() from text class

svn-id: r47765
"
"3ed2192923a146ee4b3f0784396d8e5479d68778","2010-01-31 18:08:51+00:00","Prevent my compiler to crash and object copy hopefully it doesn't break something

svn-id: r47766
"
"8f8c85e7572350f68623f8e817f60bfffd05c624","2010-01-31 18:11:48+00:00","Removed obsolete code

svn-id: r47767
"
"30bd160ad9964dade270b81c1890dacbd98467ae","2010-01-31 18:14:19+00:00","SCI: added additional decimal output for 'vo' command

svn-id: r47768
"
"a13af0270baeb63ba164e0b19f671aa226a84910","2010-01-31 18:14:20+00:00","Updated so that code compiles again

svn-id: r47769
"
"3dd46d50f53e05548156d6abe43eeb025c4ed82f","2010-01-31 18:24:49+00:00","Slight fixes to comply with our coding guidelines.

svn-id: r47770
"
"420569626c84be5242237125745a117a6ff9a8b9","2010-01-31 18:29:54+00:00","Fix return of a reference to a temporary object introduced with r47766. (Hopefully this 'workaround' will work also for Chrilith's compiler ;-).

svn-id: r47771
"
"e44620a0dffd1873f6ab1e64db3ca1d6fdb748cd","2010-01-31 18:49:59+00:00","SCI: fix printObject, so it does not output some spaces to terminal in case its supposed to output to debug console

svn-id: r47772
"
"43c15603c3b9bbfe9180a0b9a957d734d0e8a3fc","2010-01-31 19:44:40+00:00","SCI: Add support for early audio map files.

svn-id: r47773
"
"1d50acaa50ff88d22326d16b667d5f3cc8991e7f","2010-01-31 19:45:51+00:00","SCI: Handle -1 properly when passed as a language id to DoAudio

svn-id: r47774
"
"4acb18f6b9faa4a0faf3f88ae74926e9c1074ed5","2010-01-31 19:46:46+00:00","SCI: Add another DeviceInfo subfunction. Fixes VM crash in MUMG.

svn-id: r47775
"
"a92bb6193be1bcc1e00aed4ced749a5226f5815d","2010-01-31 19:47:54+00:00","SCI: Implement kMemorySegment().

svn-id: r47776
"
"180874f044380c91238069906caffbcc38499603","2010-01-31 19:52:05+00:00","SCI: display object name when addScreenItem is called

svn-id: r47777
"
"c66a6db21363c435cf75fb8968ebe76371166ebb","2010-01-31 21:11:36+00:00","SCI: Fix regression in KQ5CD caused by r47775.

svn-id: r47778
"
"fb3d272c3c6310fb5aebdec035907134debddbff","2010-01-31 21:31:11+00:00","getFont() should check _cachedFonts and not _cachedViews. Fixes segfaults when using fonts.

svn-id: r47779
"
"19bca959050503e866b5c44f33a792e8424a6711","2010-01-31 21:54:43+00:00","SCI: renamed Text class to GfxText16

svn-id: r47780
"
"5cf510648a3aaef45d706f457f56cd272e78779e","2010-01-31 21:59:37+00:00","SCI: syncWithFramebuffer() is now called directly w/o SciGui/SciGui32

svn-id: r47781
"
"12d983eaf41bd8353849ee8776fc2bbc59808870","2010-01-31 22:14:35+00:00","Make EngineState::getLanguage() check from the resource manager as to what language it has loaded before checking from what ScummVM has set and make kDoAudio use EngineState::getLanguage()

svn-id: r47782
"
"d31f696d1f5c9f5fb79be0524a6142e967308220","2010-01-31 22:20:55+00:00","SCI: rename Controls to GfxControls, gets directly called now

svn-id: r47783
"
"b0b7764178bcb9fcf3fb590abd717c056894a66a","2010-01-31 22:38:07+00:00","SCI: Add stub for kIntersections()

svn-id: r47784
"
"c5be030077d5a148eb376b5acb78af1499c0a58b","2010-01-31 23:28:12+00:00","Silenced some more cppcheck warnings.

svn-id: r47785
"
"d1bc12300cc52997d017ff8d92f41ea4ac01fd70","2010-01-31 23:53:25+00:00","mothergoose SCI1 starts at the top of the screen, so set offTop to 0 for that version.

svn-id: r47786
"
"da1a125a1ade505a061c150e57e518f11993edc0","2010-02-01 00:23:05+00:00","SCI: fixing scaling for sci32

svn-id: r47787
"
"313b531d56d4accb89bcf65c72a37480c1fc052c","2010-02-01 00:53:13+00:00","Skip extra pixels at the end of each row in the cel so that they don't carry over to the next row if the dest width is less than the source width. Fixes several images in Mixed-Up Mother Goose (SCI1).

svn-id: r47788
"
"f24e0aad2b856befb84811b6fb8f6f661b605b1c","2010-02-01 01:05:08+00:00","SCI: When removing audio resources from the resource manager, also remove them from the LRU list.

svn-id: r47789
"
"af52e2caf0cfda303233440d2d1b6867006a1af1","2010-02-01 03:59:48+00:00","Torin calls K_FILEIO_OPEN without a file mode to open with. Assume that it's opening the file for reading as it appears that it is just testing if it exists. Torin (and the demo) progress a little farther now.

svn-id: r47790
"
"c72c2ff71109544ca48d2cfabf1ff735363795c3","2010-02-01 04:14:16+00:00","kPlatform(0) should return the SCI platform number. Fixes playing AVI's in KQ7 Windows. Also, adding/updating detection entries for KQ7 Windows.

svn-id: r47791
"
"845c245ff37fc5f269a26a6f57eb55e66b6f1530","2010-02-01 09:53:42+00:00","SCI: class menu renamed to GfxMenu - now getting called directly, also fix for loading savedgames

svn-id: r47792
"
"a20f4ef1fcd034f3f6b1e81078736c976ebf5f7c","2010-02-01 10:16:45+00:00","SCI: implemented reset for GfxMenu, not recreating object anymore

svn-id: r47793
"
"80abaab1ae2a4d2039c6fd8ed19cf9f4bbc47864","2010-02-01 11:53:54+00:00","SCI: initialize gfxmenu for sci32 (fixes gk1 crash)

svn-id: r47794
"
"097b45db21cfffeb5e9acd5f6bbdfd90fd5b5cfd","2010-02-01 13:27:20+00:00","SCI: fix getLanguage - fixes gk1 german (day number blood writing at the start), thx to waltervn

svn-id: r47795
"
"bc89883da8d521ec1012e7328d83b0d714530f33","2010-02-01 15:44:24+00:00","partly reverting r46807 ffs. Regression in numpad handling - ID: 2943361

svn-id: r47796
"
"7b34392aad1f7e20dd9f663c82c7ce284bebe38e","2010-02-01 16:42:10+00:00","Only compile in the SCI32 static selectors when ENABLE_SCI32 is set; minor cleanup.

svn-id: r47797
"
"16490ab64e68770860fb1607a36a01d966c7d128","2010-02-01 16:58:17+00:00","Fix bug in kString(Printf)

svn-id: r47798
"
"86408ae3bc08509634bde6c21d64f2dd95c502cd","2010-02-01 17:04:20+00:00","Added an initial implementation of kGetHighPlanePri

svn-id: r47799
"
"56782692808300096d5da98a6c52b45817525577","2010-02-01 18:16:50+00:00","Fixed silly typos (priority is a byte in SCI32)

svn-id: r47800
"
"17f198369d76dd86e502f3095deec142a3252dba","2010-02-01 18:18:20+00:00","Fix assert after ^W and Delete key events in the debugger, when there's nothing on the line.

svn-id: r47801
"
"516d44e65c1e3babdc850c211585324ee813d14c","2010-02-01 18:23:23+00:00","Fix behavior of delete key, when the cursor is at the end of the input line.

svn-id: r47802
"
"94e821f1eb8e0505a5f22423cd1e6d4b153fa182","2010-02-01 21:32:33+00:00","Prepare test module build to allow for instantiating AudioStreams.

svn-id: r47803
"
"a7fb45927791e2d3d112f6fa020a0be9d0f82672","2010-02-01 21:55:34+00:00","Add some basic tests for Audio::convertTimeToStreamPos.

svn-id: r47804
"
"6f66286c5934545d6fcd1b200953b3fa761d8848","2010-02-01 23:34:30+00:00","Renaming saveload_Fascination.cpp to saveload_fascin.cpp, to fit the naming scheme

svn-id: r47805
"
"5f7c5185427520547b28bce29642aa89ac8ce361","2010-02-02 01:36:45+00:00","SCI: Fix bug in keyshift handling in midi driver.

svn-id: r47806
"
"34939584234235cc1a084e4c6fbb13f2de47bc83","2010-02-02 03:23:48+00:00","SCI: Abort when sound driver fails to open.

svn-id: r47807
"
"ef8215e70ca6225d2a2e01f21c8aebda2ca82a99","2010-02-02 07:26:36+00:00","added kWait event type

svn-id: r47808
"
"dca5e680d81f32a68c3a19acd868896e6dba0142","2010-02-02 08:12:45+00:00","added all wait's

svn-id: r47809
"
"7f4a1d7d9017734389cf30061bba0512627b2ff8","2010-02-02 11:46:35+00:00","Sort several lists alphabetically in the configure script

svn-id: r47810
"
"0d464397a6651103d558b7014dff506c2be0a16f","2010-02-02 11:48:28+00:00","Remove what looks like reminders of debug output in the configure script

svn-id: r47811
"
"448ef35fe17645da52c10db7658fe39080359afe","2010-02-02 13:02:08+00:00","Install the plugins from the current directory (the build one), not from the source directory

svn-id: r47812
"
"b0208e7306c40a41b0e5b6365f0c49f8aebe3b94","2010-02-02 14:41:17+00:00","SCI: moving structs/enums from helpers to animate/controls

svn-id: r47813
"
"714665f9d9bde9bf337160276c50b662a5501442","2010-02-02 16:25:35+00:00","SCI: some sort of priority support for sci32 (not working right, but at least the menu in gk1 now correctly shows up)

svn-id: r47814
"
"6b26f76f707ebd328e6c490198d8fdb80911e503","2010-02-02 16:29:14+00:00","SCI: frameout ignoring 0xFFFE for picture id as well (must be some other magic value)

svn-id: r47815
"
"e321654dcd5e8c33f3ec3bfc531ef486e24f01c4","2010-02-02 17:20:21+00:00","Added a stub for kCreateTextBitmap, which shows the text that should be drawn on screen

svn-id: r47816
"
"50e6b0283fd0fc268a73b058d7520ea5f927f250","2010-02-02 17:21:11+00:00","Silenced warning

svn-id: r47817
"
"af6648fbb0e756f0fdbfb2f77ffa5ca8a2cf1547","2010-02-02 17:33:52+00:00","Try to make drmccoy happy again (is that even possible? :P )

svn-id: r47818
"
"35d2f48fc11fb837398ac3d5a0bab3b881a55abc","2010-02-02 19:39:02+00:00","Use MIDI by default for SCI32. Fixes the GK2 demo.

svn-id: r47819
"
"66b326d3e810b9b2ce5f13a6873b0574b6380bb8","2010-02-02 19:45:22+00:00","Add support in kString(Cpy) for copying to system strings. Also, stubbing kFileIO(19) to allow Torin to see the main menu. Some minor cleanup.

svn-id: r47820
"
"21bb78b677dff6e20c4695ec9d8d2bc84619e67d","2010-02-02 21:47:51+00:00","fixed actor glitch

svn-id: r47821
"
"5d80990380a8438dc474cdd5778807b7a72e2501","2010-02-02 22:31:32+00:00","Fix compile without SCI32

svn-id: r47822
"
"6c322506dd15b164028f8c560e55323f1b834711","2010-02-02 22:50:32+00:00","SCI: Move some code around (no code changes)

svn-id: r47823
"
"4b19acf2550be8c55cefd2f1abf0759a61dfca75","2010-02-02 22:52:41+00:00","SCI: Use Common::List and Common::String to simplify breakpoint handling (untested)

svn-id: r47824
"
"2c25dab0e73ddb3f62375c0f340df9b74cd49522","2010-02-02 22:53:33+00:00","SCI: cleanup

svn-id: r47825
"
"48c023cd5b90800d68a80d29b6b30aa7e3a3ccd3","2010-02-02 23:33:10+00:00","Fascination - Fix one wrong wait time

svn-id: r47826
"
"4b063230b76c066a2612d90fbc4ad0df7ee10ec0","2010-02-02 23:35:08+00:00","Fascination - Add a define to enable/disable MDY player, as it currently generates more warnings than sounds

svn-id: r47827
"
"f072709f25b23497695b2f3e1249952a524c3c7f","2010-02-02 23:39:19+00:00","Fascination - Add a window specific function, modify checkmouse() function in order to use it (without breaking the other games). Windows are no longer 'transparent'

svn-id: r47828
"
"86aa70ec4b10fcb931c5a819fe7953a7301fa252","2010-02-02 23:45:14+00:00","Fascination - comment calls to getWindow() in checkMouse(). I think getWindow() is wrong, and to be replaced with my new check. The first window reacts !

svn-id: r47829
"
"ac6e9e07a3fdd2d90122de2ee01ca37ea616b3b7","2010-02-03 00:51:09+00:00","Fascination - Fix screen transition

svn-id: r47830
"
"81f7a55e8cda7093225bd0e574389257b2eaee24","2010-02-03 01:32:03+00:00","SCI: Renamed Console::_vm to _engine

svn-id: r47831
"
"b2d69649f7e4c484dcf3810e11cd644699b78d2c","2010-02-03 01:32:27+00:00","SCI: Rearrange members of class EngineState

svn-id: r47832
"
"bb5e34a014c0ae868de86fcea484bc9671ce18b9","2010-02-03 01:32:59+00:00","SCI: Get rid of EngineState::stack_segment

svn-id: r47833
"
"4ecaf4d4aca61000db542c19a717f6b9530b8ee7","2010-02-03 01:33:23+00:00","SCI: restoring param of run_vm is a bool, not an int

svn-id: r47834
"
"bec3a0d539b3fc23f56e09e895d06b457034faf2","2010-02-03 01:33:48+00:00","cleanup

svn-id: r47835
"
"bca7c6eef385b3818e1443038f3326f8f02a895a","2010-02-03 01:34:15+00:00","SCI: Move more stuff around

svn-id: r47836
"
"09046947d4885dea20321c5ca1166e980b169517","2010-02-03 01:34:39+00:00","SCI: Make add_exec_stack_entry & add_exec_stack_varselector static / private

svn-id: r47837
"
"887ca3145ebfce7c54d2cffeffb3d40de3fbe272","2010-02-03 01:36:53+00:00","Initial implementation of text drawing for SCI2 (it's a hack for now, done the 'SCI0-SCI11' way, and text splitting is wrong...)

svn-id: r47838
"
"d4949d03d4e1b5dffd4c80c05b0a0ef34b70eda1","2010-02-03 03:25:50+00:00","Minor style-related changes

svn-id: r47839
"
"5115c94f351e476f51763f256ca98023c84be6bd","2010-02-03 03:26:28+00:00","Only show that annoying checkmouse warning for Fascination

svn-id: r47840
"
"c040eeca448394a607767a4f9020493aa50efea4","2010-02-03 08:58:52+00:00","- Return 0 in makeVorbisStream and makeFlacStream, in case creating the stream failed.
- Add a TODO in the MP3 code for the same behavior.

svn-id: r47841
"
"9c1a42f9f5324d403293ad86a407aee35668a097","2010-02-03 08:59:10+00:00","Rename:
- FlacInputStream -> FlacStream
- VorbisInputStream -> VorbisStream
- MP3InputStream -> MP3Stream

svn-id: r47842
"
"286786b6afe73f9dc790f33cd53fec14bb2939e1","2010-02-03 09:11:55+00:00","Cleanup.

svn-id: r47843
"
"e7d5849ac88c78189eac18e7480e09b00ed5602c","2010-02-03 09:19:16+00:00","Rename RawAudioStream to RawStream for consistency.

svn-id: r47844
"
"9cad13957da8a67e68dd4e268eb53f8e413eb4be","2010-02-03 09:32:16+00:00","Implementing saving/loading for Fascination. Tested in the DOS floppy versions and the Amiga version

svn-id: r47845
"
"fe35d372dab08a2e202b5ecb41ccc14298f8cfbd","2010-02-03 09:42:11+00:00","- Rename FlacStream to FLACStream.
- Rename makeFlacStream to makeFLACStream.

svn-id: r47846
"
"8ae24a27b3f6cb2272fd7c732c8583623c8164f4","2010-02-03 09:42:40+00:00","Yet more Flac -> FLAC changes for consistency.

svn-id: r47847
"
"d32dfa3bb3df8e1b2b4fb9d146a0affe2c2be814","2010-02-03 09:47:29+00:00","Make makeMP3Stream return 0 on failure too.

svn-id: r47848
"
"baf6b53431bbb1b5a630fd153fe3df350e3d16fd","2010-02-03 10:36:14+00:00","Add some (lame) first version of RawStream unit tests. Currently all it does it, checking, whether readBuffer works for 8bit and 16bit samples.

svn-id: r47849
"
"2fb37063a4ef85aa862b8fdf035d03f6b801679e","2010-02-03 11:02:43+00:00","Placed all the game feature detection code in a separate class

svn-id: r47850
"
"b6a824f48f0d0c56542b781a918a2c4fd719e5a8","2010-02-03 12:57:47+00:00","Fascination - Cleanup: suppress some noisy debug output, suppress some obsolete and commented code.

svn-id: r47851
"
"ba5e2b336279ba524f5e86fa0ca0b732ac157e58","2010-02-03 15:24:03+00:00","Cleanup.

svn-id: r47852
"
"c0f5a5d2d959c3f1631ec5c500179db2d139f3a8","2010-02-03 15:24:24+00:00","Test both BE and LE 16bit samples.

svn-id: r47853
"
"a5e474177529596f35f6bddef24b6eb43bf5fab4","2010-02-03 15:24:44+00:00","Less noisy output in case something goes wrong.

svn-id: r47854
"
"6b2e9be345dd418a3e82254ab27394e0f95aad7d","2010-02-03 15:25:06+00:00","Add tests for unsigned sample data for RawStream.

svn-id: r47855
"
"274f6e50337b3ec5d4e48eba9c3b03703491bc52","2010-02-03 15:44:43+00:00","Add test for rewind functionality of RawStream.

svn-id: r47856
"
"e9f831c1dabddb0ed700f0733313083dd8004564","2010-02-03 15:45:08+00:00","Some additional tests of RawStream::readBuffer.

svn-id: r47857
"
"2cb82808ebb8b7b0c938cc20d5b9446182177459","2010-02-03 15:45:29+00:00","Add unit test for RawStream::getLength.

svn-id: r47858
"
"6312b690de2cdda07b158fcffab35c02afaae92b","2010-02-03 15:45:54+00:00","Fix bug in RawStream::getLength for 16bit streams. (Uncovered by our new unit tests yay!)

svn-id: r47859
"
"8fcaa28a7fa85ae5d9b2eb01e17931d3206ee56c","2010-02-03 16:02:04+00:00","Test various sample rates with RawStream's getLength implementation (just in case...).

svn-id: r47860
"
"9da2b4eac201df6ab8b5ec82fd71f69ca96d47bf","2010-02-03 16:02:25+00:00","Add tests for stereo mode of RawStream.

svn-id: r47861
"
"5030ba3596ac012273e2e29dbac1b76b843585e9","2010-02-03 16:57:46+00:00","Add tests for RawStream's seek implementation.

svn-id: r47862
"
"87534da624016dadb72a24adbee1a92a390c582f","2010-02-03 17:03:46+00:00","Remove code duplication.

svn-id: r47863
"
"51d03658184afe1a176863dec3bdbe00b162fffd","2010-02-03 19:55:14+00:00","Loosening the 2 samples per channel requirement of Apple_ADPCMStream to 1 sample per channel

svn-id: r47864
"
"da771b91e6144f0c50c22c643edd998f32c12ac5","2010-02-03 21:59:41+00:00","SCI: we checked first cel size when detecting hires instead of actual picture resolution, now checking correctly

svn-id: r47865
"
"d09d37ff4eac6eef70802cba09ff1502f88d49d5","2010-02-03 22:05:22+00:00","SCI: fixing picture corruption in sci32 (e.g. sq6 picture 430, kq7 after intro)

svn-id: r47866
"
"b2876ca9d3b322b4d9c38d924005dde8630a01db","2010-02-03 22:06:57+00:00","SCI: some work on robot REing (still comments only)

svn-id: r47867
"
"f5764b115200bd69cde6732f21f1de16057e0401","2010-02-03 22:14:06+00:00","Fascination - based on the theoritical values of flag, use getWindow instead of the code I added. Suppress shr 8 in getWindow and switched from int8 to uint16, in order to match the executable.

svn-id: r47868
"
"7e166d1ad6498dd7ef3847014df3a69c410f8f53","2010-02-03 22:20:33+00:00","clean-up : forgot commented code

svn-id: r47869
"
"ee66af41a2ab521350766540c5169bc16425306d","2010-02-03 23:02:37+00:00","Fixed the hang with the new music code after the copy protection in Island of Dr. Brain

svn-id: r47870
"
"d5ce8b500e036483724937574e29ecddf3a0beab","2010-02-04 00:12:00+00:00","Fascination - Add detection for EN Atari version

svn-id: r47871
"
"170c4c5c11e80f076483ab5374e42b5d04c5a018","2010-02-04 07:44:13+00:00","added fading in certain areas (bush in forest)

svn-id: r47872
"
"a79330e6d8003aa07d0a77b45ed70fc31f53308a","2010-02-04 11:54:48+00:00","SCI: fix support for cels that are larger than 64k (sierra logo animation in sq6)

svn-id: r47873
"
"e3cab50c15ae5a935e3aced57a638c22f5055d14","2010-02-04 12:01:19+00:00","SCI: adding support for resX, resY selectors for sci32

svn-id: r47874
"
"4e090f4edeffc750679eb851da0394a3c3bf5bc5","2010-02-04 12:07:27+00:00","SCI: support for resX, resY inside frameout

svn-id: r47875
"
"6ea821fac75196ee5eb8c3616f89829e4517ab65","2010-02-04 16:06:56+00:00","SCI: adding selectors bottom and right

svn-id: r47876
"
"751db2fcf3830048e477ec093214a766e1597918","2010-02-04 16:12:47+00:00","SCI: added clipping inside frameout (fixes torin)

svn-id: r47877
"
"7b0b4f5313c73d9c86badc90e38087840879af27","2010-02-04 16:14:59+00:00","SCI: also adjusting bottom/right coordinate of plane rect

svn-id: r47878
"
"354543890044ae6ab0f9deb982ef6915b6b2de64","2010-02-04 17:55:23+00:00","SCI: adding back selector for sci32

svn-id: r47879
"
"6664d26db791866d231e40da1da49a7c5a9ee2fc","2010-02-04 17:57:44+00:00","SCI: adding GfxPaint32 class, adding back support for planes, minor change in GfxPaint16 (using #def instead of fixed value)

svn-id: r47880
"
"708c340d1f662ea580f85bda5c784bfa0bfb8751","2010-02-04 18:48:20+00:00","SCI: fixing header of paint32

svn-id: r47881
"
"5dc8f75b68a95e4c6f69921c29d773e902022708","2010-02-04 18:52:03+00:00","SCI: moving paint32.o around...

svn-id: r47882
"
"3ce2e229786f1ce81935883ed934d14fbc3444f7","2010-02-04 19:22:40+00:00","SCI: adding GfxPaint class, implementing kernelDrawPicture for GfxPaint16 and GfxPaint32, using those classes directly when drawing pictures instead of SciGui/32. Making draw_pic command work in sci32 that way, using _gfxPaint16 for kDrawPic because that command is sci16 exclusive

svn-id: r47883
"
"21cfb4c0c7ee9ec3e833beb47a7ecd5d8494b862","2010-02-04 19:33:36+00:00","SCI: cleaning up deleting of graphic objects

svn-id: r47884
"
"fb494493225cb490f4ed173774208b377e35c692","2010-02-04 20:02:48+00:00","SCI: putting kDrawCel info GfxPaint class, debug is using GfxPaint class as well for drawing cels

svn-id: r47885
"
"822e59288f34c03e468de2111d40467e419194c4","2010-02-04 20:17:03+00:00","N64: remove some unused code

svn-id: r47886
"
"e74bd30a2e249598b6ec8ec1cb6c03fd95797ddc","2010-02-04 20:18:01+00:00","SCI: putting most kGraph functions into GfxPaint16

svn-id: r47887
"
"00ac235331bcffc19fbc96dc973e876085f2db93","2010-02-04 20:43:00+00:00","SCI: making pathfinding debug support also work in sci32 (though it just shows the path for 2.5 seconds there)

svn-id: r47888
"
"5f39e3b7b544e94d9cdee80d7067006970a16f13","2010-02-04 20:52:56+00:00","SCI: kPicNotValid now uses GfxScreen directly and not SciGui/32

svn-id: r47889
"
"c336204a3f324d1bb78287967e5c1d36f6473f7c","2010-02-04 21:04:47+00:00","SCI: renaming Transitions to GfxTransitions

svn-id: r47890
"
"cabd18da9e6a973e34bd841e4c30069ddd2a4808","2010-02-04 22:17:58+00:00","SCI: renaming class View to GfxView

svn-id: r47891
"
"3a94200e185f8de4ef8f775409f3ce1f60e39408","2010-02-04 22:30:46+00:00","SCI: fix build paint16.h change

svn-id: r47892
"
"0d85b3946876f54acd1c6953461780c128f292e3","2010-02-04 23:17:33+00:00","Moved the PalVary code inside the GfxPalette class

svn-id: r47893
"
"19d3f5ad9b9af7b1f03db35ca97aefef9010acf4","2010-02-05 03:29:04+00:00","Have SCI look through the patches directory (except in KQ6 where the patches in that directory are broken) to fix some GK1 Windows problems. Add the MSRLE codec to AVI (from DrMcCoy's Dark Seed II engine, with permission). GK1 Windows now will play the credits video.

svn-id: r47894
"
"3b6f6bfbd84dbdd6f3a134ecce470835bc6ba446","2010-02-05 04:16:12+00:00","SCI2 Windows games are scaled from 320x200 to 640x480, not 640x400. Aspect ratio correction will eventually have to be applied. This fixes a possible segfault when playing the credits video in GK1 (which is 640x480).

svn-id: r47895
"
"969a048619d166373d6cfccce1cc98674f6aa70a","2010-02-05 04:27:51+00:00","Silence a valgrind warning. The sound buffer should be created with malloc and not new[].

svn-id: r47896
"
"baae94fb81674cda55f177ba916d621acfb6eddc","2010-02-05 07:06:43+00:00","Use strcmp() to test the game ID, not the != operator.

svn-id: r47897
"
"a0e40a0675323b5d442fc369a1535a184bc8ae5d","2010-02-05 09:02:36+00:00","Added information on the patches folder included in KQ6CD

svn-id: r47898
"
"3ad4433adfd6c31b92d37d057ad677f9e971b836","2010-02-05 12:14:03+00:00","SCI: renamed SciGuiPicture to GfxPicture

svn-id: r47899
"
"51b608d794e0ac53403a1f96f36dd642677bbf1d","2010-02-05 12:30:41+00:00","SCI: renamed class Font to GfxFont

svn-id: r47900
"
"19910ec27906dc07066271a11d295c9e5fcb90d9","2010-02-05 12:57:05+00:00","SCI: Add implementation for Intersections().

svn-id: r47901
"
"6c204cc890ed769f4d9268e80c6814c2eb95eb02","2010-02-05 13:05:26+00:00","SCI: renamed class Cursor to GfxCursor

svn-id: r47902
"
"f8f490c565809c93ca35928210a740b6579fba19","2010-02-05 14:48:51+00:00","SCI: calling most of the cursor functions directly via _gfxCursor instead of SciGui/32

svn-id: r47903
"
"ab2941bb520583be93ca9520497f6c3718194fa2","2010-02-05 15:48:45+00:00","SCI: adding some minor documentation for the various graphic classes

svn-id: r47904
"
"03dd0ac7bbfa080699f1fd0f1f54303413364494","2010-02-05 15:53:36+00:00","SCI: screen specific debug functions are now called directly w/o SciGui/32

svn-id: r47905
"
"71519a0a8f2e209743ae79d2c513032b865a43f6","2010-02-05 15:55:18+00:00","SCI: removing debugShowMap from SciGui32

svn-id: r47906
"
"e7cffa90b2718398f93ce9e8ad331cd39e832c14","2010-02-05 16:03:14+00:00","SCI: frameout sci32 stuff now gets called directly w/o SciGui/32

svn-id: r47907
"
"f3ea96d168052e72ff0e5b16cef745779a89ea30","2010-02-05 18:56:13+00:00","SCI: GfxCoordAdjuster class added, local2Global and global2Local use that class directly, kGraph / RedrawBox is now using GfxPaint16 directly

svn-id: r47908
"
"a7aa3a6deabc34e00ffea0006937db745f1afc4f","2010-02-05 19:09:34+00:00","SCI: fix warning inside GfxCoordAdjuster header

svn-id: r47909
"
"c78a49f56347ead6ab20f9c927d799b16c2c65e5","2010-02-05 19:33:39+00:00","SCI: initializing _highPlanePri inside GfxFrameout

svn-id: r47910
"
"779fc7dc193d5ad360d02ccd33a86ea021f2e138","2010-02-05 19:41:06+00:00","Cleanup kShowMovie; merge the SCI1.1/SCI2 and SCI2.1 AVI code.

svn-id: r47911
"
"248bc560f32ee78a25e606b8ff54a449be6bf6e2","2010-02-05 20:44:03+00:00","SCI: moved onControl etc. into GfxCompare, now getting called directly. also fixed loading saved games due Gfx* changes

svn-id: r47912
"
"16efee3c0df7e796b21ec198064a8499d2a28dac","2010-02-05 20:48:06+00:00","SCI: drawMenuBar, drawStatus now called directly and w/o SciGui

svn-id: r47913
"
"f9673182254d2a3ea4bb770ce031d89985c8cba9","2010-02-05 21:09:36+00:00","SCI: remaining cursor functions now also directly called

svn-id: r47914
"
"9b5363c0e4ea8b37c4c94c1a2fa2e28d23858d1f","2010-02-05 21:32:43+00:00","SCI: moved control type enum

svn-id: r47915
"
"71fb77a5aa9b3e64f535ff06d58f1a31f6778d49","2010-02-05 22:20:46+00:00","SCI: priority band specific stuff now gets called directly w/o SciGui

svn-id: r47916
"
"25a9df8a817de652a40d2cc48411310b081b5653","2010-02-05 22:31:48+00:00","SCI: moving kDisplay into GfxPaint16, now getting called directly as well

svn-id: r47917
"
"f86618f92be1350bf6e56573c2419e604c811548","2010-02-05 22:55:18+00:00","SCI: Add a 'SELECTOR' macro

svn-id: r47918
"
"d2871f925af38da89362b45edac43dbed5c925f5","2010-02-05 22:55:41+00:00","SCI: Add comment to GfxCompare::canBeHereCheckRectList

svn-id: r47919
"
"b0b89e788b9fb5cbeb58c73f7adef4473f4211ed","2010-02-05 22:56:05+00:00","SCI: Document GfxCompare::canBeHereCheckRectList; pass Common::Rect by ref

svn-id: r47920
"
"4be44fe9a2292699f105382a475b2def725cb36d","2010-02-05 22:56:27+00:00","SCI: Get rid of the mysterious sign_extend_byte() and replace it by a simple cast ;)

svn-id: r47921
"
"bf82c49ce4249d4ceb776e6c0e30efdd4e4e97a8","2010-02-05 23:14:46+00:00","SCI: removing int8 inside kernelSetNowSeen as well, didnt make any sense :P

svn-id: r47922
"
"c7cbb80dc4d17969bef194ef61a53b94700c1bf5","2010-02-05 23:17:39+00:00","SCI: removing int8 from kernelSetNowSeen() as well, didnt make any sense :P

svn-id: r47923
"
"f1f277d56dc308108d33bc323c2bf1d9a79f47ff","2010-02-06 01:38:00+00:00","Add detection entry for KQ5 Mac. Also, make Mac and Amiga SCI1_EGA+ games default to MIDI as we don't (yet) support their patches. KQ5 Mac will start and go until the main menu.

svn-id: r47924
"
"38b0a148e6e5c0b09799074c8e27b8a42a7e593f","2010-02-06 04:13:00+00:00","SCI: Don't call garbage collector directly from kFlushResources() as this is no longer safe.

svn-id: r47925
"
"dc12437390d47335395a29b46538efe59c8bfa49","2010-02-06 05:29:08+00:00","Add a missing break.

svn-id: r47926
"
"59c351a3b2a10677e061a7a2814179f9bd5b3c9f","2010-02-06 08:10:56+00:00","Fascination: Fix lamp problem in parking lot.

svn-id: r47927
"
"b2e8777e1e09f13d89bea58156692c5ba2e4a733","2010-02-06 10:43:54+00:00","Silenced warning that intersectionX and intersectionY could be uninitialized

svn-id: r47928
"
"742ddb7979e0958adb1bb7944bf450da964df6a9","2010-02-06 12:50:50+00:00","SCI: Run GC only when execution_stack_base is 0.

svn-id: r47929
"
"b12437bbfcf22def9d2e20b3fc95fd76dd47636b","2010-02-06 15:58:59+00:00","Don't try and manipulate invalid views (i.e. views with view ID -1/65535, which are most likely the currently missing dynamically constructed text views). Torin chapter 1 starts now (and dies shortly afterwards, but that's a different issue)

svn-id: r47930
"
"788f375703892dae18d9f01bbda2d18f5881d1f7","2010-02-06 16:12:19+00:00","Added a sanity check for kListAt and made the hack for displaying text work in SCI2 only

svn-id: r47931
"
"2cfa5e428cecbf27509018c34d847be0301c302e","2010-02-06 16:30:32+00:00","Mark the sanity checks inside kernelSetNowSeen and kernelBaseSetter as hacks

svn-id: r47932
"
"4fca64d1b049d5d94b0ca844c7dad301ddaf8718","2010-02-06 16:41:27+00:00","Move test AudioStream creation to a new file.

svn-id: r47933
"
"e3d4d5e3793041a189370521d11bc24727da4d31","2010-02-06 16:41:53+00:00","Add (currently failing :-/) unit tests for LoopingAudioStream.

svn-id: r47934
"
"b431e700d8878b6f6367f4ac15df5080490feb55","2010-02-06 16:42:15+00:00","Fix bug in LoopingAudioStream::readBuffer, this makes the unit tests complete without any error.

svn-id: r47935
"
"454856b5fd890450be6e3fa4db088495f901d849","2010-02-06 17:03:18+00:00","SCI: put kShakeScreen into GfxPaint, called directly now

svn-id: r47936
"
"75b2b13f7fc271db229af13d926d11e83cfd08cd","2010-02-06 18:20:33+00:00","Some slight extension for the LoopingAudioStream unit test(s).

svn-id: r47937
"
"cf1b03f694740203901924ea66d004d26e461e0b","2010-02-06 18:25:57+00:00","Add test case for partial reads in LoopingAudioStream too.

svn-id: r47938
"
"4cae2b13e2acbd81e4b726f1e409c5615eda7967","2010-02-06 19:35:51+00:00","SCI: added plane coordinate adjustment code for sci32 when drawing pictures, put everything into GfxCoordAdjuster

svn-id: r47939
"
"1e67b56eee611a52f6c7fa9d3b5d17bda741c995","2010-02-06 19:41:55+00:00","SCI: Revert r47925 and put fix inside GC instead.

svn-id: r47940
"
"3255b572ad329b09f8cdc1f52c67e1db4396e07e","2010-02-06 21:22:05+00:00","SCI: added debug code to kPalVary, added warning when calling kPalette(setFromResource) with unsupported parameters

svn-id: r47941
"
"6d6996070411414d44eb04d29e451fcd3fd58880","2010-02-06 21:26:30+00:00","Removed unnecessary semi-colons to keep GCC happy.

svn-id: r47942
"
"67870c7dc887b4e32067be0c6eb41ef6fe7db7ec","2010-02-06 21:38:58+00:00","SCI: adding more debug output to kPalVary, fixing loading savedgames (_gfxPaint wasnt copied over)

svn-id: r47943
"
"ceba3a6ce9481e08ccb51b2910b251c99541a9ac","2010-02-06 22:47:13+00:00","Add an assert to avoid a crash when printing the character 0x00.

svn-id: r47944
"
"b8875aca0c20f6be53a862a54277b51d25f84f8f","2010-02-06 22:48:36+00:00","Add an assert to avoid a crash when printing the character 0x00.

svn-id: r47945
"
"aaa58495672b28fdc9ebd8132c8e3dc5424e1b53","2010-02-06 22:54:20+00:00","Revert r47944: useless debug messages, sorry for the wrong commit

svn-id: r47946
"
"d7a7fcd3a4c48840021adda1c456e5cb7ff2d9e5","2010-02-06 23:06:20+00:00","Fascination - Use invalidateRect instead of dirtiedRect, fix several other little errors

svn-id: r47947
"
"ecd8e6f7d1f8071e22b51a4387a62c352d1e211f","2010-02-07 02:53:07+00:00","Rewrite detectSetCursorType() so that it works for KQ5 Mac in addition to KQ5 DOS CD.

svn-id: r47948
"
"71c222e340a11c999c0fcfc7536bd43c60aa01be","2010-02-07 03:00:52+00:00","Oops, correct a comment.

svn-id: r47949
"
"9183ab57a3c260fda721b4eb3103f707be0ea16a","2010-02-07 04:25:05+00:00","SCI1 Mac games can call kGetFarText with a NULL destination, so we need to allocate the memory. King's Quest V Mac is now playable.

svn-id: r47950
"
"3c8ab42eea676fb2861e78261de0ad75287f5837","2010-02-07 09:33:53+00:00","With the new detection for setCursor, the game object and game ID are no longer required, which makes some ugly code obsolete. Yay! :)

svn-id: r47951
"
"aa40d430914ac20d68eecdbe3ed29e2139b4eeea","2010-02-07 11:50:18+00:00","rename to libscummvm.so to make compatible with tv from 2008

svn-id: r47952
"
"749b0ea23735f01bc465d184bce51e611e98378f","2010-02-07 12:00:06+00:00","SCI: added dummy assertpalette to GfxPalette, setting destination palette immediately on kPalVary(start) call

svn-id: r47953
"
"97c2543b0eaea6a0b10560b4a1e61aef40e26b20","2010-02-07 12:06:03+00:00","SCI: dont set palette on kernelDrawCel() call

svn-id: r47954
"
"ed2a3f1f1604d032ad2d37357ce025b3fcbf088e","2010-02-07 12:13:34+00:00","SCI: set screen palette only when it got changed during merge (performance only change)

svn-id: r47955
"
"3b4c54f0e5cac47c3f3a402865a800b43fbe4646","2010-02-07 12:13:59+00:00","SCI: Add function readPMachineInstruction()

svn-id: r47956
"
"e0218d1ba3db36740ab775c2921dfabd977bf78d","2010-02-07 12:14:26+00:00","SCI: Get rid of GET_OP_ macros

svn-id: r47957
"
"4cfcf5754667269174a7787314d6b7dfaeee579f","2010-02-07 12:14:49+00:00","SCI: Convert disassemble to use readPMachineInstruction.

This change is untested, please check it. Also, the opparams
array is not used but could be used to simplify the reading code.

svn-id: r47958
"
"f3ef11cdc5b88736467e7378abb5f1d0e67a5fdb","2010-02-07 12:15:12+00:00","SCI: Switch GameFeatures::autoDetectFeature to using readPMachineInstruction

svn-id: r47959
"
"7c05a24ade8108eed110a40ea9f65b653f4e77c8","2010-02-07 12:15:35+00:00","SCI: Refactor GameFeatures::autoDetectFeature

svn-id: r47960
"
"0a0875efb8f515ff6469d3ccdbd18f390fb53562","2010-02-07 12:15:59+00:00","SCI: Add GameFeatures::getDetectionAddr auxillary method

svn-id: r47961
"
"ae0c9b48cd48abcca3b4ff66043f38f112aff0d2","2010-02-07 12:16:23+00:00","Split GameFeatures::autoDetectFeature into several methods, one for each feature

svn-id: r47962
"
"57f9f4cc09b361648905210bf14f7f1ce91869b0","2010-02-07 12:16:45+00:00","SCI: Some cleanup

svn-id: r47963
"
"635c7d970c1083cb456ac8f9b2605cc71ebf0c7f","2010-02-07 14:32:49+00:00","SCI: Fix VM crash when NULL_REG is passed to AvoidPath (SCI32).

svn-id: r47964
"
"8eecdea67bb0868b4dbcc4d1dc59aa50c5ca5866","2010-02-07 14:47:40+00:00","SCI: GfxPalette::setFromResource() now actually passes force further down the chain

svn-id: r47965
"
"5d23dd6fa328cec3756de012046d33b6816ca935","2010-02-07 15:48:47+00:00","SCI: Fix build without SCI32 (again)

svn-id: r47966
"
"d4a0375f7e5f02f47b16d8cf1a057e15611b230b","2010-02-07 16:12:31+00:00","LOL: fixed handling of invalid monster attack sfx in the Urbish mines (should fix bug no #2945950)

svn-id: r47967
"
"00d00f9cdcd0279e3e3014080508e571abd7795f","2010-02-07 17:12:52+00:00","pathfinding improvements, added async flag setting

svn-id: r47968
"
"ae938dbef8d77bd8778d6e46992c1207d961bf9f","2010-02-07 17:13:39+00:00","added setFlag, fixed non-mark's messages

svn-id: r47969
"
"9ed02ae0c658f7feff64e5cf7f0f181e99aac908","2010-02-07 17:14:32+00:00","process object callback both on left and right click. skip r-click callback for banknote.

svn-id: r47970
"
"0e39a5ae45621e938c325a67ea096654b5e22eaf","2010-02-07 17:15:04+00:00","committed missing file

svn-id: r47971
"
"7ebbe374e6935cb8669f81fe73d37c6aadda6b0c","2010-02-07 17:16:30+00:00","added missing haystack callback, fixed fatso visibility bug

svn-id: r47972
"
"7731ded5afe4b246c8fef38b4a70602303c6dff6","2010-02-07 17:18:14+00:00","Update comments in autoDetectSci21KernelType() explaining what we're checking for.

svn-id: r47973
"
"ef8d857bafeaf35ed69aedbff586e119e3acc8f0","2010-02-07 17:46:29+00:00","fixed rgb chief glitch in final scene

svn-id: r47974
"
"ad8ebf0130e115af443481fbbccfc70f20f84ade","2010-02-07 17:47:34+00:00","do not trigger combine for the one object

svn-id: r47975
"
"3151ed91459f1cf687fbd9f4f44a162e1b69b0a1","2010-02-07 17:48:18+00:00","removed mark animation and overlay animation hack

svn-id: r47976
"
"2cc301e449c0d8f6b26bb49678543c51debe2523","2010-02-07 17:56:57+00:00","SCI: Simplify yet another case of weird 'unsigned to signed' conversion

svn-id: r47977
"
"95b90fc40d6e68d1ecece0fc7df5f7dc8a9d6b4e","2010-02-07 17:57:25+00:00","SCI: cleanup; try to unify var names when reading PMachine instructions a bit

svn-id: r47978
"
"024e762bdb3afee3add1704d2dfb4c1206f9bc8a","2010-02-07 17:57:51+00:00","SCI: Move bulk of op_callk code to new func callKernelFunc()

svn-id: r47979
"
"049436313c24a1d564e2613b16f9c5de439760c8","2010-02-07 18:05:55+00:00","added background effect for the inventory items

svn-id: r47980
"
"62066fa8ef85f4aaa43b0d4438d74415f5d7f4c5","2010-02-07 18:15:25+00:00","compile debug keys if NDEBUG was not defined

svn-id: r47981
"
"d1761a72ab16807af08787d643758e9e9051d974","2010-02-07 18:16:31+00:00","removed debug keys, sorry

svn-id: r47982
"
"99411b177cb825100fe1b99db88525da4cddff68","2010-02-07 22:04:00+00:00","Add the DOSBox Team to our 'Special Thanks' section for their awesome OPL2/OPL3 emulator.

svn-id: r47983
"
"ec913878377276e393ee94fc23be2101142a96c0","2010-02-08 02:47:05+00:00","Add the missing ResMan debug channel.

svn-id: r47986
"
"86163d5a6c294937a7d4f231f7ff14f5b652b295","2010-02-08 10:02:18+00:00","Script workaround fix for DW1, for being able to give the whistle back to the pirate before the parrot

svn-id: r47987
"
"6938ca072aa05600ece0b7041e47a0fe8e4abba4","2010-02-08 11:44:29+00:00","Add N64 backend to credits

svn-id: r47988
"
"7147f8577e08bcb037cba390dbef3e90163fb96f","2010-02-08 15:51:00+00:00","Search through arrays for outgoing references to fix possible garbage collector problems; minor cleanup.

svn-id: r47989
"
"c453f214e6e356524aff2466a8221675b7ac33be","2010-02-08 16:12:22+00:00","Close the FLI file only from the routine that opened it.

svn-id: r47990
"
"0b06fb2a88aa33e6f74b42de84aa3a1f4f9b87ac","2010-02-08 16:12:45+00:00","The text parser functions can create their temporary buffers on the stack.

svn-id: r47991
"
"1fe0facb2447ea62b9b8dcb03a2a879de24fc51f","2010-02-08 16:13:09+00:00","Pass the input stream to text parser functions.

svn-id: r47992
"
"a9a0fdc69474f0491aa2662cb83ff8b7661ebd1a","2010-02-08 16:13:31+00:00","Reduced references to _arj to the minimum. It is passed as a
SeekableReadStream everywhere.

svn-id: r47993
"
"b658c61155ff189fe4381ba774993a69a3f572ea","2010-02-08 16:14:04+00:00","Let ArjFile return a SeekableReadStream instead of implementing
the same interface itself. The caller is now responsible for
deleting the returned streams.

svn-id: r47994
"
"2df073bb68e1ecd20fa0a6814daab48144f08256","2010-02-08 16:14:23+00:00","Shuffled code around a bit.

svn-id: r47995
"
"8f6352f5bb370f1c60de0dd9541403bb10c77c1c","2010-02-08 16:14:42+00:00","Objectified CRC32 calculator.

svn-id: r47996
"
"29c4c30a25990ffecaacdc10a00d53f039ac8b24","2010-02-08 16:15:05+00:00","Made ArjFile use a new ArjArchive class.

svn-id: r47997
"
"16438e5c4d2f1a8bd8375b9068432e97cc465590","2010-02-08 16:56:04+00:00","Fix trunk after fscking up.

svn-id: r47998
"
"0aefdb782654e886a4d0a9e1798d124b7ed41260","2010-02-08 17:48:35+00:00","Moved ArjFile to drascula.

svn-id: r47999
"
"56bf7a20d343cd49c1b0e2214ee44559603aed54","2010-02-08 18:17:32+00:00","Renamed ArjFile to ArchiveMan, and _arj to _archives.

svn-id: r48000
"
"7317aa0de0a952e2760507b87504cef5e1eff826","2010-02-08 19:46:25+00:00","Renamed variable to fix warning.

svn-id: r48001
"
"110e9aafd222cec697cf74a374230f0f89bfbc3f","2010-02-08 20:03:36+00:00","Allow credits and md5scumm rule to be working, when not building from the source dir.

svn-id: r48002
"
"4c4424cb4c3f4e352212316ad23b9ca22a5b51ea","2010-02-08 20:14:25+00:00","Mention that the music/sound effects support for KYRA1 AMIGA was from a GSoC task.

svn-id: r48004
"
"c2932942c80b668fe89aec4c1dcb3da3c668b45c","2010-02-08 20:28:13+00:00","According to Buddha^ it should be fine to calculate (and set) the AMIGA dim palette in Palette::setGlobalOSystemPalette.

svn-id: r48005
"
"17fef2950718cc38fb7f7bfc1f634ed1b7491eaf","2010-02-08 20:29:19+00:00","Get rid of the workaround for a g++ (code generation) bug on AMD64, by passing a reference of a Color instance to saturatedAddColor instead of a value.

svn-id: r48006
"
"18f6ac477602d8fb7160f12284135b67532584ea","2010-02-08 21:24:47+00:00","Fix RawStream::seek implementation.

svn-id: r48007
"
"4e86741d9ae9eb468d7b352dc6d17482d394fa1f","2010-02-08 21:25:10+00:00","Make the 'seek after the end of the stream' test case a bit 'harder'.

svn-id: r48008
"
"b3da11ba8afc3925de551ae7cc51ccc73e721211","2010-02-08 21:46:50+00:00","Introduce factory function makeArjArchive, hide ArjArchive class implementation

svn-id: r48009
"
"584a58fbce8bc7a4f99689a844a6fb74bfeea765","2010-02-08 21:51:36+00:00","Reduce header interdependencies

svn-id: r48010
"
"816e318134ccf772900d0f343fa923de8822f4b2","2010-02-08 23:12:42+00:00","Fascination: - Suppress the recently added oFascin_keyFunc, replace it with a check in o1_keyFunc. This fixes the animation speed regression
- Rename Amiga-specific protracker functions
- Rewrite winDecomp.

svn-id: r48011
"
"62741adf236a8a58674c5746cf7f8ae7417f4865","2010-02-09 01:07:39+00:00","Merged _headers and _filemap.

svn-id: r48012
"
"3a1e7ccbae87aa5d515af596e5c15c478ed3c4b3","2010-02-09 01:22:24+00:00","Moved text parsing to a new class.

svn-id: r48013
"
"a4f46767d9f2a279b98e8fe33011e75318ab9ebc","2010-02-09 15:23:03+00:00","Add test cases for RawStream playing from a stream via a block list.

svn-id: r48014
"
"a4039182ce8ce21b33b13d3df675113325f555b9","2010-02-09 18:24:54+00:00","SCI: also reset some variables inside reset(), so we dont error() out in lsl2 and other games that reset game engine inbetween

svn-id: r48015
"
"9b6042efb489ea80729b43421aa1a082c20a7ed5","2010-02-09 21:09:29+00:00","LOL: fixed script bug in castle cimmeria that would cause out of bounds mem access (should fix bug #2948109)

svn-id: r48016
"
"d349be1fb8c78e0440702051f630f1060b89fb56","2010-02-09 21:51:28+00:00","Add unit test for SubLoopingAudioStream. (Currently they fail though :-/)

svn-id: r48017
"
"f6aa8d00689b4f4d4f3c3cf840efc1a4eb460aaf","2010-02-09 21:51:47+00:00","Fix SubLoopingAudioStream's readBuffer implementation.

svn-id: r48018
"
"fa2a1cd22dd3a7a7192bfcdfccff3df80e2f3297","2010-02-09 21:52:08+00:00","Add some additional tests for SubLoopingAudioStream and LoopingAudioStream. (Currently SubLoopingAudioStream tests fail for a reason unknown to me...)

svn-id: r48019
"
"6a624df560aae04b990a64dc6d8b34f960365787","2010-02-09 21:52:27+00:00","Make Audio::convertTimeToStreamPos return a frame-precision based result instead of a sub-frame-precision based result. This fixes the SubLoopingAudioStream tests.

svn-id: r48020
"
"b097e8635cebca42953cb7e98edf1492641bf3e6","2010-02-09 21:52:46+00:00","Stop SubLoopingAudioStream playback, in case reading from the parent stream fails.

svn-id: r48021
"
"e7d6d44e86168f9479b358019a849074e45e3b73","2010-02-09 22:03:02+00:00","Be a bit more forgiveful in case the SeekableAudioStream passed to SubLoopingAudioStream does not allow reading the requested sample count at once (i.e. do not tread that as error, unless endOfData() is set).

svn-id: r48022
"
"52af1b38845a0e185a7243fab5eb18f497d08ebd","2010-02-09 22:03:59+00:00","Formatting.

svn-id: r48023
"
"ba1d97211fc20a838571c2821bf653990d5ef3a2","2010-02-09 22:37:13+00:00","Remove last traces of File::addDefaultDirectory

svn-id: r48027
"
"9fb9c0955df4402d796c2ea02b3da19377e5e480","2010-02-10 00:20:33+00:00","Add support for the Motion JPEG codec (used in some Myst ME 10th Anniversary videos); minor cleanup.

svn-id: r48028
"
"a435237a385a96e979f06cf0b6b5d6a2287656db","2010-02-10 11:03:04+00:00","Bugfix for crash when view gets focus based on a key event

svn-id: r48029
"
"3415cae9ad8d588c04926c0c695bc277796f17ef","2010-02-10 11:11:31+00:00","Separated scene info console method between M4 and MADS classes, and cleaned up the message method

svn-id: r48030
"
"005cdeb8308e46fcc8e59abc9bae4c578aacbdd2","2010-02-10 12:36:46+00:00","Fix warning

svn-id: r48031
"
"2ddfdd960c4a4664b684ac1925ea4b62a8aceace","2010-02-10 16:34:32+00:00","Hopefully fixing bug #2948858 'MP3 (CD Audio) Broken under SVN'.

svn-id: r48032
"
"b90acf431b81909c50bf925220c0c1550e8c8fc6","2010-02-10 16:47:53+00:00","SCI: Update said.y to match changes made to said.cpp; regenerate said.cpp using 'bison -l -o said.cpp said.y'

svn-id: r48033
"
"c2c82b22da2a6c7e0f1528d10ac2349a9a5d6487","2010-02-10 17:08:07+00:00","Fix Rober Spalek & Hans-Joerg Frieden in the CPP resp. plain text versions of the credits

svn-id: r48034
"
"7eb92eb1cd20789ee4450589afdeb66ac2f70c13","2010-02-10 17:46:22+00:00","Fix a potential problem for some compilers with having multiple stream reads.

svn-id: r48035
"
"a3a07f19fcf6a001e5981d3efe66e834a404f1e3","2010-02-12 02:23:28+00:00","SCI: Revert r47929 (bad idea, as we may run out of offsets). Instead, adapt SCI32 list iteration code to store node successor before invoking.

svn-id: r48036
"
"e32497c54c1790cc9b3fffc638b43b6c52391f09","2010-02-12 21:15:30+00:00","Fix trap book external commands.

svn-id: r48037
"
"1b877ceb5b207c4ad95b4323980eca5159656ff2","2010-02-13 11:45:54+00:00","Added command variation for dumping quotes and vocab

svn-id: r48038
"
"52c2abba96878d3bd731f17ba04b192da3f61deb","2010-02-13 11:49:18+00:00","Added the beginnings of scene set-up logic

svn-id: r48039
"
"8ac5d00d576519b2fc0f18aff28d29ad3f6ab852","2010-02-13 11:56:30+00:00","Hide ZipArchive implementation, only expose it via factory functions: makeZipArchive()

svn-id: r48040
"
"0a13162073c95417be0d9414af69d3f6eca36f9b","2010-02-13 11:57:01+00:00","cleanup

svn-id: r48041
"
"887f446b17c640e48cc40400e28bff37519836c2","2010-02-13 11:57:23+00:00","Document Normal2xAspect

svn-id: r48042
"
"2c9883773ce7df2955d077b9c04c4c00eff94c26","2010-02-13 11:57:44+00:00","SCI: Remove unused PARSE_HEAP_SIZE

svn-id: r48043
"
"e17a2bd37d23cbfec63f28b1399ce5ebded536ee","2010-02-13 11:58:15+00:00","SCI: Change getSciVersionDesc() to return 'const char *' instead of 'Common::String'

svn-id: r48044
"
"24fd77eb242c4d90e8c3a3b0bcc5f0c48a4dc77f","2010-02-13 13:21:29+00:00","Cruise detection entry for english AtariST KixxXL edition

svn-id: r48045
"
"ac4d325e0d61b649026a5f5414f749697b285ccc","2010-02-13 17:42:49+00:00","SCI: Add global g_sci pointer to the active SciEngine instance

svn-id: r48046
"
"721a57a66101d63bc05e294c24190ba66ccceb74","2010-02-13 17:43:31+00:00","SCI: Move Gui/Gfx related permanent objects from EngineState to SciEngine

svn-id: r48047
"
"a82939c9bee20f2969f1006c1c9a836cea5c7903","2010-02-13 17:44:19+00:00","SCI: Get rid of EngineState::resMan

svn-id: r48048
"
"9575cc08a2d54af57ada390f0f736d64857a49d1","2010-02-13 17:44:58+00:00","SCI: Move GameFeatures from EngineState to SciEngine

svn-id: r48049
"
"e45f0f309acd2448dc042bd89584791f932388a3","2010-02-13 17:45:40+00:00","SCI: Remove EngineState::_kernel, use SciEngine::_kernel instead

svn-id: r48050
"
"06021f79acfb32677e68b8697d5ba63059a6893d","2010-02-13 17:46:05+00:00","SCI: Fix compiling with USE_OLD_MUSIC_FUNCTIONS enabled

svn-id: r48051
"
"b9a11ddb0b69910418d0ccc8cf303a2e2a181f3a","2010-02-13 17:46:44+00:00","SCI: Move language related code from EngineState to SciEngine

svn-id: r48052
"
"5ba36c8216e1a63064b699c6e404514dca180024","2010-02-13 21:59:45+00:00","Fascination:
- Fix a potential bug in winDraw
- Add a hack (and a todo) to work around the missing texts and windows in Amiga, Atari and early PC floppy version.

svn-id: r48053
"
"17de7acd7b19e94dcc0819d9eafe5a47903766cc","2010-02-13 22:17:17+00:00","Fix a crash in previous commit

svn-id: r48054
"
"03e8276407e1e701811eaf5bb67c9b384ecf42ba","2010-02-13 22:26:52+00:00","Fascination: REAL fix. Thanks DrMcCoy.

svn-id: r48055
"
"1cd9498dbcf5ad9f8cbdffe76ef3fa31b5543310","2010-02-13 23:34:18+00:00","Implement background video support for Riven; some VideoManager/QTPlayer cleanup.

svn-id: r48056
"
"b7ae9501309c74f76d81dc8b97730594b273acee","2010-02-14 00:02:59+00:00","Remove an obsolete TODO.

svn-id: r48057
"
"dd5518d3c5afaefe8269f86e298529712a60121c","2010-02-14 01:54:21+00:00","Add support for samples > 32kb to Paula chip emulation code.

In addition, the code got simplified considerably. Its behavior changed
slightly due to this, but I think the old behavior was wrong. In any
case, this may fix some bugs, or introduce regressions, or both. We'll
see ;).

svn-id: r48058
"
"07e405588dc09fa119f649b7efc1f357f8c40683","2010-02-14 12:23:22+00:00","Moved the reference to AudioPlayer inside SciEngine (as it doesn't have a state, per se, and is static)

svn-id: r48059
"
"f034b8bd5f2407cfa4a83e3907cc76325a364385","2010-02-14 12:32:25+00:00","Fixed typo

svn-id: r48060
"
"bf17ff87dbdd6e4e79785bff153dd96682601d98","2010-02-14 18:30:12+00:00","Fascination - Put correct protracker functions as Paula now accept sample size > 32k. MOD is now playing in Amiga and Atari versions.

svn-id: r48061
"
"384acffeb153d631b701de418c753503770f1b14","2010-02-14 19:01:02+00:00","Mohawk : Corrected Myst Opcode 200/300 in Intro/Demo stack to correctly call Intro movies.

svn-id: r48062
"
"975dbef0e58289a81cd55cf43304e5e20114a876","2010-02-15 00:20:53+00:00","SCI: Remove sound/audio.h include from engine/state.h

svn-id: r48063
"
"b246c867df233b4f9fb9f15a47d8f4492ad4cb09","2010-02-15 10:01:09+00:00","SCI: No need to set _executionStackPosChanged in kDisposeScript, as the callk opcode handler does that already

svn-id: r48064
"
"9de580aa6e8466b1a4347450af37492c59a24189","2010-02-15 10:01:26+00:00","TINSEL: Cleanup the 'script workaround' code a bit.

* Rewrap comments to 72 columns
* Add some references to relevant bug tracker items
* Use sizeof instead of handcoding array lengths, which is error prone
and tedious
* Move definition of WorkaroundEntry from pcode.h to pcode.cpp
* Define FRAGMENT_WORD to make fragment code a bit more readable,
and also encoding of 16 bit words into it less error prone
* Make all code fragments static

svn-id: r48065
"
"cf005b623838ae2ed0424296aa770bf9eed0098d","2010-02-15 17:10:40+00:00","SCI32 reorders the REF* subops in kMessage; fixes GK1 conversations.

svn-id: r48066
"
"9426e86ede8a191227fb4f18b2881a20cd3b0232","2010-02-15 22:17:48+00:00","Playtoons - 'Fascination' workaround for text is also required for Playtoons.

svn-id: r48067
"
"55a9787234d9968dc4d377efc1a82543585124f7","2010-02-16 00:12:00+00:00","Correct a rogue typo.

svn-id: r48068
"
"b3ab83d8c125f8a7d8bafce04a3db11c3cdddec1","2010-02-16 01:48:19+00:00","Add a workaround for two 'spare' variables that can exist in some save files.

svn-id: r48069
"
"5fd7dbb4061d808e4bc4c0cfba5e2eabf2687544","2010-02-16 03:01:46+00:00","Move Riven variable randomization to initVars() and implement randomization for the dome and prison combinations.

svn-id: r48070
"
"b54724a778ee9a091d87dd5a5eef8810d248ed57","2010-02-16 06:08:25+00:00","Fix typo in the ospit->tspit linking book RMAP code.

svn-id: r48071
"
"5e24974ad5ba3031867a92b7936b0b3bb112f9d5","2010-02-16 17:32:17+00:00","Implement xpisland990_elevcombo which allows you to free Catherine.

svn-id: r48072
"
"be9a0946b4fac97be41d93366a9b28f9ed7e709b","2010-02-16 23:15:57+00:00","Implement xgwatch so you can now find out the combination to free Catherine.

svn-id: r48073
"
"85bce4611c94c0bad9fcb06e868fe3441a54e636","2010-02-16 23:18:32+00:00","Fascination - Fix syntax (clone2727)

svn-id: r48074
"
"2d03db8a203a8628a2e55c25ad8c1ab0cb47d503","2010-02-17 04:20:19+00:00","Cleanup handling of the telescope cover combination; matches the original algorithm much better.

svn-id: r48075
"
"bf82639c04ccc4508a605f263d844138f6d22a6b","2010-02-17 11:37:17+00:00","Implemented player sprite loading portion of scene enter code

svn-id: r48076
"
"8daaeae84903a8f29f8f3c25808e157ab886cbbb","2010-02-17 16:07:32+00:00","Fix gcc warning.

svn-id: r48077
"
"5d6b9af72a0e40d6d48a6e064516509d6129a4ce","2010-02-17 16:08:47+00:00","Use Common::KeyCode instead of int as key type for KeyMap.

svn-id: r48078
"
"c8470e1d8915134bca7836732c174c40d3b9cf97","2010-02-17 16:18:23+00:00","Use Common::KEYCODE_* instead of ASCII values for keycode comparison.

svn-id: r48079
"
"2ab3e0fb3c74be9e94788eaab281c0bdbbb0c9a3","2010-02-17 19:59:08+00:00","Mohawk : Adding resource cache class and integrating into Myst engine.
The resource caching trades increased memory usage against disk access.

This functionality can be disabled and enabled by the console 'cache' command.

svn-id: r48080
"
"f0d8084cd5dc61ecc6f6eca996811bb16a8dbbd7","2010-02-17 22:01:05+00:00","fixed 'Cannot use rake on grass - ID: 2953464'

svn-id: r48081
"
"3452f5ea2d95e7ff477557a49b89e15c07351bbe","2010-02-17 23:05:51+00:00","Implement stopMovie() for Riven. Fixes some dome related videos.

svn-id: r48082
"
"26b7f0bbb95dad5fc05fc5aec8d675ab7fab9041","2010-02-17 23:36:50+00:00","SCI: Remove hack in convertSierraGameId which caused a memory leak

svn-id: r48083
"
"903b694574a08ce9e3b4186eebbe06197157daaa","2010-02-17 23:37:32+00:00","SCI: Cleanup resource.h

svn-id: r48084
"
"86e34c34643ddd3920025c3423ece4e1c3aaeda1","2010-02-17 23:37:59+00:00","SCI: Rename some members of class Resource

svn-id: r48085
"
"ee1110a114d8e6f889474374943ff0bce701a9ff","2010-02-17 23:38:43+00:00","SCI: Reduce header interdependencies

svn-id: r48086
"
"fd9b52509f330146e4af1169ce107abffdf3dbb9","2010-02-18 23:31:51+00:00","Mohawk : Update with work on Myst EXIT opcodes to work out purpose.

svn-id: r48087
"
"8502d9248ed348a66850a58861addaf8a685e713","2010-02-19 12:33:58+00:00","tinsel: Add detection for Discworld 1 floppy EUR version

svn-id: r48088
"
"049b4384bcfeaad3fba5678dbfee08ebcd3d7f0c","2010-02-19 14:05:55+00:00","Fix for bug #2954279 'KYRA: Error when loading non-existent savegame'.

svn-id: r48089
"
"b3bfe83877c27e0df3566041584a737388685fb6","2010-02-19 14:16:43+00:00","Fix for bug #2954286 'Gob: ScummVM quits on pause'.

svn-id: r48090
"
"b51568ddaf96f77c7993afe44e801193b38f0cb4","2010-02-19 22:26:30+00:00","Increased the amount of space for storing background filenames to fix memory overflow

svn-id: r48091
"
"9b467ee4ff927b8cad22ce1afb538b6b5a46c6fc","2010-02-20 01:57:34+00:00","'const char *' strings should be compared via strcmp and not via !=/==.

svn-id: r48092
"
"41314a356177eaa06a2bc67401e9733a965bd4b8","2010-02-20 01:58:46+00:00","strncpy does not always add a terminating zero, thus we need to do that on our own.

svn-id: r48093
"
"734c922f169f8f18e75753a0007706eb9890107c","2010-02-20 10:32:25+00:00","Reverted commit 48092 - The comparison is explicitly intended to detect if the background table field was passed to the method, so it won't try to do a redundant copy to itself

svn-id: r48094
"
"a57445e847ca241f69efc3c043962b80b82cf37d","2010-02-20 10:37:08+00:00","Put in a warning in case there is ever too long a background resource name when saving a game

svn-id: r48095
"
"0e6893d0662327bfc058e19df337d7a5da4dbc2a","2010-02-20 12:29:34+00:00","Added comment to explain pointer comparison. See r48092 and r48904.

svn-id: r48096
"
"24b0622e6f4c5a57db820e6a1effb305742c1af7","2010-02-20 23:30:59+00:00","Removed dead code

svn-id: r48097
"
"43ca6071eaa559d04988910491b3013664e9f396","2010-02-21 00:50:27+00:00","Handle invalid rects in kCanBeHere(). Fixes some odd crashes in Iceman

svn-id: r48098
"
"6969b5ebe6f428afaf9828d395d57e6c0edb6240","2010-02-21 01:18:03+00:00","Implemented some of the sprite animations loading logic for the first scene (no display yet)

svn-id: r48099
"
"cebb052e2cfd963b95d7357b7c21dc8c437e058a","2010-02-21 01:25:10+00:00","Added comments on the SCI0-SCI1.1 kernel function table differences

svn-id: r48100
"
"ef330ed9b4e5d6252134ed137b042593f79d02a9","2010-02-21 04:04:13+00:00","Patch for bug 2943361 by littleboy, adding full kb modifier support to all engines + GUI and proper keypad handling

svn-id: r48101
"
"d22d8f910a53a7ad20a5ac4df598ce92c445db7c","2010-02-21 09:52:44+00:00","SCI: added warning when getting invalid rect in kCan(t)BeHere

svn-id: r48102
"
"6af6d66e2b152e8c84936f0116d2e66ef662cf6c","2010-02-21 13:54:58+00:00","N64: Simulate numpad using C-Buttons on the gamepad

svn-id: r48104
"
"52f66d54ccdf32428d7e1b577354c530ba8907a3","2010-02-21 14:34:22+00:00","N64: send ascii code for numpad keys

svn-id: r48105
"
"4577a9038af8a89476dc35511cd4afb042bc62b4","2010-02-21 15:01:06+00:00","N64: some input related cleanup

svn-id: r48106
"
"2ca06e3e0a023ce4f55e2aab262c2c877f7af4b7","2010-02-21 19:02:45+00:00","N64: force screen update after hiding overlay

svn-id: r48108
"
"62d5dd557a2051334ce6a4c528a86dabf1fe356b","2010-02-22 18:06:21+00:00","SCI: moving scitrace

svn-id: r48111
"
"7f6c704c25ca4bae5752ece8ea7def3c07abe005","2010-02-22 23:47:10+00:00","SPY Fox 3: Operation Ozone is supported too.

svn-id: r48112
"
"ad4a3908152fc41a7e067872f4668f0cf975d087","2010-02-23 13:41:08+00:00","SCI: add Gabriel Knight 1 French DOS CD detection entry

svn-id: r48115
"
"ed11cd3980f9539404b7ce19adf76d3d539c2235","2010-02-23 21:01:05+00:00","configure: Remove angstrom-* from the ARM compiler check as angstrom can be built for ARM and many other architectures. arm*-linux-gnueabi will pick up Angstrom toolchains anyway.

svn-id: r48116
"
"da95a9820362f50477b35f9f95fd299eacfd04b2","2010-02-23 22:41:20+00:00","SCI: Stop storing EngineState in SciGui32

svn-id: r48117
"
"02201e937ab7a5d408b4804225affb7ce0251cce","2010-02-23 22:44:46+00:00","SCI: Move SciGui::wait to EngineState::wait

svn-id: r48118
"
"2e68de1e5ab333966adeafdc998433fe346c9815","2010-02-23 22:47:53+00:00","SCI: Turn kernel_sleep() into SciEvent::sleep()

svn-id: r48119
"
"cdf847408b4d7bffe9865240066341c1b1c1b2d5","2010-02-23 22:50:28+00:00","Update Common::KeyState comments

svn-id: r48120
"
"4e691a774c111906357fd41d3f71b945a37509b3","2010-02-23 22:52:18+00:00","Tweak QueuingAudioStream comments

svn-id: r48121
"
"7f2259c11f5f5d97e252dc072dc88a3964d167a7","2010-02-23 22:54:23+00:00","Add assert(!_finished) to QueuingAudioStreamImpl::queueAudioStream

svn-id: r48122
"
"151889a76786dc554bf91ad16f4ca8dfbb0a1cb5","2010-02-24 00:39:48+00:00","Add another German Windows version of Pajama Sam 2.

svn-id: r48123
"
"6e07e3e6424750d8d6d8536dd67d4962f2ea9db4","2010-02-25 15:22:26+00:00","Fixing problems with the texts table in TOT files when the order of the texts and resources tables are switched in the TOT file

svn-id: r48124
"
"a0a300af6bd17c059237ebf13cc35e8e0a187457","2010-02-25 19:54:28+00:00","fixed delayed callback timing

svn-id: r48125
"
"da286bf8280b72e68b49b7e8ef44c13ff0ea7d7c","2010-02-25 19:58:54+00:00","hide mouse while playing cutscenes

svn-id: r48126
"
"0057e63f259ab4b405a6b575ea76629fde97ab2f","2010-02-25 20:11:30+00:00","fixed haystack and fatso problems

svn-id: r48127
"
"b90088e476e530bab84f9a24e321e6e50ef3d683","2010-02-25 20:36:10+00:00","reset intro flag after savegame loading

svn-id: r48128
"
"6876e1f9debeae3a77213e7339f1d26df3fcf498","2010-02-25 20:58:52+00:00","N64: some input related cleanup

svn-id: r48129
"
"00d3d5bffec293c2b66ad5253bdef9ce660018ce","2010-02-25 21:03:48+00:00","interpret several consequent moving command as one.

svn-id: r48130
"
"eacf1030e4fce35c9f9e048edfa05dc44d0a3e5d","2010-02-26 07:36:52+00:00","added async getFlag(addr)

svn-id: r48131
"
"a8a327616b3f6bb50fb374d5e1d5c37c1c9f3c67","2010-02-26 07:37:35+00:00","better flag/scene checking for the last intrusion attempt

svn-id: r48132
"
"08d3c24c12953c0c99286dac94486507f8deae6d","2010-02-26 08:11:45+00:00","Cleanup the sound code a bit.

svn-id: r48133
"
"e8c2c2b25c12b2e303643bc6ea1f168922d77e40","2010-02-26 08:14:33+00:00","Slightly rework refreshing cards in Riven (and remove the hackish changeToCard(0)).

svn-id: r48134
"
"bcb721cccd46fccba164044cf8afea92872a3c0f","2010-02-26 16:17:12+00:00","SCUMM: Fix stride of palette data in ARM optimised costime renderer

svn-id: r48135
"
"4a8ab4b075a186ce70c441ee0ceb3f6d5019d948","2010-02-26 17:29:18+00:00","DS: Merging accross changes from branch1-0-0 into trunk.

svn-id: r48136
"
"277b3078bcd1f655ad54504959091047a496be6c","2010-02-26 17:42:40+00:00","SID: Adding DISABLE_SID option, as SID player embiggens binary by a large amount.  This is a problem for the DS port.

svn-id: r48137
"
"bd2e65a02f5335bbf29a7aefef6e660fc33b9d8b","2010-02-26 17:55:27+00:00","DS: Attempting to rename Makefile to makefile.  Not sure why it hasn't been a problem in the past.

svn-id: r48138
"
"3f2471418d9e37aca3746bbc36d947471570fdae","2010-02-26 22:24:48+00:00","Fixed the music in some Mac versions of ITE and disabled some unused code for the original DOS demo of ITE

svn-id: r48139
"
"b7e57cb51e7d924f4567245885eb62d14c7c213b","2010-02-27 01:19:36+00:00","Fix Dragon History title.

svn-id: r48141
"
"f40c466d5e4996fd8ec604e0bd469cefa5c122e0","2010-02-27 02:49:27+00:00","Fix bug #2959947 - SPYFOX1: Saves don't work from menu.

svn-id: r48142
"
"75a0022dff6dc861df04a517be88242bd9324f9a","2010-02-27 05:30:53+00:00","Beginnings of code for scene info loading

svn-id: r48143
"
"deab6f83cdf01be2528eb6be1d06837b0e249905","2010-02-27 10:34:33+00:00","N64: Add a preliminary port specific readme

svn-id: r48144
"
"86580405530dc7913d4906097c77f4f550b830e9","2010-02-27 11:08:42+00:00","N64: correct control buttons naming

svn-id: r48145
"
"9fcbfc180eb4177902c2ba61965600a42834dee8","2010-02-27 11:44:35+00:00","N64: added list of required devices to use the port

svn-id: r48146
"
"05f942917eef03c7075aa5bc867582e9b5ae0f2d","2010-02-27 15:54:31+00:00","DRACI: Don't try to set the volume for channels that couldn't be allocated (fixes bug #2907954: 'DRAGON: Crash in Intro')

svn-id: r48147
"
"22e5a557b73c7c4e25e7cc00bf7e10e7e2d530cc","2010-02-27 17:02:58+00:00","Added the svn:keywords property to some files missing it.

svn-id: r48148
"
"eda17df00c2a9600757bfbf2b85c587587ab6e16","2010-02-27 18:54:21+00:00","Check if we should quit on every opcode call instead of after every 500. Fixes bug #2960238.

svn-id: r48149
"
"2881a8c057baf9b60d2c1fd84fe5df47638b2976","2010-02-28 01:07:25+00:00","Implemented loading of the Rex Nebular walkable areas

svn-id: r48150
"
"576f0b9a66d267e5068c00a955a14f736be95992","2010-02-28 01:35:34+00:00","Fix gcc warning.

svn-id: r48151
"
"3150006528ed68f12387c015cf413b0e9a30d3f0","2010-02-28 08:32:45+00:00","Don't try to dispose of '_bgBuf + 256' automatically when playing the BASS
intro sound effects. The engine manages that memory on its own. This should
fix bug #2960522, 'BASS: Crash During the Intro'.

svn-id: r48152
"
"2741705758a6ec8f185657bf739da410dc789817","2010-02-28 13:09:09+00:00","N64: change how asserts are printed

svn-id: r48153
"
"d1e7fcbe757555b2d19684e378625ec6bb34afb9","2010-02-28 14:33:22+00:00","do not delete the stream twice in makeZipArchive as it's already deleted by unzOpen if a problem is encountered

svn-id: r48154
"
"23cf40db2b0e3aff19310ce2ed57f8ded44e51bf","2010-02-28 14:40:40+00:00","Add a comment to document my removal of stream delete in previous commit

svn-id: r48155
"
"8cc157a72da7c07bca7264232801c6c12a79c1eb","2010-02-28 20:22:48+00:00","Add detection entry for SQ4 Mac.

svn-id: r48156
"
"3c9377af089df61f6ad48c959a4ab200b4af74ef","2010-02-28 20:42:07+00:00","Remove a reference to the old MorphOS backend in configure.

svn-id: r48157
"
"d204f97beb9dc3791d1a01959735bc3c4049318c","2010-03-02 00:18:00+00:00","Fix bug #2961530 - Zak/FM-Towns: Game hangs when using monkey wrench.

svn-id: r48158
"
"4221460f6d3a27c98f8c1686784bcba748d833f7","2010-03-04 16:34:27+00:00","Fix item exchange string in Kyra 1 Amiga (both English and German).

svn-id: r48159
"
"5c93ac4adc5df5b0827285cc9f7edd0cdadec7fa","2010-03-04 17:21:59+00:00","cruise: add detection entry for Amiga English US GOLD version

svn-id: r48160
"
"ca6b617e630d4f232afb8cb1353e757ebdab500e","2010-03-04 17:24:47+00:00","Fix mismatching new[]/delete.

svn-id: r48161
"
"ef70f6996b0243e00d153c9c4ede2aad5b1f7779","2010-03-04 17:46:18+00:00","Fix another mismatching new[] call (note that this needs to be replaced by malloc, since else MemoryReadStream will try to use free on an new[] allocated block.)

svn-id: r48162
"
"902dc6929ad54fb20aa0353d09a9ceb5464e1192","2010-03-05 00:58:29+00:00","Patch #2963270: MM: V0 Verb Give Fix

svn-id: r48163
"
"724e9a0ceb945931dc30b96117282900e84b0c9c","2010-03-05 15:52:51+00:00","Add detection for Playtoons 3 EN, based on Hkz MD5s

svn-id: r48164
"
"5cf998eab3673c01f4beb0cdd77f0bb4fe404d5e","2010-03-05 23:35:28+00:00","SCI: Add detection entry for Space Quest 5 french found in Space Quest Collector's edition

svn-id: r48165
"
"e869b5c7e67d26227a013d2d5596090165a3e180","2010-03-06 00:35:27+00:00","Gob3 CD - some texts are skipped in the CD version because they are considered as subtitles. Even if this behavior is also found in the original, it's incorrect. This fixes those texts (see newspaper after death level).

svn-id: r48166
"
"e011df1f68c3acdeeba8e6d0982550a81fd0b5fe","2010-03-06 09:37:03+00:00","Gob3CD - Move subtitle check to initialization

svn-id: r48167
"
"cb71fd72407e1fa3aaa778ac9655fc4ac58dd649","2010-03-06 09:46:42+00:00","Playtoons - Add MD5s specified by scoriae in the forums

svn-id: r48168
"
"4f74853f93fe3c598b22163b42d7f4a2a22b712c","2010-03-06 12:59:19+00:00","N64: Reduce N64 mouse sensibility a bit

svn-id: r48169
"
"5f6e0c3e94491b176bf04b759320b0cf324332aa","2010-03-06 13:49:20+00:00","N64: Use mips timer to partially simulate an RTC for the n64 port

svn-id: r48170
"
"a5a8b6c19f2601113fc3d3a14b6ec19576fdd1f8","2010-03-06 22:40:55+00:00","- Reorder detection (floppy, CD, demos).
- Move Gob3CD _doSubtitles initialization to updateConfig().

svn-id: r48171
"
"7f57001e175ef2215e192968e9883e63145e7a50","2010-03-07 05:06:58+00:00","Split up the scene.cpp file into separate files for M4 and MADS specific scene code and support classes. Also have started adding code for textual display and proper current action display

svn-id: r48172
"
"e7765c983a65168178b9e18dbbe10e711906ccbc","2010-03-07 09:22:19+00:00","Add font data for Polish Windows 4CD version of The Feeble Files.

svn-id: r48173
"
"0e41ec67d15122a41c318191accbd10056569c5b","2010-03-07 11:46:03+00:00","Exclude font data tables for The Feeble Files, when AGOS2 games are disabled.

svn-id: r48174
"
"19fb5e362fa6f835d13c2daa656d4c8bf3142dba","2010-03-07 22:54:30+00:00","This is 1.1.0pre

svn-id: r48177
"
"2b453f3aa665167f4d4bac690838fd79fdf05810","2010-03-08 21:32:14+00:00","Re-enable the asm costume

svn-id: r48200
"
"9f1665220d9452a9ed7a14a7f3d7df89fb7e9631","2010-03-08 21:54:54+00:00","Backport: Fix bug #2872076 (MIXER: Division by 0 in rate conversion if w/o soundcd)

svn-id: r48204
"
"aa06fc37d80b37f31281737c8892c624fd0e04e7","2010-03-09 00:49:26+00:00","Backport of r48209 and r48210, which were some slight rule fixes.

svn-id: r48211
"
"95145fcc327de396494a1b24dd6df959ed1ea12d","2010-03-09 00:52:25+00:00","Backport of r48208: 'Conistenlty use USE_NASM instead of using HAVE_NASM in config.mk (this matches all the external library use too).'

This fixes the MSVC project files created via create_msvc.

svn-id: r48212
"
"c45eb1ada1b0045ad76b59de7bcc5cfca38b20c6","2010-03-10 10:57:28+00:00","Backport patch #2967256: Bashisms in configure break build on Solaris

svn-id: r48220
"
"12799610e7d6a269ad5d116f9588dba368c7a9cd","2010-03-10 11:26:06+00:00","Fix warning

svn-id: r48221
"
"217992ca0ffc35591604f3da6e5978901c22c8e3","2010-03-10 20:38:39+00:00","Backport of r48225.

svn-id: r48226
"
"8241dde081917a49b5119803e67e9d44a81b1173","2010-03-11 20:33:27+00:00","backport bug#2963556 SAGA: Memory leaks

svn-id: r48237
"
"4861136fb882a20934ca09b9c238f7ee218a4f6e","2010-03-12 22:37:08+00:00","Fix bug #2969282: DW2: Weird 'PC SPEAKER-like' sound distortion.

svn-id: r48247
"
"5c71f4dfd0595d7f3c7a1fee9a76137b5c46a2cd","2010-03-12 23:02:49+00:00","Fix from LordHoto for bug #2859401: GUI: GMM crashes when running in 320x200 and 320x240

svn-id: r48249
"
"9849d031848e521e120146497784e11cb129a5c7","2010-03-13 19:43:31+00:00","backport samsungtv changes from trunk

svn-id: r48252
"
"6216b47dbc63be245450f44cdc192574298cfddd","2010-03-13 19:45:49+00:00","fill debian changelog

svn-id: r48253
"
"9d4be572b5de815317b825ae9d889c948d6b17e0","2010-03-14 09:27:24+00:00","backport from trunk

svn-id: r48259
"
"adc2073ad77df241217f7b2714979a490b3b160d","2010-03-14 09:28:47+00:00","backport from trunk

svn-id: r48261
"
"4f07b4bf8fe160acb4ed40ee218d849066cd7a2b","2010-03-15 17:45:59+00:00","Backporting r48262: The frame coordinate cropping for IMDs is wrong, and should be unnecessary anyway, since Imd::renderFrame() should already check for overblitting. This fixes bug #2969904 ('GOB3: Graphical Glitch in finished cutscene')

svn-id: r48263
"
"5f509f3ce4d92beab6e7d8a942eee11c3deac1ec","2010-03-15 22:24:52+00:00","Backporting r48264: Changing Imd::renderFrame() and Vmd::renderFrame() to properly clip the drawing area to prevent overdrawing without producing garbage output

svn-id: r48265
"
"0abc527a7ea07f86554b8c28c0253cdc462ee623","2010-03-19 12:40:50+00:00","PSP: removed unnecessary overloading of addCustomDirectories()

svn-id: r48300
"
"a10ba72b18e6b7b20733500539f86589e67a1708","2010-03-19 13:47:24+00:00","DC: Removing unneeded DCPluginProvider::addCustomDirectories

svn-id: r48302
"
"113267f90c9300116ab852856f2166d5ba385610","2010-03-19 13:53:23+00:00","Also remov Win32PluginProvider::addCustomDirectories, as it obviously isn't being used

svn-id: r48303
"
"73d226851c24bc1157e5d964cfd06ce880310ee3","2010-03-20 15:57:04+00:00","DS: Changing version number in branch

svn-id: r48323
"
"97bd417befa0ed239ec062dc82fb760add6a015c","2010-03-20 17:05:59+00:00","DS: Fix hold select button for main menu timer bug

svn-id: r48328
"
"a69357dffef21f79276bd02377ce15e2673a6e17","2010-03-20 17:19:23+00:00","DS: Slight fix to my previous timer fix for holding down the select button

svn-id: r48330
"
"c8b37784ccd9d6d2ef284d01d199bef5a8592a57","2010-03-20 20:32:01+00:00","Backport of r48338: 'Fix out of bounds access.'

svn-id: r48339
"
"45d7a002d591e4133130ec25ee50d8f82941ae90","2010-03-21 00:34:18+00:00","The $VERSION string with 'pre' at the end is too long, shorten it down by replaing the inital 'V' with 'p' and dropping the suffix.

svn-id: r48344
"
"bfe420af5333f189067aecc77741015f81f27234","2010-03-21 00:40:10+00:00","Backport of commit #48255 - Increase double click allowed time

svn-id: r48345
"
"5bdb2a89f6223dd9c23e3ffe83e082da57a0a90c","2010-03-21 00:47:05+00:00","Disabled serial for release.

svn-id: r48346
"
"602c421f0cf7848bdfa5e45cb3d8418716dc5149","2010-03-21 00:50:34+00:00","Redid version shortening to match the 1.0.0 branch.  This avoids trouble with rc1 and suchlike too.

svn-id: r48347
"
"ea6d9e730a1c9abb866d35e9b334b0fe8d483478","2010-03-22 15:57:46+00:00","Backport of r48356: 'Fix for bug #2969211 'NIPPON: Crash in Intro'.'

svn-id: r48357
"
"52617f428cded1bf5f7b9f95d28284e750817caf","2010-03-22 23:04:12+00:00","Backport r48280: COMMON: Move port specific '#define fputs' from util.cpp to textconsole.cpp

svn-id: r48361
"
"466245413bfc345288fa4266b0c1f7898f0b41b1","2010-03-22 23:05:37+00:00","Fix warning

svn-id: r48363
"
"39cfeb7590815a8a6551b5411af67f40331c7b7f","2010-03-22 23:06:09+00:00","Backport patch #2938173: LinuxMoto update 23012010

svn-id: r48364
"
"1d23450ad8f7dd0700a4ca2bb31e1c6855850dbc","2010-03-23 00:42:42+00:00","Backport fix for compiler warning.

svn-id: r48366
"
"388a9843c5b3d7c65d68cb5838c64e91b646e415","2010-03-23 21:23:56+00:00","merged teenagent engine back from trunk

svn-id: r48372
"
"cfdb6aa5f84f7a9860d0847c8b2e0f8a8353b50a","2010-03-23 22:58:44+00:00","(Backport of r48373) Cine: Fix regression in executePlayerInput (Caused slowness when clicking when moving).

The regression was caused by r47505.

svn-id: r48374
"
"705dc26aeeda06cdbdcc13bab068b3efe0c55dff","2010-03-24 16:37:10+00:00","update samsungtv toolchain prefix

svn-id: r48379
"
"25ff18172ae5d62e93591eaa9e0c8b02b17133ea","2010-03-24 20:00:41+00:00","DS: Updating port-specific readme

svn-id: r48387
"
"5a380e5b9c2793c67f8c7fef86ff48c2587540d1","2010-03-24 20:06:05+00:00","Maemo icons for 1.1.0

svn-id: r48388
"
"430134435a6df68136d76e61deaac5be9df66cac","2010-03-24 20:11:03+00:00","desktop and service items for launching

svn-id: r48389
"
"54ab6837378e3e1209584de00de3776317ed589a","2010-03-24 20:42:18+00:00","Maemo dirty patch updated for 1.1.0

svn-id: r48392
"
"21a01bc640bf95b8e5cfe70e472d9455162ca6f7","2010-03-24 21:24:43+00:00","not need this for samsungtv

svn-id: r48394
"
"c83547d2bc92a1ae4319a61d60002559ef319416","2010-03-25 10:11:26+00:00","-fixed fan room
-shake screen when barmans felt
-fixed warning in messageDuration

svn-id: r48400
"
"ec3daefae5c20c689c00a735b22fe215778c4d3b","2010-03-26 22:21:56+00:00","Backport of 48406 - Adding initialisation of default NPC direction to fix Valgrind error

svn-id: r48407
"
"5edc22065780539f990110eb1ce1f2ee0a69c364","2010-03-27 22:02:05+00:00","Backport of revision 48412 - correction of menu deallocation

svn-id: r48413
"
"c8806174f7e83fa35677fc0ae8d9613cc4eaa0bf","2010-03-28 21:10:47+00:00","Backported fix for bug #2961891 ('FOTAQ: Floda Alarm Tone Won't Stop'). I've
played through the whole game without noticing any problems. The music did go
out at some point (points?) in the temple on the island, but that also happened
when playing through that part with 1.0 so I don't think it's a regression.
(For reference, in 1.0 it happened shortly after getting the big stick.)

svn-id: r48414
"
"9c9b390ce5b4d94471cc738129d0a23529c305a3","2010-03-29 18:58:47+00:00","(Backport) Fixed bug 2969234 by tampering with the gameId. Probably not a nice solution, but hopefully ok for a while.

svn-id: r48416
"
"835706cee12f34facf8a106f6da4cceb20da48f3","2010-03-29 23:15:24+00:00","DS: Fix hover mode in MADE games.

svn-id: r48419
"
"dda14f32cce546393e90571b5e7f1385291ef69a","2010-03-30 06:01:26+00:00","(Backport) Let Parallaction return game-specific gameids. This completes the fix for bug 2969234 after LordHoto's patch.

svn-id: r48423
"
"88bb8dadf2e94d7664522314bbbe548099d3391c","2010-03-30 10:46:04+00:00","Backport of revision #48421 - Fix for memory leak on Restart/Restore screen reported by Valgrind

svn-id: r48425
"
"5f1b8173d84b0a6adf799d712700ef2df90f1fa9","2010-03-30 14:16:01+00:00","Backport of r48418: 'Use ConfMan to query the gameid of the passed target instead of deducing from the target to the gameid. Along with it fix the removeSaveState implementation.'

svn-id: r48426
"
"a81e1aa29bfe7ba8307cf0a079af07a8dc14c21b","2010-03-30 21:32:26+00:00","DS: Make MAME OPL synth clean up correctly on DS

svn-id: r48427
"
"ba5e037f5cd9806fadc35b64cc574fc6fee0601c","2010-03-30 21:34:04+00:00","DS: Set controls mode correctly for AGI

svn-id: r48428
"
"cfac1bac73407c6f345b84c79b3a0fb249b88293","2010-03-30 22:12:28+00:00","DS: Fix incorrect define symbol used in previous commit

svn-id: r48429
"
"0c73cb150dca95f6f59af8f52dbddb8658cc381e","2010-03-30 22:13:29+00:00","DS: Include correct header for agi controls mode setting

svn-id: r48430
"
"d795932029373ebc5ba03f90114dccca80923c1f","2010-03-30 22:26:13+00:00","DS: Make cursor only switch to the top screen if we're in trackpad mode.

svn-id: r48431
"
"6c990511504467d886b6dc1c9f141d5b79c9da60","2010-03-30 22:31:35+00:00","DS: Initialise some global key tracking variables to attempt to fix an occational bug where the mouse mode starts in hover rather than left button mode.

svn-id: r48432
"
"74753dadcd6a1354dc421759fc157742dd045041","2010-03-31 00:01:10+00:00","For the aficionados of Makefile builds:

- modded Makefile.ps2 / Makefile.gdb so that they work with 1.1.0

- added bogus 'tools' folder to keep 'make clean' happy [hack]

svn-id: r48433
"
"2c3798a30afb8089285bdb51d4e8c27d2d6927bc","2010-03-31 22:01:12+00:00","Specify release date for 1.1.0

svn-id: r48435
"
"269430e2e0e68731639221d14506de4f9a385a79","2010-03-31 22:20:12+00:00","SAGA2 is to be disabled in all release builds, even the PS2 one ;)

svn-id: r48437
"
"054407e428dd1b0a5bacae996ea2d492de913f71","2010-03-31 22:31:59+00:00","This is 1.1.0

svn-id: r48442
"
"2c693e6877a89a14df24ab56510f67090a242598","2010-03-31 22:46:25+00:00","DS: Fix version in readme_ds.txt

svn-id: r48443
"
"b4a639744c1b26c966100b741af5154a8ca444f5","2010-03-31 22:50:30+00:00","Disable SCI for the release (wtf was it enabled in the first place?)

svn-id: r48445
"
"bdf87c92382635373142ad6f4d1e25dc39ec76cb","2010-03-31 22:54:21+00:00","REDHAT: Fixing dists/redhat/scummvm-tools.spec manually. UNTESTED but hopefully correct. In trunk this should be fixed by adding it to the list of files treated by tools/update-version.pl

svn-id: r48447
"
"0d952a092498fec2fdcb974ff8c74f7be6d35db6","2010-03-31 23:03:24+00:00","Add msvc8, msvc9 and (experimental) msvc10 project files.

svn-id: r48448
"
"941d694ca5363b7a7693fe6a400f3365caeae8f5","2010-03-31 23:33:49+00:00","Tweak WinCE port readme file to correct version numbers.

svn-id: r48450
"
"df7e13e84f3f9a3877afc0c07b3f00ceca6141eb","2010-04-03 11:27:33+00:00","Updated README-WinCE.txt file. This is a late checkin, but can't affect
anyone elses builds, so should be OK.

svn-id: r48482
"
